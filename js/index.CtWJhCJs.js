var e=Object.defineProperty,t=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,a=Math.pow,s=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i,l=(e,t)=>{for(var n in t||(t={}))r.call(t,n)&&s(e,n,t[n]);if(i)for(var n of i(t))o.call(t,n)&&s(e,n,t[n]);return e},c=(e,i)=>t(e,n(i)),u=(e,t,n)=>s(e,"symbol"!=typeof t?t+"":t,n),h=(e,t,n)=>new Promise(((i,r)=>{var o=e=>{try{s(n.next(e))}catch(t){r(t)}},a=e=>{try{s(n.throw(e))}catch(t){r(t)}},s=e=>e.done?i(e.value):Promise.resolve(e.value).then(o,a);s((n=n.apply(e,t)).next())}));import{t as d,W as f,i as p,b as g,c as v,s as A,a as m,d as y,e as b,o as C,f as w,g as x,h as _,k as E,j as S,l as I,m as k,n as B,p as O,q as T,r as D,U as M,u as Q,v as L,w as P,S as j,x as R,y as F,z as N,A as V,B as U,C as z,D as H,E as Y,F as G,G as W,H as X,I as $,J as q,K,L as J,M as Z,N as ee,O as te,P as ne,Q as ie,R as re,T as oe,V as ae,X as se,Y as le,Z as ce,_ as ue,$ as he,a0 as de,a1 as fe,a2 as pe,a3 as ge,a4 as ve,a5 as Ae,a6 as me,a7 as ye,a8 as be,a9 as Ce,aa as we,ab as xe,ac as _e,ad as Ee,ae as Se,af as Ie,ag as ke,ah as Be,ai as Oe,aj as Te,ak as De,al as Me,am as Qe,an as Le,ao as Pe,ap as je,aq as Re,ar as Fe,as as Ne,at as Ve,au as Ue,av as ze,aw as He,ax as Ye,ay as Ge,az as We,aA as Xe,aB as $e,aC as qe,aD as Ke,aE as Je,aF as Ze,aG as et,aH as tt,aI as nt,aJ as it,aK as rt,aL as ot,aM as at,aN as st,aO as lt,aP as ct,aQ as ut,aR as ht,aS as dt,aT as ft,aU as pt,aV as gt,aW as vt,aX as At,aY as mt,aZ as yt,a_ as bt,a$ as Ct,b0 as wt,b1 as xt,b2 as _t,b3 as Et,b4 as St,b5 as It,b6 as kt,b7 as Bt,b8 as Ot,b9 as Tt,ba as Dt,bb as Mt,bc as Qt,bd as Lt,be as Pt,bf as jt,bg as Rt,bh as Ft,bi as Nt,bj as Vt,bk as Ut,bl as zt,bm as Ht,bn as Yt,bo as Gt,bp as Wt,bq as Xt,br as $t,bs as qt,bt as Kt,bu as Jt,bv as Zt,bw as en,bx as tn,by as nn,bz as rn,bA as on,bB as an,bC as sn,bD as ln,bE as cn,bF as un,bG as hn,bH as dn,bI as fn,bJ as pn,bK as gn,bL as vn,bM as An,bN as mn,bO as yn,bP as bn,bQ as Cn,bR as wn,bS as xn,bT as _n,bU as En,bV as Sn,bW as In,bX as kn,bY as Bn,bZ as On,b_ as Tn,b$ as Dn,c0 as Mn,c1 as Qn}from"./usePageList.CC8tqfpJ.js";import{i as Ln,b as Pn,a as jn,r as Rn,c as Fn,d as Nn,e as Vn,f as Un,h as zn,j as Hn,t as Yn,k as Gn,l as Wn,M as Xn,S as $n,m as qn,n as Kn,o as Jn,p as Zn,q as ei,s as ti,u as ni,v as ii,w as ri,x as oi,y as ai,z as si,A as li,B as ci,C as ui,D as hi,E as di,F as fi,G as pi,H as gi,I as vi,J as Ai,K as mi,L as yi,N as bi,O as Ci,P as wi,Q as xi,R as _i,T as Ei,U as Si,V as Ii,W as ki,X as Bi,Y as Oi,Z as Ti,_ as Di,$ as Mi,a0 as Qi,a1 as Li,a2 as Pi,a3 as ji,a4 as Ri,a5 as Fi,a6 as Ni,a7 as Vi,a8 as Ui,a9 as zi,aa as Hi,ab as Yi,ac as Gi,ad as Wi,ae as Xi,af as $i,ag as qi,ah as Ki,ai as Ji,aj as Zi,ak as er,al as tr,am as nr,an as ir,ao as rr,ap as or,aq as ar,ar as sr,as as lr,at as cr,au as ur,av as hr,aw as dr,ax as fr,ay as pr,az as gr,aA as vr,aB as Ar,aC as mr,aD as yr,aE as br,aF as Cr,aG as wr,aH as xr,aI as _r,aJ as Er,aK as Sr,aL as Ir,aM as kr,aN as Br,aO as Or,aP as Tr,aQ as Dr,aR as Mr,aS as Qr,aT as Lr,aU as Pr,aV as jr,aW as Rr,aX as Fr,aY as Nr,aZ as Vr,a_ as Ur,a$ as zr}from"./index.DmdkuQXN.js";function Hr(e){return"number"==typeof e?e:Ln(e)?NaN:+e}function Yr(e,t){return function(n,i){var r;if(void 0===n&&void 0===i)return t;if(void 0!==n&&(r=n),void 0!==i){if(void 0===r)return i;"string"==typeof n||"string"==typeof i?(n=Pn(n),i=Pn(i)):(n=Hr(n),i=Hr(i)),r=e(n,i)}return r}}var Gr=Yr((function(e,t){return e+t}),0),Wr=1/0;function Xr(e){return e?(e=d(e))===Wr||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}function $r(e){var t=Xr(e),n=t%1;return t==t?n?t-n:t:0}var qr=f&&new f,Kr=qr?function(e,t){return qr.set(e,t),e}:p;function Jr(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=g(e.prototype),i=e.apply(n,t);return jn(i)?i:n}}var Zr=Math.max;function eo(e,t,n,i){for(var r=-1,o=e.length,a=n.length,s=-1,l=t.length,c=Zr(o-a,0),u=Array(l+c),h=!i;++s<l;)u[s]=t[s];for(;++r<a;)(h||r<o)&&(u[n[r]]=e[r]);for(;c--;)u[s++]=e[r++];return u}var to=Math.max;function no(e,t,n,i){for(var r=-1,o=e.length,a=-1,s=n.length,l=-1,c=t.length,u=to(o-s,0),h=Array(u+c),d=!i;++r<u;)h[r]=e[r];for(var f=r;++l<c;)h[f+l]=t[l];for(;++a<s;)(d||r<o)&&(h[f+n[a]]=e[r++]);return h}function io(){}function ro(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function oo(){}ro.prototype=g(io.prototype),ro.prototype.constructor=ro;var ao=qr?function(e){return qr.get(e)}:oo,so={},lo=Object.prototype.hasOwnProperty;function co(e){for(var t=e.name+"",n=so[t],i=lo.call(so,t)?n.length:0;i--;){var r=n[i],o=r.func;if(null==o||o==e)return r.name}return t}function uo(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}function ho(e){if(e instanceof ro)return e.clone();var t=new uo(e.__wrapped__,e.__chain__);return t.__actions__=v(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}uo.prototype=g(io.prototype),uo.prototype.constructor=uo;var fo=Object.prototype.hasOwnProperty;function po(e){if(Fn(e)&&!Nn(e)&&!(e instanceof ro)){if(e instanceof uo)return e;if(fo.call(e,"__wrapped__"))return ho(e)}return new uo(e)}function go(e){var t=co(e),n=po[t];if("function"!=typeof n||!(t in ro.prototype))return!1;if(e===n)return!0;var i=ao(n);return!!i&&e===i[0]}po.prototype=io.prototype,po.prototype.constructor=po;var vo=A(Kr),Ao=/\{\n\/\* \[wrapped with (.+)\] \*/,mo=/,? & /;var yo=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;function bo(e,t,n,i){for(var r=e.length,o=n+(i?1:-1);i?o--:++o<r;)if(t(e[o],o,e))return o;return-1}function Co(e){return e!=e}function wo(e,t,n){return t==t?function(e,t,n){for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}(e,t,n):bo(e,Co,n)}function xo(e,t){return!!(null==e?0:e.length)&&wo(e,t,0)>-1}var _o=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];function Eo(e,t,n){var i=t+"";return y(e,function(e,t){var n=t.length;if(!n)return e;var i=n-1;return t[i]=(n>1?"& ":"")+t[i],t=t.join(n>2?", ":" "),e.replace(yo,"{\n/* [wrapped with "+t+"] */\n")}(i,function(e,t){return m(_o,(function(n){var i="_."+n[0];t&n[1]&&!xo(e,i)&&e.push(i)})),e.sort()}(function(e){var t=e.match(Ao);return t?t[1].split(mo):[]}(i),n)))}function So(e,t,n,i,r,o,a,s,l,c){var u=8&t;t|=u?32:64,4&(t&=~(u?64:32))||(t&=-4);var h=[e,t,r,u?o:void 0,u?a:void 0,u?void 0:o,u?void 0:a,s,l,c],d=n.apply(void 0,h);return go(e)&&vo(d,h),d.placeholder=i,Eo(d,e,t)}function Io(e){return e.placeholder}var ko=Math.min;var Bo="__lodash_placeholder__";function Oo(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n];a!==t&&a!==Bo||(e[n]=Bo,o[r++]=n)}return o}function To(e,t,n,i,r,o,a,s,l,c){var u=128&t,h=1&t,d=2&t,f=24&t,p=512&t,g=d?void 0:Jr(e);return function A(){for(var m=arguments.length,y=Array(m),b=m;b--;)y[b]=arguments[b];if(f)var C=Io(A),w=function(e,t){for(var n=e.length,i=0;n--;)e[n]===t&&++i;return i}(y,C);if(i&&(y=eo(y,i,r,f)),o&&(y=no(y,o,a,f)),m-=w,f&&m<c){var x=Oo(y,C);return So(e,t,To,A.placeholder,n,y,x,s,l,c-m)}var _=h?n:this,E=d?_[e]:e;return m=y.length,s?y=function(e,t){for(var n=e.length,i=ko(t.length,n),r=v(e);i--;){var o=t[i];e[i]=Vn(o,n)?r[o]:void 0}return e}(y,s):p&&m>1&&y.reverse(),u&&l<m&&(y.length=l),this&&this!==Rn&&this instanceof A&&(E=g||Jr(E)),E.apply(_,y)}}var Do="__lodash_placeholder__",Mo=128,Qo=Math.min;var Lo=Math.max;function Po(e,t,n,i,r,o,a,s){var l=2&t;if(!l&&"function"!=typeof e)throw new TypeError("Expected a function");var c=i?i.length:0;if(c||(t&=-97,i=r=void 0),a=void 0===a?a:Lo($r(a),0),s=void 0===s?s:$r(s),c-=r?r.length:0,64&t){var u=i,h=r;i=r=void 0}var d=l?void 0:ao(e),f=[e,t,n,i,r,u,h,o,a,s];if(d&&function(e,t){var n=e[1],i=t[1],r=n|i,o=r<131,a=i==Mo&&8==n||i==Mo&&256==n&&e[7].length<=t[8]||384==i&&t[7].length<=t[8]&&8==n;if(!o&&!a)return e;1&i&&(e[2]=t[2],r|=1&n?0:4);var s=t[3];if(s){var l=e[3];e[3]=l?eo(l,s,t[4]):s,e[4]=l?Oo(e[3],Do):t[4]}(s=t[5])&&(l=e[5],e[5]=l?no(l,s,t[6]):s,e[6]=l?Oo(e[5],Do):t[6]),(s=t[7])&&(e[7]=s),i&Mo&&(e[8]=null==e[8]?t[8]:Qo(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=r}(f,d),e=f[0],t=f[1],n=f[2],i=f[3],r=f[4],!(s=f[9]=void 0===f[9]?l?0:e.length:Lo(f[9]-c,0))&&24&t&&(t&=-25),t&&1!=t)p=8==t||16==t?function(e,t,n){var i=Jr(e);return function r(){for(var o=arguments.length,a=Array(o),s=o,l=Io(r);s--;)a[s]=arguments[s];var c=o<3&&a[0]!==l&&a[o-1]!==l?[]:Oo(a,l);return(o-=c.length)<n?So(e,t,To,r.placeholder,void 0,a,c,void 0,void 0,n-o):b(this&&this!==Rn&&this instanceof r?i:e,this,a)}}(e,t,s):32!=t&&33!=t||r.length?To.apply(void 0,f):function(e,t,n,i){var r=1&t,o=Jr(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=i.length,u=Array(c+s),h=this&&this!==Rn&&this instanceof t?o:e;++l<c;)u[l]=i[l];for(;s--;)u[l++]=arguments[++a];return b(h,r?n:this,u)}}(e,t,n,i);else var p=function(e,t,n){var i=1&t,r=Jr(e);return function t(){return(this&&this!==Rn&&this instanceof t?r:e).apply(i?n:this,arguments)}}(e,t,n);return Eo((d?Kr:vo)(p,f),e,t)}function jo(e,t,n){return t=n?void 0:t,Po(e,128,void 0,void 0,void 0,void 0,t=e&&null==t?e.length:t)}function Ro(e,t){return y(C(e,t,p),e+"")}function Fo(e,t,n){if(!jn(n))return!1;var i=typeof t;return!!("number"==i?w(n)&&Vn(t,n.length):"string"==i&&t in n)&&Un(n[t],e)}function No(e){return Ro((function(t,n){var i=-1,r=n.length,o=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(r--,o):void 0,a&&Fo(n[0],n[1],a)&&(o=r<3?void 0:o,r=1),t=Object(t);++i<r;){var s=n[i];s&&e(t,s,i,o)}return t}))}var Vo=Object.prototype.hasOwnProperty,Uo=No((function(e,t){if(x(t)||w(t))_(t,E(t),e);else for(var n in t)Vo.call(t,n)&&zn(e,n,t[n])})),zo=No((function(e,t){_(t,S(t),e)})),Ho=No((function(e,t,n,i){_(t,S(t),e,i)})),Yo=No((function(e,t,n,i){_(t,E(t),e,i)}));function Go(e,t){for(var n=-1,i=t.length,r=Array(i),o=null==e;++n<i;)r[n]=o?void 0:I(e,t[n]);return r}var Wo=k(Go),Xo=Function.prototype,$o=Object.prototype,qo=Xo.toString,Ko=$o.hasOwnProperty,Jo=qo.call(Object);function Zo(e){if(!Fn(e)||"[object Object]"!=Hn(e))return!1;var t=B(e);if(null===t)return!0;var n=Ko.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&qo.call(n)==Jo}function ea(e){if(!Fn(e))return!1;var t=Hn(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!Zo(e)}var ta=Ro((function(e,t){try{return b(e,void 0,t)}catch(n){return ea(n)?n:new Error(n)}}));function na(e,t){var n;if("function"!=typeof t)throw new TypeError("Expected a function");return e=$r(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}var ia=Ro((function(e,t,n){var i=1;if(n.length){var r=Oo(n,Io(ia));i|=32}return Po(e,i,t,n,r)}));ia.placeholder={};var ra=k((function(e,t){return m(t,(function(t){t=Yn(t),Gn(e,t,ia(e[t],e))})),e})),oa=Ro((function(e,t,n){var i=3;if(n.length){var r=Oo(n,Io(oa));i|=32}return Po(t,i,e,n,r)}));function aa(e,t,n){var i=-1,r=e.length;t<0&&(t=-t>r?0:r+t),(n=n>r?r:n)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(r);++i<r;)o[i]=e[i+t];return o}function sa(e,t,n){var i=e.length;return n=void 0===n?i:n,!t&&n>=i?e:aa(e,t,n)}oa.placeholder={};var la=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");function ca(e){return la.test(e)}var ua="\\ud800-\\udfff",ha="["+ua+"]",da="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",fa="\\ud83c[\\udffb-\\udfff]",pa="[^"+ua+"]",ga="(?:\\ud83c[\\udde6-\\uddff]){2}",va="[\\ud800-\\udbff][\\udc00-\\udfff]",Aa="(?:"+da+"|"+fa+")"+"?",ma="[\\ufe0e\\ufe0f]?",ya=ma+Aa+("(?:\\u200d(?:"+[pa,ga,va].join("|")+")"+ma+Aa+")*"),ba="(?:"+[pa+da+"?",da,ga,va,ha].join("|")+")",Ca=RegExp(fa+"(?="+fa+")|"+ba+ya,"g");function wa(e){return ca(e)?function(e){return e.match(Ca)||[]}(e):function(e){return e.split("")}(e)}function xa(e){return function(t){var n=ca(t=Wn(t))?wa(t):void 0,i=n?n[0]:t.charAt(0),r=n?sa(n,1).join(""):t.slice(1);return i[e]()+r}}var _a=xa("toUpperCase");function Ea(e){return _a(Wn(e).toLowerCase())}function Sa(e,t,n,i){var r=-1,o=null==e?0:e.length;for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e);return n}function Ia(e){return function(t){return null==e?void 0:e[t]}}var ka=Ia({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),Ba=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Oa=RegExp("[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]","g");function Ta(e){return(e=Wn(e))&&e.replace(Ba,ka).replace(Oa,"")}var Da=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;var Ma=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;var Qa="\\ud800-\\udfff",La="\\u2700-\\u27bf",Pa="a-z\\xdf-\\xf6\\xf8-\\xff",ja="A-Z\\xc0-\\xd6\\xd8-\\xde",Ra="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fa="["+Ra+"]",Na="\\d+",Va="["+La+"]",Ua="["+Pa+"]",za="[^"+Qa+Ra+Na+La+Pa+ja+"]",Ha="(?:\\ud83c[\\udde6-\\uddff]){2}",Ya="[\\ud800-\\udbff][\\udc00-\\udfff]",Ga="["+ja+"]",Wa="(?:"+Ua+"|"+za+")",Xa="(?:"+Ga+"|"+za+")",$a="(?:['’](?:d|ll|m|re|s|t|ve))?",qa="(?:['’](?:D|LL|M|RE|S|T|VE))?",Ka="(?:[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]|\\ud83c[\\udffb-\\udfff])?",Ja="[\\ufe0e\\ufe0f]?",Za=Ja+Ka+("(?:\\u200d(?:"+["[^"+Qa+"]",Ha,Ya].join("|")+")"+Ja+Ka+")*"),es="(?:"+[Va,Ha,Ya].join("|")+")"+Za,ts=RegExp([Ga+"?"+Ua+"+"+$a+"(?="+[Fa,Ga,"$"].join("|")+")",Xa+"+"+qa+"(?="+[Fa,Ga+Wa,"$"].join("|")+")",Ga+"?"+Wa+"+"+$a,Ga+"+"+qa,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Na,es].join("|"),"g");function ns(e,t,n){return e=Wn(e),void 0===(t=n?void 0:t)?function(e){return Ma.test(e)}(e)?function(e){return e.match(ts)||[]}(e):function(e){return e.match(Da)||[]}(e):e.match(t)||[]}var is=RegExp("['’]","g");function rs(e){return function(t){return Sa(ns(Ta(t).replace(is,"")),e,"")}}var os=rs((function(e,t,n){return t=t.toLowerCase(),e+(n?Ea(t):t)})),as=Rn.isFinite,ss=Math.min;function ls(e){var t=Math[e];return function(e,n){if(e=d(e),(n=null==n?0:ss($r(n),292))&&as(e)){var i=(Wn(e)+"e").split("e"),r=t(i[0]+"e"+(+i[1]+n));return+((i=(Wn(r)+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}var cs=ls("ceil");function us(e){var t=po(e);return t.__chain__=!0,t}var hs=Math.ceil,ds=Math.max;function fs(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}function ps(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Xn;++t<n;)this.add(e[t])}function gs(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function vs(e,t){return e.has(t)}ps.prototype.add=ps.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},ps.prototype.has=function(e){return this.__data__.has(e)};function As(e,t,n,i,r,o){var a=1&n,s=e.length,l=t.length;if(s!=l&&!(a&&l>s))return!1;var c=o.get(e),u=o.get(t);if(c&&u)return c==t&&u==e;var h=-1,d=!0,f=2&n?new ps:void 0;for(o.set(e,t),o.set(t,e);++h<s;){var p=e[h],g=t[h];if(i)var v=a?i(g,p,h,t,e,o):i(p,g,h,e,t,o);if(void 0!==v){if(v)continue;d=!1;break}if(f){if(!gs(t,(function(e,t){if(!vs(f,t)&&(p===e||r(p,e,n,i,o)))return f.push(t)}))){d=!1;break}}else if(p!==g&&!r(p,g,n,i,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function ms(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function ys(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var bs=$n?$n.prototype:void 0,Cs=bs?bs.valueOf:void 0;var ws=Object.prototype.hasOwnProperty;var xs="[object Arguments]",_s="[object Array]",Es="[object Object]",Ss=Object.prototype.hasOwnProperty;function Is(e,t,n,i,r,o){var a=Nn(e),s=Nn(t),l=a?_s:L(e),c=s?_s:L(t),u=(l=l==xs?Es:l)==Es,h=(c=c==xs?Es:c)==Es,d=l==c;if(d&&P(e)){if(!P(t))return!1;a=!0,u=!1}if(d&&!u)return o||(o=new j),a||R(e)?As(e,t,n,i,r,o):function(e,t,n,i,r,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new M(e),new M(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Un(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=ms;case"[object Set]":var l=1&i;if(s||(s=ys),e.size!=t.size&&!l)return!1;var c=a.get(e);if(c)return c==t;i|=2,a.set(e,t);var u=As(s(e),s(t),i,r,o,a);return a.delete(e),u;case"[object Symbol]":if(Cs)return Cs.call(e)==Cs.call(t)}return!1}(e,t,l,n,i,r,o);if(!(1&n)){var f=u&&Ss.call(e,"__wrapped__"),p=h&&Ss.call(t,"__wrapped__");if(f||p){var g=f?e.value():e,v=p?t.value():t;return o||(o=new j),r(g,v,n,i,o)}}return!!d&&(o||(o=new j),function(e,t,n,i,r,o){var a=1&n,s=Q(e),l=s.length;if(l!=Q(t).length&&!a)return!1;for(var c=l;c--;){var u=s[c];if(!(a?u in t:ws.call(t,u)))return!1}var h=o.get(e),d=o.get(t);if(h&&d)return h==t&&d==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=a;++c<l;){var g=e[u=s[c]],v=t[u];if(i)var A=a?i(v,g,u,t,e,o):i(g,v,u,e,t,o);if(!(void 0===A?g===v||r(g,v,n,i,o):A)){f=!1;break}p||(p="constructor"==u)}if(f&&!p){var m=e.constructor,y=t.constructor;m==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,i,r,o))}function ks(e,t,n,i,r){return e===t||(null==e||null==t||!Fn(e)&&!Fn(t)?e!=e&&t!=t:Is(e,t,n,i,ks,r))}function Bs(e,t,n,i){var r=n.length,o=r,a=!i;if(null==e)return!o;for(e=Object(e);r--;){var s=n[r];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<o;){var l=(s=n[r])[0],c=e[l],u=s[1];if(a&&s[2]){if(void 0===c&&!(l in e))return!1}else{var h=new j;if(i)var d=i(c,u,l,e,t,h);if(!(void 0===d?ks(u,c,3,i,h):d))return!1}}return!0}function Os(e){return e==e&&!jn(e)}function Ts(e){for(var t=E(e),n=t.length;n--;){var i=t[n],r=e[i];t[n]=[i,r,Os(r)]}return t}function Ds(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function Ms(e){var t=Ts(e);return 1==t.length&&t[0][2]?Ds(t[0][0],t[0][1]):function(n){return n===e||Bs(n,e,t)}}function Qs(e,t){return qn(e)&&Os(t)?Ds(Yn(e),t):function(n){var i=I(n,e);return void 0===i&&i===t?F(n,e):ks(t,i,3)}}function Ls(e){return function(t){return null==t?void 0:t[e]}}function Ps(e){return qn(e)?Ls(Yn(e)):function(e){return function(t){return N(t,e)}}(e)}function js(e){return"function"==typeof e?e:null==e?p:"object"==typeof e?Nn(e)?Qs(e[0],e[1]):Ms(e):Ps(e)}function Rs(e,t,n){var i=n.length;if(null==e)return!i;for(e=Object(e);i--;){var r=n[i],o=t[r],a=e[r];if(void 0===a&&!(r in e)||!o(a))return!1}return!0}function Fs(e,t,n,i){for(var r=-1,o=null==e?0:e.length;++r<o;){var a=e[r];t(i,a,n(a),e)}return i}function Ns(e){return function(t,n,i){for(var r=-1,o=Object(t),a=i(t),s=a.length;s--;){var l=a[e?s:++r];if(!1===n(o[l],l,o))break}return t}}var Vs=Ns();function Us(e,t){return e&&Vs(e,t,E)}function zs(e,t){return function(n,i){if(null==n)return n;if(!w(n))return e(n,i);for(var r=n.length,o=t?r:-1,a=Object(n);(t?o--:++o<r)&&!1!==i(a[o],o,a););return n}}var Hs=zs(Us);function Ys(e,t,n,i){return Hs(e,(function(e,r,o){t(i,e,n(e),o)})),i}function Gs(e,t){return function(n,i){var r=Nn(n)?Fs:Ys,o=t?t():{};return r(n,e,js(i),o)}}var Ws=Object.prototype.hasOwnProperty,Xs=Gs((function(e,t,n){Ws.call(e,n)?++e[n]:Gn(e,n,1)}));function $s(e,t,n){var i=Po(e,8,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return i.placeholder=$s.placeholder,i}$s.placeholder={};function qs(e,t,n){var i=Po(e,16,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return i.placeholder=qs.placeholder,i}qs.placeholder={};var Ks=Object.prototype,Js=Ks.hasOwnProperty,Zs=Ro((function(e,t){e=Object(e);var n=-1,i=t.length,r=i>2?t[2]:void 0;for(r&&Fo(t[0],t[1],r)&&(i=1);++n<i;)for(var o=t[n],a=S(o),s=-1,l=a.length;++s<l;){var c=a[s],u=e[c];(void 0===u||Un(u,Ks[c])&&!Js.call(e,c))&&(e[c]=o[c])}return e}));function el(e,t,n){(void 0!==n&&!Un(e[t],n)||void 0===n&&!(t in e))&&Gn(e,t,n)}function tl(e){return Fn(e)&&w(e)}function nl(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function il(e){return _(e,S(e))}function rl(e,t,n,i,r){e!==t&&Vs(t,(function(o,a){if(r||(r=new j),jn(o))!function(e,t,n,i,r,o,a){var s=nl(e,n),l=nl(t,n),c=a.get(l);if(c)el(e,n,c);else{var u=o?o(s,l,n+"",e,t,a):void 0,h=void 0===u;if(h){var d=Nn(l),f=!d&&P(l),p=!d&&!f&&R(l);u=l,d||f||p?Nn(s)?u=s:tl(s)?u=v(s):f?(h=!1,u=U(l,!0)):p?(h=!1,u=z(l,!0)):u=[]:Zo(l)||H(l)?(u=s,H(s)?u=il(s):jn(s)&&!Jn(s)||(u=Y(l))):h=!1}h&&(a.set(l,u),r(u,l,i,o,a),a.delete(l)),el(e,n,u)}}(e,t,a,n,rl,i,r);else{var s=i?i(nl(e,a),o,a+"",e,t,r):void 0;void 0===s&&(s=o),el(e,a,s)}}),S)}function ol(e,t,n,i,r,o){return jn(e)&&jn(t)&&(o.set(t,e),rl(e,t,void 0,ol,o),o.delete(t)),e}var al=No((function(e,t,n,i){rl(e,t,n,i)})),sl=Ro((function(e){return e.push(void 0,ol),b(al,void 0,e)}));function ll(e,t,n){if("function"!=typeof e)throw new TypeError("Expected a function");return setTimeout((function(){e.apply(void 0,n)}),t)}var cl=Ro((function(e,t){return ll(e,1,t)})),ul=Ro((function(e,t,n){return ll(e,d(t)||0,n)}));function hl(e,t,n){for(var i=-1,r=null==e?0:e.length;++i<r;)if(n(t,e[i]))return!0;return!1}function dl(e,t,n,i){var r=-1,o=xo,a=!0,s=e.length,l=[],c=t.length;if(!s)return l;n&&(t=Kn(t,G(n))),i?(o=hl,a=!1):t.length>=200&&(o=vs,a=!1,t=new ps(t));e:for(;++r<s;){var u=e[r],h=null==n?u:n(u);if(u=i||0!==u?u:0,a&&h==h){for(var d=c;d--;)if(t[d]===h)continue e;l.push(u)}else o(t,h,i)||l.push(u)}return l}var fl=Ro((function(e,t){return tl(e)?dl(e,D(t,1,tl,!0)):[]}));function pl(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}var gl=Ro((function(e,t){var n=pl(t);return tl(n)&&(n=void 0),tl(e)?dl(e,D(t,1,tl,!0),js(n)):[]})),vl=Ro((function(e,t){var n=pl(t);return tl(n)&&(n=void 0),tl(e)?dl(e,D(t,1,tl,!0),void 0,n):[]})),Al=Yr((function(e,t){return e/t}),1);function ml(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?aa(e,i?0:o,i?o+1:r):aa(e,i?o+1:0,i?r:o)}function yl(e){return"function"==typeof e?e:p}function bl(e,t){return(Nn(e)?m:Hs)(e,yl(t))}function Cl(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}var wl=Ns(!0);function xl(e,t){return e&&wl(e,t,E)}var _l=zs(xl,!0);function El(e,t){return(Nn(e)?Cl:_l)(e,yl(t))}function Sl(e){return function(t){var n,i,r,o=L(t);return"[object Map]"==o?ms(t):"[object Set]"==o?(n=t,i=-1,r=Array(n.size),n.forEach((function(e){r[++i]=[e,e]})),r):function(e,t){return Kn(t,(function(t){return[t,e[t]]}))}(t,e(t))}}var Il=Sl(E),kl=Sl(S),Bl=Ia({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}),Ol=/[&<>"']/g,Tl=RegExp(Ol.source);function Dl(e){return(e=Wn(e))&&Tl.test(e)?e.replace(Ol,Bl):e}var Ml=/[\\^$.*+?()[\]{}|]/g,Ql=RegExp(Ml.source);function Ll(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Pl(e,t){var n=!0;return Hs(e,(function(e,i,r){return n=!!t(e,i,r)})),n}function jl(e){return e?fs($r(e),0,4294967295):0}function Rl(e,t){var n=[];return Hs(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function Fl(e){return function(t,n,i){var r=Object(t);if(!w(t)){var o=js(n);t=E(t),n=function(e){return o(r[e],e,r)}}var a=e(t,n,i);return a>-1?r[o?t[a]:a]:void 0}}var Nl=Math.max;function Vl(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:$r(n);return r<0&&(r=Nl(i+r,0)),bo(e,js(t),r)}var Ul=Fl(Vl);function zl(e,t,n){var i;return n(e,(function(e,n,r){if(t(e,n,r))return i=n,!1})),i}var Hl=Math.max,Yl=Math.min;function Gl(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=i-1;return void 0!==n&&(r=$r(n),r=n<0?Hl(i+r,0):Yl(r,i-1)),bo(e,js(t),r,!0)}var Wl=Fl(Gl);function Xl(e){return e&&e.length?e[0]:void 0}function $l(e,t){var n=-1,i=w(e)?Array(e.length):[];return Hs(e,(function(e,r,o){i[++n]=t(e,r,o)})),i}function ql(e,t){return(Nn(e)?Kn:$l)(e,js(t))}var Kl=1/0;var Jl=1/0;var Zl=ls("floor");function ec(e){return k((function(t){var n=t.length,i=n,r=uo.prototype.thru;for(e&&t.reverse();i--;){var o=t[i];if("function"!=typeof o)throw new TypeError("Expected a function");if(r&&!a&&"wrapper"==co(o))var a=new uo([],!0)}for(i=a?i:n;++i<n;){var s=co(o=t[i]),l="wrapper"==s?ao(o):void 0;a=l&&go(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?a[co(l[0])].apply(a,l[3]):1==o.length&&go(o)?a[s]():a.thru(o)}return function(){var e=arguments,i=e[0];if(a&&1==e.length&&Nn(i))return a.plant(i).value();for(var r=0,o=n?t[r].apply(this,e):i;++r<n;)o=t[r].call(this,o);return o}}))}var tc=ec(),nc=ec(!0);function ic(e,t){return W(t,(function(t){return Jn(e[t])}))}var rc=Object.prototype.hasOwnProperty,oc=Gs((function(e,t,n){rc.call(e,n)?e[n].push(t):Gn(e,n,[t])}));function ac(e,t){return e>t}function sc(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=d(t),n=d(n)),e(t,n)}}var lc=sc(ac),cc=sc((function(e,t){return e>=t})),uc=Object.prototype.hasOwnProperty;function hc(e,t){return null!=e&&uc.call(e,t)}var dc=Math.max,fc=Math.min;function pc(e){return"string"==typeof e||!Nn(e)&&Fn(e)&&"[object String]"==Hn(e)}function gc(e,t){return Kn(t,(function(t){return e[t]}))}function vc(e){return null==e?[]:gc(e,E(e))}var Ac=Math.max;var mc=Math.max;var yc=Math.min;function bc(e,t,n){for(var i=n?hl:xo,r=e[0].length,o=e.length,a=o,s=Array(o),l=1/0,c=[];a--;){var u=e[a];a&&t&&(u=Kn(u,G(t))),l=yc(u.length,l),s[a]=!n&&(t||r>=120&&u.length>=120)?new ps(a&&u):void 0}u=e[0];var h=-1,d=s[0];e:for(;++h<r&&c.length<l;){var f=u[h],p=t?t(f):f;if(f=n||0!==f?f:0,!(d?vs(d,p):i(c,p,n))){for(a=o;--a;){var g=s[a];if(!(g?vs(g,p):i(e[a],p,n)))continue e}d&&d.push(p),c.push(f)}}return c}function Cc(e){return tl(e)?e:[]}var wc=Ro((function(e){var t=Kn(e,Cc);return t.length&&t[0]===e[0]?bc(t):[]})),xc=Ro((function(e){var t=pl(e),n=Kn(e,Cc);return t===pl(n)?t=void 0:n.pop(),n.length&&n[0]===e[0]?bc(n,js(t)):[]})),_c=Ro((function(e){var t=pl(e),n=Kn(e,Cc);return(t="function"==typeof t?t:void 0)&&n.pop(),n.length&&n[0]===e[0]?bc(n,void 0,t):[]}));function Ec(e,t){return function(n,i){return function(e,t,n,i){return Us(e,(function(e,r,o){t(i,n(e),r,o)})),i}(n,e,t(i),{})}}var Sc=Object.prototype.toString,Ic=Ec((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Sc.call(t)),e[t]=n}),$(p)),kc=Object.prototype,Bc=kc.hasOwnProperty,Oc=kc.toString,Tc=Ec((function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=Oc.call(t)),Bc.call(e,t)?e[t].push(n):e[t]=[n]}),js);function Dc(e,t){return t.length<2?e:N(e,aa(t,0,-1))}function Mc(e,t,n){var i=null==(e=Dc(e,t=Zn(t,e)))?e:e[Yn(pl(t))];return null==i?void 0:b(i,e,n)}var Qc=Ro(Mc),Lc=Ro((function(e,t,n){var i=-1,r="function"==typeof t,o=w(e)?Array(e.length):[];return Hs(e,(function(e){o[++i]=r?b(t,e,n):Mc(e,t,n)})),o}));var Pc=q&&q.isArrayBuffer,jc=Pc?G(Pc):function(e){return Fn(e)&&"[object ArrayBuffer]"==Hn(e)};var Rc=q&&q.isDate,Fc=Rc?G(Rc):function(e){return Fn(e)&&"[object Date]"==Hn(e)};var Nc=Object.prototype.hasOwnProperty;function Vc(e,t){return ks(e,t)}var Uc=Rn.isFinite;function zc(e){return"number"==typeof e&&e==$r(e)}function Hc(e){return"number"==typeof e||Fn(e)&&"[object Number]"==Hn(e)}var Yc=ei?Jn:J;var Gc=q&&q.isRegExp,Wc=Gc?G(Gc):function(e){return Fn(e)&&"[object RegExp]"==Hn(e)},Xc=9007199254740991;var $c=Array.prototype.join;var qc=rs((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Kc=Gs((function(e,t,n){Gn(e,n,t)}));var Jc=Math.max,Zc=Math.min;var eu=rs((function(e,t,n){return e+(n?" ":"")+t.toLowerCase()})),tu=xa("toLowerCase");function nu(e,t){return e<t}var iu=sc(nu),ru=sc((function(e,t){return e<=t}));function ou(e,t,n){for(var i=-1,r=e.length;++i<r;){var o=e[i],a=t(o);if(null!=a&&(void 0===s?a==a&&!Ln(a):n(a,s)))var s=a,l=o}return l}function au(e,t){for(var n,i=-1,r=e.length;++i<r;){var o=t(e[i]);void 0!==o&&(n=void 0===n?o:n+o)}return n}function su(e,t){var n=null==e?0:e.length;return n?au(e,t)/n:NaN}var lu=No((function(e,t,n){rl(e,t,n)})),cu=Ro((function(e,t){return function(n){return Mc(n,e,t)}})),uu=Ro((function(e,t){return function(n){return Mc(e,n,t)}}));function hu(e,t,n){var i=E(t),r=ic(t,i),o=!(jn(n)&&"chain"in n&&!n.chain),a=Jn(e);return m(r,(function(n){var i=t[n];e[n]=i,a&&(e.prototype[n]=function(){var t=this.__chain__;if(o||t){var n=e(this.__wrapped__);return(n.__actions__=v(this.__actions__)).push({func:i,args:arguments,thisArg:e}),n.__chain__=t,n}return i.apply(e,T([this.value()],arguments))})})),e}var du=Yr((function(e,t){return e*t}),1);function fu(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}var pu=$n?$n.iterator:void 0;function gu(e){if(!e)return[];if(w(e))return pc(e)?wa(e):v(e);if(pu&&e[pu])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[pu]());var t=L(e);return("[object Map]"==t?ms:"[object Set]"==t?ys:vc)(e)}function vu(e,t){var n=e.length;if(n)return Vn(t+=t<0?n:0,n)?e[t]:void 0}function Au(e,t){return null==(e=Dc(e,t=Zn(t,e)))||delete e[Yn(pl(t))]}function mu(e){return Zo(e)?void 0:e}var yu=k((function(e,t){var n={};if(null==e)return n;var i=!1;t=Kn(t,(function(t){return t=Zn(t,e),i||(i=t.length>1),t})),_(e,Z(e),n),i&&(n=O(n,7,mu));for(var r=t.length;r--;)Au(n,t[r]);return n}));function bu(e,t){if(null==e)return{};var n=Kn(Z(e),(function(e){return[e]}));return t=js(t),ee(e,n,(function(e,n){return t(e,n[0])}))}function Cu(e,t){if(e!==t){var n=void 0!==e,i=null===e,r=e==e,o=Ln(e),a=void 0!==t,s=null===t,l=t==t,c=Ln(t);if(!s&&!c&&!o&&e>t||o&&a&&l&&!s&&!c||i&&a&&l||!n&&l||!r)return 1;if(!i&&!o&&!c&&e<t||c&&n&&r&&!i&&!o||s&&n&&r||!a&&r||!l)return-1}return 0}function wu(e,t,n){t=t.length?Kn(t,(function(e){return Nn(e)?function(t){return N(t,1===e.length?e[0]:e)}:e})):[p];var i=-1;return t=Kn(t,G(js)),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}($l(e,(function(e,n,r){return{criteria:Kn(t,(function(t){return t(e)})),index:++i,value:e}})),(function(e,t){return function(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var l=Cu(r[i],o[i]);if(l)return i>=s?l:l*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function xu(e){return k((function(t){return t=Kn(t,G(js)),Ro((function(n){var i=this;return e(t,(function(e){return b(e,i,n)}))}))}))}var _u=xu(Kn),Eu=Ro,Su=Math.min,Iu=Eu((function(e,t){var n=(t=1==t.length&&Nn(t[0])?Kn(t[0],G(js)):Kn(D(t,1),G(js))).length;return Ro((function(i){for(var r=-1,o=Su(i.length,n);++r<o;)i[r]=t[r].call(this,i[r]);return b(e,this,i)}))})),ku=xu(Ll),Bu=xu(gs),Ou=Math.floor;function Tu(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=Ou(t/2))&&(e+=e)}while(t);return n}var Du=Ls("length"),Mu="\\ud800-\\udfff",Qu="["+Mu+"]",Lu="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",Pu="\\ud83c[\\udffb-\\udfff]",ju="[^"+Mu+"]",Ru="(?:\\ud83c[\\udde6-\\uddff]){2}",Fu="[\\ud800-\\udbff][\\udc00-\\udfff]",Nu="(?:"+Lu+"|"+Pu+")"+"?",Vu="[\\ufe0e\\ufe0f]?",Uu=Vu+Nu+("(?:\\u200d(?:"+[ju,Ru,Fu].join("|")+")"+Vu+Nu+")*"),zu="(?:"+[ju+Lu+"?",Lu,Ru,Fu,Qu].join("|")+")",Hu=RegExp(Pu+"(?="+Pu+")|"+zu+Uu,"g");function Yu(e){return ca(e)?function(e){for(var t=Hu.lastIndex=0;Hu.test(e);)++t;return t}(e):Du(e)}var Gu=Math.ceil;function Wu(e,t){var n=(t=void 0===t?" ":Pn(t)).length;if(n<2)return n?Tu(t,e):t;var i=Tu(t,Gu(e/Yu(t)));return ca(t)?sa(wa(i),0,e).join(""):i.slice(0,e)}var Xu=Math.ceil,$u=Math.floor;var qu=/^\s+/,Ku=Rn.parseInt;var Ju=Ro((function(e,t){return Po(e,32,void 0,t,Oo(t,Io(Ju)))}));Ju.placeholder={};var Zu=Ro((function(e,t){return Po(e,64,void 0,t,Oo(t,Io(Zu)))}));Zu.placeholder={};var eh=Gs((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]}));function th(e,t,n,i){for(var r=n-1,o=e.length;++r<o;)if(i(e[r],t))return r;return-1}var nh=Array.prototype.splice;function ih(e,t,n,i){var r=i?th:wo,o=-1,a=t.length,s=e;for(e===t&&(t=v(t)),n&&(s=Kn(e,G(n)));++o<a;)for(var l=0,c=t[o],u=n?n(c):c;(l=r(s,u,l,i))>-1;)s!==e&&nh.call(s,l,1),nh.call(e,l,1);return e}function rh(e,t){return e&&e.length&&t&&t.length?ih(e,t):e}var oh=Ro(rh);var ah=Array.prototype.splice;function sh(e,t){for(var n=e?t.length:0,i=n-1;n--;){var r=t[n];if(n==i||r!==o){var o=r;Vn(r)?ah.call(e,r,1):Au(e,r)}}return e}var lh=k((function(e,t){var n=null==e?0:e.length,i=Go(e,t);return sh(e,Kn(t,(function(e){return Vn(e,n)?+e:e})).sort(Cu)),i})),ch=Math.floor,uh=Math.random;function hh(e,t){return e+ch(uh()*(t-e+1))}var dh=parseFloat,fh=Math.min,ph=Math.random;var gh=Math.ceil,vh=Math.max;function Ah(e){return function(t,n,i){return i&&"number"!=typeof i&&Fo(t,n,i)&&(n=i=void 0),t=Xr(t),void 0===n?(n=t,t=0):n=Xr(n),function(e,t,n,i){for(var r=-1,o=vh(gh((t-e)/(n||1)),0),a=Array(o);o--;)a[i?o:++r]=e,e+=n;return a}(t,n,i=void 0===i?t<n?1:-1:Xr(i),e)}}var mh=Ah(),yh=Ah(!0),bh=k((function(e,t){return Po(e,256,void 0,void 0,void 0,t)}));function Ch(e,t,n,i,r){return r(e,(function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)})),n}function wh(e,t,n,i){var r=null==e?0:e.length;for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e);return n}var xh=Array.prototype.reverse;function _h(e){return null==e?e:xh.call(e)}var Eh=ls("round");function Sh(e){var t=e.length;return t?e[hh(0,t-1)]:void 0}function Ih(e){return Sh(vc(e))}function kh(e,t){var n=-1,i=e.length,r=i-1;for(t=void 0===t?i:t;++n<t;){var o=hh(n,r),a=e[o];e[o]=e[n],e[n]=a}return e.length=t,e}function Bh(e,t){return kh(v(e),fs(t,0,e.length))}function Oh(e,t){var n=vc(e);return kh(n,fs(t,0,n.length))}function Th(e){return kh(v(e))}function Dh(e){return kh(vc(e))}var Mh=rs((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()}));function Qh(e,t){var n;return Hs(e,(function(e,i,r){return!(n=t(e,i,r))})),!!n}var Lh=Ro((function(e,t){if(null==e)return[];var n=t.length;return n>1&&Fo(e,t[0],t[1])?t=[]:n>2&&Fo(t[0],t[1],t[2])&&(t=[t[0]]),wu(e,D(t,1),[])})),Ph=Math.floor,jh=Math.min;function Rh(e,t,n,i){var r=0,o=null==e?0:e.length;if(0===o)return 0;for(var a=(t=n(t))!=t,s=null===t,l=Ln(t),c=void 0===t;r<o;){var u=Ph((r+o)/2),h=n(e[u]),d=void 0!==h,f=null===h,p=h==h,g=Ln(h);if(a)var v=i||p;else v=c?p&&(i||d):s?p&&d&&(i||!f):l?p&&d&&!f&&(i||!g):!f&&!g&&(i?h<=t:h<t);v?r=u+1:o=u}return jh(o,4294967294)}function Fh(e,t,n){var i=0,r=null==e?i:e.length;if("number"==typeof t&&t==t&&r<=2147483647){for(;i<r;){var o=i+r>>>1,a=e[o];null!==a&&!Ln(a)&&(n?a<=t:a<t)?i=o+1:r=o}return r}return Rh(e,t,p,n)}function Nh(e,t){for(var n=-1,i=e.length,r=0,o=[];++n<i;){var a=e[n],s=t?t(a):a;if(!n||!Un(s,l)){var l=s;o[r++]=0===a?0:a}}return o}var Vh=Math.max;var Uh=rs((function(e,t,n){return e+(n?" ":"")+_a(t)}));var zh=Yr((function(e,t){return e-t}),0);var Hh=Object.prototype,Yh=Hh.hasOwnProperty;function Gh(e,t,n,i){return void 0===e||Un(e,Hh[n])&&!Yh.call(i,n)?t:e}var Wh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"};function Xh(e){return"\\"+Wh[e]}var $h=/<%=([\s\S]+?)%>/g,qh={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:$h,variable:"",imports:{_:{escape:Dl}}},Kh=/\b__p \+= '';/g,Jh=/\b(__p \+=) '' \+/g,Zh=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ed=/[()=,{}\[\]\/\s]/,td=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,nd=/($^)/,id=/['\n\r\u2028\u2029\\]/g,rd=Object.prototype.hasOwnProperty;function od(e,t){return t(e)}var ad=4294967295,sd=Math.min;function ld(e,t){var n=e;return n instanceof ro&&(n=n.value()),Sa(t,(function(e,t){return t.func.apply(t.thisArg,T([e],t.args))}),n)}function cd(){return ld(this.__wrapped__,this.__actions__)}var ud=9007199254740991;function hd(e,t){for(var n=e.length;n--&&wo(t,e[n],0)>-1;);return n}function dd(e,t){for(var n=-1,i=e.length;++n<i&&wo(t,e[n],0)>-1;);return n}var fd=/^\s+/;var pd=/\w*$/;var gd=Ia({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vd=/&(?:amp|lt|gt|quot|#39);/g,Ad=RegExp(vd.source);var md=re&&1/ys(new re([,-0]))[1]==1/0?function(e){return new re(e)}:oo;function yd(e,t,n){var i=-1,r=xo,o=e.length,a=!0,s=[],l=s;if(n)a=!1,r=hl;else if(o>=200){var c=t?null:md(e);if(c)return ys(c);a=!1,r=vs,l=new ps}else l=t?[]:s;e:for(;++i<o;){var u=e[i],h=t?t(u):u;if(u=n||0!==u?u:0,a&&h==h){for(var d=l.length;d--;)if(l[d]===h)continue e;t&&l.push(h),s.push(u)}else r(l,h,n)||(l!==s&&l.push(h),s.push(u))}return s}var bd=Ro((function(e){return yd(D(e,1,tl,!0))})),Cd=Ro((function(e){var t=pl(e);return tl(t)&&(t=void 0),yd(D(e,1,tl,!0),js(t))})),wd=Ro((function(e){var t=pl(e);return t="function"==typeof t?t:void 0,yd(D(e,1,tl,!0),void 0,t)}));function xd(e,t){return e&&e.length?yd(e,js(t)):[]}var _d=0;var Ed=Math.max;function Sd(e){if(!e||!e.length)return[];var t=0;return e=W(e,(function(e){if(tl(e))return t=Ed(e.length,t),!0})),te(t,(function(t){return Kn(e,Ls(t))}))}function Id(e,t){if(!e||!e.length)return[];var n=Sd(e);return null==t?n:Kn(n,(function(e){return b(t,void 0,e)}))}function kd(e,t,n,i){return ni(e,t,n(N(e,t)),i)}var Bd=rs((function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}));var Od=Ro((function(e,t){return tl(e)?dl(e,t):[]}));var Td=k((function(e){var t=e.length,n=t?e[0]:0,i=this.__wrapped__,r=function(t){return Go(t,e)};return!(t>1||this.__actions__.length)&&i instanceof ro&&Vn(n)?((i=i.slice(n,+n+(t?1:0))).__actions__.push({func:od,args:[r],thisArg:void 0}),new uo(i,this.__chain__).thru((function(e){return t&&!e.length&&e.push(void 0),e}))):this.thru(r)}));function Dd(e,t,n){var i=e.length;if(i<2)return i?yd(e[0]):[];for(var r=-1,o=Array(i);++r<i;)for(var a=e[r],s=-1;++s<i;)s!=r&&(o[r]=dl(o[r]||a,e[s],t,n));return yd(D(o,1),t,n)}var Md=Ro((function(e){return Dd(W(e,tl))})),Qd=Ro((function(e){var t=pl(e);return tl(t)&&(t=void 0),Dd(W(e,tl),js(t))})),Ld=Ro((function(e){var t=pl(e);return t="function"==typeof t?t:void 0,Dd(W(e,tl),void 0,t)})),Pd=Ro(Sd);function jd(e,t,n){for(var i=-1,r=e.length,o=t.length,a={};++i<r;){var s=i<o?t[i]:void 0;n(a,e[i],s)}return a}var Rd=Ro((function(e){var t=e.length,n=t>1?e[t-1]:void 0;return n="function"==typeof n?(e.pop(),n):void 0,Id(e,n)}));const Fd={chunk:function(e,t,n){t=(n?Fo(e,t,n):void 0===t)?1:ds($r(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var r=0,o=0,a=Array(hs(i/t));r<i;)a[o++]=aa(e,r,r+=t);return a},compact:function(e){for(var t=-1,n=null==e?0:e.length,i=0,r=[];++t<n;){var o=e[t];o&&(r[i++]=o)}return r},concat:function(){var e=arguments.length;if(!e)return[];for(var t=Array(e-1),n=arguments[0],i=e;i--;)t[i-1]=arguments[i];return T(Nn(n)?v(n):[n],D(t,1))},difference:fl,differenceBy:gl,differenceWith:vl,drop:function(e,t,n){var i=null==e?0:e.length;return i?aa(e,(t=n||void 0===t?1:$r(t))<0?0:t,i):[]},dropRight:function(e,t,n){var i=null==e?0:e.length;return i?aa(e,0,(t=i-(t=n||void 0===t?1:$r(t)))<0?0:t):[]},dropRightWhile:function(e,t){return e&&e.length?ml(e,js(t),!0,!0):[]},dropWhile:function(e,t){return e&&e.length?ml(e,js(t),!0):[]},fill:function(e,t,n,i){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&Fo(e,t,n)&&(n=0,i=r),function(e,t,n,i){var r=e.length;for((n=$r(n))<0&&(n=-n>r?0:r+n),(i=void 0===i||i>r?r:$r(i))<0&&(i+=r),i=n>i?0:jl(i);n<i;)e[n++]=t;return e}(e,t,n,i)):[]},findIndex:Vl,findLastIndex:Gl,first:Xl,flatten:oe,flattenDeep:function(e){return(null==e?0:e.length)?D(e,Jl):[]},flattenDepth:function(e,t){return(null==e?0:e.length)?(t=void 0===t?1:$r(t),D(e,t)):[]},fromPairs:ae,head:Xl,indexOf:function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=null==n?0:$r(n);return r<0&&(r=mc(i+r,0)),wo(e,t,r)},initial:function(e){return(null==e?0:e.length)?aa(e,0,-1):[]},intersection:wc,intersectionBy:xc,intersectionWith:_c,join:function(e,t){return null==e?"":$c.call(e,t)},last:pl,lastIndexOf:function(e,t,n){var i=null==e?0:e.length;if(!i)return-1;var r=i;return void 0!==n&&(r=(r=$r(n))<0?Jc(i+r,0):Zc(r,i-1)),t==t?function(e,t,n){for(var i=n+1;i--;)if(e[i]===t)return i;return i}(e,t,r):bo(e,Co,r,!0)},nth:function(e,t){return e&&e.length?vu(e,$r(t)):void 0},pull:oh,pullAll:rh,pullAllBy:function(e,t,n){return e&&e.length&&t&&t.length?ih(e,t,js(n)):e},pullAllWith:function(e,t,n){return e&&e.length&&t&&t.length?ih(e,t,void 0,n):e},pullAt:lh,remove:function(e,t){var n=[];if(!e||!e.length)return n;var i=-1,r=[],o=e.length;for(t=js(t);++i<o;){var a=e[i];t(a,i,e)&&(n.push(a),r.push(i))}return sh(e,r),n},reverse:_h,slice:function(e,t,n){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&Fo(e,t,n)?(t=0,n=i):(t=null==t?0:$r(t),n=void 0===n?i:$r(n)),aa(e,t,n)):[]},sortedIndex:function(e,t){return Fh(e,t)},sortedIndexBy:function(e,t,n){return Rh(e,t,js(n))},sortedIndexOf:function(e,t){var n=null==e?0:e.length;if(n){var i=Fh(e,t);if(i<n&&Un(e[i],t))return i}return-1},sortedLastIndex:function(e,t){return Fh(e,t,!0)},sortedLastIndexBy:function(e,t,n){return Rh(e,t,js(n),!0)},sortedLastIndexOf:function(e,t){if(null==e?0:e.length){var n=Fh(e,t,!0)-1;if(Un(e[n],t))return n}return-1},sortedUniq:function(e){return e&&e.length?Nh(e):[]},sortedUniqBy:function(e,t){return e&&e.length?Nh(e,js(t)):[]},tail:function(e){var t=null==e?0:e.length;return t?aa(e,1,t):[]},take:function(e,t,n){return e&&e.length?aa(e,0,(t=n||void 0===t?1:$r(t))<0?0:t):[]},takeRight:function(e,t,n){var i=null==e?0:e.length;return i?aa(e,(t=i-(t=n||void 0===t?1:$r(t)))<0?0:t,i):[]},takeRightWhile:function(e,t){return e&&e.length?ml(e,js(t),!1,!0):[]},takeWhile:function(e,t){return e&&e.length?ml(e,js(t)):[]},union:bd,unionBy:Cd,unionWith:wd,uniq:function(e){return e&&e.length?yd(e):[]},uniqBy:xd,uniqWith:function(e,t){return t="function"==typeof t?t:void 0,e&&e.length?yd(e,void 0,t):[]},unzip:Sd,unzipWith:Id,without:Od,xor:Md,xorBy:Qd,xorWith:Ld,zip:Pd,zipObject:function(e,t){return jd(e||[],t||[],zn)},zipObjectDeep:function(e,t){return jd(e||[],t||[],ni)},zipWith:Rd},Nd={countBy:Xs,each:bl,eachRight:El,every:function(e,t,n){var i=Nn(e)?Ll:Pl;return n&&Fo(e,t,n)&&(t=void 0),i(e,js(t))},filter:function(e,t){return(Nn(e)?W:Rl)(e,js(t))},find:Ul,findLast:Wl,flatMap:function(e,t){return D(ql(e,t),1)},flatMapDeep:function(e,t){return D(ql(e,t),Kl)},flatMapDepth:function(e,t,n){return n=void 0===n?1:$r(n),D(ql(e,t),n)},forEach:bl,forEachRight:El,groupBy:oc,includes:function(e,t,n,i){e=w(e)?e:vc(e),n=n&&!i?$r(n):0;var r=e.length;return n<0&&(n=Ac(r+n,0)),pc(e)?n<=r&&e.indexOf(t,n)>-1:!!r&&wo(e,t,n)>-1},invokeMap:Lc,keyBy:Kc,map:ql,orderBy:function(e,t,n,i){return null==e?[]:(Nn(t)||(t=null==t?[]:[t]),Nn(n=i?void 0:n)||(n=null==n?[]:[n]),wu(e,t,n))},partition:eh,reduce:function(e,t,n){var i=Nn(e)?Sa:Ch,r=arguments.length<3;return i(e,js(t),n,r,Hs)},reduceRight:function(e,t,n){var i=Nn(e)?wh:Ch,r=arguments.length<3;return i(e,js(t),n,r,_l)},reject:function(e,t){return(Nn(e)?W:Rl)(e,fu(js(t)))},sample:function(e){return(Nn(e)?Sh:Ih)(e)},sampleSize:function(e,t,n){return t=(n?Fo(e,t,n):void 0===t)?1:$r(t),(Nn(e)?Bh:Oh)(e,t)},shuffle:function(e){return(Nn(e)?Th:Dh)(e)},size:function(e){if(null==e)return 0;if(w(e))return pc(e)?Yu(e):e.length;var t=L(e);return"[object Map]"==t||"[object Set]"==t?e.size:K(e).length},some:function(e,t,n){var i=Nn(e)?gs:Qh;return n&&Fo(e,t,n)&&(t=void 0),i(e,js(t))},sortBy:Lh},Vd={now:se},Ud={after:function(e,t){if("function"!=typeof t)throw new TypeError("Expected a function");return e=$r(e),function(){if(--e<1)return t.apply(this,arguments)}},ary:jo,before:na,bind:ia,bindKey:oa,curry:$s,curryRight:qs,debounce:le,defer:cl,delay:ul,flip:function(e){return Po(e,512)},memoize:ri,negate:fu,once:function(e){return na(2,e)},overArgs:Iu,partial:Ju,partialRight:Zu,rearg:bh,rest:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return Ro(e,t=void 0===t?t:$r(t))},spread:function(e,t){if("function"!=typeof e)throw new TypeError("Expected a function");return t=null==t?0:Vh($r(t),0),Ro((function(n){var i=n[t],r=sa(n,0,t);return i&&T(r,i),b(e,this,r)}))},throttle:ce,unary:function(e){return jo(e,1)},wrap:function(e,t){return Ju(yl(t),e)}},zd={castArray:ue,clone:he,cloneDeep:function(e){return O(e,5)},cloneDeepWith:function(e,t){return O(e,5,t="function"==typeof t?t:void 0)},cloneWith:function(e,t){return O(e,4,t="function"==typeof t?t:void 0)},conformsTo:function(e,t){return null==t||Rs(e,t,E(t))},eq:Un,gt:lc,gte:cc,isArguments:H,isArray:Nn,isArrayBuffer:jc,isArrayLike:w,isArrayLikeObject:tl,isBoolean:function(e){return!0===e||!1===e||Fn(e)&&"[object Boolean]"==Hn(e)},isBuffer:P,isDate:Fc,isElement:function(e){return Fn(e)&&1===e.nodeType&&!Zo(e)},isEmpty:function(e){if(null==e)return!0;if(w(e)&&(Nn(e)||"string"==typeof e||"function"==typeof e.splice||P(e)||R(e)||H(e)))return!e.length;var t=L(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(x(e))return!K(e).length;for(var n in e)if(Nc.call(e,n))return!1;return!0},isEqual:Vc,isEqualWith:function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?ks(e,t,void 0,n):!!i},isError:ea,isFinite:function(e){return"number"==typeof e&&Uc(e)},isFunction:Jn,isInteger:zc,isLength:de,isMap:fe,isMatch:function(e,t){return e===t||Bs(e,t,Ts(t))},isMatchWith:function(e,t,n){return n="function"==typeof n?n:void 0,Bs(e,t,Ts(t),n)},isNaN:function(e){return Hc(e)&&e!=+e},isNative:function(e){if(Yc(e))throw new Error("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return ti(e)},isNil:pe,isNull:function(e){return null===e},isNumber:Hc,isObject:jn,isObjectLike:Fn,isPlainObject:Zo,isRegExp:Wc,isSafeInteger:function(e){return zc(e)&&e>=-9007199254740991&&e<=Xc},isSet:ge,isString:pc,isSymbol:Ln,isTypedArray:R,isUndefined:ve,isWeakMap:function(e){return Fn(e)&&"[object WeakMap]"==L(e)},isWeakSet:function(e){return Fn(e)&&"[object WeakSet]"==Hn(e)},lt:iu,lte:ru,toArray:gu,toFinite:Xr,toInteger:$r,toLength:jl,toNumber:d,toPlainObject:il,toSafeInteger:function(e){return e?fs($r(e),-9007199254740991,ud):0===e?e:0},toString:Wn},Hd={add:Gr,ceil:cs,divide:Al,floor:Zl,max:function(e){return e&&e.length?ou(e,p,ac):void 0},maxBy:function(e,t){return e&&e.length?ou(e,js(t),ac):void 0},mean:function(e){return su(e,p)},meanBy:function(e,t){return su(e,js(t))},min:function(e){return e&&e.length?ou(e,p,nu):void 0},minBy:function(e,t){return e&&e.length?ou(e,js(t),nu):void 0},multiply:du,round:Eh,subtract:zh,sum:function(e){return e&&e.length?au(e,p):0},sumBy:function(e,t){return e&&e.length?au(e,js(t)):0}},Yd=function(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=d(n))==n?n:0),void 0!==t&&(t=(t=d(t))==t?t:0),fs(d(e),t,n)},Gd=function(e,t,n){return t=Xr(t),void 0===n?(n=t,t=0):n=Xr(n),function(e,t,n){return e>=fc(t,n)&&e<dc(t,n)}(e=d(e),t,n)},Wd=function(e,t,n){if(n&&"boolean"!=typeof n&&Fo(e,t,n)&&(t=n=void 0),void 0===n&&("boolean"==typeof t?(n=t,t=void 0):"boolean"==typeof e&&(n=e,e=void 0)),void 0===e&&void 0===t?(e=0,t=1):(e=Xr(e),void 0===t?(t=e,e=0):t=Xr(t)),e>t){var i=e;e=t,t=i}if(n||e%1||t%1){var r=ph();return fh(e+r*(t-e+dh("1e-"+((r+"").length-1))),t)}return hh(e,t)},Xd={assign:Uo,assignIn:zo,assignInWith:Ho,assignWith:Yo,at:Wo,create:function(e,t){var n=g(e);return null==t?n:V(n,t)},defaults:Zs,defaultsDeep:sl,entries:Il,entriesIn:kl,extend:zo,extendWith:Ho,findKey:function(e,t){return zl(e,js(t),Us)},findLastKey:function(e,t){return zl(e,js(t),xl)},forIn:function(e,t){return null==e?e:Vs(e,yl(t),S)},forInRight:function(e,t){return null==e?e:wl(e,yl(t),S)},forOwn:function(e,t){return e&&Us(e,yl(t))},forOwnRight:function(e,t){return e&&xl(e,yl(t))},functions:function(e){return null==e?[]:ic(e,E(e))},functionsIn:function(e){return null==e?[]:ic(e,S(e))},get:I,has:function(e,t){return null!=e&&X(e,t,hc)},hasIn:F,invert:Ic,invertBy:Tc,invoke:Qc,keys:E,keysIn:S,mapKeys:function(e,t){var n={};return t=js(t),Us(e,(function(e,i,r){Gn(n,t(e,i,r),e)})),n},mapValues:function(e,t){var n={};return t=js(t),Us(e,(function(e,i,r){Gn(n,i,t(e,i,r))})),n},merge:lu,mergeWith:al,omit:yu,omitBy:function(e,t){return bu(e,fu(js(t)))},pick:Ae,pickBy:bu,result:function(e,t,n){var i=-1,r=(t=Zn(t,e)).length;for(r||(r=1,e=void 0);++i<r;){var o=null==e?void 0:e[Yn(t[i])];void 0===o&&(i=r,o=n),e=Jn(o)?o.call(e):o}return e},set:oi,setWith:function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:ni(e,t,n,i)},toPairs:Il,toPairsIn:kl,transform:function(e,t,n){var i=Nn(e),r=i||P(e)||R(e);if(t=js(t),null==n){var o=e&&e.constructor;n=r?i?new o:[]:jn(e)&&Jn(o)?g(B(e)):{}}return(r?m:Us)(e,(function(e,i,r){return t(n,e,i,r)})),n},unset:function(e,t){return null==e||Au(e,t)},update:function(e,t,n){return null==e?e:kd(e,t,yl(n))},updateWith:function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:kd(e,t,yl(n),i)},values:vc,valuesIn:function(e){return null==e?[]:gc(e,S(e))}},$d={at:Td,chain:us,commit:function(){return new uo(this.value(),this.__chain__)},lodash:po,next:function(){void 0===this.__values__&&(this.__values__=gu(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?void 0:this.__values__[this.__index__++]}},plant:function(e){for(var t,n=this;n instanceof io;){var i=ho(n);i.__index__=0,i.__values__=void 0,t?r.__wrapped__=i:t=i;var r=i;n=n.__wrapped__}return r.__wrapped__=e,t},reverse:function(){var e=this.__wrapped__;if(e instanceof ro){var t=e;return this.__actions__.length&&(t=new ro(this)),(t=t.reverse()).__actions__.push({func:od,args:[_h],thisArg:void 0}),new uo(t,this.__chain__)}return this.thru(_h)},tap:function(e,t){return t(e),e},thru:od,toIterator:function(){return this},toJSON:cd,value:cd,valueOf:cd,wrapperChain:function(){return us(this)}},qd={camelCase:os,capitalize:Ea,deburr:Ta,endsWith:function(e,t,n){e=Wn(e),t=Pn(t);var i=e.length,r=n=void 0===n?i:fs($r(n),0,i);return(n-=t.length)>=0&&e.slice(n,r)==t},escape:Dl,escapeRegExp:function(e){return(e=Wn(e))&&Ql.test(e)?e.replace(Ml,"\\$&"):e},kebabCase:qc,lowerCase:eu,lowerFirst:tu,pad:function(e,t,n){e=Wn(e);var i=(t=$r(t))?Yu(e):0;if(!t||i>=t)return e;var r=(t-i)/2;return Wu($u(r),n)+e+Wu(Xu(r),n)},padEnd:function(e,t,n){e=Wn(e);var i=(t=$r(t))?Yu(e):0;return t&&i<t?e+Wu(t-i,n):e},padStart:function(e,t,n){e=Wn(e);var i=(t=$r(t))?Yu(e):0;return t&&i<t?Wu(t-i,n)+e:e},parseInt:function(e,t,n){return n||null==t?t=0:t&&(t=+t),Ku(Wn(e).replace(qu,""),t||0)},repeat:function(e,t,n){return t=(n?Fo(e,t,n):void 0===t)?1:$r(t),Tu(Wn(e),t)},replace:function(){var e=arguments,t=Wn(e[0]);return e.length<3?t:t.replace(e[1],e[2])},snakeCase:Mh,split:function(e,t,n){return n&&"number"!=typeof n&&Fo(e,t,n)&&(t=n=void 0),(n=void 0===n?4294967295:n>>>0)?(e=Wn(e))&&("string"==typeof t||null!=t&&!Wc(t))&&!(t=Pn(t))&&ca(e)?sa(wa(e),0,n):e.split(t,n):[]},startCase:Uh,startsWith:function(e,t,n){return e=Wn(e),n=null==n?0:fs($r(n),0,e.length),t=Pn(t),e.slice(n,n+t.length)==t},template:function(e,t,n){var i=qh.imports._.templateSettings||qh;n&&Fo(e,t,n)&&(t=void 0),e=Wn(e),t=Ho({},t,i,Gh);var r,o,a=Ho({},t.imports,i.imports,Gh),s=E(a),l=gc(a,s),c=0,u=t.interpolate||nd,h="__p += '",d=RegExp((t.escape||nd).source+"|"+u.source+"|"+(u===$h?td:nd).source+"|"+(t.evaluate||nd).source+"|$","g"),f=rd.call(t,"sourceURL")?"//# sourceURL="+(t.sourceURL+"").replace(/\s/g," ")+"\n":"";e.replace(d,(function(t,n,i,a,s,l){return i||(i=a),h+=e.slice(c,l).replace(id,Xh),n&&(r=!0,h+="' +\n__e("+n+") +\n'"),s&&(o=!0,h+="';\n"+s+";\n__p += '"),i&&(h+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),c=l+t.length,t})),h+="';\n";var p=rd.call(t,"variable")&&t.variable;if(p){if(ed.test(p))throw new Error("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(o?h.replace(Kh,""):h).replace(Jh,"$1").replace(Zh,"$1;"),h="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var g=ta((function(){return Function(s,f+"return "+h).apply(void 0,l)}));if(g.source=h,ea(g))throw g;return g},templateSettings:qh,toLower:function(e){return Wn(e).toLowerCase()},toUpper:function(e){return Wn(e).toUpperCase()},trim:function(e,t,n){if((e=Wn(e))&&(n||void 0===t))return ne(e);if(!e||!(t=Pn(t)))return e;var i=wa(e),r=wa(t);return sa(i,dd(i,r),hd(i,r)+1).join("")},trimEnd:function(e,t,n){if((e=Wn(e))&&(n||void 0===t))return e.slice(0,ie(e)+1);if(!e||!(t=Pn(t)))return e;var i=wa(e);return sa(i,0,hd(i,wa(t))+1).join("")},trimStart:function(e,t,n){if((e=Wn(e))&&(n||void 0===t))return e.replace(fd,"");if(!e||!(t=Pn(t)))return e;var i=wa(e);return sa(i,dd(i,wa(t))).join("")},truncate:function(e,t){var n=30,i="...";if(jn(t)){var r="separator"in t?t.separator:r;n="length"in t?$r(t.length):n,i="omission"in t?Pn(t.omission):i}var o=(e=Wn(e)).length;if(ca(e)){var a=wa(e);o=a.length}if(n>=o)return e;var s=n-Yu(i);if(s<1)return i;var l=a?sa(a,0,s).join(""):e.slice(0,s);if(void 0===r)return l+i;if(a&&(s+=l.length-s),Wc(r)){if(e.slice(s).search(r)){var c,u=l;for(r.global||(r=RegExp(r.source,Wn(pd.exec(r))+"g")),r.lastIndex=0;c=r.exec(u);)var h=c.index;l=l.slice(0,void 0===h?s:h)}}else if(e.indexOf(Pn(r),s)!=s){var d=l.lastIndexOf(r);d>-1&&(l=l.slice(0,d))}return l+i},unescape:function(e){return(e=Wn(e))&&Ad.test(e)?e.replace(vd,gd):e},upperCase:Bd,upperFirst:_a,words:ns},Kd={attempt:ta,bindAll:ra,cond:function(e){var t=null==e?0:e.length,n=js;return e=t?Kn(e,(function(e){if("function"!=typeof e[1])throw new TypeError("Expected a function");return[n(e[0]),e[1]]})):[],Ro((function(n){for(var i=-1;++i<t;){var r=e[i];if(b(r[0],this,n))return b(r[1],this,n)}}))},conforms:function(e){return function(e){var t=E(e);return function(n){return Rs(n,e,t)}}(O(e,1))},constant:$,defaultTo:function(e,t){return null==e||e!=e?t:e},flow:tc,flowRight:nc,identity:p,iteratee:function(e){return js("function"==typeof e?e:O(e,1))},matches:function(e){return Ms(O(e,1))},matchesProperty:function(e,t){return Qs(e,O(t,1))},method:cu,methodOf:uu,mixin:hu,noop:oo,nthArg:function(e){return e=$r(e),Ro((function(t){return vu(t,e)}))},over:_u,overEvery:ku,overSome:Bu,property:Ps,propertyOf:function(e){return function(t){return null==e?void 0:N(e,t)}},range:mh,rangeRight:yh,stubArray:me,stubFalse:J,stubObject:function(){return{}},stubString:function(){return""},stubTrue:function(){return!0},times:function(e,t){if((e=$r(e))<1||e>9007199254740991)return[];var n=ad,i=sd(e,ad);t=yl(t),e-=ad;for(var r=te(i,t);++n<e;)t(n);return r},toPath:function(e){return Nn(e)?Kn(e,Yn):Ln(e)?[e]:v(ii(Wn(e)))},uniqueId:function(e){var t=++_d;return Wn(e)+t}};var Jd=Math.max,Zd=Math.min;var ef=Math.min;
/**
 * @license
 * Lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="es" -o ./`
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */
var tf,nf=4294967295,rf=Array.prototype,of=Object.prototype.hasOwnProperty,af=$n?$n.iterator:void 0,sf=Math.max,lf=Math.min,cf=function(e){return function(t,n,i){if(null==i){var r=jn(n),o=r&&E(n),a=o&&o.length&&ic(n,o);(a?a.length:r)||(i=n,n=t,t=this)}return e(t,n,i)}}(hu);po.after=Ud.after,po.ary=Ud.ary,po.assign=Xd.assign,po.assignIn=Xd.assignIn,po.assignInWith=Xd.assignInWith,po.assignWith=Xd.assignWith,po.at=Xd.at,po.before=Ud.before,po.bind=Ud.bind,po.bindAll=Kd.bindAll,po.bindKey=Ud.bindKey,po.castArray=zd.castArray,po.chain=$d.chain,po.chunk=Fd.chunk,po.compact=Fd.compact,po.concat=Fd.concat,po.cond=Kd.cond,po.conforms=Kd.conforms,po.constant=Kd.constant,po.countBy=Nd.countBy,po.create=Xd.create,po.curry=Ud.curry,po.curryRight=Ud.curryRight,po.debounce=Ud.debounce,po.defaults=Xd.defaults,po.defaultsDeep=Xd.defaultsDeep,po.defer=Ud.defer,po.delay=Ud.delay,po.difference=Fd.difference,po.differenceBy=Fd.differenceBy,po.differenceWith=Fd.differenceWith,po.drop=Fd.drop,po.dropRight=Fd.dropRight,po.dropRightWhile=Fd.dropRightWhile,po.dropWhile=Fd.dropWhile,po.fill=Fd.fill,po.filter=Nd.filter,po.flatMap=Nd.flatMap,po.flatMapDeep=Nd.flatMapDeep,po.flatMapDepth=Nd.flatMapDepth,po.flatten=Fd.flatten,po.flattenDeep=Fd.flattenDeep,po.flattenDepth=Fd.flattenDepth,po.flip=Ud.flip,po.flow=Kd.flow,po.flowRight=Kd.flowRight,po.fromPairs=Fd.fromPairs,po.functions=Xd.functions,po.functionsIn=Xd.functionsIn,po.groupBy=Nd.groupBy,po.initial=Fd.initial,po.intersection=Fd.intersection,po.intersectionBy=Fd.intersectionBy,po.intersectionWith=Fd.intersectionWith,po.invert=Xd.invert,po.invertBy=Xd.invertBy,po.invokeMap=Nd.invokeMap,po.iteratee=Kd.iteratee,po.keyBy=Nd.keyBy,po.keys=E,po.keysIn=Xd.keysIn,po.map=Nd.map,po.mapKeys=Xd.mapKeys,po.mapValues=Xd.mapValues,po.matches=Kd.matches,po.matchesProperty=Kd.matchesProperty,po.memoize=Ud.memoize,po.merge=Xd.merge,po.mergeWith=Xd.mergeWith,po.method=Kd.method,po.methodOf=Kd.methodOf,po.mixin=cf,po.negate=fu,po.nthArg=Kd.nthArg,po.omit=Xd.omit,po.omitBy=Xd.omitBy,po.once=Ud.once,po.orderBy=Nd.orderBy,po.over=Kd.over,po.overArgs=Ud.overArgs,po.overEvery=Kd.overEvery,po.overSome=Kd.overSome,po.partial=Ud.partial,po.partialRight=Ud.partialRight,po.partition=Nd.partition,po.pick=Xd.pick,po.pickBy=Xd.pickBy,po.property=Kd.property,po.propertyOf=Kd.propertyOf,po.pull=Fd.pull,po.pullAll=Fd.pullAll,po.pullAllBy=Fd.pullAllBy,po.pullAllWith=Fd.pullAllWith,po.pullAt=Fd.pullAt,po.range=Kd.range,po.rangeRight=Kd.rangeRight,po.rearg=Ud.rearg,po.reject=Nd.reject,po.remove=Fd.remove,po.rest=Ud.rest,po.reverse=Fd.reverse,po.sampleSize=Nd.sampleSize,po.set=Xd.set,po.setWith=Xd.setWith,po.shuffle=Nd.shuffle,po.slice=Fd.slice,po.sortBy=Nd.sortBy,po.sortedUniq=Fd.sortedUniq,po.sortedUniqBy=Fd.sortedUniqBy,po.split=qd.split,po.spread=Ud.spread,po.tail=Fd.tail,po.take=Fd.take,po.takeRight=Fd.takeRight,po.takeRightWhile=Fd.takeRightWhile,po.takeWhile=Fd.takeWhile,po.tap=$d.tap,po.throttle=Ud.throttle,po.thru=od,po.toArray=zd.toArray,po.toPairs=Xd.toPairs,po.toPairsIn=Xd.toPairsIn,po.toPath=Kd.toPath,po.toPlainObject=zd.toPlainObject,po.transform=Xd.transform,po.unary=Ud.unary,po.union=Fd.union,po.unionBy=Fd.unionBy,po.unionWith=Fd.unionWith,po.uniq=Fd.uniq,po.uniqBy=Fd.uniqBy,po.uniqWith=Fd.uniqWith,po.unset=Xd.unset,po.unzip=Fd.unzip,po.unzipWith=Fd.unzipWith,po.update=Xd.update,po.updateWith=Xd.updateWith,po.values=Xd.values,po.valuesIn=Xd.valuesIn,po.without=Fd.without,po.words=qd.words,po.wrap=Ud.wrap,po.xor=Fd.xor,po.xorBy=Fd.xorBy,po.xorWith=Fd.xorWith,po.zip=Fd.zip,po.zipObject=Fd.zipObject,po.zipObjectDeep=Fd.zipObjectDeep,po.zipWith=Fd.zipWith,po.entries=Xd.toPairs,po.entriesIn=Xd.toPairsIn,po.extend=Xd.assignIn,po.extendWith=Xd.assignInWith,cf(po,po),po.add=Hd.add,po.attempt=Kd.attempt,po.camelCase=qd.camelCase,po.capitalize=qd.capitalize,po.ceil=Hd.ceil,po.clamp=Yd,po.clone=zd.clone,po.cloneDeep=zd.cloneDeep,po.cloneDeepWith=zd.cloneDeepWith,po.cloneWith=zd.cloneWith,po.conformsTo=zd.conformsTo,po.deburr=qd.deburr,po.defaultTo=Kd.defaultTo,po.divide=Hd.divide,po.endsWith=qd.endsWith,po.eq=zd.eq,po.escape=qd.escape,po.escapeRegExp=qd.escapeRegExp,po.every=Nd.every,po.find=Nd.find,po.findIndex=Fd.findIndex,po.findKey=Xd.findKey,po.findLast=Nd.findLast,po.findLastIndex=Fd.findLastIndex,po.findLastKey=Xd.findLastKey,po.floor=Hd.floor,po.forEach=Nd.forEach,po.forEachRight=Nd.forEachRight,po.forIn=Xd.forIn,po.forInRight=Xd.forInRight,po.forOwn=Xd.forOwn,po.forOwnRight=Xd.forOwnRight,po.get=Xd.get,po.gt=zd.gt,po.gte=zd.gte,po.has=Xd.has,po.hasIn=Xd.hasIn,po.head=Fd.head,po.identity=p,po.includes=Nd.includes,po.indexOf=Fd.indexOf,po.inRange=Gd,po.invoke=Xd.invoke,po.isArguments=zd.isArguments,po.isArray=Nn,po.isArrayBuffer=zd.isArrayBuffer,po.isArrayLike=zd.isArrayLike,po.isArrayLikeObject=zd.isArrayLikeObject,po.isBoolean=zd.isBoolean,po.isBuffer=zd.isBuffer,po.isDate=zd.isDate,po.isElement=zd.isElement,po.isEmpty=zd.isEmpty,po.isEqual=zd.isEqual,po.isEqualWith=zd.isEqualWith,po.isError=zd.isError,po.isFinite=zd.isFinite,po.isFunction=zd.isFunction,po.isInteger=zd.isInteger,po.isLength=zd.isLength,po.isMap=zd.isMap,po.isMatch=zd.isMatch,po.isMatchWith=zd.isMatchWith,po.isNaN=zd.isNaN,po.isNative=zd.isNative,po.isNil=zd.isNil,po.isNull=zd.isNull,po.isNumber=zd.isNumber,po.isObject=jn,po.isObjectLike=zd.isObjectLike,po.isPlainObject=zd.isPlainObject,po.isRegExp=zd.isRegExp,po.isSafeInteger=zd.isSafeInteger,po.isSet=zd.isSet,po.isString=zd.isString,po.isSymbol=zd.isSymbol,po.isTypedArray=zd.isTypedArray,po.isUndefined=zd.isUndefined,po.isWeakMap=zd.isWeakMap,po.isWeakSet=zd.isWeakSet,po.join=Fd.join,po.kebabCase=qd.kebabCase,po.last=pl,po.lastIndexOf=Fd.lastIndexOf,po.lowerCase=qd.lowerCase,po.lowerFirst=qd.lowerFirst,po.lt=zd.lt,po.lte=zd.lte,po.max=Hd.max,po.maxBy=Hd.maxBy,po.mean=Hd.mean,po.meanBy=Hd.meanBy,po.min=Hd.min,po.minBy=Hd.minBy,po.stubArray=Kd.stubArray,po.stubFalse=Kd.stubFalse,po.stubObject=Kd.stubObject,po.stubString=Kd.stubString,po.stubTrue=Kd.stubTrue,po.multiply=Hd.multiply,po.nth=Fd.nth,po.noop=Kd.noop,po.now=Vd.now,po.pad=qd.pad,po.padEnd=qd.padEnd,po.padStart=qd.padStart,po.parseInt=qd.parseInt,po.random=Wd,po.reduce=Nd.reduce,po.reduceRight=Nd.reduceRight,po.repeat=qd.repeat,po.replace=qd.replace,po.result=Xd.result,po.round=Hd.round,po.sample=Nd.sample,po.size=Nd.size,po.snakeCase=qd.snakeCase,po.some=Nd.some,po.sortedIndex=Fd.sortedIndex,po.sortedIndexBy=Fd.sortedIndexBy,po.sortedIndexOf=Fd.sortedIndexOf,po.sortedLastIndex=Fd.sortedLastIndex,po.sortedLastIndexBy=Fd.sortedLastIndexBy,po.sortedLastIndexOf=Fd.sortedLastIndexOf,po.startCase=qd.startCase,po.startsWith=qd.startsWith,po.subtract=Hd.subtract,po.sum=Hd.sum,po.sumBy=Hd.sumBy,po.template=qd.template,po.times=Kd.times,po.toFinite=zd.toFinite,po.toInteger=$r,po.toLength=zd.toLength,po.toLower=qd.toLower,po.toNumber=zd.toNumber,po.toSafeInteger=zd.toSafeInteger,po.toString=zd.toString,po.toUpper=qd.toUpper,po.trim=qd.trim,po.trimEnd=qd.trimEnd,po.trimStart=qd.trimStart,po.truncate=qd.truncate,po.unescape=qd.unescape,po.uniqueId=Kd.uniqueId,po.upperCase=qd.upperCase,po.upperFirst=qd.upperFirst,po.each=Nd.forEach,po.eachRight=Nd.forEachRight,po.first=Fd.head,cf(po,(tf={},Us(po,(function(e,t){of.call(po.prototype,t)||(tf[t]=e)})),tf),{chain:!1}),po.VERSION="4.17.21",(po.templateSettings=qd.templateSettings).imports._=po,m(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){po[e].placeholder=po})),m(["drop","take"],(function(e,t){ro.prototype[e]=function(n){n=void 0===n?1:sf($r(n),0);var i=this.__filtered__&&!t?new ro(this):this.clone();return i.__filtered__?i.__takeCount__=lf(n,i.__takeCount__):i.__views__.push({size:lf(n,nf),type:e+(i.__dir__<0?"Right":"")}),i},ro.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),m(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=1==n||3==n;ro.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:js(e),type:n}),t.__filtered__=t.__filtered__||i,t}})),m(["head","last"],(function(e,t){var n="take"+(t?"Right":"");ro.prototype[e]=function(){return this[n](1).value()[0]}})),m(["initial","tail"],(function(e,t){var n="drop"+(t?"":"Right");ro.prototype[e]=function(){return this.__filtered__?new ro(this):this[n](1)}})),ro.prototype.compact=function(){return this.filter(p)},ro.prototype.find=function(e){return this.filter(e).head()},ro.prototype.findLast=function(e){return this.reverse().find(e)},ro.prototype.invokeMap=Ro((function(e,t){return"function"==typeof e?new ro(this):this.map((function(n){return Mc(n,e,t)}))})),ro.prototype.reject=function(e){return this.filter(fu(js(e)))},ro.prototype.slice=function(e,t){e=$r(e);var n=this;return n.__filtered__&&(e>0||t<0)?new ro(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),void 0!==t&&(n=(t=$r(t))<0?n.dropRight(-t):n.take(t-e)),n)},ro.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ro.prototype.toArray=function(){return this.take(nf)},Us(ro.prototype,(function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),i=/^(?:head|last)$/.test(t),r=po[i?"take"+("last"==t?"Right":""):t],o=i||/^find/.test(t);r&&(po.prototype[t]=function(){var t=this.__wrapped__,a=i?[1]:arguments,s=t instanceof ro,l=a[0],c=s||Nn(t),u=function(e){var t=r.apply(po,T([e],a));return i&&h?t[0]:t};c&&n&&"function"==typeof l&&1!=l.length&&(s=c=!1);var h=this.__chain__,d=!!this.__actions__.length,f=o&&!h,p=s&&!d;if(!o&&c){t=p?t:new ro(this);var g=e.apply(t,a);return g.__actions__.push({func:od,args:[u],thisArg:void 0}),new uo(g,h)}return f&&p?e.apply(this,a):(g=this.thru(u),f?i?g.value()[0]:g.value():g)})})),m(["pop","push","shift","sort","splice","unshift"],(function(e){var t=rf[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=/^(?:pop|shift)$/.test(e);po.prototype[e]=function(){var e=arguments;if(i&&!this.__chain__){var r=this.value();return t.apply(Nn(r)?r:[],e)}return this[n]((function(n){return t.apply(Nn(n)?n:[],e)}))}})),Us(ro.prototype,(function(e,t){var n=po[t];if(n){var i=n.name+"";of.call(so,i)||(so[i]=[]),so[i].push({name:t,func:n})}})),so[To(void 0,2).name]=[{name:"wrapper",func:void 0}],ro.prototype.clone=function(){var e=new ro(this.__wrapped__);return e.__actions__=v(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=v(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=v(this.__views__),e},ro.prototype.reverse=function(){if(this.__filtered__){var e=new ro(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},ro.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Nn(e),i=t<0,r=n?e.length:0,o=function(e,t,n){for(var i=-1,r=n.length;++i<r;){var o=n[i],a=o.size;switch(o.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=Zd(t,e+a);break;case"takeRight":e=Jd(e,t-a)}}return{start:e,end:t}}(0,r,this.__views__),a=o.start,s=o.end,l=s-a,c=i?s:a-1,u=this.__iteratees__,h=u.length,d=0,f=ef(l,this.__takeCount__);if(!n||!i&&r==l&&f==l)return ld(e,this.__actions__);var p=[];e:for(;l--&&d<f;){for(var g=-1,v=e[c+=t];++g<h;){var A=u[g],m=A.iteratee,y=A.type,b=m(v);if(2==y)v=b;else if(!b){if(1==y)continue e;break e}}p[d++]=v}return p},po.prototype.at=$d.at,po.prototype.chain=$d.wrapperChain,po.prototype.commit=$d.commit,po.prototype.next=$d.next,po.prototype.plant=$d.plant,po.prototype.reverse=$d.reverse,po.prototype.toJSON=po.prototype.valueOf=po.prototype.value=$d.value,po.prototype.first=po.prototype.head,af&&(po.prototype[af]=$d.toIterator);const uf=e=>{let t,n;return"touchend"===e.type?(n=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(n=e.touches[0].clientY,t=e.touches[0].clientX):(n=e.clientY,t=e.clientX),{clientX:t,clientY:n}},hf=Symbol("breadcrumbKey"),df=be({separator:{type:String,default:"/"},separatorIcon:{type:Ce}}),ff=["aria-label"],pf=ai({name:"ElBreadcrumb"});var gf=_e(ai(c(l({},pf),{props:df,setup(e){const t=e,{t:n}=we(),i=xe("breadcrumb"),r=si();return li(hf,t),ci((()=>{const e=r.value.querySelectorAll(`.${i.e("item")}`);e.length&&e[e.length-1].setAttribute("aria-current","page")})),(e,t)=>(ui(),hi("div",{ref_key:"breadcrumb",ref:r,class:fi(pi(i).b()),"aria-label":pi(n)("el.breadcrumb.label"),role:"navigation"},[di(e.$slots,"default")],10,ff))}})),[["__file","breadcrumb.vue"]]);const vf=be({to:{type:Ee([String,Object]),default:""},replace:{type:Boolean,default:!1}}),Af=ai({name:"ElBreadcrumbItem"});var mf=_e(ai(c(l({},Af),{props:vf,setup(e){const t=e,n=Ci(),i=gi(hf,void 0),r=xe("breadcrumb"),o=n.appContext.config.globalProperties.$router,a=si(),s=()=>{t.to&&o&&(t.replace?o.replace(t.to):o.push(t.to))};return(e,t)=>{var n,o;return ui(),hi("span",{class:fi(pi(r).e("item"))},[vi("span",{ref_key:"link",ref:a,class:fi([pi(r).e("inner"),pi(r).is("link",!!e.to)]),role:"link",onClick:s},[di(e.$slots,"default")],2),(null==(n=pi(i))?void 0:n.separatorIcon)?(ui(),Ai(pi(Se),{key:0,class:fi(pi(r).e("separator"))},{default:mi((()=>[(ui(),Ai(yi(pi(i).separatorIcon)))])),_:1},8,["class"])):(ui(),hi("span",{key:1,class:fi(pi(r).e("separator")),role:"presentation"},bi(null==(o=pi(i))?void 0:o.separator),3))],2)}}})),[["__file","breadcrumb-item.vue"]]);const yf=Ie(gf,{BreadcrumbItem:mf}),bf=ke(mf);var Cf={exports:{}};Cf.exports=function(){var e=1e3,t=6e4,n=36e5,i="millisecond",r="second",o="minute",a="hour",s="day",l="week",c="month",u="quarter",h="year",d="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},A=function(e,t,n){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(n)+e},m={s:A,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),i=Math.floor(n/60),r=n%60;return(t<=0?"+":"-")+A(i,2,"0")+":"+A(r,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var i=12*(n.year()-t.year())+(n.month()-t.month()),r=t.clone().add(i,c),o=n-r<0,a=t.clone().add(i+(o?-1:1),c);return+(-(i+(n-r)/(o?r-a:a-r))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:h,w:l,d:s,D:d,h:a,m:o,s:r,ms:i,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=v;var C="$isDayjsObject",w=function(e){return e instanceof S||!(!e||!e[C])},x=function e(t,n,i){var r;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();b[o]&&(r=o),n&&(b[o]=n,r=o);var a=t.split("-");if(!r&&a.length>1)return e(a[0])}else{var s=t.name;b[s]=t,r=s}return!i&&r&&(y=r),r||!i&&y},_=function(e,t){if(w(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new S(n)},E=m;E.l=x,E.i=w,E.w=function(e,t){return _(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var S=function(){function v(e){this.$L=x(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[C]=!0}var A=v.prototype;return A.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(E.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(p);if(i){var r=i[2]-1||0,o=(i[7]||"0").substring(0,3);return n?new Date(Date.UTC(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)):new Date(i[1],r,i[3]||1,i[4]||0,i[5]||0,i[6]||0,o)}}return new Date(t)}(e),this.init()},A.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},A.$utils=function(){return E},A.isValid=function(){return!(this.$d.toString()===f)},A.isSame=function(e,t){var n=_(e);return this.startOf(t)<=n&&n<=this.endOf(t)},A.isAfter=function(e,t){return _(e)<this.startOf(t)},A.isBefore=function(e,t){return this.endOf(t)<_(e)},A.$g=function(e,t,n){return E.u(e)?this[t]:this.set(n,e)},A.unix=function(){return Math.floor(this.valueOf()/1e3)},A.valueOf=function(){return this.$d.getTime()},A.startOf=function(e,t){var n=this,i=!!E.u(t)||t,u=E.p(e),f=function(e,t){var r=E.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return i?r:r.endOf(s)},p=function(e,t){return E.w(n.toDate()[e].apply(n.toDate("s"),(i?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},g=this.$W,v=this.$M,A=this.$D,m="set"+(this.$u?"UTC":"");switch(u){case h:return i?f(1,0):f(31,11);case c:return i?f(1,v):f(0,v+1);case l:var y=this.$locale().weekStart||0,b=(g<y?g+7:g)-y;return f(i?A-b:A+(6-b),v);case s:case d:return p(m+"Hours",0);case a:return p(m+"Minutes",1);case o:return p(m+"Seconds",2);case r:return p(m+"Milliseconds",3);default:return this.clone()}},A.endOf=function(e){return this.startOf(e,!1)},A.$set=function(e,t){var n,l=E.p(e),u="set"+(this.$u?"UTC":""),f=(n={},n[s]=u+"Date",n[d]=u+"Date",n[c]=u+"Month",n[h]=u+"FullYear",n[a]=u+"Hours",n[o]=u+"Minutes",n[r]=u+"Seconds",n[i]=u+"Milliseconds",n)[l],p=l===s?this.$D+(t-this.$W):t;if(l===c||l===h){var g=this.clone().set(d,1);g.$d[f](p),g.init(),this.$d=g.set(d,Math.min(this.$D,g.daysInMonth())).$d}else f&&this.$d[f](p);return this.init(),this},A.set=function(e,t){return this.clone().$set(e,t)},A.get=function(e){return this[E.p(e)]()},A.add=function(i,u){var d,f=this;i=Number(i);var p=E.p(u),g=function(e){var t=_(f);return E.w(t.date(t.date()+Math.round(e*i)),f)};if(p===c)return this.set(c,this.$M+i);if(p===h)return this.set(h,this.$y+i);if(p===s)return g(1);if(p===l)return g(7);var v=(d={},d[o]=t,d[a]=n,d[r]=e,d)[p]||1,A=this.$d.getTime()+i*v;return E.w(A,this)},A.subtract=function(e,t){return this.add(-1*e,t)},A.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var i=e||"YYYY-MM-DDTHH:mm:ssZ",r=E.z(this),o=this.$H,a=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=n.meridiem,h=function(e,n,r,o){return e&&(e[n]||e(t,i))||r[n].slice(0,o)},d=function(e){return E.s(o%12||12,e,"0")},p=u||function(e,t,n){var i=e<12?"AM":"PM";return n?i.toLowerCase():i};return i.replace(g,(function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return E.s(t.$y,4,"0");case"M":return s+1;case"MM":return E.s(s+1,2,"0");case"MMM":return h(n.monthsShort,s,c,3);case"MMMM":return h(c,s);case"D":return t.$D;case"DD":return E.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return h(n.weekdaysMin,t.$W,l,2);case"ddd":return h(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(o);case"HH":return E.s(o,2,"0");case"h":return d(1);case"hh":return d(2);case"a":return p(o,a,!0);case"A":return p(o,a,!1);case"m":return String(a);case"mm":return E.s(a,2,"0");case"s":return String(t.$s);case"ss":return E.s(t.$s,2,"0");case"SSS":return E.s(t.$ms,3,"0");case"Z":return r}return null}(e)||r.replace(":","")}))},A.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},A.diff=function(i,d,f){var p,g=this,v=E.p(d),A=_(i),m=(A.utcOffset()-this.utcOffset())*t,y=this-A,b=function(){return E.m(g,A)};switch(v){case h:p=b()/12;break;case c:p=b();break;case u:p=b()/3;break;case l:p=(y-m)/6048e5;break;case s:p=(y-m)/864e5;break;case a:p=y/n;break;case o:p=y/t;break;case r:p=y/e;break;default:p=y}return f?p:E.a(p)},A.daysInMonth=function(){return this.endOf(c).$D},A.$locale=function(){return b[this.$L]},A.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),i=x(e,t,!0);return i&&(n.$L=i),n},A.clone=function(){return E.w(this.$d,this)},A.toDate=function(){return new Date(this.valueOf())},A.toJSON=function(){return this.isValid()?this.toISOString():null},A.toISOString=function(){return this.$d.toISOString()},A.toString=function(){return this.$d.toUTCString()},v}(),I=S.prototype;return _.prototype=I,[["$ms",i],["$s",r],["$m",o],["$H",a],["$W",s],["$M",c],["$y",h],["$D",d]].forEach((function(e){I[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),_.extend=function(e,t){return e.$i||(e(t,S,_),e.$i=!0),_},_.locale=x,_.isDayjs=w,_.unix=function(e){return _(1e3*e)},_.en=b[y],_.Ls=b,_.p={},_}();const wf=xi(Cf.exports),xf=new Map;let _f;function Ef(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:Be(t.arg)&&n.push(t.arg),function(i,r){const o=t.instance.popperRef,a=i.target,s=null==r?void 0:r.target,l=!t||!t.instance,c=!a||!s,u=e.contains(a)||e.contains(s),h=e===a,d=n.length&&n.some((e=>null==e?void 0:e.contains(a)))||n.length&&n.includes(s),f=o&&(o.contains(a)||o.contains(s));l||c||u||h||d||f||t.value(i,r)}}ye&&(document.addEventListener("mousedown",(e=>_f=e)),document.addEventListener("mouseup",(e=>{for(const t of xf.values())for(const{documentHandler:n}of t)n(e,_f)})));const Sf={beforeMount(e,t){xf.has(e)||xf.set(e,[]),xf.get(e).push({documentHandler:Ef(e,t),bindingFn:t.value})},updated(e,t){xf.has(e)||xf.set(e,[]);const n=xf.get(e),i=n.findIndex((e=>e.bindingFn===t.oldValue)),r={documentHandler:Ef(e,t),bindingFn:t.value};i>=0?n.splice(i,1,r):n.push(r)},unmounted(e){xf.delete(e)}},If=100,kf=600,Bf={beforeMount(e,t){const n=t.value,{interval:i=If,delay:r=kf}=_i(n)?{}:n;let o,a;const s=()=>_i(n)?n():n.handler(),l=()=>{a&&(clearTimeout(a),a=void 0),o&&(clearInterval(o),o=void 0)};e.addEventListener("mousedown",(e=>{0===e.button&&(l(),s(),document.addEventListener("mouseup",(()=>l()),{once:!0}),a=setTimeout((()=>{o=setInterval((()=>{s()}),i)}),r))}))}},Of=l({modelValue:{type:[Number,String,Boolean],default:void 0},label:{type:[String,Boolean,Number,Object],default:void 0},value:{type:[String,Boolean,Number,Object],default:void 0},indeterminate:Boolean,disabled:Boolean,checked:Boolean,name:{type:String,default:void 0},trueValue:{type:[String,Number],default:void 0},falseValue:{type:[String,Number],default:void 0},trueLabel:{type:[String,Number],default:void 0},falseLabel:{type:[String,Number],default:void 0},id:{type:String,default:void 0},controls:{type:String,default:void 0},border:Boolean,size:Oe,tabindex:[String,Number],validateEvent:{type:Boolean,default:!0}},Te(["ariaControls"])),Tf={[De]:e=>Ei(e)||Me(e)||Qe(e),change:e=>Ei(e)||Me(e)||Qe(e)},Df=Symbol("checkboxGroupContextKey"),Mf=(e,{model:t,isLimitExceeded:n,hasOwnLabel:i,isDisabled:r,isLabeledByFormItem:o})=>{const a=gi(Df,void 0),{formItem:s}=je(),{emit:l}=Ci();function c(t){var n,i,r,o;return[!0,e.trueValue,e.trueLabel].includes(t)?null==(i=null!=(n=e.trueValue)?n:e.trueLabel)||i:null!=(o=null!=(r=e.falseValue)?r:e.falseLabel)&&o}const u=Si((()=>(null==a?void 0:a.validateEvent)||e.validateEvent));return Ii((()=>e.modelValue),(()=>{u.value&&(null==s||s.validate("change").catch((e=>Re())))})),{handleChange:function(e){if(n.value)return;const t=e.target;l("change",c(t.checked),e)},onClickRoot:function(a){return h(this,null,(function*(){if(!n.value&&!i.value&&!r.value&&o.value){a.composedPath().some((e=>"LABEL"===e.tagName))||(t.value=c([!1,e.falseValue,e.falseLabel].includes(t.value)),yield ki(),function(e,t){l("change",c(e),t)}(t.value,a))}}))}}},Qf=(e,t)=>{const{formItem:n}=je(),{model:i,isGroup:r,isLimitExceeded:o}=(e=>{const t=si(!1),{emit:n}=Ci(),i=gi(Df,void 0),r=Si((()=>!1===Le(i))),o=si(!1),a=Si({get(){var n,o;return r.value?null==(n=null==i?void 0:i.modelValue)?void 0:n.value:null!=(o=e.modelValue)?o:t.value},set(e){var s,l;r.value&&Bi(e)?(o.value=void 0!==(null==(s=null==i?void 0:i.max)?void 0:s.value)&&e.length>(null==i?void 0:i.max.value)&&e.length>a.value.length,!1===o.value&&(null==(l=null==i?void 0:i.changeEvent)||l.call(i,e))):(n(De,e),t.value=e)}});return{model:a,isGroup:r,isLimitExceeded:o}})(e),{isFocused:a,isChecked:s,checkboxButtonSize:l,checkboxSize:c,hasOwnLabel:u,actualValue:h}=((e,t,{model:n})=>{const i=gi(Df,void 0),r=si(!1),o=Si((()=>Fe(e.value)?e.label:e.value)),a=Si((()=>{const t=n.value;return Qe(t)?t:Bi(t)?Oi(o.value)?t.map(Ti).some((e=>Vc(e,o.value))):t.map(Ti).includes(o.value):null!=t?t===e.trueValue||t===e.trueLabel:!!t}));return{checkboxButtonSize:Ne(Si((()=>{var e;return null==(e=null==i?void 0:i.size)?void 0:e.value})),{prop:!0}),isChecked:a,isFocused:r,checkboxSize:Ne(Si((()=>{var e;return null==(e=null==i?void 0:i.size)?void 0:e.value}))),hasOwnLabel:Si((()=>!!t.default||!Fe(o.value))),actualValue:o}})(e,t,{model:i}),{isDisabled:d}=(({model:e,isChecked:t})=>{const n=gi(Df,void 0),i=Si((()=>{var i,r;const o=null==(i=null==n?void 0:n.max)?void 0:i.value,a=null==(r=null==n?void 0:n.min)?void 0:r.value;return!Le(o)&&e.value.length>=o&&!t.value||!Le(a)&&e.value.length<=a&&t.value}));return{isDisabled:Pe(Si((()=>(null==n?void 0:n.disabled.value)||i.value))),isLimitDisabled:i}})({model:i,isChecked:s}),{inputId:f,isLabeledByFormItem:p}=Ve(e,{formItemContext:n,disableIdGeneration:u,disableIdManagement:r}),{handleChange:g,onClickRoot:v}=Mf(e,{model:i,isLimitExceeded:o,hasOwnLabel:u,isDisabled:d,isLabeledByFormItem:p});var A,m;return e.checked&&(Bi(i.value)&&!i.value.includes(h.value)?i.value.push(h.value):i.value=null==(m=null!=(A=e.trueValue)?A:e.trueLabel)||m),Ue({from:"controls",replacement:"aria-controls",version:"2.8.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Si((()=>!!e.controls))),Ue({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Si((()=>r.value&&Fe(e.value)))),Ue({from:"true-label",replacement:"true-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Si((()=>!!e.trueLabel))),Ue({from:"false-label",replacement:"false-value",version:"3.0.0",scope:"el-checkbox",ref:"https://element-plus.org/en-US/component/checkbox.html"},Si((()=>!!e.falseLabel))),{inputId:f,isLabeledByFormItem:p,isChecked:s,isDisabled:d,isFocused:a,checkboxButtonSize:l,checkboxSize:c,hasOwnLabel:u,model:i,actualValue:h,handleChange:g,onClickRoot:v}},Lf=["id","indeterminate","name","tabindex","disabled","true-value","false-value"],Pf=["id","indeterminate","disabled","value","name","tabindex"],jf=ai({name:"ElCheckbox"});var Rf=_e(ai(c(l({},jf),{props:Of,emits:Tf,setup(e){const t=e,n=Di(),{inputId:i,isLabeledByFormItem:r,isChecked:o,isDisabled:a,isFocused:s,checkboxSize:l,hasOwnLabel:c,model:u,actualValue:h,handleChange:d,onClickRoot:f}=Qf(t,n),p=xe("checkbox"),g=Si((()=>[p.b(),p.m(l.value),p.is("disabled",a.value),p.is("bordered",t.border),p.is("checked",o.value)])),v=Si((()=>[p.e("input"),p.is("disabled",a.value),p.is("checked",o.value),p.is("indeterminate",t.indeterminate),p.is("focus",s.value)]));return(e,t)=>(ui(),Ai(yi(!pi(c)&&pi(r)?"span":"label"),{class:fi(pi(g)),"aria-controls":e.indeterminate?e.controls||e.ariaControls:null,onClick:pi(f)},{default:mi((()=>{var n,r;return[vi("span",{class:fi(pi(v))},[e.trueValue||e.falseValue||e.trueLabel||e.falseLabel?Mi((ui(),hi("input",{key:0,id:pi(i),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(u)?u.value=e:null),class:fi(pi(p).e("original")),type:"checkbox",indeterminate:e.indeterminate,name:e.name,tabindex:e.tabindex,disabled:pi(a),"true-value":null!=(n=e.trueValue)?n:e.trueLabel,"false-value":null!=(r=e.falseValue)?r:e.falseLabel,onChange:t[1]||(t[1]=(...e)=>pi(d)&&pi(d)(...e)),onFocus:t[2]||(t[2]=e=>s.value=!0),onBlur:t[3]||(t[3]=e=>s.value=!1),onClick:t[4]||(t[4]=Li((()=>{}),["stop"]))},null,42,Lf)),[[Pi,pi(u)]]):Mi((ui(),hi("input",{key:1,id:pi(i),"onUpdate:modelValue":t[5]||(t[5]=e=>Qi(u)?u.value=e:null),class:fi(pi(p).e("original")),type:"checkbox",indeterminate:e.indeterminate,disabled:pi(a),value:pi(h),name:e.name,tabindex:e.tabindex,onChange:t[6]||(t[6]=(...e)=>pi(d)&&pi(d)(...e)),onFocus:t[7]||(t[7]=e=>s.value=!0),onBlur:t[8]||(t[8]=e=>s.value=!1),onClick:t[9]||(t[9]=Li((()=>{}),["stop"]))},null,42,Pf)),[[Pi,pi(u)]]),vi("span",{class:fi(pi(p).e("inner"))},null,2)],2),pi(c)?(ui(),hi("span",{key:0,class:fi(pi(p).e("label"))},[di(e.$slots,"default"),e.$slots.default?Fi("v-if",!0):(ui(),hi(ji,{key:0},[Ri(bi(e.label),1)],64))],2)):Fi("v-if",!0)]})),_:3},8,["class","aria-controls","onClick"]))}})),[["__file","checkbox.vue"]]);const Ff=["name","tabindex","disabled","true-value","false-value"],Nf=["name","tabindex","disabled","value"],Vf=ai({name:"ElCheckboxButton"});var Uf=_e(ai(c(l({},Vf),{props:Of,emits:Tf,setup(e){const t=e,n=Di(),{isFocused:i,isChecked:r,isDisabled:o,checkboxButtonSize:a,model:s,actualValue:l,handleChange:c}=Qf(t,n),u=gi(Df,void 0),h=xe("checkbox"),d=Si((()=>{var e,t,n,i;const r=null!=(t=null==(e=null==u?void 0:u.fill)?void 0:e.value)?t:"";return{backgroundColor:r,borderColor:r,color:null!=(i=null==(n=null==u?void 0:u.textColor)?void 0:n.value)?i:"",boxShadow:r?`-1px 0 0 0 ${r}`:void 0}})),f=Si((()=>[h.b("button"),h.bm("button",a.value),h.is("disabled",o.value),h.is("checked",r.value),h.is("focus",i.value)]));return(e,t)=>{var n,a;return ui(),hi("label",{class:fi(pi(f))},[e.trueValue||e.falseValue||e.trueLabel||e.falseLabel?Mi((ui(),hi("input",{key:0,"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(s)?s.value=e:null),class:fi(pi(h).be("button","original")),type:"checkbox",name:e.name,tabindex:e.tabindex,disabled:pi(o),"true-value":null!=(n=e.trueValue)?n:e.trueLabel,"false-value":null!=(a=e.falseValue)?a:e.falseLabel,onChange:t[1]||(t[1]=(...e)=>pi(c)&&pi(c)(...e)),onFocus:t[2]||(t[2]=e=>i.value=!0),onBlur:t[3]||(t[3]=e=>i.value=!1),onClick:t[4]||(t[4]=Li((()=>{}),["stop"]))},null,42,Ff)),[[Pi,pi(s)]]):Mi((ui(),hi("input",{key:1,"onUpdate:modelValue":t[5]||(t[5]=e=>Qi(s)?s.value=e:null),class:fi(pi(h).be("button","original")),type:"checkbox",name:e.name,tabindex:e.tabindex,disabled:pi(o),value:pi(l),onChange:t[6]||(t[6]=(...e)=>pi(c)&&pi(c)(...e)),onFocus:t[7]||(t[7]=e=>i.value=!0),onBlur:t[8]||(t[8]=e=>i.value=!1),onClick:t[9]||(t[9]=Li((()=>{}),["stop"]))},null,42,Nf)),[[Pi,pi(s)]]),e.$slots.default||e.label?(ui(),hi("span",{key:2,class:fi(pi(h).be("button","inner")),style:Ni(pi(r)?pi(d):void 0)},[di(e.$slots,"default",{},(()=>[Ri(bi(e.label),1)]))],6)):Fi("v-if",!0)],2)}}})),[["__file","checkbox-button.vue"]]);const zf=be(l({modelValue:{type:Ee(Array),default:()=>[]},disabled:Boolean,min:Number,max:Number,size:Oe,label:String,fill:String,textColor:String,tag:{type:String,default:"div"},validateEvent:{type:Boolean,default:!0}},Te(["ariaLabel"]))),Hf={[De]:e=>Bi(e),change:e=>Bi(e)},Yf=ai({name:"ElCheckboxGroup"});var Gf=_e(ai(c(l({},Yf),{props:zf,emits:Hf,setup(e,{emit:t}){const n=e,i=xe("checkbox"),{formItem:r}=je(),{inputId:o,isLabeledByFormItem:a}=Ve(n,{formItemContext:r}),s=e=>h(this,null,(function*(){t(De,e),yield ki(),t("change",e)})),u=Si({get:()=>n.modelValue,set(e){s(e)}});return li(Df,c(l({},Ae(Vi(n),["size","min","max","disabled","validateEvent","fill","textColor"])),{modelValue:u,changeEvent:s})),Ue({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-checkbox-group",ref:"https://element-plus.org/en-US/component/checkbox.html"},Si((()=>!!n.label))),Ii((()=>n.modelValue),(()=>{n.validateEvent&&(null==r||r.validate("change").catch((e=>Re())))})),(e,t)=>{var n;return ui(),Ai(yi(e.tag),{id:pi(o),class:fi(pi(i).b("group")),role:"group","aria-label":pi(a)?void 0:e.label||e.ariaLabel||"checkbox-group","aria-labelledby":pi(a)?null==(n=pi(r))?void 0:n.labelId:void 0},{default:mi((()=>[di(e.$slots,"default")])),_:3},8,["id","class","aria-label","aria-labelledby"])}}})),[["__file","checkbox-group.vue"]]);const Wf=Ie(Rf,{CheckboxButton:Uf,CheckboxGroup:Gf});ke(Uf),ke(Gf);const Xf=be({modelValue:{type:[String,Number,Boolean],default:void 0},size:Oe,disabled:Boolean,label:{type:[String,Number,Boolean],default:void 0},value:{type:[String,Number,Boolean],default:void 0},name:{type:String,default:void 0}}),$f=be(c(l({},Xf),{border:Boolean})),qf={[De]:e=>Ei(e)||Me(e)||Qe(e),[ze]:e=>Ei(e)||Me(e)||Qe(e)},Kf=Symbol("radioGroupKey"),Jf=(e,t)=>{const n=si(),i=gi(Kf,void 0),r=Si((()=>!!i)),o=Si((()=>Fe(e.value)?e.label:e.value)),a=Si({get:()=>r.value?i.modelValue:e.modelValue,set(a){r.value?i.changeEvent(a):t&&t(De,a),n.value.checked=e.modelValue===o.value}}),s=Ne(Si((()=>null==i?void 0:i.size))),l=Pe(Si((()=>null==i?void 0:i.disabled))),c=si(!1),u=Si((()=>l.value||r.value&&a.value!==o.value?-1:0));return Ue({from:"label act as value",replacement:"value",version:"3.0.0",scope:"el-radio",ref:"https://element-plus.org/en-US/component/radio.html"},Si((()=>r.value&&Fe(e.value)))),{radioRef:n,isGroup:r,radioGroup:i,focus:c,size:s,disabled:l,tabIndex:u,modelValue:a,actualValue:o}},Zf=["value","name","disabled"],ep=ai({name:"ElRadio"});var tp=_e(ai(c(l({},ep),{props:$f,emits:qf,setup(e,{emit:t}){const n=e,i=xe("radio"),{radioRef:r,radioGroup:o,focus:a,size:s,disabled:l,modelValue:c,actualValue:u}=Jf(n,t);function h(){ki((()=>t("change",c.value)))}return(e,t)=>{var n;return ui(),hi("label",{class:fi([pi(i).b(),pi(i).is("disabled",pi(l)),pi(i).is("focus",pi(a)),pi(i).is("bordered",e.border),pi(i).is("checked",pi(c)===pi(u)),pi(i).m(pi(s))])},[vi("span",{class:fi([pi(i).e("input"),pi(i).is("disabled",pi(l)),pi(i).is("checked",pi(c)===pi(u))])},[Mi(vi("input",{ref_key:"radioRef",ref:r,"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(c)?c.value=e:null),class:fi(pi(i).e("original")),value:pi(u),name:e.name||(null==(n=pi(o))?void 0:n.name),disabled:pi(l),type:"radio",onFocus:t[1]||(t[1]=e=>a.value=!0),onBlur:t[2]||(t[2]=e=>a.value=!1),onChange:h,onClick:t[3]||(t[3]=Li((()=>{}),["stop"]))},null,42,Zf),[[Ui,pi(c)]]),vi("span",{class:fi(pi(i).e("inner"))},null,2)],2),vi("span",{class:fi(pi(i).e("label")),onKeydown:t[4]||(t[4]=Li((()=>{}),["stop"]))},[di(e.$slots,"default",{},(()=>[Ri(bi(e.label),1)]))],34)],2)}}})),[["__file","radio.vue"]]);const np=be(l({},Xf)),ip=["value","name","disabled"],rp=ai({name:"ElRadioButton"});var op=_e(ai(c(l({},rp),{props:np,setup(e){const t=e,n=xe("radio"),{radioRef:i,focus:r,size:o,disabled:a,modelValue:s,radioGroup:l,actualValue:c}=Jf(t),u=Si((()=>({backgroundColor:(null==l?void 0:l.fill)||"",borderColor:(null==l?void 0:l.fill)||"",boxShadow:(null==l?void 0:l.fill)?`-1px 0 0 0 ${l.fill}`:"",color:(null==l?void 0:l.textColor)||""})));return(e,t)=>{var h;return ui(),hi("label",{class:fi([pi(n).b("button"),pi(n).is("active",pi(s)===pi(c)),pi(n).is("disabled",pi(a)),pi(n).is("focus",pi(r)),pi(n).bm("button",pi(o))])},[Mi(vi("input",{ref_key:"radioRef",ref:i,"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(s)?s.value=e:null),class:fi(pi(n).be("button","original-radio")),value:pi(c),type:"radio",name:e.name||(null==(h=pi(l))?void 0:h.name),disabled:pi(a),onFocus:t[1]||(t[1]=e=>r.value=!0),onBlur:t[2]||(t[2]=e=>r.value=!1),onClick:t[3]||(t[3]=Li((()=>{}),["stop"]))},null,42,ip),[[Ui,pi(s)]]),vi("span",{class:fi(pi(n).be("button","inner")),style:Ni(pi(s)===pi(c)?pi(u):{}),onKeydown:t[4]||(t[4]=Li((()=>{}),["stop"]))},[di(e.$slots,"default",{},(()=>[Ri(bi(e.label),1)]))],38)],2)}}})),[["__file","radio-button.vue"]]);const ap=be(l({id:{type:String,default:void 0},size:Oe,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:void 0},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}},Te(["ariaLabel"]))),sp=qf,lp=["id","aria-label","aria-labelledby"],cp=ai({name:"ElRadioGroup"}),up=ai(c(l({},cp),{props:ap,emits:sp,setup(e,{emit:t}){const n=e,i=xe("radio"),r=He(),o=si(),{formItem:a}=je(),{inputId:s,isLabeledByFormItem:u}=Ve(n,{formItemContext:a});ci((()=>{const e=o.value.querySelectorAll("[type=radio]"),t=e[0];!Array.from(e).some((e=>e.checked))&&t&&(t.tabIndex=0)}));const h=Si((()=>n.name||r.value));return li(Kf,zi(c(l({},Vi(n)),{changeEvent:e=>{t(De,e),ki((()=>t("change",e)))},name:h}))),Ii((()=>n.modelValue),(()=>{n.validateEvent&&(null==a||a.validate("change").catch((e=>Re())))})),Ue({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-radio-group",ref:"https://element-plus.org/en-US/component/radio.html"},Si((()=>!!n.label))),(e,t)=>(ui(),hi("div",{id:pi(s),ref_key:"radioGroupRef",ref:o,class:fi(pi(i).b("group")),role:"radiogroup","aria-label":pi(u)?void 0:e.label||e.ariaLabel||"radio-group","aria-labelledby":pi(u)?pi(a).labelId:void 0},[di(e.$slots,"default")],10,lp))}}));var hp=_e(up,[["__file","radio-group.vue"]]);const dp=Ie(tp,{RadioButton:op,RadioGroup:hp}),fp=ke(hp),pp=ke(op),gp=be({type:{type:String,values:["primary","success","info","warning","danger"],default:"primary"},closable:Boolean,disableTransitions:Boolean,hit:Boolean,color:String,size:{type:String,values:Ye},effect:{type:String,values:["dark","light","plain"],default:"light"},round:Boolean}),vp={close:e=>e instanceof MouseEvent,click:e=>e instanceof MouseEvent},Ap=ai({name:"ElTag"});const mp=Ie(_e(ai(c(l({},Ap),{props:gp,emits:vp,setup(e,{emit:t}){const n=e,i=Ne(),r=xe("tag"),o=Si((()=>{const{type:e,hit:t,effect:o,closable:a,round:s}=n;return[r.b(),r.is("closable",a),r.m(e||"primary"),r.m(i.value),r.m(o),r.is("hit",t),r.is("round",s)]})),a=e=>{t("close",e)},s=e=>{t("click",e)};return(e,t)=>e.disableTransitions?(ui(),hi("span",{key:0,class:fi(pi(o)),style:Ni({backgroundColor:e.color}),onClick:s},[vi("span",{class:fi(pi(r).e("content"))},[di(e.$slots,"default")],2),e.closable?(ui(),Ai(pi(Se),{key:0,class:fi(pi(r).e("close")),onClick:Li(a,["stop"])},{default:mi((()=>[Hi(pi(Ge))])),_:1},8,["class","onClick"])):Fi("v-if",!0)],6)):(ui(),Ai(Yi,{key:1,name:`${pi(r).namespace.value}-zoom-in-center`,appear:""},{default:mi((()=>[vi("span",{class:fi(pi(o)),style:Ni({backgroundColor:e.color}),onClick:s},[vi("span",{class:fi(pi(r).e("content"))},[di(e.$slots,"default")],2),e.closable?(ui(),Ai(pi(Se),{key:0,class:fi(pi(r).e("close")),onClick:Li(a,["stop"])},{default:mi((()=>[Hi(pi(Ge))])),_:1},8,["class","onClick"])):Fi("v-if",!0)],6)])),_:3},8,["name"]))}})),[["__file","tag.vue"]])),yp=Symbol("rowContextKey"),bp=be({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:["start","center","end","space-around","space-between","space-evenly"],default:"start"},align:{type:String,values:["top","middle","bottom"]}}),Cp=ai({name:"ElRow"});const wp=Ie(_e(ai(c(l({},Cp),{props:bp,setup(e){const t=e,n=xe("row"),i=Si((()=>t.gutter));li(yp,{gutter:i});const r=Si((()=>{const e={};return t.gutter?(e.marginRight=e.marginLeft=`-${t.gutter/2}px`,e):e})),o=Si((()=>[n.b(),n.is(`justify-${t.justify}`,"start"!==t.justify),n.is(`align-${t.align}`,!!t.align)]));return(e,t)=>(ui(),Ai(yi(e.tag),{class:fi(pi(o)),style:Ni(pi(r))},{default:mi((()=>[di(e.$slots,"default")])),_:3},8,["class","style"]))}})),[["__file","row.vue"]])),xp=be({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:Ee([Number,Object]),default:()=>We({})},sm:{type:Ee([Number,Object]),default:()=>We({})},md:{type:Ee([Number,Object]),default:()=>We({})},lg:{type:Ee([Number,Object]),default:()=>We({})},xl:{type:Ee([Number,Object]),default:()=>We({})}}),_p=ai({name:"ElCol"});const Ep=Ie(_e(ai(c(l({},_p),{props:xp,setup(e){const t=e,{gutter:n}=gi(yp,{gutter:Si((()=>0))}),i=xe("col"),r=Si((()=>{const e={};return n.value&&(e.paddingLeft=e.paddingRight=n.value/2+"px"),e})),o=Si((()=>{const e=[];["span","offset","pull","push"].forEach((n=>{const r=t[n];Me(r)&&("span"===n?e.push(i.b(`${t[n]}`)):r>0&&e.push(i.b(`${n}-${t[n]}`)))}));return["xs","sm","md","lg","xl"].forEach((n=>{Me(t[n])?e.push(i.b(`${n}-${t[n]}`)):Oi(t[n])&&Object.entries(t[n]).forEach((([t,r])=>{e.push("span"!==t?i.b(`${n}-${t}-${r}`):i.b(`${n}-${r}`))}))})),n.value&&e.push(i.is("guttered")),[i.b(),e]}));return(e,t)=>(ui(),Ai(yi(e.tag),{class:fi(pi(o)),style:Ni(pi(r))},{default:mi((()=>[di(e.$slots,"default")])),_:3},8,["class","style"]))}})),[["__file","col.vue"]])),Sp=e=>Me(e)||Ei(e)||Bi(e),Ip=be({accordion:Boolean,modelValue:{type:Ee([Array,String,Number]),default:()=>We([])}}),kp={[De]:Sp,[ze]:Sp},Bp=Symbol("collapseContextKey"),Op=ai({name:"ElCollapse"}),Tp=ai(c(l({},Op),{props:Ip,emits:kp,setup(e,{expose:t,emit:n}){const i=e,{activeNames:r,setActiveNames:o}=((e,t)=>{const n=si(ue(e.modelValue)),i=i=>{n.value=i;const r=e.accordion?n.value[0]:n.value;t(De,r),t(ze,r)};return Ii((()=>e.modelValue),(()=>n.value=ue(e.modelValue)),{deep:!0}),li(Bp,{activeNames:n,handleItemClick:t=>{if(e.accordion)i([n.value[0]===t?"":t]);else{const e=[...n.value],r=e.indexOf(t);r>-1?e.splice(r,1):e.push(t),i(e)}}}),{activeNames:n,setActiveNames:i}})(i,n),{rootKls:a}=(()=>{const e=xe("collapse");return{rootKls:Si((()=>e.b()))}})();return t({activeNames:r,setActiveNames:o}),(e,t)=>(ui(),hi("div",{class:fi(pi(a))},[di(e.$slots,"default")],2))}}));var Dp=_e(Tp,[["__file","collapse.vue"]]);const Mp=ai({name:"ElCollapseTransition"});var Qp=_e(ai(c(l({},Mp),{setup(e){const t=xe("collapse-transition"),n=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},i={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height&&(e.dataset.elExistsHeight=e.style.height),e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){requestAnimationFrame((()=>{e.dataset.oldOverflow=e.style.overflow,e.dataset.elExistsHeight?e.style.maxHeight=e.dataset.elExistsHeight:0!==e.scrollHeight?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"}))},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){n(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){0!==e.scrollHeight&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){n(e)},leaveCancelled(e){n(e)}};return(e,n)=>(ui(),Ai(Yi,Gi({name:pi(t).b()},Wi(i)),{default:mi((()=>[di(e.$slots,"default")])),_:3},16,["name"]))}})),[["__file","collapse-transition.vue"]]);Qp.install=e=>{e.component(Qp.name,Qp)};const Lp=Qp,Pp=be({title:{type:String,default:""},name:{type:Ee([String,Number]),default:void 0},disabled:Boolean}),jp=["id","aria-expanded","aria-controls","aria-describedby","tabindex"],Rp=["id","aria-hidden","aria-labelledby"],Fp=ai({name:"ElCollapseItem"}),Np=ai(c(l({},Fp),{props:Pp,setup(e,{expose:t}){const n=e,{focusing:i,id:r,isActive:o,handleFocus:a,handleHeaderClick:s,handleEnterClick:l}=(e=>{const t=gi(Bp),{namespace:n}=xe("collapse"),i=si(!1),r=si(!1),o=Xe(),a=Si((()=>o.current++)),s=Si((()=>{var t;return null!=(t=e.name)?t:`${n.value}-id-${o.prefix}-${pi(a)}`})),l=Si((()=>null==t?void 0:t.activeNames.value.includes(pi(s))));return{focusing:i,id:a,isActive:l,handleFocus:()=>{setTimeout((()=>{r.value?r.value=!1:i.value=!0}),50)},handleHeaderClick:()=>{e.disabled||(null==t||t.handleItemClick(pi(s)),i.value=!1,r.value=!0)},handleEnterClick:()=>{null==t||t.handleItemClick(pi(s))}}})(n),{arrowKls:c,headKls:u,rootKls:h,itemWrapperKls:d,itemContentKls:f,scopedContentId:p,scopedHeadId:g}=((e,{focusing:t,isActive:n,id:i})=>{const r=xe("collapse"),o=Si((()=>[r.b("item"),r.is("active",pi(n)),r.is("disabled",e.disabled)])),a=Si((()=>[r.be("item","header"),r.is("active",pi(n)),{focusing:pi(t)&&!e.disabled}]));return{arrowKls:Si((()=>[r.be("item","arrow"),r.is("active",pi(n))])),headKls:a,rootKls:o,itemWrapperKls:Si((()=>r.be("item","wrap"))),itemContentKls:Si((()=>r.be("item","content"))),scopedContentId:Si((()=>r.b(`content-${pi(i)}`))),scopedHeadId:Si((()=>r.b(`head-${pi(i)}`)))}})(n,{focusing:i,isActive:o,id:r});return t({isActive:o}),(e,t)=>(ui(),hi("div",{class:fi(pi(h))},[vi("button",{id:pi(g),class:fi(pi(u)),"aria-expanded":pi(o),"aria-controls":pi(p),"aria-describedby":pi(p),tabindex:e.disabled?-1:0,type:"button",onClick:t[0]||(t[0]=(...e)=>pi(s)&&pi(s)(...e)),onKeydown:t[1]||(t[1]=Xi(Li(((...e)=>pi(l)&&pi(l)(...e)),["stop","prevent"]),["space","enter"])),onFocus:t[2]||(t[2]=(...e)=>pi(a)&&pi(a)(...e)),onBlur:t[3]||(t[3]=e=>i.value=!1)},[di(e.$slots,"title",{},(()=>[Ri(bi(e.title),1)])),Hi(pi(Se),{class:fi(pi(c))},{default:mi((()=>[Hi(pi($e))])),_:1},8,["class"])],42,jp),Hi(pi(Lp),null,{default:mi((()=>[Mi(vi("div",{id:pi(p),role:"region",class:fi(pi(d)),"aria-hidden":!pi(o),"aria-labelledby":pi(g)},[vi("div",{class:fi(pi(f))},[di(e.$slots,"default")],2)],10,Rp),[[$i,pi(o)]])])),_:3})],2))}}));var Vp=_e(Np,[["__file","collapse-item.vue"]]);const Up=Ie(Dp,{CollapseItem:Vp}),zp=ke(Vp),Hp=be({color:{type:Ee(Object),required:!0},vertical:{type:Boolean,default:!1}});let Yp=!1;function Gp(e,t){if(!ye)return;const n=function(e){var n;null==(n=t.drag)||n.call(t,e)},i=function(e){var r;document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",i),document.removeEventListener("touchmove",n),document.removeEventListener("touchend",i),document.onselectstart=null,document.ondragstart=null,Yp=!1,null==(r=t.end)||r.call(t,e)},r=function(e){var r;Yp||(e.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",n),document.addEventListener("mouseup",i),document.addEventListener("touchmove",n),document.addEventListener("touchend",i),Yp=!0,null==(r=t.start)||r.call(t,e))};e.addEventListener("mousedown",r),e.addEventListener("touchstart",r)}const Wp=(e,{bar:t,thumb:n,handleDrag:i})=>{const r=Ci(),o=xe("color-alpha-slider"),a=si(0),s=si(0),l=si();function c(){a.value=function(){if(!n.value)return 0;if(e.vertical)return 0;const t=r.vnode.el,i=e.color.get("alpha");return t?Math.round(i*(t.offsetWidth-n.value.offsetWidth/2)/100):0}(),s.value=function(){if(!n.value)return 0;const t=r.vnode.el;if(!e.vertical)return 0;const i=e.color.get("alpha");return t?Math.round(i*(t.offsetHeight-n.value.offsetHeight/2)/100):0}(),l.value=function(){if(e.color&&e.color.value){const{r:t,g:n,b:i}=e.color.toRgb();return`linear-gradient(to right, rgba(${t}, ${n}, ${i}, 0) 0%, rgba(${t}, ${n}, ${i}, 1) 100%)`}return""}()}ci((()=>{if(!t.value||!n.value)return;const e={drag:e=>{i(e)},end:e=>{i(e)}};Gp(t.value,e),Gp(n.value,e),c()})),Ii((()=>e.color.get("alpha")),(()=>c())),Ii((()=>e.color.value),(()=>c()));const u=Si((()=>[o.b(),o.is("vertical",e.vertical)])),h=Si((()=>o.e("bar"))),d=Si((()=>o.e("thumb")));return{rootKls:u,barKls:h,barStyle:Si((()=>({background:l.value}))),thumbKls:d,thumbStyle:Si((()=>({left:qe(a.value),top:qe(s.value)}))),update:c}},Xp=ai({name:"ElColorAlphaSlider"});var $p=_e(ai(c(l({},Xp),{props:Hp,setup(e,{expose:t}){const n=e,{bar:i,thumb:r,handleDrag:o,handleClick:a}=(e=>{const t=Ci(),n=qi(),i=qi();function r(r){if(!i.value||!n.value)return;const o=t.vnode.el.getBoundingClientRect(),{clientX:a,clientY:s}=uf(r);if(e.vertical){let t=s-o.top;t=Math.max(n.value.offsetHeight/2,t),t=Math.min(t,o.height-n.value.offsetHeight/2),e.color.set("alpha",Math.round((t-n.value.offsetHeight/2)/(o.height-n.value.offsetHeight)*100))}else{let t=a-o.left;t=Math.max(n.value.offsetWidth/2,t),t=Math.min(t,o.width-n.value.offsetWidth/2),e.color.set("alpha",Math.round((t-n.value.offsetWidth/2)/(o.width-n.value.offsetWidth)*100))}}return{thumb:n,bar:i,handleDrag:r,handleClick:function(e){e.target!==n.value&&r(e)}}})(n),{rootKls:s,barKls:l,barStyle:c,thumbKls:u,thumbStyle:h,update:d}=Wp(n,{bar:i,thumb:r,handleDrag:o});return t({update:d,bar:i,thumb:r}),(e,t)=>(ui(),hi("div",{class:fi(pi(s))},[vi("div",{ref_key:"bar",ref:i,class:fi(pi(l)),style:Ni(pi(c)),onClick:t[0]||(t[0]=(...e)=>pi(a)&&pi(a)(...e))},null,6),vi("div",{ref_key:"thumb",ref:r,class:fi(pi(u)),style:Ni(pi(h))},null,6)],2))}})),[["__file","alpha-slider.vue"]]);var qp=_e(ai({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean},setup(e){const t=xe("color-hue-slider"),n=Ci(),i=si(),r=si(),o=si(0),a=si(0),s=Si((()=>e.color.get("hue")));function l(t){if(!r.value||!i.value)return;const o=n.vnode.el.getBoundingClientRect(),{clientX:a,clientY:s}=uf(t);let l;if(e.vertical){let e=s-o.top;e=Math.min(e,o.height-i.value.offsetHeight/2),e=Math.max(i.value.offsetHeight/2,e),l=Math.round((e-i.value.offsetHeight/2)/(o.height-i.value.offsetHeight)*360)}else{let e=a-o.left;e=Math.min(e,o.width-i.value.offsetWidth/2),e=Math.max(i.value.offsetWidth/2,e),l=Math.round((e-i.value.offsetWidth/2)/(o.width-i.value.offsetWidth)*360)}e.color.set("hue",l)}function c(){o.value=function(){if(!i.value)return 0;const t=n.vnode.el;if(e.vertical)return 0;const r=e.color.get("hue");return t?Math.round(r*(t.offsetWidth-i.value.offsetWidth/2)/360):0}(),a.value=function(){if(!i.value)return 0;const t=n.vnode.el;if(!e.vertical)return 0;const r=e.color.get("hue");return t?Math.round(r*(t.offsetHeight-i.value.offsetHeight/2)/360):0}()}return Ii((()=>s.value),(()=>{c()})),ci((()=>{if(!r.value||!i.value)return;const e={drag:e=>{l(e)},end:e=>{l(e)}};Gp(r.value,e),Gp(i.value,e),c()})),{bar:r,thumb:i,thumbLeft:o,thumbTop:a,hueValue:s,handleClick:function(e){e.target!==i.value&&l(e)},update:c,ns:t}}}),[["render",function(e,t,n,i,r,o){return ui(),hi("div",{class:fi([e.ns.b(),e.ns.is("vertical",e.vertical)])},[vi("div",{ref:"bar",class:fi(e.ns.e("bar")),onClick:t[0]||(t[0]=(...t)=>e.handleClick&&e.handleClick(...t))},null,2),vi("div",{ref:"thumb",class:fi(e.ns.e("thumb")),style:Ni({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}],["__file","hue-slider.vue"]]);const Kp=be(l({modelValue:String,id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:Oe,popperClass:{type:String,default:""},label:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},teleported:Ke.teleported,predefine:{type:Ee(Array)},validateEvent:{type:Boolean,default:!0}},Te(["ariaLabel"]))),Jp={[De]:e=>Ei(e)||pe(e),[ze]:e=>Ei(e)||pe(e),activeChange:e=>Ei(e)||pe(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},Zp=Symbol("colorPickerContextKey"),eg=function(e,t,n){return[e,t*n/((e=(2-t)*n)<1?e:2-e)||0,e/2]},tg=function(e,t){var n;"string"==typeof(n=e)&&n.includes(".")&&1===Number.parseFloat(n)&&(e="100%");const i=function(e){return"string"==typeof e&&e.includes("%")}(e);return e=Math.min(t,Math.max(0,Number.parseFloat(`${e}`))),i&&(e=Number.parseInt(""+e*t,10)/100),Math.abs(e-t)<1e-6?1:e%t/Number.parseFloat(t)},ng={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"},ig=e=>{e=Math.min(Math.round(e),255);const t=Math.floor(e/16),n=e%16;return`${ng[t]||t}${ng[n]||n}`},rg=function({r:e,g:t,b:n}){return Number.isNaN(+e)||Number.isNaN(+t)||Number.isNaN(+n)?"":`#${ig(e)}${ig(t)}${ig(n)}`},og={A:10,B:11,C:12,D:13,E:14,F:15},ag=function(e){return 2===e.length?16*(og[e[0].toUpperCase()]||+e[0])+(og[e[1].toUpperCase()]||+e[1]):og[e[1].toUpperCase()]||+e[1]},sg=(e,t,n)=>{e=tg(e,255),t=tg(t,255),n=tg(n,255);const i=Math.max(e,t,n),r=Math.min(e,t,n);let o;const a=i,s=i-r,l=0===i?0:s/i;if(i===r)o=0;else{switch(i){case e:o=(t-n)/s+(t<n?6:0);break;case t:o=(n-e)/s+2;break;case n:o=(e-t)/s+4}o/=6}return{h:360*o,s:100*l,v:100*a}},lg=function(e,t,n){e=6*tg(e,360),t=tg(t,100),n=tg(n,100);const i=Math.floor(e),r=e-i,o=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),l=i%6,c=[n,a,o,o,s,n][l],u=[s,n,n,a,o,o][l],h=[o,o,s,n,n,a][l];return{r:Math.round(255*c),g:Math.round(255*u),b:Math.round(255*h)}};class cg{constructor(e={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this.enableAlpha=!1,this.format="hex",this.value="";for(const t in e)Ki(e,t)&&(this[t]=e[t]);e.value?this.fromString(e.value):this.doOnChange()}set(e,t){if(1!==arguments.length||"object"!=typeof e)this[`_${e}`]=t,this.doOnChange();else for(const n in e)Ki(e,n)&&this.set(n,e[n])}get(e){return"alpha"===e?Math.floor(this[`_${e}`]):this[`_${e}`]}toRgb(){return lg(this._hue,this._saturation,this._value)}fromString(e){if(!e)return this._hue=0,this._saturation=100,this._value=100,void this.doOnChange();const t=(e,t,n)=>{this._hue=Math.max(0,Math.min(360,e)),this._saturation=Math.max(0,Math.min(100,t)),this._value=Math.max(0,Math.min(100,n)),this.doOnChange()};if(e.includes("hsl")){const n=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter((e=>""!==e)).map(((e,t)=>t>2?Number.parseFloat(e):Number.parseInt(e,10)));if(4===n.length?this._alpha=100*Number.parseFloat(n[3]):3===n.length&&(this._alpha=100),n.length>=3){const{h:e,s:i,v:r}=function(e,t,n){n/=100;let i=t/=100;const r=Math.max(n,.01);return t*=(n*=2)<=1?n:2-n,i*=r<=1?r:2-r,{h:e,s:100*(0===n?2*i/(r+i):2*t/(n+t)),v:(n+t)/2*100}}(n[0],n[1],n[2]);t(e,i,r)}}else if(e.includes("hsv")){const n=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter((e=>""!==e)).map(((e,t)=>t>2?Number.parseFloat(e):Number.parseInt(e,10)));4===n.length?this._alpha=100*Number.parseFloat(n[3]):3===n.length&&(this._alpha=100),n.length>=3&&t(n[0],n[1],n[2])}else if(e.includes("rgb")){const n=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter((e=>""!==e)).map(((e,t)=>t>2?Number.parseFloat(e):Number.parseInt(e,10)));if(4===n.length?this._alpha=100*Number.parseFloat(n[3]):3===n.length&&(this._alpha=100),n.length>=3){const{h:e,s:i,v:r}=sg(n[0],n[1],n[2]);t(e,i,r)}}else if(e.includes("#")){const n=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(n))return;let i,r,o;3===n.length?(i=ag(n[0]+n[0]),r=ag(n[1]+n[1]),o=ag(n[2]+n[2])):6!==n.length&&8!==n.length||(i=ag(n.slice(0,2)),r=ag(n.slice(2,4)),o=ag(n.slice(4,6))),8===n.length?this._alpha=ag(n.slice(6))/255*100:3!==n.length&&6!==n.length||(this._alpha=100);const{h:a,s:s,v:l}=sg(i,r,o);t(a,s,l)}}compare(e){return Math.abs(e._hue-this._hue)<2&&Math.abs(e._saturation-this._saturation)<1&&Math.abs(e._value-this._value)<1&&Math.abs(e._alpha-this._alpha)<1}doOnChange(){const{_hue:e,_saturation:t,_value:n,_alpha:i,format:r}=this;if(this.enableAlpha)switch(r){case"hsl":{const i=eg(e,t/100,n/100);this.value=`hsla(${e}, ${Math.round(100*i[1])}%, ${Math.round(100*i[2])}%, ${this.get("alpha")/100})`;break}case"hsv":this.value=`hsva(${e}, ${Math.round(t)}%, ${Math.round(n)}%, ${this.get("alpha")/100})`;break;case"hex":this.value=`${rg(lg(e,t,n))}${ig(255*i/100)}`;break;default:{const{r:i,g:r,b:o}=lg(e,t,n);this.value=`rgba(${i}, ${r}, ${o}, ${this.get("alpha")/100})`}}else switch(r){case"hsl":{const i=eg(e,t/100,n/100);this.value=`hsl(${e}, ${Math.round(100*i[1])}%, ${Math.round(100*i[2])}%)`;break}case"hsv":this.value=`hsv(${e}, ${Math.round(t)}%, ${Math.round(n)}%)`;break;case"rgb":{const{r:i,g:r,b:o}=lg(e,t,n);this.value=`rgb(${i}, ${r}, ${o})`;break}default:this.value=rg(lg(e,t,n))}}}const ug=ai({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0}},setup(e){const t=xe("color-predefine"),{currentColor:n}=gi(Zp),i=si(r(e.colors,e.color));function r(t,n){return t.map((t=>{const i=new cg;return i.enableAlpha=e.enableAlpha,i.format="rgba",i.fromString(t),i.selected=i.value===n.value,i}))}return Ii((()=>n.value),(e=>{const t=new cg;t.fromString(e),i.value.forEach((e=>{e.selected=t.compare(e)}))})),Ji((()=>{i.value=r(e.colors,e.color)})),{rgbaColors:i,handleSelect:function(t){e.color.fromString(e.colors[t])},ns:t}}}),hg=["onClick"];var dg=_e(ug,[["render",function(e,t,n,i,r,o){return ui(),hi("div",{class:fi(e.ns.b())},[vi("div",{class:fi(e.ns.e("colors"))},[(ui(!0),hi(ji,null,Zi(e.rgbaColors,((t,n)=>(ui(),hi("div",{key:e.colors[n],class:fi([e.ns.e("color-selector"),e.ns.is("alpha",t._alpha<100),{selected:t.selected}]),onClick:t=>e.handleSelect(n)},[vi("div",{style:Ni({backgroundColor:t.value})},null,4)],10,hg)))),128))],2)],2)}],["__file","predefine.vue"]]);const fg=ai({name:"ElSlPanel",props:{color:{type:Object,required:!0}},setup(e){const t=xe("color-svpanel"),n=Ci(),i=si(0),r=si(0),o=si("hsl(0, 100%, 50%)"),a=Si((()=>({hue:e.color.get("hue"),value:e.color.get("value")})));function s(){const t=e.color.get("saturation"),a=e.color.get("value"),s=n.vnode.el,{clientWidth:l,clientHeight:c}=s;r.value=t*l/100,i.value=(100-a)*c/100,o.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function l(t){const o=n.vnode.el.getBoundingClientRect(),{clientX:a,clientY:s}=uf(t);let l=a-o.left,c=s-o.top;l=Math.max(0,l),l=Math.min(l,o.width),c=Math.max(0,c),c=Math.min(c,o.height),r.value=l,i.value=c,e.color.set({saturation:l/o.width*100,value:100-c/o.height*100})}return Ii((()=>a.value),(()=>{s()})),ci((()=>{Gp(n.vnode.el,{drag:e=>{l(e)},end:e=>{l(e)}}),s()})),{cursorTop:i,cursorLeft:r,background:o,colorValue:a,handleDrag:l,update:s,ns:t}}}),pg=[vi("div",null,null,-1)];var gg=_e(fg,[["render",function(e,t,n,i,r,o){return ui(),hi("div",{class:fi(e.ns.b()),style:Ni({backgroundColor:e.background})},[vi("div",{class:fi(e.ns.e("white"))},null,2),vi("div",{class:fi(e.ns.e("black"))},null,2),vi("div",{class:fi(e.ns.e("cursor")),style:Ni({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},pg,6)],6)}],["__file","sv-panel.vue"]]);const vg=["onKeydown"],Ag=["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex"],mg=ai({name:"ElColorPicker"});const yg=Ie(_e(ai(c(l({},mg),{props:Kp,emits:Jp,setup(e,{expose:t,emit:n}){const i=e,{t:r}=we(),o=xe("color"),{formItem:a}=je(),s=Ne(),l=Pe(),{inputId:c,isLabeledByFormItem:u}=Ve(i,{formItemContext:a}),h=si(),d=si(),f=si(),p=si(),g=si(),v=si(),{isFocused:A,handleFocus:m,handleBlur:y}=Je(g,{beforeBlur(e){var t;return null==(t=p.value)?void 0:t.isFocusInsideContent(e)},afterBlur(){T(!1),L()}}),b=e=>{if(l.value)return z();m(e)};let C=!0;const w=zi(new cg({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue})),x=si(!1),_=si(!1),E=si(""),S=Si((()=>i.modelValue||_.value?function(e,t){if(!(e instanceof cg))throw new TypeError("color should be instance of _color Class");const{r:n,g:i,b:r}=e.toRgb();return t?`rgba(${n}, ${i}, ${r}, ${e.get("alpha")/100})`:`rgb(${n}, ${i}, ${r})`}(w,i.showAlpha):"transparent")),I=Si((()=>i.modelValue||_.value?w.value:"")),k=Si((()=>u.value?void 0:i.label||i.ariaLabel||r("el.colorpicker.defaultLabel")));Ue({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-color-picker",ref:"https://element-plus.org/en-US/component/color-picker.html"},Si((()=>!!i.label)));const B=Si((()=>u.value?null==a?void 0:a.labelId:void 0)),O=Si((()=>[o.b("picker"),o.is("disabled",l.value),o.bm("picker",s.value),o.is("focused",A.value)]));function T(e){x.value=e}const D=le(T,100,{leading:!0});function M(){l.value||T(!0)}function Q(){D(!1),L()}function L(){ki((()=>{i.modelValue?w.fromString(i.modelValue):(w.value="",ki((()=>{_.value=!1})))}))}function P(){l.value||D(!x.value)}function j(){w.fromString(E.value)}function R(){const e=w.value;n(De,e),n("change",e),i.validateEvent&&(null==a||a.validate("change").catch((e=>Re()))),D(!1),ki((()=>{const e=new cg({enableAlpha:i.showAlpha,format:i.colorFormat||"",value:i.modelValue});w.compare(e)||L()}))}function F(){D(!1),n(De,null),n("change",null),null!==i.modelValue&&i.validateEvent&&(null==a||a.validate("change").catch((e=>Re()))),L()}function N(e){if(x.value&&(Q(),A.value)){const t=new FocusEvent("focus",e);y(t)}}function V(e){e.preventDefault(),e.stopPropagation(),T(!1),L()}function U(e){switch(e.code){case it.enter:case it.space:e.preventDefault(),e.stopPropagation(),M(),v.value.focus();break;case it.esc:V(e)}}function z(){g.value.blur()}return ci((()=>{i.modelValue&&(E.value=I.value)})),Ii((()=>i.modelValue),(e=>{e?e&&e!==w.value&&(C=!1,w.fromString(e)):_.value=!1})),Ii((()=>I.value),(e=>{E.value=e,C&&n("activeChange",e),C=!0})),Ii((()=>w.value),(()=>{i.modelValue||_.value||(_.value=!0)})),Ii((()=>x.value),(()=>{ki((()=>{var e,t,n;null==(e=h.value)||e.update(),null==(t=d.value)||t.update(),null==(n=f.value)||n.update()}))})),li(Zp,{currentColor:I}),t({color:w,show:M,hide:Q,focus:function(){g.value.focus()},blur:z}),(e,t)=>(ui(),Ai(pi(nt),{ref_key:"popper",ref:p,visible:x.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[pi(o).be("picker","panel"),pi(o).b("dropdown"),e.popperClass],"stop-popper-mouse-event":!1,effect:"light",trigger:"click",teleported:e.teleported,transition:`${pi(o).namespace.value}-zoom-in-top`,persistent:"",onHide:t[2]||(t[2]=e=>T(!1))},{content:mi((()=>[Mi((ui(),hi("div",{onKeydown:Xi(V,["esc"])},[vi("div",{class:fi(pi(o).be("dropdown","main-wrapper"))},[Hi(qp,{ref_key:"hue",ref:h,class:"hue-slider",color:pi(w),vertical:""},null,8,["color"]),Hi(gg,{ref_key:"sv",ref:d,color:pi(w)},null,8,["color"])],2),e.showAlpha?(ui(),Ai($p,{key:0,ref_key:"alpha",ref:f,color:pi(w)},null,8,["color"])):Fi("v-if",!0),e.predefine?(ui(),Ai(dg,{key:1,ref:"predefine","enable-alpha":e.showAlpha,color:pi(w),colors:e.predefine},null,8,["enable-alpha","color","colors"])):Fi("v-if",!0),vi("div",{class:fi(pi(o).be("dropdown","btns"))},[vi("span",{class:fi(pi(o).be("dropdown","value"))},[Hi(pi(Ze),{ref_key:"inputRef",ref:v,modelValue:E.value,"onUpdate:modelValue":t[0]||(t[0]=e=>E.value=e),"validate-event":!1,size:"small",onKeyup:Xi(j,["enter"]),onBlur:j},null,8,["modelValue","onKeyup"])],2),Hi(pi(et),{class:fi(pi(o).be("dropdown","link-btn")),text:"",size:"small",onClick:F},{default:mi((()=>[Ri(bi(pi(r)("el.colorpicker.clear")),1)])),_:1},8,["class"]),Hi(pi(et),{plain:"",size:"small",class:fi(pi(o).be("dropdown","btn")),onClick:R},{default:mi((()=>[Ri(bi(pi(r)("el.colorpicker.confirm")),1)])),_:1},8,["class"])],2)],40,vg)),[[pi(Sf),N]])])),default:mi((()=>[vi("div",Gi({id:pi(c),ref_key:"triggerRef",ref:g},e.$attrs,{class:pi(O),role:"button","aria-label":pi(k),"aria-labelledby":pi(B),"aria-description":pi(r)("el.colorpicker.description",{color:e.modelValue||""}),"aria-disabled":pi(l),tabindex:pi(l)?-1:e.tabindex,onKeydown:U,onFocus:b,onBlur:t[1]||(t[1]=(...e)=>pi(y)&&pi(y)(...e))}),[pi(l)?(ui(),hi("div",{key:0,class:fi(pi(o).be("picker","mask"))},null,2)):Fi("v-if",!0),vi("div",{class:fi(pi(o).be("picker","trigger")),onClick:P},[vi("span",{class:fi([pi(o).be("picker","color"),pi(o).is("alpha",e.showAlpha)])},[vi("span",{class:fi(pi(o).be("picker","color-inner")),style:Ni({backgroundColor:pi(S)})},[Mi(Hi(pi(Se),{class:fi([pi(o).be("picker","icon"),pi(o).is("icon-arrow-down")])},{default:mi((()=>[Hi(pi(tt))])),_:1},8,["class"]),[[$i,e.modelValue||_.value]]),Mi(Hi(pi(Se),{class:fi([pi(o).be("picker","empty"),pi(o).is("icon-close")])},{default:mi((()=>[Hi(pi(Ge))])),_:1},8,["class"]),[[$i,!e.modelValue&&!_.value]])],6)],2)],2)],16,Ag)])),_:1},8,["visible","popper-class","teleported","transition"]))}})),[["__file","color-picker.vue"]])),bg=be({urlList:{type:Ee(Array),default:()=>We([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Ee(String)}}),Cg={close:()=>!0,switch:e=>Me(e),rotate:e=>Me(e)},wg=["src","crossorigin"],xg=ai({name:"ElImageViewer"}),_g=ai(c(l({},xg),{props:bg,emits:Cg,setup(e,{expose:t,emit:n}){var i;const r=e,o={CONTAIN:{name:"contain",icon:er(rt)},ORIGINAL:{name:"original",icon:er(ot)}},{t:a}=we(),s=xe("image-viewer"),{nextZIndex:u}=at(),h=si(),d=si([]),f=tr(),p=si(!0),g=si(r.initialIndex),v=qi(o.CONTAIN),A=si({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),m=si(null!=(i=r.zIndex)?i:u()),y=Si((()=>{const{urlList:e}=r;return e.length<=1})),b=Si((()=>0===g.value)),C=Si((()=>g.value===r.urlList.length-1)),w=Si((()=>r.urlList[g.value])),x=Si((()=>[s.e("btn"),s.e("prev"),s.is("disabled",!r.infinite&&b.value)])),_=Si((()=>[s.e("btn"),s.e("next"),s.is("disabled",!r.infinite&&C.value)])),E=Si((()=>{const{scale:e,deg:t,offsetX:n,offsetY:i,enableTransition:r}=A.value;let a=n/e,s=i/e;switch(t%360){case 90:case-270:[a,s]=[s,-a];break;case 180:case-180:[a,s]=[-a,-s];break;case 270:case-90:[a,s]=[-s,a]}const l={transform:`scale(${e}) rotate(${t}deg) translate(${a}px, ${s}px)`,transition:r?"transform .3s":""};return v.value.name===o.CONTAIN.name&&(l.maxWidth=l.maxHeight="100%"),l}));function S(){f.stop(),n("close")}function I(){p.value=!1}function k(e){p.value=!1,e.target.alt=a("el.image.error")}function B(e){if(p.value||0!==e.button||!h.value)return;A.value.enableTransition=!1;const{offsetX:t,offsetY:n}=A.value,i=e.pageX,r=e.pageY,o=ce((e=>{A.value=c(l({},A.value),{offsetX:t+e.pageX-i,offsetY:n+e.pageY-r})})),a=dt(document,"mousemove",o);dt(document,"mouseup",(()=>{a()})),e.preventDefault()}function O(){A.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function T(){if(p.value)return;const e=ft(o),t=Object.values(o),n=v.value.name,i=t.findIndex((e=>e.name===n)),r=(i+1)%e.length;v.value=o[e[r]],O()}function D(e){const t=r.urlList.length;g.value=(e+t)%t}function M(){b.value&&!r.infinite||D(g.value-1)}function Q(){C.value&&!r.infinite||D(g.value+1)}function L(e,t={}){if(p.value)return;const{minScale:i,maxScale:o}=r,{zoomRate:a,rotateDeg:s,enableTransition:c}=l({zoomRate:r.zoomRate,rotateDeg:90,enableTransition:!0},t);switch(e){case"zoomOut":A.value.scale>i&&(A.value.scale=Number.parseFloat((A.value.scale/a).toFixed(3)));break;case"zoomIn":A.value.scale<o&&(A.value.scale=Number.parseFloat((A.value.scale*a).toFixed(3)));break;case"clockwise":A.value.deg+=s,n("rotate",A.value.deg);break;case"anticlockwise":A.value.deg-=s,n("rotate",A.value.deg)}A.value.enableTransition=c}return Ii(w,(()=>{ki((()=>{const e=d.value[0];(null==e?void 0:e.complete)||(p.value=!0)}))})),Ii(g,(e=>{O(),n("switch",e)})),ci((()=>{var e,t;!function(){const e=ce((e=>{switch(e.code){case it.esc:r.closeOnPressEscape&&S();break;case it.space:T();break;case it.left:M();break;case it.up:L("zoomIn");break;case it.right:Q();break;case it.down:L("zoomOut")}})),t=ce((e=>{L((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:r.zoomRate,enableTransition:!1})}));f.run((()=>{dt(document,"keydown",e),dt(document,"wheel",t)}))}(),null==(t=null==(e=h.value)?void 0:e.focus)||t.call(e)})),t({setActiveItem:D}),(e,t)=>(ui(),Ai(nr,{to:"body",disabled:!e.teleported},[Hi(Yi,{name:"viewer-fade",appear:""},{default:mi((()=>[vi("div",{ref_key:"wrapper",ref:h,tabindex:-1,class:fi(pi(s).e("wrapper")),style:Ni({zIndex:m.value})},[vi("div",{class:fi(pi(s).e("mask")),onClick:t[0]||(t[0]=Li((t=>e.hideOnClickModal&&S()),["self"]))},null,2),Fi(" CLOSE "),vi("span",{class:fi([pi(s).e("btn"),pi(s).e("close")]),onClick:S},[Hi(pi(Se),null,{default:mi((()=>[Hi(pi(Ge))])),_:1})],2),Fi(" ARROW "),pi(y)?Fi("v-if",!0):(ui(),hi(ji,{key:0},[vi("span",{class:fi(pi(x)),onClick:M},[Hi(pi(Se),null,{default:mi((()=>[Hi(pi(st))])),_:1})],2),vi("span",{class:fi(pi(_)),onClick:Q},[Hi(pi(Se),null,{default:mi((()=>[Hi(pi($e))])),_:1})],2)],64)),Fi(" ACTIONS "),vi("div",{class:fi([pi(s).e("btn"),pi(s).e("actions")])},[vi("div",{class:fi(pi(s).e("actions__inner"))},[Hi(pi(Se),{onClick:t[1]||(t[1]=e=>L("zoomOut"))},{default:mi((()=>[Hi(pi(lt))])),_:1}),Hi(pi(Se),{onClick:t[2]||(t[2]=e=>L("zoomIn"))},{default:mi((()=>[Hi(pi(ct))])),_:1}),vi("i",{class:fi(pi(s).e("actions__divider"))},null,2),Hi(pi(Se),{onClick:T},{default:mi((()=>[(ui(),Ai(yi(pi(v).icon)))])),_:1}),vi("i",{class:fi(pi(s).e("actions__divider"))},null,2),Hi(pi(Se),{onClick:t[3]||(t[3]=e=>L("anticlockwise"))},{default:mi((()=>[Hi(pi(ut))])),_:1}),Hi(pi(Se),{onClick:t[4]||(t[4]=e=>L("clockwise"))},{default:mi((()=>[Hi(pi(ht))])),_:1})],2)],2),Fi(" CANVAS "),vi("div",{class:fi(pi(s).e("canvas"))},[(ui(!0),hi(ji,null,Zi(e.urlList,((t,n)=>Mi((ui(),hi("img",{ref_for:!0,ref:e=>d.value[n]=e,key:t,src:t,style:Ni(pi(E)),class:fi(pi(s).e("img")),crossorigin:e.crossorigin,onLoad:I,onError:k,onMousedown:B},null,46,wg)),[[$i,n===g.value]]))),128))],2),di(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}));const Eg=Ie(_e(_g,[["__file","image-viewer.vue"]])),Sg=be({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:Ee([String,Object])},previewSrcList:{type:Ee(Array),default:()=>We([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},crossorigin:{type:Ee(String)}}),Ig={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>Me(e),close:()=>!0,show:()=>!0},kg=["src","loading","crossorigin"],Bg={key:0},Og=ai({name:"ElImage",inheritAttrs:!1});const Tg=Ie(_e(ai(c(l({},Og),{props:Sg,emits:Ig,setup(e,{emit:t}){const n=e;let i="";const{t:r}=we(),o=xe("image"),a=ir(),s=pt(),l=si(),c=si(!1),u=si(!0),d=si(!1),f=si(),p=si(),g=ye&&"loading"in HTMLImageElement.prototype;let v,A;const m=Si((()=>[o.e("inner"),C.value&&o.e("preview"),u.value&&o.is("loading")])),y=Si((()=>a.style)),b=Si((()=>{const{fit:e}=n;return ye&&e?{objectFit:e}:{}})),C=Si((()=>{const{previewSrcList:e}=n;return Array.isArray(e)&&e.length>0})),w=Si((()=>{const{previewSrcList:e,initialIndex:t}=n;let i=t;return t>e.length-1&&(i=0),i})),x=Si((()=>"eager"!==n.loading&&(!g&&"lazy"===n.loading||n.lazy))),_=()=>{ye&&(u.value=!0,c.value=!1,l.value=n.src)};function E(e){u.value=!1,c.value=!1,t("load",e)}function S(e){u.value=!1,c.value=!0,t("error",e)}function I(){((e,t)=>{if(!ye||!e||!t)return!1;const n=e.getBoundingClientRect();let i;return i=t instanceof Element?t.getBoundingClientRect():{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},n.top<i.bottom&&n.bottom>i.top&&n.right>i.left&&n.left<i.right})(f.value,p.value)&&(_(),O())}const k=gt(I,200,!0);function B(){return h(this,null,(function*(){var e;if(!ye)return;yield ki();const{scrollContainer:t}=n;Be(t)?p.value=t:Ei(t)&&""!==t?p.value=null!=(e=document.querySelector(t))?e:void 0:f.value&&(p.value=vt(f.value)),p.value&&(v=dt(p,"scroll",k),setTimeout((()=>I()),100))}))}function O(){ye&&p.value&&k&&(null==v||v(),p.value=void 0)}function T(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function D(){C.value&&(A=dt("wheel",T,{passive:!1}),i=document.body.style.overflow,document.body.style.overflow="hidden",d.value=!0,t("show"))}function M(){null==A||A(),document.body.style.overflow=i,d.value=!1,t("close")}function Q(e){t("switch",e)}return Ii((()=>n.src),(()=>{x.value?(u.value=!0,c.value=!1,O(),B()):_()})),ci((()=>{x.value?B():_()})),(e,t)=>(ui(),hi("div",{ref_key:"container",ref:f,class:fi([pi(o).b(),e.$attrs.class]),style:Ni(pi(y))},[c.value?di(e.$slots,"error",{key:0},(()=>[vi("div",{class:fi(pi(o).e("error"))},bi(pi(r)("el.image.error")),3)])):(ui(),hi(ji,{key:1},[void 0!==l.value?(ui(),hi("img",Gi({key:0},pi(s),{src:l.value,loading:e.loading,style:pi(b),class:pi(m),crossorigin:e.crossorigin,onClick:D,onLoad:E,onError:S}),null,16,kg)):Fi("v-if",!0),u.value?(ui(),hi("div",{key:1,class:fi(pi(o).e("wrapper"))},[di(e.$slots,"placeholder",{},(()=>[vi("div",{class:fi(pi(o).e("placeholder"))},null,2)]))],2)):Fi("v-if",!0)],64)),pi(C)?(ui(),hi(ji,{key:2},[d.value?(ui(),Ai(pi(Eg),{key:0,"z-index":e.zIndex,"initial-index":pi(w),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"url-list":e.previewSrcList,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:M,onSwitch:Q},{default:mi((()=>[e.$slots.viewer?(ui(),hi("div",Bg,[di(e.$slots,"viewer")])):Fi("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","url-list","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):Fi("v-if",!0)],64)):Fi("v-if",!0)],6))}})),[["__file","image.vue"]])),Dg=be(l({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:Oe,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||Me(e)||["min","max"].includes(e),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0}},Te(["ariaLabel"]))),Mg={[ze]:(e,t)=>t!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[At]:e=>Me(e)||pe(e),[De]:e=>Me(e)||pe(e)},Qg=["aria-label","onKeydown"],Lg=["aria-label","onKeydown"],Pg=ai({name:"ElInputNumber"});const jg=Ie(_e(ai(c(l({},Pg),{props:Dg,emits:Mg,setup(e,{expose:t,emit:n}){const i=e,{t:r}=we(),o=xe("input-number"),a=si(),s=zi({currentValue:i.modelValue,userInput:null}),{formItem:l}=je(),c=Si((()=>Me(i.modelValue)&&i.modelValue<=i.min)),u=Si((()=>Me(i.modelValue)&&i.modelValue>=i.max)),h=Si((()=>{const e=A(i.step);return Le(i.precision)?Math.max(A(i.modelValue),e):(i.precision,i.precision)})),d=Si((()=>i.controls&&"right"===i.controlsPosition)),f=Ne(),p=Pe(),g=Si((()=>{if(null!==s.userInput)return s.userInput;let e=s.currentValue;if(pe(e))return"";if(Me(e)){if(Number.isNaN(e))return"";Le(i.precision)||(e=e.toFixed(i.precision))}return e})),v=(e,t)=>{if(Le(t)&&(t=h.value),0===t)return Math.round(e);let n=String(e);const i=n.indexOf(".");if(-1===i)return e;if(!n.replace(".","").split("")[i+t])return e;const r=n.length;return"5"===n.charAt(r-1)&&(n=`${n.slice(0,Math.max(0,r-1))}6`),Number.parseFloat(Number(n).toFixed(t))},A=e=>{if(pe(e))return 0;const t=e.toString(),n=t.indexOf(".");let i=0;return-1!==n&&(i=t.length-n-1),i},m=(e,t=1)=>Me(e)?v(e+i.step*t):s.currentValue,y=()=>{if(i.readonly||p.value||u.value)return;const e=Number(g.value)||0,t=m(e);w(t),n(At,s.currentValue),I()},b=()=>{if(i.readonly||p.value||c.value)return;const e=Number(g.value)||0,t=m(e,-1);w(t),n(At,s.currentValue),I()},C=(e,t)=>{const{max:r,min:o,step:a,precision:s,stepStrictly:l,valueOnClear:c}=i;r<o&&Ct("InputNumber","min should not be greater than max.");let u=Number(e);if(pe(e)||Number.isNaN(u))return null;if(""===e){if(null===c)return null;u=Ei(c)?{min:o,max:r}[c]:c}return l&&(u=v(Math.round(u/a)*a,s)),Le(s)||(u=v(u,s)),(u>r||u<o)&&(u=u>r?r:o,t&&n(De,u)),u},w=(e,t=!0)=>{var r;const o=s.currentValue,a=C(e);t?o===a&&e||(s.userInput=null,n(De,a),o!==a&&n(ze,a,o),i.validateEvent&&(null==(r=null==l?void 0:l.validate)||r.call(l,"change").catch((e=>Re()))),s.currentValue=a):n(De,a)},x=e=>{s.userInput=e;const t=""===e?null:Number(e);n(At,t),w(t,!1)},_=e=>{const t=""!==e?Number(e):"";(Me(t)&&!Number.isNaN(t)||""===e)&&w(t),I(),s.userInput=null},E=e=>{n("focus",e)},S=e=>{var t;s.userInput=null,n("blur",e),i.validateEvent&&(null==(t=null==l?void 0:l.validate)||t.call(l,"blur").catch((e=>Re())))},I=()=>{s.currentValue!==i.modelValue&&(s.currentValue=i.modelValue)},k=e=>{document.activeElement===e.target&&e.preventDefault()};return Ii((()=>i.modelValue),((e,t)=>{const n=C(e,!0);null===s.userInput&&n!==t&&(s.currentValue=n)}),{immediate:!0}),ci((()=>{var e;const{min:t,max:r,modelValue:o}=i,l=null==(e=a.value)?void 0:e.input;if(l.setAttribute("role","spinbutton"),Number.isFinite(r)?l.setAttribute("aria-valuemax",String(r)):l.removeAttribute("aria-valuemax"),Number.isFinite(t)?l.setAttribute("aria-valuemin",String(t)):l.removeAttribute("aria-valuemin"),l.setAttribute("aria-valuenow",s.currentValue||0===s.currentValue?String(s.currentValue):""),l.setAttribute("aria-disabled",String(p.value)),!Me(o)&&null!=o){let e=Number(o);Number.isNaN(e)&&(e=null),n(De,e)}l.addEventListener("wheel",k,{passive:!1})})),rr((()=>{var e,t;const n=null==(e=a.value)?void 0:e.input;null==n||n.setAttribute("aria-valuenow",`${null!=(t=s.currentValue)?t:""}`)})),Ue({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-input-number",ref:"https://element-plus.org/en-US/component/input-number.html"},Si((()=>!!i.label))),t({focus:()=>{var e,t;null==(t=null==(e=a.value)?void 0:e.focus)||t.call(e)},blur:()=>{var e,t;null==(t=null==(e=a.value)?void 0:e.blur)||t.call(e)}}),(e,t)=>(ui(),hi("div",{class:fi([pi(o).b(),pi(o).m(pi(f)),pi(o).is("disabled",pi(p)),pi(o).is("without-controls",!e.controls),pi(o).is("controls-right",pi(d))]),onDragstart:t[0]||(t[0]=Li((()=>{}),["prevent"]))},[e.controls?Mi((ui(),hi("span",{key:0,role:"button","aria-label":pi(r)("el.inputNumber.decrease"),class:fi([pi(o).e("decrease"),pi(o).is("disabled",pi(c))]),onKeydown:Xi(b,["enter"])},[di(e.$slots,"decrease-icon",{},(()=>[Hi(pi(Se),null,{default:mi((()=>[pi(d)?(ui(),Ai(pi(tt),{key:0})):(ui(),Ai(pi(mt),{key:1}))])),_:1})]))],42,Qg)),[[pi(Bf),b]]):Fi("v-if",!0),e.controls?Mi((ui(),hi("span",{key:1,role:"button","aria-label":pi(r)("el.inputNumber.increase"),class:fi([pi(o).e("increase"),pi(o).is("disabled",pi(u))]),onKeydown:Xi(y,["enter"])},[di(e.$slots,"increase-icon",{},(()=>[Hi(pi(Se),null,{default:mi((()=>[pi(d)?(ui(),Ai(pi(yt),{key:0})):(ui(),Ai(pi(bt),{key:1}))])),_:1})]))],42,Lg)),[[pi(Bf),y]]):Fi("v-if",!0),Hi(pi(Ze),{id:e.id,ref_key:"input",ref:a,type:"number",step:e.step,"model-value":pi(g),placeholder:e.placeholder,readonly:e.readonly,disabled:pi(p),size:pi(f),max:e.max,min:e.min,name:e.name,"aria-label":e.label||e.ariaLabel,"validate-event":!1,onKeydown:[Xi(Li(y,["prevent"]),["up"]),Xi(Li(b,["prevent"]),["down"])],onBlur:S,onFocus:E,onInput:x,onChange:_},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],34))}})),[["__file","input-number.vue"]])),Rg=Symbol("ElSelectGroup"),Fg=Symbol("ElSelect");const Ng=ai({name:"ElOption",componentName:"ElOption",props:{value:{required:!0,type:[String,Number,Boolean,Object]},label:[String,Number],created:Boolean,disabled:Boolean},setup(e){const t=xe("select"),n=He(),i=Si((()=>[t.be("dropdown","item"),t.is("disabled",pi(s)),t.is("selected",pi(a)),t.is("hovering",pi(d))])),r=zi({index:-1,groupDisabled:!1,visible:!0,hover:!1}),{currentLabel:o,itemSelected:a,isDisabled:s,select:l,hoverItem:c,updateOption:u}=function(e,t){const n=gi(Fg),i=gi(Rg,{disabled:!1}),r=Si((()=>n.props.multiple?u(n.props.modelValue,e.value):u([n.props.modelValue],e.value))),o=Si((()=>{if(n.props.multiple){const e=n.props.modelValue||[];return!r.value&&e.length>=n.props.multipleLimit&&n.props.multipleLimit>0}return!1})),a=Si((()=>e.label||(Oi(e.value)?"":e.value))),s=Si((()=>e.value||e.label||"")),l=Si((()=>e.disabled||t.groupDisabled||o.value)),c=Ci(),u=(t=[],i)=>{if(Oi(e.value)){const e=n.props.valueKey;return t&&t.some((t=>Ti(I(t,e))===I(i,e)))}return t&&t.includes(i)};return Ii((()=>a.value),(()=>{e.created||n.props.remote||n.setSelected()})),Ii((()=>e.value),((t,i)=>{const{remote:r,valueKey:o}=n.props;if(Vc(t,i)||(n.onOptionDestroy(i,c.proxy),n.onOptionCreate(c.proxy)),!e.created&&!r){if(o&&Oi(t)&&Oi(i)&&t[o]===i[o])return;n.setSelected()}})),Ii((()=>i.disabled),(()=>{t.groupDisabled=i.disabled}),{immediate:!0}),{select:n,currentLabel:a,currentValue:s,itemSelected:r,isDisabled:l,hoverItem:()=>{e.disabled||i.disabled||(n.states.hoveringIndex=n.optionsArray.indexOf(c.proxy))},updateOption:n=>{const i=new RegExp(wt(n),"i");t.visible=i.test(a.value)||e.created}}}(e,r),{visible:h,hover:d}=Vi(r),f=Ci().proxy;return l.onOptionCreate(f),or((()=>{const e=f.value,{selected:t}=l.states,n=(l.props.multiple?t:[t]).some((e=>e.value===f.value));ki((()=>{l.states.cachedOptions.get(e)!==f||n||l.states.cachedOptions.delete(e)})),l.onOptionDestroy(e,f)})),{ns:t,id:n,containerKls:i,currentLabel:o,itemSelected:a,isDisabled:s,select:l,hoverItem:c,updateOption:u,visible:h,hover:d,selectOptionClick:function(){!0!==e.disabled&&!0!==r.groupDisabled&&l.handleOptionSelect(f)},states:r}}}),Vg=["id","aria-disabled","aria-selected"];var Ug=_e(Ng,[["render",function(e,t,n,i,r,o){return Mi((ui(),hi("li",{id:e.id,class:fi(e.containerKls),role:"option","aria-disabled":e.isDisabled||void 0,"aria-selected":e.itemSelected,onMouseenter:t[0]||(t[0]=(...t)=>e.hoverItem&&e.hoverItem(...t)),onClick:t[1]||(t[1]=Li(((...t)=>e.selectOptionClick&&e.selectOptionClick(...t)),["stop"]))},[di(e.$slots,"default",{},(()=>[vi("span",null,bi(e.currentLabel),1)]))],42,Vg)),[[$i,e.visible]])}],["__file","option.vue"]]);var zg=_e(ai({name:"ElSelectDropdown",componentName:"ElSelectDropdown",setup(){const e=gi(Fg),t=xe("select"),n=Si((()=>e.props.popperClass)),i=Si((()=>e.props.multiple)),r=Si((()=>e.props.fitInputWidth)),o=si("");function a(){var t;o.value=`${null==(t=e.selectRef)?void 0:t.offsetWidth}px`}return ci((()=>{a(),xt(e.selectRef,a)})),{ns:t,minWidth:o,popperClass:n,isMultiple:i,isFitInputWidth:r}}}),[["render",function(e,t,n,i,r,o){return ui(),hi("div",{class:fi([e.ns.b("dropdown"),e.ns.is("multiple",e.isMultiple),e.popperClass]),style:Ni({[e.isFitInputWidth?"width":"minWidth"]:e.minWidth})},[e.$slots.header?(ui(),hi("div",{key:0,class:fi(e.ns.be("dropdown","header"))},[di(e.$slots,"header")],2)):Fi("v-if",!0),di(e.$slots,"default"),e.$slots.footer?(ui(),hi("div",{key:1,class:fi(e.ns.be("dropdown","footer"))},[di(e.$slots,"footer")],2)):Fi("v-if",!0)],6)}],["__file","select-dropdown.vue"]]);const Hg=(e,t)=>{const{t:n}=we(),i=He(),r=xe("select"),o=xe("input"),a=zi({inputValue:"",options:new Map,cachedOptions:new Map,disabledOptions:new Map,optionValues:[],selected:e.multiple?[]:{},selectionWidth:0,calculatorWidth:0,collapseItemWidth:0,selectedLabel:"",hoveringIndex:-1,previousQuery:null,inputHovering:!1,menuVisibleOnFocus:!1,isBeforeHide:!1}),s=si(null),l=si(null),c=si(null),u=si(null),h=si(null),d=si(null),f=si(null),p=si(null),g=si(null),v=si(null),A=si(null),m=si(null),{wrapperRef:y,isFocused:b,handleFocus:C,handleBlur:w}=Je(h,{afterFocus(){e.automaticDropdown&&!x.value&&(x.value=!0,a.menuVisibleOnFocus=!0)},beforeBlur(e){var t,n;return(null==(t=c.value)?void 0:t.isFocusInsideContent(e))||(null==(n=u.value)?void 0:n.isFocusInsideContent(e))},afterBlur(){x.value=!1,a.menuVisibleOnFocus=!1}}),x=si(!1),_=si(),{form:E,formItem:S}=je(),{inputId:k}=Ve(e,{formItemContext:S}),{valueOnClear:B,isEmptyValue:O}=Et(e),T=Si((()=>e.disabled||(null==E?void 0:E.disabled))),D=Si((()=>e.multiple?Bi(e.modelValue)&&e.modelValue.length>0:!O(e.modelValue))),M=Si((()=>e.clearable&&!T.value&&a.inputHovering&&D.value)),Q=Si((()=>e.remote&&e.filterable&&!e.remoteShowSuffix?"":e.suffixIcon)),L=Si((()=>r.is("reverse",Q.value&&x.value))),P=Si((()=>(null==S?void 0:S.validateState)||"")),j=Si((()=>St[P.value])),R=Si((()=>e.remote?300:0)),F=Si((()=>e.loading?e.loadingText||n("el.select.loading"):!(e.remote&&!a.inputValue&&0===a.options.size)&&(e.filterable&&a.inputValue&&a.options.size>0&&0===N.value?e.noMatchText||n("el.select.noMatch"):0===a.options.size?e.noDataText||n("el.select.noData"):null))),N=Si((()=>V.value.filter((e=>e.visible)).length)),V=Si((()=>{const e=Array.from(a.options.values()),t=[];return a.optionValues.forEach((n=>{const i=e.findIndex((e=>e.value===n));i>-1&&t.push(e[i])})),t.length>=e.length?t:e})),U=Si((()=>Array.from(a.cachedOptions.values()))),z=Si((()=>{const t=V.value.filter((e=>!e.created)).some((e=>e.currentLabel===a.inputValue));return e.filterable&&e.allowCreate&&""!==a.inputValue&&!t})),H=()=>{e.filterable&&_i(e.filterMethod)||e.filterable&&e.remote&&_i(e.remoteMethod)||V.value.forEach((e=>{var t;null==(t=e.updateOption)||t.call(e,a.inputValue)}))},Y=Ne(),G=Si((()=>["small"].includes(Y.value)?"small":"default")),W=Si({get:()=>x.value&&!1!==F.value,set(e){x.value=e}}),X=Si((()=>Bi(e.modelValue)?0===e.modelValue.length&&!a.inputValue:!e.filterable||!a.inputValue)),$=Si((()=>{var t;const i=null!=(t=e.placeholder)?t:n("el.select.placeholder");return e.multiple||!D.value?i:a.selectedLabel})),q=Si((()=>It?null:"mouseenter"));Ii((()=>e.modelValue),((t,n)=>{e.multiple&&e.filterable&&!e.reserveKeyword&&(a.inputValue="",K("")),Z(),!Vc(t,n)&&e.validateEvent&&(null==S||S.validate("change").catch((e=>Re())))}),{flush:"post",deep:!0}),Ii((()=>x.value),(e=>{e?K(a.inputValue):(a.inputValue="",a.previousQuery=null,a.isBeforeHide=!0),t("visible-change",e)})),Ii((()=>a.options.entries()),(()=>{var t;if(!ye)return;const n=(null==(t=s.value)?void 0:t.querySelectorAll("input"))||[];(e.filterable||e.defaultFirstOption||Le(e.modelValue))&&Array.from(n).includes(document.activeElement)||Z(),e.defaultFirstOption&&(e.filterable||e.remote)&&N.value&&J()}),{flush:"post"}),Ii((()=>a.hoveringIndex),(e=>{Me(e)&&e>-1?_.value=V.value[e]||{}:_.value={},V.value.forEach((e=>{e.hover=_.value===e}))})),Ji((()=>{a.isBeforeHide||H()}));const K=t=>{a.previousQuery!==t&&(a.previousQuery=t,e.filterable&&_i(e.filterMethod)?e.filterMethod(t):e.filterable&&e.remote&&_i(e.remoteMethod)&&e.remoteMethod(t),e.defaultFirstOption&&(e.filterable||e.remote)&&N.value?ki(J):ki(te))},J=()=>{const e=V.value.filter((e=>e.visible&&!e.disabled&&!e.states.groupDisabled)),t=e.find((e=>e.created)),n=e[0];a.hoveringIndex=de(V.value,t||n)},Z=()=>{if(!e.multiple){const t=ee(e.modelValue);return a.selectedLabel=t.currentLabel,void(a.selected=t)}a.selectedLabel="";const t=[];Bi(e.modelValue)&&e.modelValue.forEach((e=>{t.push(ee(e))})),a.selected=t},ee=t=>{let n;const i="object"===ar(t).toLowerCase(),r="null"===ar(t).toLowerCase(),o="undefined"===ar(t).toLowerCase();for(let s=a.cachedOptions.size-1;s>=0;s--){const r=U.value[s];if(i?I(r.value,e.valueKey)===I(t,e.valueKey):r.value===t){n={value:t,currentLabel:r.currentLabel,get isDisabled(){return r.isDisabled}};break}}if(n)return n;return{value:t,currentLabel:i?t.label:r||o?"":t}},te=()=>{e.multiple?a.hoveringIndex=V.value.findIndex((e=>a.selected.some((t=>_e(t)===_e(e))))):a.hoveringIndex=V.value.findIndex((e=>_e(e)===_e(a.selected)))},ne=()=>{a.calculatorWidth=d.value.getBoundingClientRect().width},ie=()=>{var e,t;null==(t=null==(e=c.value)?void 0:e.updatePopper)||t.call(e)},re=()=>{var e,t;null==(t=null==(e=u.value)?void 0:e.updatePopper)||t.call(e)},oe=()=>{a.inputValue.length>0&&!x.value&&(x.value=!0),K(a.inputValue)},ae=t=>{if(a.inputValue=t.target.value,!e.remote)return oe();se()},se=le((()=>{oe()}),R.value),ce=n=>{Vc(e.modelValue,n)||t(ze,n)},ue=n=>{n.stopPropagation();const i=e.multiple?[]:B.value;if(e.multiple)for(const e of a.selected)e.isDisabled&&i.push(e.value);t(De,i),ce(i),a.hoveringIndex=-1,x.value=!1,t("clear"),me()},he=n=>{if(e.multiple){const i=(e.modelValue||[]).slice(),r=de(i,n.value);r>-1?i.splice(r,1):(e.multipleLimit<=0||i.length<e.multipleLimit)&&i.push(n.value),t(De,i),ce(i),n.created&&K(""),e.filterable&&!e.reserveKeyword&&(a.inputValue="")}else t(De,n.value),ce(n.value),x.value=!1;me(),x.value||ki((()=>{fe(n)}))},de=(t=[],n)=>{if(!Oi(n))return t.indexOf(n);const i=e.valueKey;let r=-1;return t.some(((e,t)=>Ti(I(e,i))===I(n,i)&&(r=t,!0))),r},fe=e=>{var t,n,i,o,a;const s=Bi(e)?e[0]:e;let l=null;if(null==s?void 0:s.value){const e=V.value.filter((e=>e.value===s.value));e.length>0&&(l=e[0].$el)}if(c.value&&l){const e=null==(o=null==(i=null==(n=null==(t=c.value)?void 0:t.popperRef)?void 0:n.contentRef)?void 0:i.querySelector)?void 0:o.call(i,`.${r.be("dropdown","wrap")}`);e&&kt(e,l)}null==(a=m.value)||a.handleScroll()},{handleCompositionStart:pe,handleCompositionUpdate:ge,handleCompositionEnd:ve}=function(e){const t=si(!1);return{handleCompositionStart:()=>{t.value=!0},handleCompositionUpdate:e=>{const n=e.target.value,i=n[n.length-1]||"";t.value=!_t(i)},handleCompositionEnd:n=>{t.value&&(t.value=!1,_i(e)&&e(n))}}}((e=>ae(e))),Ae=Si((()=>{var e,t;return null==(t=null==(e=c.value)?void 0:e.popperRef)?void 0:t.contentRef})),me=()=>{var e;null==(e=h.value)||e.focus()},be=e=>{if(x.value=!1,b.value){const t=new FocusEvent("focus",e);ki((()=>w(t)))}},Ce=()=>{T.value||(It&&(a.inputHovering=!0),a.menuVisibleOnFocus?a.menuVisibleOnFocus=!1:x.value=!x.value)},_e=t=>Oi(t.value)?I(t.value,e.valueKey):t.value,Ee=Si((()=>V.value.filter((e=>e.visible)).every((e=>e.disabled)))),Se=Si((()=>e.multiple?e.collapseTags?a.selected.slice(0,e.maxCollapseTags):a.selected:[])),Ie=Si((()=>e.multiple&&e.collapseTags?a.selected.slice(e.maxCollapseTags):[])),ke=e=>{if(x.value){if(0!==a.options.size&&0!==N.value&&!Ee.value){"next"===e?(a.hoveringIndex++,a.hoveringIndex===a.options.size&&(a.hoveringIndex=0)):"prev"===e&&(a.hoveringIndex--,a.hoveringIndex<0&&(a.hoveringIndex=a.options.size-1));const t=V.value[a.hoveringIndex];!0!==t.disabled&&!0!==t.states.groupDisabled&&t.visible||ke(e),ki((()=>fe(_.value)))}}else x.value=!0},Be=Si((()=>{const t=(()=>{if(!l.value)return 0;const e=window.getComputedStyle(l.value);return Number.parseFloat(e.gap||"6px")})();return{maxWidth:`${A.value&&1===e.maxCollapseTags?a.selectionWidth-a.collapseItemWidth-t:a.selectionWidth}px`}})),Oe=Si((()=>({maxWidth:`${a.selectionWidth}px`}))),Te=Si((()=>({width:`${Math.max(a.calculatorWidth,11)}px`})));return e.multiple&&!Bi(e.modelValue)&&t(De,[]),!e.multiple&&Bi(e.modelValue)&&t(De,""),xt(l,(()=>{a.selectionWidth=l.value.getBoundingClientRect().width})),xt(d,ne),xt(g,ie),xt(y,ie),xt(v,re),xt(A,(()=>{a.collapseItemWidth=A.value.getBoundingClientRect().width})),ci((()=>{Z()})),{inputId:k,contentId:i,nsSelect:r,nsInput:o,states:a,isFocused:b,expanded:x,optionsArray:V,hoverOption:_,selectSize:Y,filteredOptionsCount:N,resetCalculatorWidth:ne,updateTooltip:ie,updateTagTooltip:re,debouncedOnInputChange:se,onInput:ae,deletePrevTag:n=>{if(e.multiple&&n.code!==it.delete&&n.target.value.length<=0){const n=e.modelValue.slice(),i=(e=>Gl(e,(e=>!a.disabledOptions.has(e))))(n);if(i<0)return;const r=n[i];n.splice(i,1),t(De,n),ce(n),t("remove-tag",r)}},deleteTag:(n,i)=>{const r=a.selected.indexOf(i);if(r>-1&&!T.value){const n=e.modelValue.slice();n.splice(r,1),t(De,n),ce(n),t("remove-tag",i.value)}n.stopPropagation(),me()},deleteSelected:ue,handleOptionSelect:he,scrollToOption:fe,hasModelValue:D,shouldShowPlaceholder:X,currentPlaceholder:$,mouseEnterEventName:q,showClose:M,iconComponent:Q,iconReverse:L,validateState:P,validateIcon:j,showNewOption:z,updateOptions:H,collapseTagSize:G,setSelected:Z,selectDisabled:T,emptyText:F,handleCompositionStart:pe,handleCompositionUpdate:ge,handleCompositionEnd:ve,onOptionCreate:e=>{a.options.set(e.value,e),a.cachedOptions.set(e.value,e),e.disabled&&a.disabledOptions.set(e.value,e)},onOptionDestroy:(e,t)=>{a.options.get(e)===t&&a.options.delete(e)},handleMenuEnter:()=>{a.isBeforeHide=!1,ki((()=>fe(a.selected)))},handleFocus:C,focus:me,blur:()=>{be()},handleBlur:w,handleClearClick:e=>{ue(e)},handleClickOutside:be,handleEsc:()=>{a.inputValue.length>0?a.inputValue="":x.value=!1},toggleMenu:Ce,selectOption:()=>{x.value?V.value[a.hoveringIndex]&&he(V.value[a.hoveringIndex]):Ce()},getValueKey:_e,navigateOptions:ke,dropdownMenuVisible:W,showTagList:Se,collapseTagList:Ie,tagStyle:Be,collapseTagStyle:Oe,inputStyle:Te,popperRef:Ae,inputRef:h,tooltipRef:c,tagTooltipRef:u,calculatorRef:d,prefixRef:f,suffixRef:p,selectRef:s,wrapperRef:y,selectionRef:l,scrollbarRef:m,menuRef:g,tagMenuRef:v,collapseItemRef:A}};var Yg=ai({name:"ElOptions",setup(e,{slots:t}){const n=gi(Fg);let i=[];return()=>{var e,r;const o=null==(e=t.default)?void 0:e.call(t),a=[];return o.length&&function e(t){Bi(t)&&t.forEach((t=>{var n,i,r,o;const s=null==(n=(null==t?void 0:t.type)||{})?void 0:n.name;"ElOptionGroup"===s?e(Ei(t.children)||Bi(t.children)||!_i(null==(i=t.children)?void 0:i.default)?t.children:null==(r=t.children)?void 0:r.default()):"ElOption"===s?a.push(null==(o=t.props)?void 0:o.value):Bi(t.children)&&e(t.children)}))}(null==(r=o[0])?void 0:r.children),Vc(a,i)||(i=a,n&&(n.states.optionValues=a)),o}}});const Gg=be(l(l({name:String,id:String,modelValue:{type:[Array,String,Number,Boolean,Object],default:void 0},autocomplete:{type:String,default:"off"},automaticDropdown:Boolean,size:Oe,effect:{type:Ee(String),default:"light"},disabled:Boolean,clearable:Boolean,filterable:Boolean,allowCreate:Boolean,loading:Boolean,popperClass:{type:String,default:""},popperOptions:{type:Ee(Object),default:()=>({})},remote:Boolean,loadingText:String,noMatchText:String,noDataText:String,remoteMethod:Function,filterMethod:Function,multiple:Boolean,multipleLimit:{type:Number,default:0},placeholder:{type:String},defaultFirstOption:Boolean,reserveKeyword:{type:Boolean,default:!0},valueKey:{type:String,default:"value"},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},teleported:Ke.teleported,persistent:{type:Boolean,default:!0},clearIcon:{type:Ce,default:Bt},fitInputWidth:Boolean,suffixIcon:{type:Ce,default:tt},tagType:c(l({},gp.type),{default:"info"}),tagEffect:c(l({},gp.effect),{default:"light"}),validateEvent:{type:Boolean,default:!0},remoteShowSuffix:Boolean,placement:{type:Ee(String),values:Ot,default:"bottom-start"},fallbackPlacements:{type:Ee(Array),default:["bottom-start","top-start","right","left"]}},Tt),Te(["ariaLabel"]))),Wg="ElSelect",Xg=ai({name:Wg,componentName:Wg,components:{ElInput:Ze,ElSelectMenu:zg,ElOption:Ug,ElOptions:Yg,ElTag:mp,ElScrollbar:Dt,ElTooltip:nt,ElIcon:Se},directives:{ClickOutside:Sf},props:Gg,emits:[De,ze,"remove-tag","clear","visible-change","focus","blur"],setup(e,{emit:t}){const n=Hg(e,t);return li(Fg,zi({props:e,states:n.states,optionsArray:n.optionsArray,handleOptionSelect:n.handleOptionSelect,onOptionCreate:n.onOptionCreate,onOptionDestroy:n.onOptionDestroy,selectRef:n.selectRef,setSelected:n.setSelected})),l({},n)}}),$g=["id","name","disabled","autocomplete","readonly","aria-activedescendant","aria-controls","aria-expanded","aria-label"],qg=["textContent"],Kg={key:1};var Jg=_e(Xg,[["render",function(e,t,n,i,r,o){const a=sr("el-tag"),s=sr("el-tooltip"),l=sr("el-icon"),c=sr("el-option"),u=sr("el-options"),h=sr("el-scrollbar"),d=sr("el-select-menu"),f=lr("click-outside");return Mi((ui(),hi("div",{ref:"selectRef",class:fi([e.nsSelect.b(),e.nsSelect.m(e.selectSize)]),[ur(e.mouseEnterEventName)]:t[16]||(t[16]=t=>e.states.inputHovering=!0),onMouseleave:t[17]||(t[17]=t=>e.states.inputHovering=!1),onClick:t[18]||(t[18]=Li(((...t)=>e.toggleMenu&&e.toggleMenu(...t)),["prevent","stop"]))},[Hi(s,{ref:"tooltipRef",visible:e.dropdownMenuVisible,placement:e.placement,teleported:e.teleported,"popper-class":[e.nsSelect.e("popper"),e.popperClass],"popper-options":e.popperOptions,"fallback-placements":e.fallbackPlacements,effect:e.effect,pure:"",trigger:"click",transition:`${e.nsSelect.namespace.value}-zoom-in-top`,"stop-popper-mouse-event":!1,"gpu-acceleration":!1,persistent:e.persistent,onBeforeShow:e.handleMenuEnter,onHide:t[15]||(t[15]=t=>e.states.isBeforeHide=!1)},{default:mi((()=>{var n;return[vi("div",{ref:"wrapperRef",class:fi([e.nsSelect.e("wrapper"),e.nsSelect.is("focused",e.isFocused),e.nsSelect.is("hovering",e.states.inputHovering),e.nsSelect.is("filterable",e.filterable),e.nsSelect.is("disabled",e.selectDisabled)])},[e.$slots.prefix?(ui(),hi("div",{key:0,ref:"prefixRef",class:fi(e.nsSelect.e("prefix"))},[di(e.$slots,"prefix")],2)):Fi("v-if",!0),vi("div",{ref:"selectionRef",class:fi([e.nsSelect.e("selection"),e.nsSelect.is("near",e.multiple&&!e.$slots.prefix&&!!e.states.selected.length)])},[e.multiple?di(e.$slots,"tag",{key:0},(()=>[(ui(!0),hi(ji,null,Zi(e.showTagList,(t=>(ui(),hi("div",{key:e.getValueKey(t),class:fi(e.nsSelect.e("selected-item"))},[Hi(a,{closable:!e.selectDisabled&&!t.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Ni(e.tagStyle),onClose:n=>e.deleteTag(n,t)},{default:mi((()=>[vi("span",{class:fi(e.nsSelect.e("tags-text"))},[di(e.$slots,"label",{label:t.currentLabel,value:t.value},(()=>[Ri(bi(t.currentLabel),1)]))],2)])),_:2},1032,["closable","size","type","effect","style","onClose"])],2)))),128)),e.collapseTags&&e.states.selected.length>e.maxCollapseTags?(ui(),Ai(s,{key:0,ref:"tagTooltipRef",disabled:e.dropdownMenuVisible||!e.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:e.effect,placement:"bottom",teleported:e.teleported},{default:mi((()=>[vi("div",{ref:"collapseItemRef",class:fi(e.nsSelect.e("selected-item"))},[Hi(a,{closable:!1,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",style:Ni(e.collapseTagStyle)},{default:mi((()=>[vi("span",{class:fi(e.nsSelect.e("tags-text"))}," + "+bi(e.states.selected.length-e.maxCollapseTags),3)])),_:1},8,["size","type","effect","style"])],2)])),content:mi((()=>[vi("div",{ref:"tagMenuRef",class:fi(e.nsSelect.e("selection"))},[(ui(!0),hi(ji,null,Zi(e.collapseTagList,(t=>(ui(),hi("div",{key:e.getValueKey(t),class:fi(e.nsSelect.e("selected-item"))},[Hi(a,{class:"in-tooltip",closable:!e.selectDisabled&&!t.isDisabled,size:e.collapseTagSize,type:e.tagType,effect:e.tagEffect,"disable-transitions":"",onClose:n=>e.deleteTag(n,t)},{default:mi((()=>[vi("span",{class:fi(e.nsSelect.e("tags-text"))},[di(e.$slots,"label",{label:t.currentLabel,value:t.value},(()=>[Ri(bi(t.currentLabel),1)]))],2)])),_:2},1032,["closable","size","type","effect","onClose"])],2)))),128))],2)])),_:3},8,["disabled","effect","teleported"])):Fi("v-if",!0)])):Fi("v-if",!0),e.selectDisabled?Fi("v-if",!0):(ui(),hi("div",{key:1,class:fi([e.nsSelect.e("selected-item"),e.nsSelect.e("input-wrapper"),e.nsSelect.is("hidden",!e.filterable)])},[Mi(vi("input",{id:e.inputId,ref:"inputRef","onUpdate:modelValue":t[0]||(t[0]=t=>e.states.inputValue=t),type:"text",name:e.name,class:fi([e.nsSelect.e("input"),e.nsSelect.is(e.selectSize)]),disabled:e.selectDisabled,autocomplete:e.autocomplete,style:Ni(e.inputStyle),role:"combobox",readonly:!e.filterable,spellcheck:"false","aria-activedescendant":(null==(n=e.hoverOption)?void 0:n.id)||"","aria-controls":e.contentId,"aria-expanded":e.dropdownMenuVisible,"aria-label":e.ariaLabel,"aria-autocomplete":"none","aria-haspopup":"listbox",onFocus:t[1]||(t[1]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onBlur:t[2]||(t[2]=(...t)=>e.handleBlur&&e.handleBlur(...t)),onKeydown:[t[3]||(t[3]=Xi(Li((t=>e.navigateOptions("next")),["stop","prevent"]),["down"])),t[4]||(t[4]=Xi(Li((t=>e.navigateOptions("prev")),["stop","prevent"]),["up"])),t[5]||(t[5]=Xi(Li(((...t)=>e.handleEsc&&e.handleEsc(...t)),["stop","prevent"]),["esc"])),t[6]||(t[6]=Xi(Li(((...t)=>e.selectOption&&e.selectOption(...t)),["stop","prevent"]),["enter"])),t[7]||(t[7]=Xi(Li(((...t)=>e.deletePrevTag&&e.deletePrevTag(...t)),["stop"]),["delete"]))],onCompositionstart:t[8]||(t[8]=(...t)=>e.handleCompositionStart&&e.handleCompositionStart(...t)),onCompositionupdate:t[9]||(t[9]=(...t)=>e.handleCompositionUpdate&&e.handleCompositionUpdate(...t)),onCompositionend:t[10]||(t[10]=(...t)=>e.handleCompositionEnd&&e.handleCompositionEnd(...t)),onInput:t[11]||(t[11]=(...t)=>e.onInput&&e.onInput(...t)),onClick:t[12]||(t[12]=Li(((...t)=>e.toggleMenu&&e.toggleMenu(...t)),["stop"]))},null,46,$g),[[cr,e.states.inputValue]]),e.filterable?(ui(),hi("span",{key:0,ref:"calculatorRef","aria-hidden":"true",class:fi(e.nsSelect.e("input-calculator")),textContent:bi(e.states.inputValue)},null,10,qg)):Fi("v-if",!0)],2)),e.shouldShowPlaceholder?(ui(),hi("div",{key:2,class:fi([e.nsSelect.e("selected-item"),e.nsSelect.e("placeholder"),e.nsSelect.is("transparent",!e.hasModelValue||e.expanded&&!e.states.inputValue)])},[e.hasModelValue?di(e.$slots,"label",{key:0,label:e.currentPlaceholder,value:e.modelValue},(()=>[vi("span",null,bi(e.currentPlaceholder),1)])):(ui(),hi("span",Kg,bi(e.currentPlaceholder),1))],2)):Fi("v-if",!0)],2),vi("div",{ref:"suffixRef",class:fi(e.nsSelect.e("suffix"))},[e.iconComponent&&!e.showClose?(ui(),Ai(l,{key:0,class:fi([e.nsSelect.e("caret"),e.nsSelect.e("icon"),e.iconReverse])},{default:mi((()=>[(ui(),Ai(yi(e.iconComponent)))])),_:1},8,["class"])):Fi("v-if",!0),e.showClose&&e.clearIcon?(ui(),Ai(l,{key:1,class:fi([e.nsSelect.e("caret"),e.nsSelect.e("icon")]),onClick:e.handleClearClick},{default:mi((()=>[(ui(),Ai(yi(e.clearIcon)))])),_:1},8,["class","onClick"])):Fi("v-if",!0),e.validateState&&e.validateIcon?(ui(),Ai(l,{key:2,class:fi([e.nsInput.e("icon"),e.nsInput.e("validateIcon")])},{default:mi((()=>[(ui(),Ai(yi(e.validateIcon)))])),_:1},8,["class"])):Fi("v-if",!0)],2)],2)]})),content:mi((()=>[Hi(d,{ref:"menuRef"},{default:mi((()=>[e.$slots.header?(ui(),hi("div",{key:0,class:fi(e.nsSelect.be("dropdown","header")),onClick:t[13]||(t[13]=Li((()=>{}),["stop"]))},[di(e.$slots,"header")],2)):Fi("v-if",!0),Mi(Hi(h,{id:e.contentId,ref:"scrollbarRef",tag:"ul","wrap-class":e.nsSelect.be("dropdown","wrap"),"view-class":e.nsSelect.be("dropdown","list"),class:fi([e.nsSelect.is("empty",0===e.filteredOptionsCount)]),role:"listbox","aria-label":e.ariaLabel,"aria-orientation":"vertical"},{default:mi((()=>[e.showNewOption?(ui(),Ai(c,{key:0,value:e.states.inputValue,created:!0},null,8,["value"])):Fi("v-if",!0),Hi(u,null,{default:mi((()=>[di(e.$slots,"default")])),_:3})])),_:3},8,["id","wrap-class","view-class","class","aria-label"]),[[$i,e.states.options.size>0&&!e.loading]]),e.$slots.loading&&e.loading?(ui(),hi("div",{key:1,class:fi(e.nsSelect.be("dropdown","loading"))},[di(e.$slots,"loading")],2)):e.loading||0===e.filteredOptionsCount?(ui(),hi("div",{key:2,class:fi(e.nsSelect.be("dropdown","empty"))},[di(e.$slots,"empty",{},(()=>[vi("span",null,bi(e.emptyText),1)]))],2)):Fi("v-if",!0),e.$slots.footer?(ui(),hi("div",{key:3,class:fi(e.nsSelect.be("dropdown","footer")),onClick:t[14]||(t[14]=Li((()=>{}),["stop"]))},[di(e.$slots,"footer")],2)):Fi("v-if",!0)])),_:3},512)])),_:3},8,["visible","placement","teleported","popper-class","popper-options","fallback-placements","effect","transition","persistent","onBeforeShow"])],16)),[[f,e.handleClickOutside,e.popperRef]])}],["__file","select.vue"]]);var Zg=_e(ai({name:"ElOptionGroup",componentName:"ElOptionGroup",props:{label:String,disabled:Boolean},setup(e){const t=xe("select"),n=si(null),i=Ci(),r=si([]);li(Rg,zi(l({},Vi(e))));const o=Si((()=>r.value.some((e=>!0===e.visible)))),a=e=>{const t=ue(e),n=[];return t.forEach((e=>{var t,i;(e=>{var t,n;return"ElOption"===(null==(t=e.type)?void 0:t.name)&&!!(null==(n=e.component)?void 0:n.proxy)})(e)?n.push(e.component.proxy):(null==(t=e.children)?void 0:t.length)?n.push(...a(e.children)):(null==(i=e.component)?void 0:i.subTree)&&n.push(...a(e.component.subTree))})),n},s=()=>{r.value=a(i.subTree)};return ci((()=>{s()})),Mt(n,s,{attributes:!0,subtree:!0,childList:!0}),{groupRef:n,visible:o,ns:t}}}),[["render",function(e,t,n,i,r,o){return Mi((ui(),hi("ul",{ref:"groupRef",class:fi(e.ns.be("group","wrap"))},[vi("li",{class:fi(e.ns.be("group","title"))},bi(e.label),3),vi("li",null,[vi("ul",{class:fi(e.ns.b("group"))},[di(e.$slots,"default")],2)])],2)),[[$i,e.visible]])}],["__file","option-group.vue"]]);const ev=Ie(Jg,{Option:Ug,OptionGroup:Zg}),tv=ke(Ug);ke(Zg);const nv=be({trigger:Qt.trigger,placement:Lt.placement,disabled:Qt.disabled,visible:Ke.visible,transition:Ke.transition,popperOptions:Lt.popperOptions,tabindex:Lt.tabindex,content:Ke.content,popperStyle:Ke.popperStyle,popperClass:Ke.popperClass,enterable:c(l({},Ke.enterable),{default:!0}),effect:c(l({},Ke.effect),{default:"light"}),teleported:Ke.teleported,title:String,width:{type:[String,Number],default:150},offset:{type:Number,default:void 0},showAfter:{type:Number,default:0},hideAfter:{type:Number,default:200},autoClose:{type:Number,default:0},showArrow:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},"onUpdate:visible":{type:Function}}),iv={"update:visible":e=>Qe(e),"before-enter":()=>!0,"before-leave":()=>!0,"after-enter":()=>!0,"after-leave":()=>!0},rv=ai({name:"ElPopover"}),ov=ai(c(l({},rv),{props:nv,emits:iv,setup(e,{expose:t,emit:n}){const i=e,r=Si((()=>i["onUpdate:visible"])),o=xe("popover"),a=si(),s=Si((()=>{var e;return null==(e=pi(a))?void 0:e.popperRef})),l=Si((()=>[{width:qe(i.width)},i.popperStyle])),c=Si((()=>[o.b(),i.popperClass,{[o.m("plain")]:!!i.content}])),u=Si((()=>i.transition===`${o.namespace.value}-fade-in-linear`)),h=()=>{n("before-enter")},d=()=>{n("before-leave")},f=()=>{n("after-enter")},p=()=>{n("update:visible",!1),n("after-leave")};return t({popperRef:s,hide:()=>{var e;null==(e=a.value)||e.hide()}}),(e,t)=>(ui(),Ai(pi(nt),Gi({ref_key:"tooltipRef",ref:a},e.$attrs,{trigger:e.trigger,placement:e.placement,disabled:e.disabled,visible:e.visible,transition:e.transition,"popper-options":e.popperOptions,tabindex:e.tabindex,content:e.content,offset:e.offset,"show-after":e.showAfter,"hide-after":e.hideAfter,"auto-close":e.autoClose,"show-arrow":e.showArrow,"aria-label":e.title,effect:e.effect,enterable:e.enterable,"popper-class":pi(c),"popper-style":pi(l),teleported:e.teleported,persistent:e.persistent,"gpu-acceleration":pi(u),"onUpdate:visible":pi(r),onBeforeShow:h,onBeforeHide:d,onShow:f,onHide:p}),{content:mi((()=>[e.title?(ui(),hi("div",{key:0,class:fi(pi(o).e("title")),role:"title"},bi(e.title),3)):Fi("v-if",!0),di(e.$slots,"default",{},(()=>[Ri(bi(e.content),1)]))])),default:mi((()=>[e.$slots.reference?di(e.$slots,"reference",{key:0}):Fi("v-if",!0)])),_:3},16,["trigger","placement","disabled","visible","transition","popper-options","tabindex","content","offset","show-after","hide-after","auto-close","show-arrow","aria-label","effect","enterable","popper-class","popper-style","teleported","persistent","gpu-acceleration","onUpdate:visible"]))}}));const av=(e,t)=>{const n=t.arg||t.value,i=null==n?void 0:n.popperRef;i&&(i.triggerRef=e)};const sv=Ie(_e(ov,[["__file","popover.vue"]]),{directive:Pt({mounted(e,t){av(e,t)},updated(e,t){av(e,t)}},"popover")}),lv=Symbol("sliderContextKey"),cv=be(l({modelValue:{type:Ee([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:Oe,inputSize:Oe,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:Ee(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,debounce:{type:Number,default:300},label:{type:String,default:void 0},rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:Ee(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Ot,default:"top"},marks:{type:Ee(Object)},validateEvent:{type:Boolean,default:!0}},Te(["ariaLabel"]))),uv=e=>Me(e)||Bi(e)&&e.every(Me),hv={[De]:uv,[At]:uv,[ze]:uv},dv=(e,t,n)=>{const{form:i,formItem:r}=je(),o=qi(),a=si(),s=si(),l={firstButton:a,secondButton:s},c=Si((()=>e.disabled||(null==i?void 0:i.disabled)||!1)),u=Si((()=>Math.min(t.firstValue,t.secondValue))),d=Si((()=>Math.max(t.firstValue,t.secondValue))),f=Si((()=>e.range?100*(d.value-u.value)/(e.max-e.min)+"%":100*(t.firstValue-e.min)/(e.max-e.min)+"%")),p=Si((()=>e.range?100*(u.value-e.min)/(e.max-e.min)+"%":"0%")),g=Si((()=>e.vertical?{height:e.height}:{})),v=Si((()=>e.vertical?{height:f.value,bottom:p.value}:{width:f.value,left:p.value})),A=()=>{o.value&&(t.sliderSize=o.value["client"+(e.vertical?"Height":"Width")])},m=n=>{const i=(n=>{const i=e.min+n*(e.max-e.min)/100;if(!e.range)return a;let r;return r=Math.abs(u.value-i)<Math.abs(d.value-i)?t.firstValue<t.secondValue?"firstButton":"secondButton":t.firstValue>t.secondValue?"firstButton":"secondButton",l[r]})(n);return i.value.setPosition(n),i},y=e=>{n(De,e),n(At,e)},b=()=>h(void 0,null,(function*(){yield ki(),n(ze,e.range?[u.value,d.value]:e.modelValue)})),C=n=>{var i,r,a,s,l,u;if(c.value||t.dragging)return;A();let h=0;if(e.vertical){const e=null!=(a=null==(r=null==(i=n.touches)?void 0:i.item(0))?void 0:r.clientY)?a:n.clientY;h=(o.value.getBoundingClientRect().bottom-e)/t.sliderSize*100}else{h=((null!=(u=null==(l=null==(s=n.touches)?void 0:s.item(0))?void 0:l.clientX)?u:n.clientX)-o.value.getBoundingClientRect().left)/t.sliderSize*100}return h<0||h>100?void 0:m(h)};return{elFormItem:r,slider:o,firstButton:a,secondButton:s,sliderDisabled:c,minValue:u,maxValue:d,runwayStyle:g,barStyle:v,resetSize:A,setPosition:m,emitChange:b,onSliderWrapperPrevent:e=>{var t,n;((null==(t=l.firstButton.value)?void 0:t.dragging)||(null==(n=l.secondButton.value)?void 0:n.dragging))&&e.preventDefault()},onSliderClick:e=>{C(e)&&b()},onSliderDown:e=>h(void 0,null,(function*(){const t=C(e);t&&(yield ki(),t.value.onButtonDown(e))})),setFirstValue:n=>{t.firstValue=n,y(e.range?[u.value,d.value]:n)},setSecondValue:n=>{t.secondValue=n,e.range&&y([u.value,d.value])}}},{left:fv,down:pv,right:gv,up:vv,home:Av,end:mv,pageUp:yv,pageDown:bv}=it,Cv=(e,t,n)=>{const{disabled:i,min:r,max:o,step:a,showTooltip:s,precision:l,sliderSize:c,formatTooltip:u,emitChange:d,resetSize:f,updateDragging:p}=gi(lv),{tooltip:g,tooltipVisible:v,formatValue:A,displayTooltip:m,hideTooltip:y}=((e,t,n)=>{const i=si(),r=si(!1),o=Si((()=>t.value instanceof Function)),a=Si((()=>o.value&&t.value(e.modelValue)||e.modelValue)),s=le((()=>{n.value&&(r.value=!0)}),50),l=le((()=>{n.value&&(r.value=!1)}),50);return{tooltip:i,tooltipVisible:r,formatValue:a,displayTooltip:s,hideTooltip:l}})(e,u,s),b=si(),C=Si((()=>(e.modelValue-r.value)/(o.value-r.value)*100+"%")),w=Si((()=>e.vertical?{bottom:C.value}:{left:C.value})),x=e=>{i.value||(t.newPosition=Number.parseFloat(C.value)+e/(o.value-r.value)*100,k(t.newPosition),d())},_=e=>{let t,n;return e.type.startsWith("touch")?(n=e.touches[0].clientY,t=e.touches[0].clientX):(n=e.clientY,t=e.clientX),{clientX:t,clientY:n}},E=n=>{t.dragging=!0,t.isClick=!0;const{clientX:i,clientY:r}=_(n);e.vertical?t.startY=r:t.startX=i,t.startPosition=Number.parseFloat(C.value),t.newPosition=t.startPosition},S=n=>{if(t.dragging){let i;t.isClick=!1,m(),f();const{clientX:r,clientY:o}=_(n);e.vertical?(t.currentY=o,i=(t.startY-t.currentY)/c.value*100):(t.currentX=r,i=(t.currentX-t.startX)/c.value*100),t.newPosition=t.startPosition+i,k(t.newPosition)}},I=()=>{t.dragging&&(setTimeout((()=>{t.dragging=!1,t.hovering||y(),t.isClick||k(t.newPosition),d()}),0),window.removeEventListener("mousemove",S),window.removeEventListener("touchmove",S),window.removeEventListener("mouseup",I),window.removeEventListener("touchend",I),window.removeEventListener("contextmenu",I))},k=i=>h(void 0,null,(function*(){if(null===i||Number.isNaN(+i))return;i<0?i=0:i>100&&(i=100);const s=100/((o.value-r.value)/a.value);let c=Math.round(i/s)*s*(o.value-r.value)*.01+r.value;c=Number.parseFloat(c.toFixed(l.value)),c!==e.modelValue&&n(De,c),t.dragging||e.modelValue===t.oldValue||(t.oldValue=e.modelValue),yield ki(),t.dragging&&m(),g.value.updatePopper()}));return Ii((()=>t.dragging),(e=>{p(e)})),{disabled:i,button:b,tooltip:g,tooltipVisible:v,showTooltip:s,wrapperStyle:w,formatValue:A,handleMouseEnter:()=>{t.hovering=!0,m()},handleMouseLeave:()=>{t.hovering=!1,t.dragging||y()},onButtonDown:e=>{i.value||(e.preventDefault(),E(e),window.addEventListener("mousemove",S),window.addEventListener("touchmove",S),window.addEventListener("mouseup",I),window.addEventListener("touchend",I),window.addEventListener("contextmenu",I),b.value.focus())},onKeyDown:e=>{let t=!0;[fv,pv].includes(e.key)?x(-a.value):[gv,vv].includes(e.key)?x(a.value):e.key===Av?i.value||(k(0),d()):e.key===mv?i.value||(k(100),d()):e.key===bv?x(4*-a.value):e.key===yv?x(4*a.value):t=!1,t&&e.preventDefault()},setPosition:k}},wv=be({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Ot,default:"top"}}),xv={[De]:e=>Me(e)},_v=["tabindex"],Ev=ai({name:"ElSliderButton"});var Sv=_e(ai(c(l({},Ev),{props:wv,emits:xv,setup(e,{expose:t,emit:n}){const i=e,r=xe("slider"),o=zi({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:i.modelValue}),{disabled:a,button:s,tooltip:l,showTooltip:c,tooltipVisible:u,wrapperStyle:h,formatValue:d,handleMouseEnter:f,handleMouseLeave:p,onButtonDown:g,onKeyDown:v,setPosition:A}=Cv(i,o,n),{hovering:m,dragging:y}=Vi(o);return t({onButtonDown:g,onKeyDown:v,setPosition:A,hovering:m,dragging:y}),(e,t)=>(ui(),hi("div",{ref_key:"button",ref:s,class:fi([pi(r).e("button-wrapper"),{hover:pi(m),dragging:pi(y)}]),style:Ni(pi(h)),tabindex:pi(a)?-1:0,onMouseenter:t[0]||(t[0]=(...e)=>pi(f)&&pi(f)(...e)),onMouseleave:t[1]||(t[1]=(...e)=>pi(p)&&pi(p)(...e)),onMousedown:t[2]||(t[2]=(...e)=>pi(g)&&pi(g)(...e)),onTouchstart:t[3]||(t[3]=(...e)=>pi(g)&&pi(g)(...e)),onFocus:t[4]||(t[4]=(...e)=>pi(f)&&pi(f)(...e)),onBlur:t[5]||(t[5]=(...e)=>pi(p)&&pi(p)(...e)),onKeydown:t[6]||(t[6]=(...e)=>pi(v)&&pi(v)(...e))},[Hi(pi(nt),{ref_key:"tooltip",ref:l,visible:pi(u),placement:e.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":e.tooltipClass,disabled:!pi(c),persistent:""},{content:mi((()=>[vi("span",null,bi(pi(d)),1)])),default:mi((()=>[vi("div",{class:fi([pi(r).e("button"),{hover:pi(m),dragging:pi(y)}])},null,2)])),_:1},8,["visible","placement","popper-class","disabled"])],46,_v))}})),[["__file","button.vue"]]);var Iv=ai({name:"ElSliderMarker",props:be({mark:{type:Ee([String,Object]),default:void 0}}),setup(e){const t=xe("slider"),n=Si((()=>Ei(e.mark)?e.mark:e.mark.label)),i=Si((()=>Ei(e.mark)?void 0:e.mark.style));return()=>hr("div",{class:t.e("marks-text"),style:i.value},n.value)}});const kv=["id","role","aria-label","aria-labelledby"],Bv={key:1},Ov=ai({name:"ElSlider"});const Tv=Ie(_e(ai(c(l({},Ov),{props:cv,emits:hv,setup(e,{expose:t,emit:n}){const i=e,r=xe("slider"),{t:o}=we(),a=zi({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:s,slider:u,firstButton:d,secondButton:f,sliderDisabled:p,minValue:g,maxValue:v,runwayStyle:A,barStyle:m,resetSize:y,emitChange:b,onSliderWrapperPrevent:C,onSliderClick:w,onSliderDown:x,setFirstValue:_,setSecondValue:E}=dv(i,a,n),{stops:S,getStopStyle:I}=((e,t,n,i)=>({stops:Si((()=>{if(!e.showStops||e.min>e.max)return[];if(0===e.step)return[];const r=(e.max-e.min)/e.step,o=100*e.step/(e.max-e.min),a=Array.from({length:r-1}).map(((e,t)=>(t+1)*o));return e.range?a.filter((t=>t<100*(n.value-e.min)/(e.max-e.min)||t>100*(i.value-e.min)/(e.max-e.min))):a.filter((n=>n>100*(t.firstValue-e.min)/(e.max-e.min)))})),getStopStyle:t=>e.vertical?{bottom:`${t}%`}:{left:`${t}%`}}))(i,a,g,v),{inputId:k,isLabeledByFormItem:B}=Ve(i,{formItemContext:s}),O=Ne(),T=Si((()=>i.inputSize||O.value)),D=Si((()=>i.label||i.ariaLabel||o("el.slider.defaultLabel",{min:i.min,max:i.max}))),M=Si((()=>i.range?i.rangeStartLabel||o("el.slider.defaultRangeStartLabel"):D.value)),Q=Si((()=>i.formatValueText?i.formatValueText(V.value):`${V.value}`)),L=Si((()=>i.rangeEndLabel||o("el.slider.defaultRangeEndLabel"))),P=Si((()=>i.formatValueText?i.formatValueText(U.value):`${U.value}`)),j=Si((()=>[r.b(),r.m(O.value),r.is("vertical",i.vertical),{[r.m("with-input")]:i.showInput}])),R=(e=>Si((()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort(((e,t)=>e-t)).filter((t=>t<=e.max&&t>=e.min)).map((t=>({point:t,position:100*(t-e.min)/(e.max-e.min),mark:e.marks[t]}))):[])))(i);((e,t,n,i,r,o)=>{const a=e=>{r(De,e),r(At,e)},s=()=>e.range?![n.value,i.value].every(((e,n)=>e===t.oldValue[n])):e.modelValue!==t.oldValue,l=()=>{var n,i;e.min>e.max&&Ct("Slider","min should not be greater than max.");const r=e.modelValue;e.range&&Array.isArray(r)?r[1]<e.min?a([e.min,e.min]):r[0]>e.max?a([e.max,e.max]):r[0]<e.min?a([e.min,r[1]]):r[1]>e.max?a([r[0],e.max]):(t.firstValue=r[0],t.secondValue=r[1],s()&&(e.validateEvent&&(null==(n=null==o?void 0:o.validate)||n.call(o,"change").catch((e=>Re()))),t.oldValue=r.slice())):e.range||"number"!=typeof r||Number.isNaN(r)||(r<e.min?a(e.min):r>e.max?a(e.max):(t.firstValue=r,s()&&(e.validateEvent&&(null==(i=null==o?void 0:o.validate)||i.call(o,"change").catch((e=>Re()))),t.oldValue=r)))};l(),Ii((()=>t.dragging),(e=>{e||l()})),Ii((()=>e.modelValue),((e,n)=>{t.dragging||Array.isArray(e)&&Array.isArray(n)&&e.every(((e,t)=>e===n[t]))&&t.firstValue===e[0]&&t.secondValue===e[1]||l()}),{deep:!0}),Ii((()=>[e.min,e.max]),(()=>{l()}))})(i,a,g,v,n,s);const F=Si((()=>{const e=[i.min,i.max,i.step].map((e=>{const t=`${e}`.split(".")[1];return t?t.length:0}));return Math.max.apply(null,e)})),{sliderWrapper:N}=((e,t,n)=>{const i=si();return ci((()=>h(void 0,null,(function*(){e.range?(Array.isArray(e.modelValue)?(t.firstValue=Math.max(e.min,e.modelValue[0]),t.secondValue=Math.min(e.max,e.modelValue[1])):(t.firstValue=e.min,t.secondValue=e.max),t.oldValue=[t.firstValue,t.secondValue]):("number"!=typeof e.modelValue||Number.isNaN(e.modelValue)?t.firstValue=e.min:t.firstValue=Math.min(e.max,Math.max(e.min,e.modelValue)),t.oldValue=t.firstValue),dt(window,"resize",n),yield ki(),n()})))),{sliderWrapper:i}})(i,a,y),{firstValue:V,secondValue:U,sliderSize:z}=Vi(a);return li(lv,c(l({},Vi(i)),{sliderSize:z,disabled:p,precision:F,emitChange:b,resetSize:y,updateDragging:e=>{a.dragging=e}})),Ue({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-slider",ref:"https://element-plus.org/en-US/component/slider.html"},Si((()=>!!i.label))),t({onSliderClick:w}),(e,t)=>{var n,i;return ui(),hi("div",{id:e.range?pi(k):void 0,ref_key:"sliderWrapper",ref:N,class:fi(pi(j)),role:e.range?"group":void 0,"aria-label":e.range&&!pi(B)?pi(D):void 0,"aria-labelledby":e.range&&pi(B)?null==(n=pi(s))?void 0:n.labelId:void 0,onTouchstart:t[2]||(t[2]=(...e)=>pi(C)&&pi(C)(...e)),onTouchmove:t[3]||(t[3]=(...e)=>pi(C)&&pi(C)(...e))},[vi("div",{ref_key:"slider",ref:u,class:fi([pi(r).e("runway"),{"show-input":e.showInput&&!e.range},pi(r).is("disabled",pi(p))]),style:Ni(pi(A)),onMousedown:t[0]||(t[0]=(...e)=>pi(x)&&pi(x)(...e)),onTouchstart:t[1]||(t[1]=(...e)=>pi(x)&&pi(x)(...e))},[vi("div",{class:fi(pi(r).e("bar")),style:Ni(pi(m))},null,6),Hi(Sv,{id:e.range?void 0:pi(k),ref_key:"firstButton",ref:d,"model-value":pi(V),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":e.range||!pi(B)?pi(M):void 0,"aria-labelledby":!e.range&&pi(B)?null==(i=pi(s))?void 0:i.labelId:void 0,"aria-valuemin":e.min,"aria-valuemax":e.range?pi(U):e.max,"aria-valuenow":pi(V),"aria-valuetext":pi(Q),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":pi(p),"onUpdate:modelValue":pi(_)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),e.range?(ui(),Ai(Sv,{key:0,ref_key:"secondButton",ref:f,"model-value":pi(U),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":pi(L),"aria-valuemin":pi(V),"aria-valuemax":e.max,"aria-valuenow":pi(U),"aria-valuetext":pi(P),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":pi(p),"onUpdate:modelValue":pi(E)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):Fi("v-if",!0),e.showStops?(ui(),hi("div",Bv,[(ui(!0),hi(ji,null,Zi(pi(S),((e,t)=>(ui(),hi("div",{key:t,class:fi(pi(r).e("stop")),style:Ni(pi(I)(e))},null,6)))),128))])):Fi("v-if",!0),pi(R).length>0?(ui(),hi(ji,{key:2},[vi("div",null,[(ui(!0),hi(ji,null,Zi(pi(R),((e,t)=>(ui(),hi("div",{key:t,style:Ni(pi(I)(e.position)),class:fi([pi(r).e("stop"),pi(r).e("marks-stop")])},null,6)))),128))]),vi("div",{class:fi(pi(r).e("marks"))},[(ui(!0),hi(ji,null,Zi(pi(R),((e,t)=>(ui(),Ai(pi(Iv),{key:t,mark:e.mark,style:Ni(pi(I)(e.position))},null,8,["mark","style"])))),128))],2)],64)):Fi("v-if",!0)],38),e.showInput&&!e.range?(ui(),Ai(pi(jg),{key:0,ref:"input","model-value":pi(V),class:fi(pi(r).e("input")),step:e.step,disabled:pi(p),controls:e.showInputControls,min:e.min,max:e.max,debounce:e.debounce,size:pi(T),"onUpdate:modelValue":pi(_),onChange:pi(b)},null,8,["model-value","class","step","disabled","controls","min","max","debounce","size","onUpdate:modelValue","onChange"])):Fi("v-if",!0)],42,kv)}}})),[["__file","slider.vue"]])),Dv=be(l({modelValue:{type:[Boolean,String,Number],default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},size:{type:String,validator:jt},width:{type:[String,Number],default:""},inlinePrompt:{type:Boolean,default:!1},inactiveActionIcon:{type:Ce},activeActionIcon:{type:Ce},activeIcon:{type:Ce},inactiveIcon:{type:Ce},activeText:{type:String,default:""},inactiveText:{type:String,default:""},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},name:{type:String,default:""},validateEvent:{type:Boolean,default:!0},beforeChange:{type:Ee(Function)},id:String,tabindex:{type:[String,Number]},label:{type:String,default:void 0}},Te(["ariaLabel"]))),Mv={[De]:e=>Qe(e)||Ei(e)||Me(e),[ze]:e=>Qe(e)||Ei(e)||Me(e),[At]:e=>Qe(e)||Ei(e)||Me(e)},Qv=["onClick"],Lv=["id","aria-checked","aria-disabled","aria-label","name","true-value","false-value","disabled","tabindex","onKeydown"],Pv=["aria-hidden"],jv=["aria-hidden"],Rv=["aria-hidden"],Fv="ElSwitch",Nv=ai({name:Fv});const Vv=Ie(_e(ai(c(l({},Nv),{props:Dv,emits:Mv,setup(e,{expose:t,emit:n}){const i=e,{formItem:r}=je(),o=Ne(),a=xe("switch"),{inputId:s}=Ve(i,{formItemContext:r}),l=Pe(Si((()=>i.loading))),c=si(!1!==i.modelValue),u=si(),h=si(),d=Si((()=>[a.b(),a.m(o.value),a.is("disabled",l.value),a.is("checked",A.value)])),f=Si((()=>[a.e("label"),a.em("label","left"),a.is("active",!A.value)])),p=Si((()=>[a.e("label"),a.em("label","right"),a.is("active",A.value)])),g=Si((()=>({width:qe(i.width)})));Ii((()=>i.modelValue),(()=>{c.value=!0}));const v=Si((()=>!!c.value&&i.modelValue)),A=Si((()=>v.value===i.activeValue));[i.activeValue,i.inactiveValue].includes(v.value)||(n(De,i.inactiveValue),n(ze,i.inactiveValue),n(At,i.inactiveValue)),Ii(A,(e=>{var t;u.value.checked=e,i.validateEvent&&(null==(t=null==r?void 0:r.validate)||t.call(r,"change").catch((e=>Re())))}));const m=()=>{const e=A.value?i.inactiveValue:i.activeValue;n(De,e),n(ze,e),n(At,e),ki((()=>{u.value.checked=A.value}))},y=()=>{if(l.value)return;const{beforeChange:e}=i;if(!e)return void m();const t=e();[dr(t),Qe(t)].includes(!0)||Ct(Fv,"beforeChange must return type `Promise<boolean>` or `boolean`"),dr(t)?t.then((e=>{e&&m()})).catch((e=>{})):t&&m()};return ci((()=>{u.value.checked=A.value})),Ue({from:"label",replacement:"aria-label",version:"2.8.0",scope:"el-switch",ref:"https://element-plus.org/en-US/component/switch.html"},Si((()=>!!i.label))),t({focus:()=>{var e,t;null==(t=null==(e=u.value)?void 0:e.focus)||t.call(e)},checked:A}),(e,t)=>(ui(),hi("div",{class:fi(pi(d)),onClick:Li(y,["prevent"])},[vi("input",{id:pi(s),ref_key:"input",ref:u,class:fi(pi(a).e("input")),type:"checkbox",role:"switch","aria-checked":pi(A),"aria-disabled":pi(l),"aria-label":e.label||e.ariaLabel,name:e.name,"true-value":e.activeValue,"false-value":e.inactiveValue,disabled:pi(l),tabindex:e.tabindex,onChange:m,onKeydown:Xi(y,["enter"])},null,42,Lv),e.inlinePrompt||!e.inactiveIcon&&!e.inactiveText?Fi("v-if",!0):(ui(),hi("span",{key:0,class:fi(pi(f))},[e.inactiveIcon?(ui(),Ai(pi(Se),{key:0},{default:mi((()=>[(ui(),Ai(yi(e.inactiveIcon)))])),_:1})):Fi("v-if",!0),!e.inactiveIcon&&e.inactiveText?(ui(),hi("span",{key:1,"aria-hidden":pi(A)},bi(e.inactiveText),9,Pv)):Fi("v-if",!0)],2)),vi("span",{ref_key:"core",ref:h,class:fi(pi(a).e("core")),style:Ni(pi(g))},[e.inlinePrompt?(ui(),hi("div",{key:0,class:fi(pi(a).e("inner"))},[e.activeIcon||e.inactiveIcon?(ui(),Ai(pi(Se),{key:0,class:fi(pi(a).is("icon"))},{default:mi((()=>[(ui(),Ai(yi(pi(A)?e.activeIcon:e.inactiveIcon)))])),_:1},8,["class"])):e.activeText||e.inactiveText?(ui(),hi("span",{key:1,class:fi(pi(a).is("text")),"aria-hidden":!pi(A)},bi(pi(A)?e.activeText:e.inactiveText),11,jv)):Fi("v-if",!0)],2)):Fi("v-if",!0),vi("div",{class:fi(pi(a).e("action"))},[e.loading?(ui(),Ai(pi(Se),{key:0,class:fi(pi(a).is("loading"))},{default:mi((()=>[Hi(pi(Rt))])),_:1},8,["class"])):pi(A)?di(e.$slots,"active-action",{key:1},(()=>[e.activeActionIcon?(ui(),Ai(pi(Se),{key:0},{default:mi((()=>[(ui(),Ai(yi(e.activeActionIcon)))])),_:1})):Fi("v-if",!0)])):pi(A)?Fi("v-if",!0):di(e.$slots,"inactive-action",{key:2},(()=>[e.inactiveActionIcon?(ui(),Ai(pi(Se),{key:0},{default:mi((()=>[(ui(),Ai(yi(e.inactiveActionIcon)))])),_:1})):Fi("v-if",!0)]))],2)],6),e.inlinePrompt||!e.activeIcon&&!e.activeText?Fi("v-if",!0):(ui(),hi("span",{key:1,class:fi(pi(p))},[e.activeIcon?(ui(),Ai(pi(Se),{key:0},{default:mi((()=>[(ui(),Ai(yi(e.activeIcon)))])),_:1})):Fi("v-if",!0),!e.activeIcon&&e.activeText?(ui(),hi("span",{key:1,"aria-hidden":!pi(A)},bi(e.activeText),9,Rv)):Fi("v-if",!0)],2))],10,Qv))}})),[["__file","switch.vue"]])),Uv="$treeNodeId",zv=function(e,t){t&&!t[Uv]&&Object.defineProperty(t,Uv,{value:e.id,enumerable:!1,configurable:!1,writable:!1})},Hv=function(e,t){return e?t[e]:t[Uv]},Yv=(e,t,n)=>{const i=e.value.currentNode;n();const r=e.value.currentNode;i!==r&&t("current-change",r?r.data:null,r)},Gv=e=>{let t=!0,n=!0,i=!0;for(let r=0,o=e.length;r<o;r++){const o=e[r];(!0!==o.checked||o.indeterminate)&&(t=!1,o.disabled||(i=!1)),(!1!==o.checked||o.indeterminate)&&(n=!1)}return{all:t,none:n,allWithoutDisable:i,half:!t&&!n}},Wv=function(e){if(0===e.childNodes.length||e.loading)return;const{all:t,none:n,half:i}=Gv(e.childNodes);t?(e.checked=!0,e.indeterminate=!1):i?(e.checked=!1,e.indeterminate=!0):n&&(e.checked=!1,e.indeterminate=!1);const r=e.parent;r&&0!==r.level&&(e.store.checkStrictly||Wv(r))},Xv=function(e,t){const n=e.store.props,i=e.data||{},r=n[t];if("function"==typeof r)return r(i,e);if("string"==typeof r)return i[r];if(void 0===r){const e=i[t];return void 0===e?"":e}};let $v=0;class qv{constructor(e){this.id=$v++,this.text=null,this.checked=!1,this.indeterminate=!1,this.data=null,this.expanded=!1,this.parent=null,this.visible=!0,this.isCurrent=!1,this.canFocus=!1;for(const t in e)Ki(e,t)&&(this[t]=e[t]);this.level=0,this.loaded=!1,this.childNodes=[],this.loading=!1,this.parent&&(this.level=this.parent.level+1)}initialize(){const e=this.store;if(!e)throw new Error("[Node]store is required!");e.registerNode(this);const t=e.props;if(t&&void 0!==t.isLeaf){const e=Xv(this,"isLeaf");"boolean"==typeof e&&(this.isLeafByUser=e)}if(!0!==e.lazy&&this.data?(this.setData(this.data),e.defaultExpandAll&&(this.expanded=!0,this.canFocus=!0)):this.level>0&&e.lazy&&e.defaultExpandAll&&this.expand(),Array.isArray(this.data)||zv(this,this.data),!this.data)return;const n=e.defaultExpandedKeys,i=e.key;i&&n&&n.includes(this.key)&&this.expand(null,e.autoExpandParent),i&&void 0!==e.currentNodeKey&&this.key===e.currentNodeKey&&(e.currentNode=this,e.currentNode.isCurrent=!0),e.lazy&&e._initDefaultCheckedNode(this),this.updateLeafState(),!this.parent||1!==this.level&&!0!==this.parent.expanded||(this.canFocus=!0)}setData(e){let t;Array.isArray(e)||zv(this,e),this.data=e,this.childNodes=[],t=0===this.level&&Array.isArray(this.data)?this.data:Xv(this,"children")||[];for(let n=0,i=t.length;n<i;n++)this.insertChild({data:t[n]})}get label(){return Xv(this,"label")}get key(){const e=this.store.key;return this.data?this.data[e]:null}get disabled(){return Xv(this,"disabled")}get nextSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return e.childNodes[t+1]}return null}get previousSibling(){const e=this.parent;if(e){const t=e.childNodes.indexOf(this);if(t>-1)return t>0?e.childNodes[t-1]:null}return null}contains(e,t=!0){return(this.childNodes||[]).some((n=>n===e||t&&n.contains(e)))}remove(){const e=this.parent;e&&e.removeChild(this)}insertChild(e,t,n){if(!e)throw new Error("InsertChild error: child is required.");if(!(e instanceof qv)){if(!n){const n=this.getChildren(!0);n.includes(e.data)||(void 0===t||t<0?n.push(e.data):n.splice(t,0,e.data))}Object.assign(e,{parent:this,store:this.store}),(e=zi(new qv(e)))instanceof qv&&e.initialize()}e.level=this.level+1,void 0===t||t<0?this.childNodes.push(e):this.childNodes.splice(t,0,e),this.updateLeafState()}insertBefore(e,t){let n;t&&(n=this.childNodes.indexOf(t)),this.insertChild(e,n)}insertAfter(e,t){let n;t&&(n=this.childNodes.indexOf(t),-1!==n&&(n+=1)),this.insertChild(e,n)}removeChild(e){const t=this.getChildren()||[],n=t.indexOf(e.data);n>-1&&t.splice(n,1);const i=this.childNodes.indexOf(e);i>-1&&(this.store&&this.store.deregisterNode(e),e.parent=null,this.childNodes.splice(i,1)),this.updateLeafState()}removeChildByData(e){let t=null;for(let n=0;n<this.childNodes.length;n++)if(this.childNodes[n].data===e){t=this.childNodes[n];break}t&&this.removeChild(t)}expand(e,t){const n=()=>{if(t){let e=this.parent;for(;e.level>0;)e.expanded=!0,e=e.parent}this.expanded=!0,e&&e(),this.childNodes.forEach((e=>{e.canFocus=!0}))};this.shouldLoadData()?this.loadData((e=>{Array.isArray(e)&&(this.checked?this.setChecked(!0,!0):this.store.checkStrictly||Wv(this),n())})):n()}doCreateChildren(e,t={}){e.forEach((e=>{this.insertChild(Object.assign({data:e},t),void 0,!0)}))}collapse(){this.expanded=!1,this.childNodes.forEach((e=>{e.canFocus=!1}))}shouldLoadData(){return!0===this.store.lazy&&this.store.load&&!this.loaded}updateLeafState(){if(!0===this.store.lazy&&!0!==this.loaded&&void 0!==this.isLeafByUser)return void(this.isLeaf=this.isLeafByUser);const e=this.childNodes;!this.store.lazy||!0===this.store.lazy&&!0===this.loaded?this.isLeaf=!e||0===e.length:this.isLeaf=!1}setChecked(e,t,n,i){if(this.indeterminate="half"===e,this.checked=!0===e,this.store.checkStrictly)return;if(!this.shouldLoadData()||this.store.checkDescendants){const{all:n,allWithoutDisable:r}=Gv(this.childNodes);this.isLeaf||n||!r||(this.checked=!1,e=!1);const o=()=>{if(t){const n=this.childNodes;for(let a=0,s=n.length;a<s;a++){const r=n[a];i=i||!1!==e;const o=r.disabled?r.checked:i;r.setChecked(o,t,!0,i)}const{half:r,all:o}=Gv(n);o||(this.checked=o,this.indeterminate=r)}};if(this.shouldLoadData())return void this.loadData((()=>{o(),Wv(this)}),{checked:!1!==e});o()}const r=this.parent;r&&0!==r.level&&(n||Wv(r))}getChildren(e=!1){if(0===this.level)return this.data;const t=this.data;if(!t)return null;const n=this.store.props;let i="children";return n&&(i=n.children||"children"),void 0===t[i]&&(t[i]=null),e&&!t[i]&&(t[i]=[]),t[i]}updateChildren(){const e=this.getChildren()||[],t=this.childNodes.map((e=>e.data)),n={},i=[];e.forEach(((e,r)=>{const o=e[Uv];!!o&&t.findIndex((e=>e[Uv]===o))>=0?n[o]={index:r,data:e}:i.push({index:r,data:e})})),this.store.lazy||t.forEach((e=>{n[e[Uv]]||this.removeChildByData(e)})),i.forEach((({index:e,data:t})=>{this.insertChild({data:t},e)})),this.updateLeafState()}loadData(e,t={}){if(!0!==this.store.lazy||!this.store.load||this.loaded||this.loading&&!Object.keys(t).length)e&&e.call(this);else{this.loading=!0;const n=n=>{this.childNodes=[],this.doCreateChildren(n,t),this.loaded=!0,this.loading=!1,this.updateLeafState(),e&&e.call(this,n)},i=()=>{this.loading=!1};this.store.load(this,n,i)}}eachNode(e){const t=[this];for(;t.length;){const n=t.shift();t.unshift(...n.childNodes),e(n)}}reInitChecked(){this.store.checkStrictly||Wv(this)}}class Kv{constructor(e){this.currentNode=null,this.currentNodeKey=null;for(const t in e)Ki(e,t)&&(this[t]=e[t]);this.nodesMap={}}initialize(){if(this.root=new qv({data:this.data,store:this}),this.root.initialize(),this.lazy&&this.load){(0,this.load)(this.root,(e=>{this.root.doCreateChildren(e),this._initDefaultCheckedNodes()}))}else this._initDefaultCheckedNodes()}filter(e){const t=this.filterNodeMethod,n=this.lazy,i=function(r){const o=r.root?r.root.childNodes:r.childNodes;if(o.forEach((n=>{n.visible=t.call(n,e,n.data,n),i(n)})),!r.visible&&o.length){let e=!0;e=!o.some((e=>e.visible)),r.root?r.root.visible=!1===e:r.visible=!1===e}e&&r.visible&&!r.isLeaf&&(n&&!r.loaded||r.expand())};i(this)}setData(e){e!==this.root.data?(this.root.setData(e),this._initDefaultCheckedNodes()):this.root.updateChildren()}getNode(e){if(e instanceof qv)return e;const t=Oi(e)?Hv(this.key,e):e;return this.nodesMap[t]||null}insertBefore(e,t){const n=this.getNode(t);n.parent.insertBefore({data:e},n)}insertAfter(e,t){const n=this.getNode(t);n.parent.insertAfter({data:e},n)}remove(e){const t=this.getNode(e);t&&t.parent&&(t===this.currentNode&&(this.currentNode=null),t.parent.removeChild(t))}append(e,t){const n=Fe(t)?this.root:this.getNode(t);n&&n.insertChild({data:e})}_initDefaultCheckedNodes(){const e=this.defaultCheckedKeys||[],t=this.nodesMap;e.forEach((e=>{const n=t[e];n&&n.setChecked(!0,!this.checkStrictly)}))}_initDefaultCheckedNode(e){(this.defaultCheckedKeys||[]).includes(e.key)&&e.setChecked(!0,!this.checkStrictly)}setDefaultCheckedKey(e){e!==this.defaultCheckedKeys&&(this.defaultCheckedKeys=e,this._initDefaultCheckedNodes())}registerNode(e){const t=this.key;if(e&&e.data)if(t){void 0!==e.key&&(this.nodesMap[e.key]=e)}else this.nodesMap[e.id]=e}deregisterNode(e){this.key&&e&&e.data&&(e.childNodes.forEach((e=>{this.deregisterNode(e)})),delete this.nodesMap[e.key])}getCheckedNodes(e=!1,t=!1){const n=[],i=function(r){(r.root?r.root.childNodes:r.childNodes).forEach((r=>{(r.checked||t&&r.indeterminate)&&(!e||e&&r.isLeaf)&&n.push(r.data),i(r)}))};return i(this),n}getCheckedKeys(e=!1){return this.getCheckedNodes(e).map((e=>(e||{})[this.key]))}getHalfCheckedNodes(){const e=[],t=function(n){(n.root?n.root.childNodes:n.childNodes).forEach((n=>{n.indeterminate&&e.push(n.data),t(n)}))};return t(this),e}getHalfCheckedKeys(){return this.getHalfCheckedNodes().map((e=>(e||{})[this.key]))}_getAllNodes(){const e=[],t=this.nodesMap;for(const n in t)Ki(t,n)&&e.push(t[n]);return e}updateChildren(e,t){const n=this.nodesMap[e];if(!n)return;const i=n.childNodes;for(let r=i.length-1;r>=0;r--){const e=i[r];this.remove(e.data)}for(let r=0,o=t.length;r<o;r++){const e=t[r];this.append(e,n.data)}}_setCheckedKeys(e,t=!1,n){const i=this._getAllNodes().sort(((e,t)=>e.level-t.level)),r=Object.create(null),o=Object.keys(n);i.forEach((e=>e.setChecked(!1,!1)));const a=t=>{t.childNodes.forEach((t=>{var n;r[t.data[e]]=!0,(null==(n=t.childNodes)?void 0:n.length)&&a(t)}))};for(let s=0,l=i.length;s<l;s++){const n=i[s],l=n.data[e].toString();if(o.includes(l)){if(n.childNodes.length&&a(n),n.isLeaf||this.checkStrictly)n.setChecked(!0,!1);else if(n.setChecked(!0,!0),t){n.setChecked(!1,!1);const e=function(t){t.childNodes.forEach((t=>{t.isLeaf||t.setChecked(!1,!1),e(t)}))};e(n)}}else n.checked&&!r[l]&&n.setChecked(!1,!1)}}setCheckedNodes(e,t=!1){const n=this.key,i={};e.forEach((e=>{i[(e||{})[n]]=!0})),this._setCheckedKeys(n,t,i)}setCheckedKeys(e,t=!1){this.defaultCheckedKeys=e;const n=this.key,i={};e.forEach((e=>{i[e]=!0})),this._setCheckedKeys(n,t,i)}setDefaultExpandedKeys(e){e=e||[],this.defaultExpandedKeys=e,e.forEach((e=>{const t=this.getNode(e);t&&t.expand(null,this.autoExpandParent)}))}setChecked(e,t,n){const i=this.getNode(e);i&&i.setChecked(!!t,n)}getCurrentNode(){return this.currentNode}setCurrentNode(e){const t=this.currentNode;t&&(t.isCurrent=!1),this.currentNode=e,this.currentNode.isCurrent=!0}setUserCurrentNode(e,t=!0){const n=e[this.key],i=this.nodesMap[n];this.setCurrentNode(i),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0)}setCurrentNodeKey(e,t=!0){if(null==e)return this.currentNode&&(this.currentNode.isCurrent=!1),void(this.currentNode=null);const n=this.getNode(e);n&&(this.setCurrentNode(n),t&&this.currentNode.level>1&&this.currentNode.parent.expand(null,!0))}}var Jv=_e(ai({name:"ElTreeNodeContent",props:{node:{type:Object,required:!0},renderContent:Function},setup(e){const t=xe("tree"),n=gi("NodeInstance"),i=gi("RootTree");return()=>{const r=e.node,{data:o,store:a}=r;return e.renderContent?e.renderContent(hr,{_self:n,node:r,data:o,store:a}):di(i.ctx.slots,"default",{node:r,data:o},(()=>[hr("span",{class:t.be("node","label")},[r.label])]))}}}),[["__file","tree-node-content.vue"]]);function Zv(e){const t=gi("TreeNodeMap",null),n={treeNodeExpand:t=>{e.node!==t&&e.node.collapse()},children:[]};return t&&t.children.push(n),li("TreeNodeMap",n),{broadcastExpanded:t=>{if(e.accordion)for(const e of n.children)e.treeNodeExpand(t)}}}const eA=Symbol("dragEvents");const tA=ai({name:"ElTreeNode",components:{ElCollapseTransition:Lp,ElCheckbox:Wf,NodeContent:Jv,ElIcon:Se,Loading:Rt},props:{node:{type:qv,default:()=>({})},props:{type:Object,default:()=>({})},accordion:Boolean,renderContent:Function,renderAfterExpand:Boolean,showCheckbox:{type:Boolean,default:!1}},emits:["node-expand"],setup(e,t){const n=xe("tree"),{broadcastExpanded:i}=Zv(e),r=gi("RootTree"),o=si(!1),a=si(!1),s=si(null),l=si(null),c=si(null),u=gi(eA),h=Ci();li("NodeInstance",h),e.node.expanded&&(o.value=!0,a.value=!0);const d=r.props.props.children||"children";Ii((()=>{const t=e.node.data[d];return t&&[...t]}),(()=>{e.node.updateChildren()})),Ii((()=>e.node.indeterminate),(t=>{f(e.node.checked,t)})),Ii((()=>e.node.checked),(t=>{f(t,e.node.indeterminate)})),Ii((()=>e.node.childNodes.length),(()=>e.node.reInitChecked())),Ii((()=>e.node.expanded),(e=>{ki((()=>o.value=e)),e&&(a.value=!0)}));const f=(t,n)=>{s.value===t&&l.value===n||r.ctx.emit("check-change",e.node.data,t,n),s.value=t,l.value=n},p=()=>{e.node.isLeaf||(o.value?(r.ctx.emit("node-collapse",e.node.data,e.node,h),e.node.collapse()):(e.node.expand(),t.emit("node-expand",e.node.data,e.node,h)))},g=(t,n)=>{e.node.setChecked(n.target.checked,!r.props.checkStrictly),ki((()=>{const t=r.store.value;r.ctx.emit("check",e.node.data,{checkedNodes:t.getCheckedNodes(),checkedKeys:t.getCheckedKeys(),halfCheckedNodes:t.getHalfCheckedNodes(),halfCheckedKeys:t.getHalfCheckedKeys()})}))};return{ns:n,node$:c,tree:r,expanded:o,childNodeRendered:a,oldChecked:s,oldIndeterminate:l,getNodeKey:e=>Hv(r.props.nodeKey,e.data),getNodeClass:t=>{const n=e.props.class;if(!n)return{};let i;if(_i(n)){const{data:e}=t;i=n(e,t)}else i=n;return Ei(i)?{[i]:!0}:i},handleSelectChange:f,handleClick:t=>{Yv(r.store,r.ctx.emit,(()=>r.store.value.setCurrentNode(e.node))),r.currentNode.value=e.node,r.props.expandOnClickNode&&p(),r.props.checkOnClickNode&&!e.node.disabled&&g(null,{target:{checked:!e.node.checked}}),r.ctx.emit("node-click",e.node.data,e.node,h,t)},handleContextMenu:t=>{r.instance.vnode.props.onNodeContextmenu&&(t.stopPropagation(),t.preventDefault()),r.ctx.emit("node-contextmenu",t,e.node.data,e.node,h)},handleExpandIconClick:p,handleCheckChange:g,handleChildNodeExpand:(e,t,n)=>{i(t),r.ctx.emit("node-expand",e,t,n)},handleDragStart:t=>{r.props.draggable&&u.treeNodeDragStart({event:t,treeNode:e})},handleDragOver:t=>{t.preventDefault(),r.props.draggable&&u.treeNodeDragOver({event:t,treeNode:{$el:c.value,node:e.node}})},handleDrop:e=>{e.preventDefault()},handleDragEnd:e=>{r.props.draggable&&u.treeNodeDragEnd(e)},CaretRight:Vt}}}),nA=["aria-expanded","aria-disabled","aria-checked","draggable","data-key"],iA=["aria-expanded"];var rA=_e(ai({name:"ElTree",components:{ElTreeNode:_e(tA,[["render",function(e,t,n,i,r,o){const a=sr("el-icon"),s=sr("el-checkbox"),l=sr("loading"),c=sr("node-content"),u=sr("el-tree-node"),h=sr("el-collapse-transition");return Mi((ui(),hi("div",{ref:"node$",class:fi([e.ns.b("node"),e.ns.is("expanded",e.expanded),e.ns.is("current",e.node.isCurrent),e.ns.is("hidden",!e.node.visible),e.ns.is("focusable",!e.node.disabled),e.ns.is("checked",!e.node.disabled&&e.node.checked),e.getNodeClass(e.node)]),role:"treeitem",tabindex:"-1","aria-expanded":e.expanded,"aria-disabled":e.node.disabled,"aria-checked":e.node.checked,draggable:e.tree.props.draggable,"data-key":e.getNodeKey(e.node),onClick:t[1]||(t[1]=Li(((...t)=>e.handleClick&&e.handleClick(...t)),["stop"])),onContextmenu:t[2]||(t[2]=(...t)=>e.handleContextMenu&&e.handleContextMenu(...t)),onDragstart:t[3]||(t[3]=Li(((...t)=>e.handleDragStart&&e.handleDragStart(...t)),["stop"])),onDragover:t[4]||(t[4]=Li(((...t)=>e.handleDragOver&&e.handleDragOver(...t)),["stop"])),onDragend:t[5]||(t[5]=Li(((...t)=>e.handleDragEnd&&e.handleDragEnd(...t)),["stop"])),onDrop:t[6]||(t[6]=Li(((...t)=>e.handleDrop&&e.handleDrop(...t)),["stop"]))},[vi("div",{class:fi(e.ns.be("node","content")),style:Ni({paddingLeft:(e.node.level-1)*e.tree.props.indent+"px"})},[e.tree.props.icon||e.CaretRight?(ui(),Ai(a,{key:0,class:fi([e.ns.be("node","expand-icon"),e.ns.is("leaf",e.node.isLeaf),{expanded:!e.node.isLeaf&&e.expanded}]),onClick:Li(e.handleExpandIconClick,["stop"])},{default:mi((()=>[(ui(),Ai(yi(e.tree.props.icon||e.CaretRight)))])),_:1},8,["class","onClick"])):Fi("v-if",!0),e.showCheckbox?(ui(),Ai(s,{key:1,"model-value":e.node.checked,indeterminate:e.node.indeterminate,disabled:!!e.node.disabled,onClick:t[0]||(t[0]=Li((()=>{}),["stop"])),onChange:e.handleCheckChange},null,8,["model-value","indeterminate","disabled","onChange"])):Fi("v-if",!0),e.node.loading?(ui(),Ai(a,{key:2,class:fi([e.ns.be("node","loading-icon"),e.ns.is("loading")])},{default:mi((()=>[Hi(l)])),_:1},8,["class"])):Fi("v-if",!0),Hi(c,{node:e.node,"render-content":e.renderContent},null,8,["node","render-content"])],6),Hi(h,null,{default:mi((()=>[!e.renderAfterExpand||e.childNodeRendered?Mi((ui(),hi("div",{key:0,class:fi(e.ns.be("node","children")),role:"group","aria-expanded":e.expanded},[(ui(!0),hi(ji,null,Zi(e.node.childNodes,(t=>(ui(),Ai(u,{key:e.getNodeKey(t),"render-content":e.renderContent,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,node:t,accordion:e.accordion,props:e.props,onNodeExpand:e.handleChildNodeExpand},null,8,["render-content","render-after-expand","show-checkbox","node","accordion","props","onNodeExpand"])))),128))],10,iA)),[[$i,e.expanded]]):Fi("v-if",!0)])),_:1})],42,nA)),[[$i,e.node.visible]])}],["__file","tree-node.vue"]])},props:{data:{type:Array,default:()=>[]},emptyText:{type:String},renderAfterExpand:{type:Boolean,default:!0},nodeKey:String,checkStrictly:Boolean,defaultExpandAll:Boolean,expandOnClickNode:{type:Boolean,default:!0},checkOnClickNode:Boolean,checkDescendants:{type:Boolean,default:!1},autoExpandParent:{type:Boolean,default:!0},defaultCheckedKeys:Array,defaultExpandedKeys:Array,currentNodeKey:[String,Number],renderContent:Function,showCheckbox:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},allowDrag:Function,allowDrop:Function,props:{type:Object,default:()=>({children:"children",label:"label",disabled:"disabled"})},lazy:{type:Boolean,default:!1},highlightCurrent:Boolean,load:Function,filterNodeMethod:Function,accordion:Boolean,indent:{type:Number,default:18},icon:{type:Ce}},emits:["check-change","current-change","node-click","node-contextmenu","node-collapse","node-expand","check","node-drag-start","node-drag-end","node-drop","node-drag-leave","node-drag-enter","node-drag-over"],setup(e,t){const{t:n}=we(),i=xe("tree"),r=gi(Fg,null),o=si(new Kv({key:e.nodeKey,data:e.data,lazy:e.lazy,props:e.props,load:e.load,currentNodeKey:e.currentNodeKey,checkStrictly:e.checkStrictly,checkDescendants:e.checkDescendants,defaultCheckedKeys:e.defaultCheckedKeys,defaultExpandedKeys:e.defaultExpandedKeys,autoExpandParent:e.autoExpandParent,defaultExpandAll:e.defaultExpandAll,filterNodeMethod:e.filterNodeMethod}));o.value.initialize();const a=si(o.value.root),s=si(null),l=si(null),c=si(null),{broadcastExpanded:u}=Zv(e),{dragState:h}=function({props:e,ctx:t,el$:n,dropIndicator$:i,store:r}){const o=xe("tree"),a=si({showDropIndicator:!1,draggingNode:null,dropNode:null,allowDrop:!0,dropType:null});return li(eA,{treeNodeDragStart:({event:n,treeNode:i})=>{if("function"==typeof e.allowDrag&&!e.allowDrag(i.node))return n.preventDefault(),!1;n.dataTransfer.effectAllowed="move";try{n.dataTransfer.setData("text/plain","")}catch(r){}a.value.draggingNode=i,t.emit("node-drag-start",i.node,n)},treeNodeDragOver:({event:r,treeNode:s})=>{const l=s,c=a.value.dropNode;c&&c.node.id!==l.node.id&&Ft(c.$el,o.is("drop-inner"));const u=a.value.draggingNode;if(!u||!l)return;let h=!0,d=!0,f=!0,p=!0;"function"==typeof e.allowDrop&&(h=e.allowDrop(u.node,l.node,"prev"),p=d=e.allowDrop(u.node,l.node,"inner"),f=e.allowDrop(u.node,l.node,"next")),r.dataTransfer.dropEffect=d||h||f?"move":"none",(h||d||f)&&(null==c?void 0:c.node.id)!==l.node.id&&(c&&t.emit("node-drag-leave",u.node,c.node,r),t.emit("node-drag-enter",u.node,l.node,r)),a.value.dropNode=h||d||f?l:null,l.node.nextSibling===u.node&&(f=!1),l.node.previousSibling===u.node&&(h=!1),l.node.contains(u.node,!1)&&(d=!1),(u.node===l.node||u.node.contains(l.node))&&(h=!1,d=!1,f=!1);const g=l.$el.querySelector(`.${o.be("node","content")}`).getBoundingClientRect(),v=n.value.getBoundingClientRect();let A;const m=h?d?.25:f?.45:1:-1,y=f?d?.75:h?.55:0:1;let b=-9999;const C=r.clientY-g.top;A=C<g.height*m?"before":C>g.height*y?"after":d?"inner":"none";const w=l.$el.querySelector(`.${o.be("node","expand-icon")}`).getBoundingClientRect(),x=i.value;"before"===A?b=w.top-v.top:"after"===A&&(b=w.bottom-v.top),x.style.top=`${b}px`,x.style.left=w.right-v.left+"px","inner"===A?Nt(l.$el,o.is("drop-inner")):Ft(l.$el,o.is("drop-inner")),a.value.showDropIndicator="before"===A||"after"===A,a.value.allowDrop=a.value.showDropIndicator||p,a.value.dropType=A,t.emit("node-drag-over",u.node,l.node,r)},treeNodeDragEnd:e=>{const{draggingNode:n,dropType:i,dropNode:s}=a.value;if(e.preventDefault(),e.dataTransfer.dropEffect="move",n&&s){const a={data:n.node.data};"none"!==i&&n.node.remove(),"before"===i?s.node.parent.insertBefore(a,s.node):"after"===i?s.node.parent.insertAfter(a,s.node):"inner"===i&&s.node.insertChild(a),"none"!==i&&(r.value.registerNode(a),r.value.key&&n.node.eachNode((e=>{var t;null==(t=r.value.nodesMap[e.data[r.value.key]])||t.setChecked(e.checked,!r.value.checkStrictly)}))),Ft(s.$el,o.is("drop-inner")),t.emit("node-drag-end",n.node,s.node,i,e),"none"!==i&&t.emit("node-drop",n.node,s.node,i,e)}n&&!s&&t.emit("node-drag-end",n.node,null,i,e),a.value.showDropIndicator=!1,a.value.draggingNode=null,a.value.dropNode=null,a.value.allowDrop=!0}}),{dragState:a}}({props:e,ctx:t,el$:l,dropIndicator$:c,store:o});!function({el$:e},t){const n=xe("tree"),i=qi([]),r=qi([]);ci((()=>{o()})),rr((()=>{i.value=Array.from(e.value.querySelectorAll("[role=treeitem]")),r.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"))})),Ii(r,(e=>{e.forEach((e=>{e.setAttribute("tabindex","-1")}))})),dt(e,"keydown",(r=>{const o=r.target;if(!o.className.includes(n.b("node")))return;const a=r.code;i.value=Array.from(e.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`));const s=i.value.indexOf(o);let l;if([it.up,it.down].includes(a)){if(r.preventDefault(),a===it.up){l=-1===s?0:0!==s?s-1:i.value.length-1;const e=l;for(;!t.value.getNode(i.value[l].dataset.key).canFocus;){if(l--,l===e){l=-1;break}l<0&&(l=i.value.length-1)}}else{l=-1===s?0:s<i.value.length-1?s+1:0;const e=l;for(;!t.value.getNode(i.value[l].dataset.key).canFocus;){if(l++,l===e){l=-1;break}l>=i.value.length&&(l=0)}}-1!==l&&i.value[l].focus()}[it.left,it.right].includes(a)&&(r.preventDefault(),o.click());const c=o.querySelector('[type="checkbox"]');[it.enter,it.space].includes(a)&&c&&(r.preventDefault(),c.click())}));const o=()=>{var t;i.value=Array.from(e.value.querySelectorAll(`.${n.is("focusable")}[role=treeitem]`)),r.value=Array.from(e.value.querySelectorAll("input[type=checkbox]"));const o=e.value.querySelectorAll(`.${n.is("checked")}[role=treeitem]`);o.length?o[0].setAttribute("tabindex","0"):null==(t=i.value[0])||t.setAttribute("tabindex","0")}}({el$:l},o);const d=Si((()=>{const{childNodes:e}=a.value,t=!!r&&0!==r.hasFilteredOptions;return(!e||0===e.length||e.every((({visible:e})=>!e)))&&!t}));Ii((()=>e.currentNodeKey),(e=>{o.value.setCurrentNodeKey(e)})),Ii((()=>e.defaultCheckedKeys),(e=>{o.value.setDefaultCheckedKey(e)})),Ii((()=>e.defaultExpandedKeys),(e=>{o.value.setDefaultExpandedKeys(e)})),Ii((()=>e.data),(e=>{o.value.setData(e)}),{deep:!0}),Ii((()=>e.checkStrictly),(e=>{o.value.checkStrictly=e}));const f=()=>{const e=o.value.getCurrentNode();return e?e.data:null};return li("RootTree",{ctx:t,props:e,store:o,root:a,currentNode:s,instance:Ci()}),li(Ut,void 0),{ns:i,store:o,root:a,currentNode:s,dragState:h,el$:l,dropIndicator$:c,isEmpty:d,filter:t=>{if(!e.filterNodeMethod)throw new Error("[Tree] filterNodeMethod is required when filter");o.value.filter(t)},getNodeKey:t=>Hv(e.nodeKey,t.data),getNodePath:t=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getNodePath");const n=o.value.getNode(t);if(!n)return[];const i=[n.data];let r=n.parent;for(;r&&r!==a.value;)i.push(r.data),r=r.parent;return i.reverse()},getCheckedNodes:(e,t)=>o.value.getCheckedNodes(e,t),getCheckedKeys:e=>o.value.getCheckedKeys(e),getCurrentNode:f,getCurrentKey:()=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in getCurrentKey");const t=f();return t?t[e.nodeKey]:null},setCheckedNodes:(t,n)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedNodes");o.value.setCheckedNodes(t,n)},setCheckedKeys:(t,n)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCheckedKeys");o.value.setCheckedKeys(t,n)},setChecked:(e,t,n)=>{o.value.setChecked(e,t,n)},getHalfCheckedNodes:()=>o.value.getHalfCheckedNodes(),getHalfCheckedKeys:()=>o.value.getHalfCheckedKeys(),setCurrentNode:(n,i=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentNode");Yv(o,t.emit,(()=>o.value.setUserCurrentNode(n,i)))},setCurrentKey:(n,i=!0)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in setCurrentKey");Yv(o,t.emit,(()=>o.value.setCurrentNodeKey(n,i)))},t:n,getNode:e=>o.value.getNode(e),remove:e=>{o.value.remove(e)},append:(e,t)=>{o.value.append(e,t)},insertBefore:(e,t)=>{o.value.insertBefore(e,t)},insertAfter:(e,t)=>{o.value.insertAfter(e,t)},handleNodeExpand:(e,n,i)=>{u(n),t.emit("node-expand",e,n,i)},updateKeyChildren:(t,n)=>{if(!e.nodeKey)throw new Error("[Tree] nodeKey is required in updateKeyChild");o.value.updateChildren(t,n)}}}}),[["render",function(e,t,n,i,r,o){const a=sr("el-tree-node");return ui(),hi("div",{ref:"el$",class:fi([e.ns.b(),e.ns.is("dragging",!!e.dragState.draggingNode),e.ns.is("drop-not-allow",!e.dragState.allowDrop),e.ns.is("drop-inner","inner"===e.dragState.dropType),{[e.ns.m("highlight-current")]:e.highlightCurrent}]),role:"tree"},[(ui(!0),hi(ji,null,Zi(e.root.childNodes,(t=>(ui(),Ai(a,{key:e.getNodeKey(t),node:t,props:e.props,accordion:e.accordion,"render-after-expand":e.renderAfterExpand,"show-checkbox":e.showCheckbox,"render-content":e.renderContent,onNodeExpand:e.handleNodeExpand},null,8,["node","props","accordion","render-after-expand","show-checkbox","render-content","onNodeExpand"])))),128)),e.isEmpty?(ui(),hi("div",{key:0,class:fi(e.ns.e("empty-block"))},[di(e.$slots,"empty",{},(()=>{var t;return[vi("span",{class:fi(e.ns.e("empty-text"))},bi(null!=(t=e.emptyText)?t:e.t("el.tree.emptyText")),3)]}))],2)):Fi("v-if",!0),Mi(vi("div",{ref:"dropIndicator$",class:fi(e.ns.e("drop-indicator"))},null,2),[[$i,e.dragState.showDropIndicator]])],2)}],["__file","tree.vue"]]);rA.install=e=>{e.component(rA.name,rA)};const oA=rA,aA=ai({extends:tv,setup(e,t){const n=tv.setup(e,t);delete n.selectOptionClick;const i=Ci().proxy;return ki((()=>{n.select.states.cachedOptions.get(i.value)||n.select.onOptionCreate(i)})),Ii((()=>t.attrs.visible),(e=>{n.states.visible=e}),{immediate:!0}),n},methods:{selectOptionClick(){this.$el.parentElement.click()}}});function sA(e){return e||0===e}function lA(e){return Array.isArray(e)&&e.length}function cA(e){return Array.isArray(e)?e:sA(e)?[e]:[]}function uA(e,t,n,i,r){for(let o=0;o<e.length;o++){const a=e[o];if(t(a,o,e,r))return i?i(a,o,e,r):a;{const e=n(a);if(lA(e)){const r=uA(e,t,n,i,a);if(r)return r}}}}function hA(e,t,n,i){for(let r=0;r<e.length;r++){const o=e[r];t(o,r,e,i);const a=n(o);lA(a)&&hA(a,t,n,o)}}var dA=ai({props:{data:{type:Array,default:()=>[]}},setup(e){const t=gi(Fg);return Ii((()=>e.data),(()=>{var n;e.data.forEach((e=>{t.states.cachedOptions.has(e.value)||t.states.cachedOptions.set(e.value,e)}));const i=(null==(n=t.selectRef)?void 0:n.querySelectorAll("input"))||[];ye&&!Array.from(i).includes(document.activeElement)&&t.setSelected()}),{flush:"post",immediate:!0}),()=>{}}});const fA=ai({name:"ElTreeSelect",inheritAttrs:!1,props:c(l(l({},ev.props),oA.props),{cacheData:{type:Array,default:()=>[]}}),setup(e,t){const{slots:n,expose:a}=t,s=si(),u=si(),h=Si((()=>e.nodeKey||e.valueKey||"value")),d=((e,{attrs:t,emit:n},{select:i,tree:r,key:o})=>{const a=xe("tree-select");return Ii((()=>e.data),(()=>{e.filterable&&ki((()=>{var e,t;null==(t=r.value)||t.filter(null==(e=i.value)?void 0:e.states.inputValue)}))}),{flush:"post"}),c(l(l({},Ae(Vi(e),Object.keys(ev.props))),t),{"onUpdate:modelValue":e=>n(De,e),valueKey:o,popperClass:Si((()=>{const t=[a.e("popper")];return e.popperClass&&t.push(e.popperClass),t.join(" ")})),filterMethod:(t="")=>{var n;e.filterMethod?e.filterMethod(t):e.remoteMethod?e.remoteMethod(t):null==(n=r.value)||n.filter(t)}})})(e,t,{select:s,tree:u,key:h}),f=((e,{attrs:t,slots:n,emit:i},{select:r,tree:o,key:a})=>{Ii((()=>e.modelValue),(()=>{e.showCheckbox&&ki((()=>{const t=o.value;t&&!Vc(t.getCheckedKeys(),cA(e.modelValue))&&t.setCheckedKeys(cA(e.modelValue))}))}),{immediate:!0,deep:!0});const s=Si((()=>l({value:a.value,label:"label",children:"children",disabled:"disabled",isLeaf:"isLeaf"},e.props))),u=(e,t)=>{var n;const i=s.value[e];return _i(i)?i(t,null==(n=o.value)?void 0:n.getNode(u("value",t))):t[i]},h=cA(e.modelValue).map((t=>uA(e.data||[],(e=>u("value",e)===t),(e=>u("children",e)),((e,t,n,i)=>i&&u("value",i))))).filter((e=>sA(e))),d=Si((()=>{if(!e.renderAfterExpand&&!e.lazy)return[];const t=[];return hA(e.data.concat(e.cacheData),(e=>{const n=u("value",e);t.push({value:n,currentLabel:u("label",e),isDisabled:u("disabled",e)})}),(e=>u("children",e))),t}));return c(l(l({},Ae(Vi(e),Object.keys(oA.props))),t),{nodeKey:a,expandOnClickNode:Si((()=>!e.checkStrictly&&e.expandOnClickNode)),defaultExpandedKeys:Si((()=>e.defaultExpandedKeys?e.defaultExpandedKeys.concat(h):h)),renderContent:(t,{node:i,data:r,store:o})=>t(aA,{value:u("value",r),label:u("label",r),disabled:u("disabled",r),visible:i.visible},e.renderContent?()=>e.renderContent(t,{node:i,data:r,store:o}):n.default?()=>n.default({node:i,data:r,store:o}):void 0),filterNodeMethod:(t,n,i)=>e.filterNodeMethod?e.filterNodeMethod(t,n,i):!t||new RegExp(wt(t),"i").test(u("label",n)||""),onNodeClick:(n,i,o)=>{var a,s,l,c;if(null==(a=t.onNodeClick)||a.call(t,n,i,o),!e.showCheckbox||!e.checkOnClickNode){if(e.showCheckbox||!e.checkStrictly&&!i.isLeaf)e.expandOnClickNode&&o.proxy.handleExpandIconClick();else if(!u("disabled",n)){const e=null==(s=r.value)?void 0:s.states.options.get(u("value",n));null==(l=r.value)||l.handleOptionSelect(e)}null==(c=r.value)||c.focus()}},onCheck:(n,a)=>{var s;if(!e.showCheckbox)return;const l=u("value",n),c={};hA([o.value.store.root],(e=>c[e.key]=e),(e=>e.childNodes));const h=a.checkedKeys,d=e.multiple?cA(e.modelValue).filter((e=>!(e in c)&&!h.includes(e))):[],f=d.concat(h);if(e.checkStrictly)i(De,e.multiple?f:f.includes(l)?l:void 0);else if(e.multiple)i(De,d.concat(o.value.getCheckedKeys(!0)));else{const t=uA([n],(e=>!lA(u("children",e))&&!u("disabled",e)),(e=>u("children",e))),r=t?u("value",t):void 0,o=sA(e.modelValue)&&!!uA([n],(t=>u("value",t)===e.modelValue),(e=>u("children",e)));i(De,r===e.modelValue||o?void 0:r)}ki((()=>{var i;const r=cA(e.modelValue);o.value.setCheckedKeys(r),null==(i=t.onCheck)||i.call(t,n,{checkedKeys:o.value.getCheckedKeys(),checkedNodes:o.value.getCheckedNodes(),halfCheckedKeys:o.value.getHalfCheckedKeys(),halfCheckedNodes:o.value.getHalfCheckedNodes()})})),null==(s=r.value)||s.focus()},cacheOptions:d})})(e,t,{select:s,tree:u,key:h}),{cacheOptions:p}=f,g=((e,t)=>{var n={};for(var a in e)r.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&i)for(var a of i(e))t.indexOf(a)<0&&o.call(e,a)&&(n[a]=e[a]);return n})(f,["cacheOptions"]),v=zi({});return a(v),ci((()=>{Object.assign(v,l(l({},Ae(u.value,["filter","updateKeyChildren","getCheckedNodes","setCheckedNodes","getCheckedKeys","setCheckedKeys","setChecked","getHalfCheckedNodes","getHalfCheckedKeys","getCurrentKey","getCurrentNode","setCurrentKey","setCurrentNode","getNode","remove","append","insertBefore","insertAfter"])),Ae(s.value,["focus","blur"])))})),()=>hr(ev,zi(c(l({},d),{ref:e=>s.value=e})),c(l({},n),{default:()=>[hr(dA,{data:p.value}),hr(oA,zi(c(l({},g),{ref:e=>u.value=e})))]}))}});var pA=_e(fA,[["__file","tree-select.vue"]]);pA.install=e=>{e.component(pA.name,pA)};const gA=pA;var vA={};!function(e){
/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */
var t,n,i,r,o,a,s,l,c,u,h,d,f,p,g,v,A,m,y,b,C,w=w||{version:"5.3.0"};if(e.fabric=w,"undefined"!=typeof document&&"undefined"!=typeof window)document instanceof("undefined"!=typeof HTMLDocument?HTMLDocument:Document)?w.document=document:w.document=document.implementation.createHTMLDocument(""),w.window=window;else{var x=new zt.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;w.document=x.document,w.jsdomImplForWrapper=zt.implForWrapper,w.nodeCanvas=zt.Canvas,w.window=x,DOMParser=w.window.DOMParser}function _(e,t){var n=e.canvas,i=t.targetCanvas,r=i.getContext("2d");r.translate(0,i.height),r.scale(1,-1);var o=n.height-i.height;r.drawImage(n,0,o,i.width,i.height,0,0,i.width,i.height)}function E(e,t){var n=t.targetCanvas.getContext("2d"),i=t.destinationWidth,r=t.destinationHeight,o=i*r*4,a=new Uint8Array(this.imageBuffer,0,o),s=new Uint8ClampedArray(this.imageBuffer,0,o);e.readPixels(0,0,i,r,e.RGBA,e.UNSIGNED_BYTE,a);var l=new ImageData(s,i,r);n.putImageData(l,0,0)}w.isTouchSupported="ontouchstart"in w.window||"ontouchstart"in w.document||w.window&&w.window.navigator&&w.window.navigator.maxTouchPoints>0,w.isLikelyNode="undefined"!=typeof Buffer&&"undefined"==typeof window,w.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],w.DPI=96,w.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",w.commaWsp="(?:\\s+,?\\s*|,\\s*)",w.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,w.reNonWord=/[ \n\.,;!\?\-]/,w.fontPaths={},w.iMatrix=[1,0,0,1,0,0],w.svgNS="http://www.w3.org/2000/svg",w.perfLimitSizeTotal=2097152,w.maxCacheSideLimit=4096,w.minCacheSideLimit=256,w.charWidthsCache={},w.textureSize=2048,w.disableStyleCopyPaste=!1,w.enableGLFiltering=!0,w.devicePixelRatio=w.window.devicePixelRatio||w.window.webkitDevicePixelRatio||w.window.mozDevicePixelRatio||1,w.browserShadowBlurConstant=1,w.arcToSegmentsCache={},w.boundsOfCurveCache={},w.cachesBoundsOfCurve=!0,w.forceGLPutImageData=!1,w.initFilterBackend=function(){return w.enableGLFiltering&&w.isWebglSupported&&w.isWebglSupported(w.textureSize)?new w.WebglFilterBackend({tileSize:w.textureSize}):w.Canvas2dFilterBackend?new w.Canvas2dFilterBackend:void 0},"undefined"!=typeof document&&"undefined"!=typeof window&&(window.fabric=w),function(){function e(e,t){if(this.__eventListeners[e]){var n=this.__eventListeners[e];t?n[n.indexOf(t)]=!1:w.util.array.fill(n,!1)}}function t(e,t){var n=function(){t.apply(this,arguments),this.off(e,n)}.bind(this);this.on(e,n)}w.Observable={fire:function(e,t){if(!this.__eventListeners)return this;var n=this.__eventListeners[e];if(!n)return this;for(var i=0,r=n.length;i<r;i++)n[i]&&n[i].call(this,t||{});return this.__eventListeners[e]=n.filter((function(e){return!1!==e})),this},on:function(e,t){if(this.__eventListeners||(this.__eventListeners={}),1===arguments.length)for(var n in e)this.on(n,e[n]);else this.__eventListeners[e]||(this.__eventListeners[e]=[]),this.__eventListeners[e].push(t);return this},once:function(e,n){if(1===arguments.length)for(var i in e)t.call(this,i,e[i]);else t.call(this,e,n);return this},off:function(t,n){if(!this.__eventListeners)return this;if(0===arguments.length)for(t in this.__eventListeners)e.call(this,t);else if(1===arguments.length&&"object"==typeof arguments[0])for(var i in t)e.call(this,i,t[i]);else e.call(this,t,n);return this}}}(),w.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var e=0,t=arguments.length;e<t;e++)this._onObjectAdded(arguments[e]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(e,t,n){var i=this._objects;return n?i[t]=e:i.splice(t,0,e),this._onObjectAdded&&this._onObjectAdded(e),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var e,t=this._objects,n=!1,i=0,r=arguments.length;i<r;i++)-1!==(e=t.indexOf(arguments[i]))&&(n=!0,t.splice(e,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[i]));return this.renderOnAddRemove&&n&&this.requestRenderAll(),this},forEachObject:function(e,t){for(var n=this.getObjects(),i=0,r=n.length;i<r;i++)e.call(t,n[i],i,n);return this},getObjects:function(e){return void 0===e?this._objects.concat():this._objects.filter((function(t){return t.type===e}))},item:function(e){return this._objects[e]},isEmpty:function(){return 0===this._objects.length},size:function(){return this._objects.length},contains:function(e,t){return this._objects.indexOf(e)>-1||!!t&&this._objects.some((function(t){return"function"==typeof t.contains&&t.contains(e,!0)}))},complexity:function(){return this._objects.reduce((function(e,t){return e+=t.complexity?t.complexity():0}),0)}},w.CommonMethods={_setOptions:function(e){for(var t in e)this.set(t,e[t])},_initGradient:function(e,t){!e||!e.colorStops||e instanceof w.Gradient||this.set(t,new w.Gradient(e))},_initPattern:function(e,t,n){!e||!e.source||e instanceof w.Pattern?n&&n():this.set(t,new w.Pattern(e,n))},_setObject:function(e){for(var t in e)this._set(t,e[t])},set:function(e,t){return"object"==typeof e?this._setObject(e):this._set(e,t),this},_set:function(e,t){this[e]=t},toggle:function(e){var t=this.get(e);return"boolean"==typeof t&&this.set(e,!t),this},get:function(e){return this[e]}},t=e,n=Math.sqrt,i=Math.atan2,r=Math.pow,o=Math.PI/180,a=Math.PI/2,w.util={cos:function(e){if(0===e)return 1;switch(e<0&&(e=-e),e/a){case 1:case 3:return 0;case 2:return-1}return Math.cos(e)},sin:function(e){if(0===e)return 0;var t=1;switch(e<0&&(t=-1),e/a){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(e)},removeFromArray:function(e,t){var n=e.indexOf(t);return-1!==n&&e.splice(n,1),e},getRandomInt:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},degreesToRadians:function(e){return e*o},radiansToDegrees:function(e){return e/o},rotatePoint:function(e,t,n){var i=new w.Point(e.x-t.x,e.y-t.y),r=w.util.rotateVector(i,n);return new w.Point(r.x,r.y).addEquals(t)},rotateVector:function(e,t){var n=w.util.sin(t),i=w.util.cos(t);return{x:e.x*i-e.y*n,y:e.x*n+e.y*i}},createVector:function(e,t){return new w.Point(t.x-e.x,t.y-e.y)},calcAngleBetweenVectors:function(e,t){return Math.acos((e.x*t.x+e.y*t.y)/(Math.hypot(e.x,e.y)*Math.hypot(t.x,t.y)))},getHatVector:function(e){return new w.Point(e.x,e.y).multiply(1/Math.hypot(e.x,e.y))},getBisector:function(e,t,n){var i=w.util.createVector(e,t),r=w.util.createVector(e,n),o=w.util.calcAngleBetweenVectors(i,r),a=o*(0===w.util.calcAngleBetweenVectors(w.util.rotateVector(i,o),r)?1:-1)/2;return{vector:w.util.getHatVector(w.util.rotateVector(i,a)),angle:o}},projectStrokeOnPoints:function(e,t,n){var i=[],r=t.strokeWidth/2,o=t.strokeUniform?new w.Point(1/t.scaleX,1/t.scaleY):new w.Point(1,1),a=function(e){var t=r/Math.hypot(e.x,e.y);return new w.Point(e.x*t*o.x,e.y*t*o.y)};return e.length<=1||e.forEach((function(s,l){var c,u,h=new w.Point(s.x,s.y);0===l?(u=e[l+1],c=n?a(w.util.createVector(u,h)).addEquals(h):e[e.length-1]):l===e.length-1?(c=e[l-1],u=n?a(w.util.createVector(c,h)).addEquals(h):e[0]):(c=e[l-1],u=e[l+1]);var d,f,p=w.util.getBisector(h,c,u),g=p.vector,v=p.angle;if("miter"===t.strokeLineJoin&&(d=-r/Math.sin(v/2),f=new w.Point(g.x*d*o.x,g.y*d*o.y),Math.hypot(f.x,f.y)/r<=t.strokeMiterLimit))return i.push(h.add(f)),void i.push(h.subtract(f));d=-r*Math.SQRT2,f=new w.Point(g.x*d*o.x,g.y*d*o.y),i.push(h.add(f)),i.push(h.subtract(f))})),i},transformPoint:function(e,t,n){return n?new w.Point(t[0]*e.x+t[2]*e.y,t[1]*e.x+t[3]*e.y):new w.Point(t[0]*e.x+t[2]*e.y+t[4],t[1]*e.x+t[3]*e.y+t[5])},makeBoundingBoxFromPoints:function(e,t){if(t)for(var n=0;n<e.length;n++)e[n]=w.util.transformPoint(e[n],t);var i=[e[0].x,e[1].x,e[2].x,e[3].x],r=w.util.array.min(i),o=w.util.array.max(i)-r,a=[e[0].y,e[1].y,e[2].y,e[3].y],s=w.util.array.min(a);return{left:r,top:s,width:o,height:w.util.array.max(a)-s}},invertTransform:function(e){var t=1/(e[0]*e[3]-e[1]*e[2]),n=[t*e[3],-t*e[1],-t*e[2],t*e[0]],i=w.util.transformPoint({x:e[4],y:e[5]},n,!0);return n[4]=-i.x,n[5]=-i.y,n},toFixed:function(e,t){return parseFloat(Number(e).toFixed(t))},parseUnit:function(e,t){var n=/\D{0,2}$/.exec(e),i=parseFloat(e);switch(t||(t=w.Text.DEFAULT_SVG_FONT_SIZE),n[0]){case"mm":return i*w.DPI/25.4;case"cm":return i*w.DPI/2.54;case"in":return i*w.DPI;case"pt":return i*w.DPI/72;case"pc":return i*w.DPI/72*12;case"em":return i*t;default:return i}},falseFunction:function(){return!1},getKlass:function(e,t){return e=w.util.string.camelize(e.charAt(0).toUpperCase()+e.slice(1)),w.util.resolveNamespace(t)[e]},getSvgAttributes:function(e){var t=["instantiated_by_use","style","id","class"];switch(e){case"linearGradient":t=t.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":t=t.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":t=t.concat(["offset","stop-color","stop-opacity"])}return t},resolveNamespace:function(e){if(!e)return w;var n,i=e.split("."),r=i.length,o=t||w.window;for(n=0;n<r;++n)o=o[i[n]];return o},loadImage:function(e,t,n,i){if(e){var r=w.util.createImage(),o=function(){t&&t.call(n,r,!1),r=r.onload=r.onerror=null};r.onload=o,r.onerror=function(){w.log("Error loading "+r.src),t&&t.call(n,null,!0),r=r.onload=r.onerror=null},0!==e.indexOf("data")&&null!=i&&(r.crossOrigin=i),"data:image/svg"===e.substring(0,14)&&(r.onload=null,w.util.loadImageInDom(r,o)),r.src=e}else t&&t.call(n,e)},loadImageInDom:function(e,t){var n=w.document.createElement("div");n.style.width=n.style.height="1px",n.style.left=n.style.top="-100%",n.style.position="absolute",n.appendChild(e),w.document.querySelector("body").appendChild(n),e.onload=function(){t(),n.parentNode.removeChild(n),n=null}},enlivenObjects:function(e,t,n,i){var r=[],o=0,a=(e=e||[]).length;function s(){++o===a&&t&&t(r.filter((function(e){return e})))}a?e.forEach((function(e,t){e&&e.type?w.util.getKlass(e.type,n).fromObject(e,(function(n,o){o||(r[t]=n),i&&i(e,n,o),s()})):s()})):t&&t(r)},enlivenObjectEnlivables:function(e,t,n){var i=w.Object.ENLIVEN_PROPS.filter((function(t){return!!e[t]}));w.util.enlivenObjects(i.map((function(t){return e[t]})),(function(e){var r={};i.forEach((function(n,i){r[n]=e[i],t&&(t[n]=e[i])})),n&&n(r)}))},enlivenPatterns:function(e,t){function n(){++r===o&&t&&t(i)}var i=[],r=0,o=(e=e||[]).length;o?e.forEach((function(e,t){e&&e.source?new w.Pattern(e,(function(e){i[t]=e,n()})):(i[t]=e,n())})):t&&t(i)},groupSVGElements:function(e,t,n){var i;return e&&1===e.length?(void 0!==n&&(e[0].sourcePath=n),e[0]):(t&&(t.width&&t.height?t.centerPoint={x:t.width/2,y:t.height/2}:(delete t.width,delete t.height)),i=new w.Group(e,t),void 0!==n&&(i.sourcePath=n),i)},populateWithProperties:function(e,t,n){if(n&&Array.isArray(n))for(var i=0,r=n.length;i<r;i++)n[i]in e&&(t[n[i]]=e[n[i]])},createCanvasElement:function(){return w.document.createElement("canvas")},copyCanvasElement:function(e){var t=w.util.createCanvasElement();return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t},toDataURL:function(e,t,n){return e.toDataURL("image/"+t,n)},createImage:function(){return w.document.createElement("img")},multiplyTransformMatrices:function(e,t,n){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],n?0:e[0]*t[4]+e[2]*t[5]+e[4],n?0:e[1]*t[4]+e[3]*t[5]+e[5]]},qrDecompose:function(e){var t=i(e[1],e[0]),a=r(e[0],2)+r(e[1],2),s=n(a),l=(e[0]*e[3]-e[2]*e[1])/s,c=i(e[0]*e[2]+e[1]*e[3],a);return{angle:t/o,scaleX:s,scaleY:l,skewX:c/o,skewY:0,translateX:e[4],translateY:e[5]}},calcRotateMatrix:function(e){if(!e.angle)return w.iMatrix.concat();var t=w.util.degreesToRadians(e.angle),n=w.util.cos(t),i=w.util.sin(t);return[n,i,-i,n,0,0]},calcDimensionsMatrix:function(e){var t=void 0===e.scaleX?1:e.scaleX,n=void 0===e.scaleY?1:e.scaleY,i=[e.flipX?-t:t,0,0,e.flipY?-n:n,0,0],r=w.util.multiplyTransformMatrices,o=w.util.degreesToRadians;return e.skewX&&(i=r(i,[1,0,Math.tan(o(e.skewX)),1],!0)),e.skewY&&(i=r(i,[1,Math.tan(o(e.skewY)),0,1],!0)),i},composeMatrix:function(e){var t=[1,0,0,1,e.translateX||0,e.translateY||0],n=w.util.multiplyTransformMatrices;return e.angle&&(t=n(t,w.util.calcRotateMatrix(e))),(1!==e.scaleX||1!==e.scaleY||e.skewX||e.skewY||e.flipX||e.flipY)&&(t=n(t,w.util.calcDimensionsMatrix(e))),t},resetObjectTransform:function(e){e.scaleX=1,e.scaleY=1,e.skewX=0,e.skewY=0,e.flipX=!1,e.flipY=!1,e.rotate(0)},saveObjectTransform:function(e){return{scaleX:e.scaleX,scaleY:e.scaleY,skewX:e.skewX,skewY:e.skewY,angle:e.angle,left:e.left,flipX:e.flipX,flipY:e.flipY,top:e.top}},isTransparent:function(e,t,n,i){i>0&&(t>i?t-=i:t=0,n>i?n-=i:n=0);var r,o=!0,a=e.getImageData(t,n,2*i||1,2*i||1),s=a.data.length;for(r=3;r<s&&!1!=(o=a.data[r]<=0);r+=4);return a=null,o},parsePreserveAspectRatioAttribute:function(e){var t,n="meet",i=e.split(" ");return i&&i.length&&("meet"!==(n=i.pop())&&"slice"!==n?(t=n,n="meet"):i.length&&(t=i.pop())),{meetOrSlice:n,alignX:"none"!==t?t.slice(1,4):"none",alignY:"none"!==t?t.slice(5,8):"none"}},clearFabricFontCache:function(e){(e=(e||"").toLowerCase())?w.charWidthsCache[e]&&delete w.charWidthsCache[e]:w.charWidthsCache={}},limitDimsByArea:function(e,t){var n=Math.sqrt(t*e),i=Math.floor(t/n);return{x:Math.floor(n),y:i}},capValue:function(e,t,n){return Math.max(e,Math.min(t,n))},findScaleToFit:function(e,t){return Math.min(t.width/e.width,t.height/e.height)},findScaleToCover:function(e,t){return Math.max(t.width/e.width,t.height/e.height)},matrixToSVG:function(e){return"matrix("+e.map((function(e){return w.util.toFixed(e,w.Object.NUM_FRACTION_DIGITS)})).join(" ")+")"},removeTransformFromObject:function(e,t){var n=w.util.invertTransform(t),i=w.util.multiplyTransformMatrices(n,e.calcOwnMatrix());w.util.applyTransformToObject(e,i)},addTransformToObject:function(e,t){w.util.applyTransformToObject(e,w.util.multiplyTransformMatrices(t,e.calcOwnMatrix()))},applyTransformToObject:function(e,t){var n=w.util.qrDecompose(t),i=new w.Point(n.translateX,n.translateY);e.flipX=!1,e.flipY=!1,e.set("scaleX",n.scaleX),e.set("scaleY",n.scaleY),e.skewX=n.skewX,e.skewY=n.skewY,e.angle=n.angle,e.setPositionByOrigin(i,"center","center")},sizeAfterTransform:function(e,t,n){var i=e/2,r=t/2,o=[{x:-i,y:-r},{x:i,y:-r},{x:-i,y:r},{x:i,y:r}],a=w.util.calcDimensionsMatrix(n),s=w.util.makeBoundingBoxFromPoints(o,a);return{x:s.width,y:s.height}},mergeClipPaths:function(e,t){var n=e,i=t;n.inverted&&!i.inverted&&(n=t,i=e),w.util.applyTransformToObject(i,w.util.multiplyTransformMatrices(w.util.invertTransform(n.calcTransformMatrix()),i.calcTransformMatrix()));var r=n.inverted&&i.inverted;return r&&(n.inverted=i.inverted=!1),new w.Group([n],{clipPath:i,inverted:r})},hasStyleChanged:function(e,t,n){return n=n||!1,e.fill!==t.fill||e.stroke!==t.stroke||e.strokeWidth!==t.strokeWidth||e.fontSize!==t.fontSize||e.fontFamily!==t.fontFamily||e.fontWeight!==t.fontWeight||e.fontStyle!==t.fontStyle||e.textBackgroundColor!==t.textBackgroundColor||e.deltaY!==t.deltaY||n&&(e.overline!==t.overline||e.underline!==t.underline||e.linethrough!==t.linethrough)},stylesToArray:function(e,t){e=w.util.object.clone(e,!0);for(var n=t.split("\n"),i=-1,r={},o=[],a=0;a<n.length;a++)if(e[a])for(var s=0;s<n[a].length;s++){i++;var l=e[a][s];l&&Object.keys(l).length>0&&(w.util.hasStyleChanged(r,l,!0)?o.push({start:i,end:i+1,style:l}):o[o.length-1].end++),r=l||{}}else i+=n[a].length;return o},stylesFromArray:function(e,t){if(!Array.isArray(e))return e;for(var n=t.split("\n"),i=-1,r=0,o={},a=0;a<n.length;a++)for(var s=0;s<n[a].length;s++)i++,e[r]&&e[r].start<=i&&i<e[r].end&&(o[a]=o[a]||{},o[a][s]=Object.assign({},e[r].style),i===e[r].end-1&&r++);return o}},function(){var e=Array.prototype.join,t={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},n={m:"l",M:"L"};function i(e,t,n,i,r,o,a,s,l,c,u){var h=w.util.cos(e),d=w.util.sin(e),f=w.util.cos(t),p=w.util.sin(t),g=n*r*f-i*o*p+a,v=i*r*f+n*o*p+s;return["C",c+l*(-n*r*d-i*o*h),u+l*(-i*r*d+n*o*h),g+l*(n*r*p+i*o*f),v+l*(i*r*p-n*o*f),g,v]}function r(e,t,n,i){var r=Math.atan2(t,e),o=Math.atan2(i,n);return o>=r?o-r:2*Math.PI-(r-o)}function o(e,t,n){for(var o=n[1],a=n[2],s=n[3],l=n[4],c=n[5],u=function(e,t,n,o,a,s,l){var c=Math.PI,u=l*c/180,h=w.util.sin(u),d=w.util.cos(u),f=0,p=0,g=-d*e*.5-h*t*.5,v=-d*t*.5+h*e*.5,A=(n=Math.abs(n))*n,m=(o=Math.abs(o))*o,y=v*v,b=g*g,C=A*m-A*y-m*b,x=0;if(C<0){var _=Math.sqrt(1-C/(A*m));n*=_,o*=_}else x=(a===s?-1:1)*Math.sqrt(C/(A*y+m*b));var E=x*n*v/o,S=-x*o*g/n,I=d*E-h*S+.5*e,k=h*E+d*S+.5*t,B=r(1,0,(g-E)/n,(v-S)/o),O=r((g-E)/n,(v-S)/o,(-g-E)/n,(-v-S)/o);0===s&&O>0?O-=2*c:1===s&&O<0&&(O+=2*c);for(var T=Math.ceil(Math.abs(O/c*2)),D=[],M=O/T,Q=8/3*Math.sin(M/4)*Math.sin(M/4)/Math.sin(M/2),L=B+M,P=0;P<T;P++)D[P]=i(B,L,d,h,n,o,I,k,Q,f,p),f=D[P][5],p=D[P][6],B=L,L+=M;return D}(n[6]-e,n[7]-t,o,a,l,c,s),h=0,d=u.length;h<d;h++)u[h][1]+=e,u[h][2]+=t,u[h][3]+=e,u[h][4]+=t,u[h][5]+=e,u[h][6]+=t;return u}function a(e,t,n,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))}function s(e,t,n,i,r,o,a,s){return function(l){var c,u=(c=l)*c*c,h=function(e){return 3*e*e*(1-e)}(l),d=function(e){return 3*e*(1-e)*(1-e)}(l),f=function(e){return(1-e)*(1-e)*(1-e)}(l);return{x:a*u+r*h+n*d+e*f,y:s*u+o*h+i*d+t*f}}}function l(e,t,n,i,r,o,a,s){return function(l){var c=1-l,u=3*c*c*(n-e)+6*c*l*(r-n)+3*l*l*(a-r),h=3*c*c*(i-t)+6*c*l*(o-i)+3*l*l*(s-o);return Math.atan2(h,u)}}function c(e,t,n,i,r,o){return function(a){var s,l=(s=a)*s,c=function(e){return 2*e*(1-e)}(a),u=function(e){return(1-e)*(1-e)}(a);return{x:r*l+n*c+e*u,y:o*l+i*c+t*u}}}function u(e,t,n,i,r,o){return function(a){var s=1-a,l=2*s*(n-e)+2*a*(r-n),c=2*s*(i-t)+2*a*(o-i);return Math.atan2(c,l)}}function h(e,t,n){var i,r,o={x:t,y:n},s=0;for(r=1;r<=100;r+=1)i=e(r/100),s+=a(o.x,o.y,i.x,i.y),o=i;return s}function d(e,t){for(var n,i,r,o=0,s=0,l=e.iterator,c={x:e.x,y:e.y},u=.01,h=e.angleFinder;s<t&&u>1e-4;)n=l(o),r=o,(i=a(c.x,c.y,n.x,n.y))+s>t?(o-=u,u/=2):(c=n,o+=u,s+=i);return n.angle=h(r),n}function f(e){for(var t,n,i,r,o=0,d=e.length,f=0,p=0,g=0,v=0,A=[],m=0;m<d;m++){switch(i={x:f,y:p,command:(t=e[m])[0]},t[0]){case"M":i.length=0,g=f=t[1],v=p=t[2];break;case"L":i.length=a(f,p,t[1],t[2]),f=t[1],p=t[2];break;case"C":n=s(f,p,t[1],t[2],t[3],t[4],t[5],t[6]),r=l(f,p,t[1],t[2],t[3],t[4],t[5],t[6]),i.iterator=n,i.angleFinder=r,i.length=h(n,f,p),f=t[5],p=t[6];break;case"Q":n=c(f,p,t[1],t[2],t[3],t[4]),r=u(f,p,t[1],t[2],t[3],t[4]),i.iterator=n,i.angleFinder=r,i.length=h(n,f,p),f=t[3],p=t[4];break;case"Z":case"z":i.destX=g,i.destY=v,i.length=a(f,p,g,v),f=g,p=v}o+=i.length,A.push(i)}return A.push({length:o,x:f,y:p}),A}w.util.joinPath=function(e){return e.map((function(e){return e.join(" ")})).join(" ")},w.util.parsePath=function(e){var i,r,o,a,s,l=[],c=[],u=w.rePathCommand,h="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",d="("+h+")"+w.commaWsp,f="([01])"+w.commaWsp+"?",p=new RegExp(d+"?"+d+"?"+d+f+f+d+"?("+h+")","g");if(!e||!e.match)return l;for(var g,v=0,A=(s=e.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;v<A;v++){a=(i=s[v]).slice(1).trim(),c.length=0;var m=i.charAt(0);if(g=[m],"a"===m.toLowerCase())for(var y;y=p.exec(a);)for(var b=1;b<y.length;b++)c.push(y[b]);else for(;o=u.exec(a);)c.push(o[0]);b=0;for(var C=c.length;b<C;b++)r=parseFloat(c[b]),isNaN(r)||g.push(r);var x=t[m.toLowerCase()],_=n[m]||m;if(g.length-1>x)for(var E=1,S=g.length;E<S;E+=x)l.push([m].concat(g.slice(E,E+x))),m=_;else l.push(g)}return l},w.util.makePathSimpler=function(e){var t,n,i,r,a,s,l=0,c=0,u=e.length,h=0,d=0,f=[];for(n=0;n<u;++n){switch(i=!1,(t=e[n].slice(0))[0]){case"l":t[0]="L",t[1]+=l,t[2]+=c;case"L":l=t[1],c=t[2];break;case"h":t[1]+=l;case"H":t[0]="L",t[2]=c,l=t[1];break;case"v":t[1]+=c;case"V":t[0]="L",c=t[1],t[1]=l,t[2]=c;break;case"m":t[0]="M",t[1]+=l,t[2]+=c;case"M":l=t[1],c=t[2],h=t[1],d=t[2];break;case"c":t[0]="C",t[1]+=l,t[2]+=c,t[3]+=l,t[4]+=c,t[5]+=l,t[6]+=c;case"C":a=t[3],s=t[4],l=t[5],c=t[6];break;case"s":t[0]="S",t[1]+=l,t[2]+=c,t[3]+=l,t[4]+=c;case"S":"C"===r?(a=2*l-a,s=2*c-s):(a=l,s=c),l=t[3],c=t[4],t[0]="C",t[5]=t[3],t[6]=t[4],t[3]=t[1],t[4]=t[2],t[1]=a,t[2]=s,a=t[3],s=t[4];break;case"q":t[0]="Q",t[1]+=l,t[2]+=c,t[3]+=l,t[4]+=c;case"Q":a=t[1],s=t[2],l=t[3],c=t[4];break;case"t":t[0]="T",t[1]+=l,t[2]+=c;case"T":"Q"===r?(a=2*l-a,s=2*c-s):(a=l,s=c),t[0]="Q",l=t[1],c=t[2],t[1]=a,t[2]=s,t[3]=l,t[4]=c;break;case"a":t[0]="A",t[6]+=l,t[7]+=c;case"A":i=!0,f=f.concat(o(l,c,t)),l=t[6],c=t[7];break;case"z":case"Z":l=h,c=d}i||f.push(t),r=t[0]}return f},w.util.getSmoothPathFromPoints=function(e,t){var n,i=[],r=new w.Point(e[0].x,e[0].y),o=new w.Point(e[1].x,e[1].y),a=e.length,s=1,l=0,c=a>2;for(t=t||0,c&&(s=e[2].x<o.x?-1:e[2].x===o.x?0:1,l=e[2].y<o.y?-1:e[2].y===o.y?0:1),i.push(["M",r.x-s*t,r.y-l*t]),n=1;n<a;n++){if(!r.eq(o)){var u=r.midPointFrom(o);i.push(["Q",r.x,r.y,u.x,u.y])}r=e[n],n+1<e.length&&(o=e[n+1])}return c&&(s=r.x>e[n-2].x?1:r.x===e[n-2].x?0:-1,l=r.y>e[n-2].y?1:r.y===e[n-2].y?0:-1),i.push(["L",r.x+s*t,r.y+l*t]),i},w.util.getPathSegmentsInfo=f,w.util.getBoundsOfCurve=function(t,n,i,r,o,a,s,l){var c;if(w.cachesBoundsOfCurve&&(c=e.call(arguments),w.boundsOfCurveCache[c]))return w.boundsOfCurveCache[c];var u,h,d,f,p,g,v,A,m=Math.sqrt,y=Math.min,b=Math.max,C=Math.abs,x=[],_=[[],[]];h=6*t-12*i+6*o,u=-3*t+9*i-9*o+3*s,d=3*i-3*t;for(var E=0;E<2;++E)if(E>0&&(h=6*n-12*r+6*a,u=-3*n+9*r-9*a+3*l,d=3*r-3*n),C(u)<1e-12){if(C(h)<1e-12)continue;0<(f=-d/h)&&f<1&&x.push(f)}else(v=h*h-4*d*u)<0||(0<(p=(-h+(A=m(v)))/(2*u))&&p<1&&x.push(p),0<(g=(-h-A)/(2*u))&&g<1&&x.push(g));for(var S,I,k,B=x.length,O=B;B--;)S=(k=1-(f=x[B]))*k*k*t+3*k*k*f*i+3*k*f*f*o+f*f*f*s,_[0][B]=S,I=k*k*k*n+3*k*k*f*r+3*k*f*f*a+f*f*f*l,_[1][B]=I;_[0][O]=t,_[1][O]=n,_[0][O+1]=s,_[1][O+1]=l;var T=[{x:y.apply(null,_[0]),y:y.apply(null,_[1])},{x:b.apply(null,_[0]),y:b.apply(null,_[1])}];return w.cachesBoundsOfCurve&&(w.boundsOfCurveCache[c]=T),T},w.util.getPointOnPath=function(e,t,n){n||(n=f(e));for(var i=0;t-n[i].length>0&&i<n.length-2;)t-=n[i].length,i++;var r,o=n[i],a=t/o.length,s=o.command,l=e[i];switch(s){case"M":return{x:o.x,y:o.y,angle:0};case"Z":case"z":return(r=new w.Point(o.x,o.y).lerp(new w.Point(o.destX,o.destY),a)).angle=Math.atan2(o.destY-o.y,o.destX-o.x),r;case"L":return(r=new w.Point(o.x,o.y).lerp(new w.Point(l[1],l[2]),a)).angle=Math.atan2(l[2]-o.y,l[1]-o.x),r;case"C":case"Q":return d(o,t)}},w.util.transformPath=function(e,t,n){return n&&(t=w.util.multiplyTransformMatrices(t,[1,0,0,1,-n.x,-n.y])),e.map((function(e){for(var n=e.slice(0),i={},r=1;r<e.length-1;r+=2)i.x=e[r],i.y=e[r+1],i=w.util.transformPoint(i,t),n[r]=i.x,n[r+1]=i.y;return n}))}}(),function(){var e=Array.prototype.slice;function t(e,t,n){if(e&&0!==e.length){var i=e.length-1,r=t?e[i][t]:e[i];if(t)for(;i--;)n(e[i][t],r)&&(r=e[i][t]);else for(;i--;)n(e[i],r)&&(r=e[i]);return r}}w.util.array={fill:function(e,t){for(var n=e.length;n--;)e[n]=t;return e},invoke:function(t,n){for(var i=e.call(arguments,2),r=[],o=0,a=t.length;o<a;o++)r[o]=i.length?t[o][n].apply(t[o],i):t[o][n].call(t[o]);return r},min:function(e,n){return t(e,n,(function(e,t){return e<t}))},max:function(e,n){return t(e,n,(function(e,t){return e>=t}))}}}(),function(){function e(t,n,i){if(i)if(!w.isLikelyNode&&n instanceof Element)t=n;else if(n instanceof Array){t=[];for(var r=0,o=n.length;r<o;r++)t[r]=e({},n[r],i)}else if(n&&"object"==typeof n)for(var a in n)"canvas"===a||"group"===a?t[a]=null:n.hasOwnProperty(a)&&(t[a]=e({},n[a],i));else t=n;else for(var a in n)t[a]=n[a];return t}w.util.object={extend:e,clone:function(t,n){return e({},t,n)}},w.util.object.extend(w.util,w.Observable)}(),function(){function e(e,t){var n=e.charCodeAt(t);if(isNaN(n))return"";if(n<55296||n>57343)return e.charAt(t);if(55296<=n&&n<=56319){if(e.length<=t+1)throw"High surrogate without following low surrogate";var i=e.charCodeAt(t+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return e.charAt(t)+e.charAt(t+1)}if(0===t)throw"Low surrogate without preceding high surrogate";var r=e.charCodeAt(t-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}w.util.string={camelize:function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},capitalize:function(e,t){return e.charAt(0).toUpperCase()+(t?e.slice(1):e.slice(1).toLowerCase())},escapeXml:function(e){return e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(t){var n,i=0,r=[];for(i=0;i<t.length;i++)!1!==(n=e(t,i))&&r.push(n);return r}}}(),function(){var e=Array.prototype.slice,t=function(){},n=function(){for(var e in{toString:1})if("toString"===e)return!1;return!0}(),i=function(e,t,i){for(var r in t)r in e.prototype&&"function"==typeof e.prototype[r]&&(t[r]+"").indexOf("callSuper")>-1?e.prototype[r]=function(e){return function(){var n=this.constructor.superclass;this.constructor.superclass=i;var r=t[e].apply(this,arguments);if(this.constructor.superclass=n,"initialize"!==e)return r}}(r):e.prototype[r]=t[r],n&&(t.toString!==Object.prototype.toString&&(e.prototype.toString=t.toString),t.valueOf!==Object.prototype.valueOf&&(e.prototype.valueOf=t.valueOf))};function r(){}function o(t){for(var n=null,i=this;i.constructor.superclass;){var r=i.constructor.superclass.prototype[t];if(i[t]!==r){n=r;break}i=i.constructor.superclass.prototype}if(n)return arguments.length>1?n.apply(this,e.call(arguments,1)):n.call(this)}w.util.createClass=function(){var n=null,a=e.call(arguments,0);function s(){this.initialize.apply(this,arguments)}"function"==typeof a[0]&&(n=a.shift()),s.superclass=n,s.subclasses=[],n&&(r.prototype=n.prototype,s.prototype=new r,n.subclasses.push(s));for(var l=0,c=a.length;l<c;l++)i(s,a[l],n);return s.prototype.initialize||(s.prototype.initialize=t),s.prototype.constructor=s,s.prototype.callSuper=o,s}}(),s=!!w.document.createElement("div").attachEvent,l=["touchstart","touchmove","touchend"],w.util.addListener=function(e,t,n,i){e&&e.addEventListener(t,n,!s&&i)},w.util.removeListener=function(e,t,n,i){e&&e.removeEventListener(t,n,!s&&i)},w.util.getPointer=function(e){var t=e.target,n=w.util.getScrollLeftTop(t),i=function(e){var t=e.changedTouches;return t&&t[0]?t[0]:e}(e);return{x:i.clientX+n.left,y:i.clientY+n.top}},w.util.isTouchEvent=function(e){return l.indexOf(e.type)>-1||"touch"===e.pointerType},c=w.document.createElement("div"),u="string"==typeof c.style.opacity,h="string"==typeof c.style.filter,d=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,f=function(e){return e},u?f=function(e,t){return e.style.opacity=t,e}:h&&(f=function(e,t){var n=e.style;return e.currentStyle&&!e.currentStyle.hasLayout&&(n.zoom=1),d.test(n.filter)?(t=t>=.9999?"":"alpha(opacity="+100*t+")",n.filter=n.filter.replace(d,t)):n.filter+=" alpha(opacity="+100*t+")",e}),w.util.setStyle=function(e,t){var n=e.style;if(!n)return e;if("string"==typeof t)return e.style.cssText+=";"+t,t.indexOf("opacity")>-1?f(e,t.match(/opacity:\s*(\d?\.?\d*)/)[1]):e;for(var i in t)if("opacity"===i)f(e,t[i]);else{var r="float"===i||"cssFloat"===i?void 0===n.styleFloat?"cssFloat":"styleFloat":i;n.setProperty(r,t[i])}return e},function(){var e=Array.prototype.slice;var t,n,i,r,o=function(t){return e.call(t,0)};try{t=o(w.document.childNodes)instanceof Array}catch(l){}function a(e,t){var n=w.document.createElement(e);for(var i in t)"class"===i?n.className=t[i]:"for"===i?n.htmlFor=t[i]:n.setAttribute(i,t[i]);return n}function s(e){for(var t=0,n=0,i=w.document.documentElement,r=w.document.body||{scrollLeft:0,scrollTop:0};e&&(e.parentNode||e.host)&&((e=e.parentNode||e.host)===w.document?(t=r.scrollLeft||i.scrollLeft||0,n=r.scrollTop||i.scrollTop||0):(t+=e.scrollLeft||0,n+=e.scrollTop||0),1!==e.nodeType||"fixed"!==e.style.position););return{left:t,top:n}}t||(o=function(e){for(var t=new Array(e.length),n=e.length;n--;)t[n]=e[n];return t}),n=w.document.defaultView&&w.document.defaultView.getComputedStyle?function(e,t){var n=w.document.defaultView.getComputedStyle(e,null);return n?n[t]:void 0}:function(e,t){var n=e.style[t];return!n&&e.currentStyle&&(n=e.currentStyle[t]),n},i=w.document.documentElement.style,r="userSelect"in i?"userSelect":"MozUserSelect"in i?"MozUserSelect":"WebkitUserSelect"in i?"WebkitUserSelect":"KhtmlUserSelect"in i?"KhtmlUserSelect":"",w.util.makeElementUnselectable=function(e){return void 0!==e.onselectstart&&(e.onselectstart=w.util.falseFunction),r?e.style[r]="none":"string"==typeof e.unselectable&&(e.unselectable="on"),e},w.util.makeElementSelectable=function(e){return void 0!==e.onselectstart&&(e.onselectstart=null),r?e.style[r]="":"string"==typeof e.unselectable&&(e.unselectable=""),e},w.util.setImageSmoothing=function(e,t){e.imageSmoothingEnabled=e.imageSmoothingEnabled||e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled||e.oImageSmoothingEnabled,e.imageSmoothingEnabled=t},w.util.getById=function(e){return"string"==typeof e?w.document.getElementById(e):e},w.util.toArray=o,w.util.addClass=function(e,t){e&&-1===(" "+e.className+" ").indexOf(" "+t+" ")&&(e.className+=(e.className?" ":"")+t)},w.util.makeElement=a,w.util.wrapElement=function(e,t,n){return"string"==typeof t&&(t=a(t,n)),e.parentNode&&e.parentNode.replaceChild(t,e),t.appendChild(e),t},w.util.getScrollLeftTop=s,w.util.getElementOffset=function(e){var t,i,r=e&&e.ownerDocument,o={left:0,top:0},a={left:0,top:0},l={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!r)return a;for(var c in l)a[l[c]]+=parseInt(n(e,c),10)||0;return t=r.documentElement,void 0!==e.getBoundingClientRect&&(o=e.getBoundingClientRect()),i=s(e),{left:o.left+i.left-(t.clientLeft||0)+a.left,top:o.top+i.top-(t.clientTop||0)+a.top}},w.util.getNodeCanvas=function(e){var t=w.jsdomImplForWrapper(e);return t._canvas||t._image},w.util.cleanUpJsdomNode=function(e){if(w.isLikelyNode){var t=w.jsdomImplForWrapper(e);t&&(t._image=null,t._canvas=null,t._currentSrc=null,t._attributes=null,t._classList=null)}}}(),function(){function e(){}w.util.request=function(t,n){n||(n={});var i=n.method?n.method.toUpperCase():"GET",r=n.onComplete||function(){},o=new w.window.XMLHttpRequest,a=n.body||n.parameters;return o.onreadystatechange=function(){4===o.readyState&&(r(o),o.onreadystatechange=e)},"GET"===i&&(a=null,"string"==typeof n.parameters&&(t=function(e,t){return e+(/\?/.test(e)?"&":"?")+t}(t,n.parameters))),o.open(i,t,!0),"POST"!==i&&"PUT"!==i||o.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o.send(a),o}}(),w.log=console.log,w.warn=console.warn,function(){var e=w.util.object.extend,t=w.util.object.clone,n=[];function i(){return!1}function r(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t}w.util.object.extend(n,{cancelAll:function(){var e=this.splice(0);return e.forEach((function(e){e.cancel()})),e},cancelByCanvas:function(e){if(!e)return[];var t=this.filter((function(t){return"object"==typeof t.target&&t.target.canvas===e}));return t.forEach((function(e){e.cancel()})),t},cancelByTarget:function(e){var t=this.findAnimationsByTarget(e);return t.forEach((function(e){e.cancel()})),t},findAnimationIndex:function(e){return this.indexOf(this.findAnimation(e))},findAnimation:function(e){return this.find((function(t){return t.cancel===e}))},findAnimationsByTarget:function(e){return e?this.filter((function(t){return t.target===e})):[]}});var o=w.window.requestAnimationFrame||w.window.webkitRequestAnimationFrame||w.window.mozRequestAnimationFrame||w.window.oRequestAnimationFrame||w.window.msRequestAnimationFrame||function(e){return w.window.setTimeout(e,1e3/60)},a=w.window.cancelAnimationFrame||w.window.clearTimeout;function s(){return o.apply(w.window,arguments)}w.util.animate=function(n){n||(n={});var o,a=!1,l=function(){var e=w.runningAnimations.indexOf(o);return e>-1&&w.runningAnimations.splice(e,1)[0]};return o=e(t(n),{cancel:function(){return a=!0,l()},currentValue:"startValue"in n?n.startValue:0,completionRate:0,durationRate:0}),w.runningAnimations.push(o),s((function(e){var t,c=e||+new Date,u=n.duration||500,h=c+u,d=n.onChange||i,f=n.abort||i,p=n.onComplete||i,g=n.easing||r,v="startValue"in n&&n.startValue.length>0,A="startValue"in n?n.startValue:0,m="endValue"in n?n.endValue:100,y=n.byValue||(v?A.map((function(e,t){return m[t]-A[t]})):m-A);n.onStart&&n.onStart(),function e(n){var i=(t=n||+new Date)>h?u:t-c,r=i/u,b=v?A.map((function(e,t){return g(i,A[t],y[t],u)})):g(i,A,y,u),C=v?Math.abs((b[0]-A[0])/y[0]):Math.abs((b-A)/y);if(o.currentValue=v?b.slice():b,o.completionRate=C,o.durationRate=r,!a){if(!f(b,C,r))return t>h?(o.currentValue=v?m.slice():m,o.completionRate=1,o.durationRate=1,d(v?m.slice():m,1,1),p(m,1,1),void l()):(d(b,C,r),void s(e));l()}}(c)})),o.cancel},w.util.requestAnimFrame=s,w.util.cancelAnimFrame=function(){return a.apply(w.window,arguments)},w.runningAnimations=n}(),function(){function e(e,t,n){var i="rgba("+parseInt(e[0]+n*(t[0]-e[0]),10)+","+parseInt(e[1]+n*(t[1]-e[1]),10)+","+parseInt(e[2]+n*(t[2]-e[2]),10);return i+=","+(e&&t?parseFloat(e[3]+n*(t[3]-e[3])):1),i+=")"}w.util.animateColor=function(t,n,i,r){var o=new w.Color(t).getSource(),a=new w.Color(n).getSource(),s=r.onComplete,l=r.onChange;return r=r||{},w.util.animate(w.util.object.extend(r,{duration:i||500,startValue:o,endValue:a,byValue:a,easing:function(t,n,i,o){return e(n,i,r.colorEasing?r.colorEasing(t,o):1-Math.cos(t/o*(Math.PI/2)))},onComplete:function(t,n,i){if(s)return s(e(a,a,0),n,i)},onChange:function(t,n,i){if(l){if(Array.isArray(t))return l(e(t,t,0),n,i);l(t,n,i)}}}))}}(),function(){function e(e,t,n,i){return e<Math.abs(t)?(e=t,i=n/4):i=0===t&&0===e?n/(2*Math.PI)*Math.asin(1):n/(2*Math.PI)*Math.asin(t/e),{a:e,c:t,p:n,s:i}}function t(e,t,n){return e.a*Math.pow(2,10*(t-=1))*Math.sin((t*n-e.s)*(2*Math.PI)/e.p)}function n(e,t,n,r){return n-i(r-e,0,n,r)+t}function i(e,t,n,i){return(e/=i)<1/2.75?n*(7.5625*e*e)+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t}w.util.ease={easeInQuad:function(e,t,n,i){return n*(e/=i)*e+t},easeOutQuad:function(e,t,n,i){return-n*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,n,i){return n*(e/=i)*e*e+t},easeOutCubic:function(e,t,n,i){return n*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,n,i){return n*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,n,i){return-n*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,n,i){return n*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,n,i){return n*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,n,i){return(e/=i/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,n,i){return-n*Math.cos(e/i*(Math.PI/2))+n+t},easeOutSine:function(e,t,n,i){return n*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,n,i){return-n/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,n,i){return 0===e?t:n*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,n,i){return e===i?t+n:n*(1-Math.pow(2,-10*e/i))+t},easeInOutExpo:function(e,t,n,i){return 0===e?t:e===i?t+n:(e/=i/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(2-Math.pow(2,-10*--e))+t},easeInCirc:function(e,t,n,i){return-n*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,n,i){return n*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,n,i){return(e/=i/2)<1?-n/2*(Math.sqrt(1-e*e)-1)+t:n/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(n,i,r,o){var a=0;return 0===n?i:1===(n/=o)?i+r:(a||(a=.3*o),-t(e(r,r,a,1.70158),n,o)+i)},easeOutElastic:function(t,n,i,r){var o=0;if(0===t)return n;if(1===(t/=r))return n+i;o||(o=.3*r);var a=e(i,i,o,1.70158);return a.a*Math.pow(2,-10*t)*Math.sin((t*r-a.s)*(2*Math.PI)/a.p)+a.c+n},easeInOutElastic:function(n,i,r,o){var a=0;if(0===n)return i;if(2===(n/=o/2))return i+r;a||(a=o*(.3*1.5));var s=e(r,r,a,1.70158);return n<1?-.5*t(s,n,o)+i:s.a*Math.pow(2,-10*(n-=1))*Math.sin((n*o-s.s)*(2*Math.PI)/s.p)*.5+s.c+i},easeInBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),n*(e/=i)*e*((r+1)*e-r)+t},easeOutBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),n*((e=e/i-1)*e*((r+1)*e+r)+1)+t},easeInOutBack:function(e,t,n,i,r){return void 0===r&&(r=1.70158),(e/=i/2)<1?n/2*(e*e*((1+(r*=1.525))*e-r))+t:n/2*((e-=2)*e*((1+(r*=1.525))*e+r)+2)+t},easeInBounce:n,easeOutBounce:i,easeInOutBounce:function(e,t,r,o){return e<o/2?.5*n(2*e,0,r,o)+t:.5*i(2*e-o,0,r,o)+.5*r+t}}}(),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.object.clone,r=t.util.toFixed,o=t.util.parseUnit,a=t.util.multiplyTransformMatrices,s={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},l={stroke:"strokeOpacity",fill:"fillOpacity"},c="font-size",u="clip-path";function h(e){return e in s?s[e]:e}function d(e,n,i,r){var s,l=Array.isArray(n);if("fill"!==e&&"stroke"!==e||"none"!==n){if("strokeUniform"===e)return"non-scaling-stroke"===n;if("strokeDashArray"===e)n="none"===n?null:n.replace(/,/g," ").split(/\s+/).map(parseFloat);else if("transformMatrix"===e)n=i&&i.transformMatrix?a(i.transformMatrix,t.parseTransformAttribute(n)):t.parseTransformAttribute(n);else if("visible"===e)n="none"!==n&&"hidden"!==n,i&&!1===i.visible&&(n=!1);else if("opacity"===e)n=parseFloat(n),i&&void 0!==i.opacity&&(n*=i.opacity);else if("textAnchor"===e)n="start"===n?"left":"end"===n?"right":"center";else if("charSpacing"===e)s=o(n,r)/r*1e3;else if("paintFirst"===e){var c=n.indexOf("fill"),u=n.indexOf("stroke");n="fill";(c>-1&&u>-1&&u<c||-1===c&&u>-1)&&(n="stroke")}else{if("href"===e||"xlink:href"===e||"font"===e)return n;if("imageSmoothing"===e)return"optimizeQuality"===n;s=l?n.map(o):o(n,r)}}else n="";return!l&&isNaN(s)?n:s}function f(e){return new RegExp("^("+e.join("|")+")\\b","i")}function p(e,t){var n,i,r,o,a=[];for(r=0,o=t.length;r<o;r++)n=t[r],i=e.getElementsByTagName(n),a=a.concat(Array.prototype.slice.call(i));return a}function g(e,t){var n,i=!0;return(n=v(e,t.pop()))&&t.length&&(i=function(e,t){var n,i=!0;for(;e.parentNode&&1===e.parentNode.nodeType&&t.length;)i&&(n=t.pop()),i=v(e=e.parentNode,n);return 0===t.length}(e,t)),n&&i&&0===t.length}function v(e,t){var n,i,r=e.nodeName,o=e.getAttribute("class"),a=e.getAttribute("id");if(n=new RegExp("^"+r,"i"),t=t.replace(n,""),a&&t.length&&(n=new RegExp("#"+a+"(?![a-zA-Z\\-]+)","i"),t=t.replace(n,"")),o&&t.length)for(i=(o=o.split(" ")).length;i--;)n=new RegExp("\\."+o[i]+"(?![a-zA-Z\\-]+)","i"),t=t.replace(n,"");return 0===t.length}function A(e,t){var n;if(e.getElementById&&(n=e.getElementById(t)),n)return n;var i,r,o,a=e.getElementsByTagName("*");for(r=0,o=a.length;r<o;r++)if(t===(i=a[r]).getAttribute("id"))return i}t.svgValidTagNamesRegEx=f(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),t.svgViewBoxElementsRegEx=f(["symbol","image","marker","pattern","view","svg"]),t.svgInvalidAncestorsRegEx=f(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),t.svgValidParentsRegEx=f(["symbol","g","a","svg","clipPath","defs"]),t.cssRules={},t.gradientDefs={},t.clipPaths={},t.parseTransformAttribute=function(){function e(e,n,i){e[i]=Math.tan(t.util.degreesToRadians(n[0]))}var n=t.iMatrix,i=t.reNum,r=t.commaWsp,o="(?:"+("(?:(matrix)\\s*\\(\\s*("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")"+r+"("+i+")\\s*\\))")+"|"+("(?:(translate)\\s*\\(\\s*("+i+")(?:"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(scale)\\s*\\(\\s*("+i+")(?:"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(rotate)\\s*\\(\\s*("+i+")(?:"+r+"("+i+")"+r+"("+i+"))?\\s*\\))")+"|"+("(?:(skewX)\\s*\\(\\s*("+i+")\\s*\\))")+"|"+("(?:(skewY)\\s*\\(\\s*("+i+")\\s*\\))")+")",a=new RegExp("^\\s*(?:"+("(?:"+o+"(?:"+r+"*"+o+")*)")+"?)\\s*$"),s=new RegExp(o,"g");return function(i){var r=n.concat(),l=[];if(!i||i&&!a.test(i))return r;i.replace(s,(function(i){var a=new RegExp(o).exec(i).filter((function(e){return!!e})),s=a[1],c=a.slice(2).map(parseFloat);switch(s){case"translate":!function(e,t){e[4]=t[0],2===t.length&&(e[5]=t[1])}(r,c);break;case"rotate":c[0]=t.util.degreesToRadians(c[0]),function(e,n){var i=t.util.cos(n[0]),r=t.util.sin(n[0]),o=0,a=0;3===n.length&&(o=n[1],a=n[2]),e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=o-(i*o-r*a),e[5]=a-(r*o+i*a)}(r,c);break;case"scale":!function(e,t){var n=t[0],i=2===t.length?t[1]:t[0];e[0]=n,e[3]=i}(r,c);break;case"skewX":e(r,c,2);break;case"skewY":e(r,c,1);break;case"matrix":r=c}l.push(r.concat()),r=n.concat()}));for(var c=l[0];l.length>1;)l.shift(),c=t.util.multiplyTransformMatrices(c,l[0]);return c}}();var m=new RegExp("^\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*,?\\s*("+t.reNum+"+)\\s*$");function y(e){if(!t.svgViewBoxElementsRegEx.test(e.nodeName))return{};var n,i,r,a,s,l,c=e.getAttribute("viewBox"),u=1,h=1,d=e.getAttribute("width"),f=e.getAttribute("height"),p=e.getAttribute("x")||0,g=e.getAttribute("y")||0,v=e.getAttribute("preserveAspectRatio")||"",A=!c||!(c=c.match(m)),y=!d||!f||"100%"===d||"100%"===f,b=A&&y,C={},w="",x=0,_=0;if(C.width=0,C.height=0,C.toBeParsed=b,A&&(p||g)&&e.parentNode&&"#document"!==e.parentNode.nodeName&&(w=" translate("+o(p)+" "+o(g)+") ",s=(e.getAttribute("transform")||"")+w,e.setAttribute("transform",s),e.removeAttribute("x"),e.removeAttribute("y")),b)return C;if(A)return C.width=o(d),C.height=o(f),C;if(n=-parseFloat(c[1]),i=-parseFloat(c[2]),r=parseFloat(c[3]),a=parseFloat(c[4]),C.minX=n,C.minY=i,C.viewBoxWidth=r,C.viewBoxHeight=a,y?(C.width=r,C.height=a):(C.width=o(d),C.height=o(f),u=C.width/r,h=C.height/a),"none"!==(v=t.util.parsePreserveAspectRatioAttribute(v)).alignX&&("meet"===v.meetOrSlice&&(h=u=u>h?h:u),"slice"===v.meetOrSlice&&(h=u=u>h?u:h),x=C.width-r*u,_=C.height-a*u,"Mid"===v.alignX&&(x/=2),"Mid"===v.alignY&&(_/=2),"Min"===v.alignX&&(x=0),"Min"===v.alignY&&(_=0)),1===u&&1===h&&0===n&&0===i&&0===p&&0===g)return C;if((p||g)&&"#document"!==e.parentNode.nodeName&&(w=" translate("+o(p)+" "+o(g)+") "),s=w+" matrix("+u+" 0 0 "+h+" "+(n*u+x)+" "+(i*h+_)+") ","svg"===e.nodeName){for(l=e.ownerDocument.createElementNS(t.svgNS,"g");e.firstChild;)l.appendChild(e.firstChild);e.appendChild(l)}else(l=e).removeAttribute("x"),l.removeAttribute("y"),s=l.getAttribute("transform")+s;return l.setAttribute("transform",s),C}function b(e,t){var n="xlink:href",i=A(e,t.getAttribute(n).slice(1));if(i&&i.getAttribute(n)&&b(e,i),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach((function(e){i&&!t.hasAttribute(e)&&i.hasAttribute(e)&&t.setAttribute(e,i.getAttribute(e))})),!t.children.length)for(var r=i.cloneNode(!0);r.firstChild;)t.appendChild(r.firstChild);t.removeAttribute(n)}t.parseSVGDocument=function(e,n,r,o){if(e){!function(e){for(var n=p(e,["use","svg:use"]),i=0;n.length&&i<n.length;){var r=n[i],o=r.getAttribute("xlink:href")||r.getAttribute("href");if(null===o)return;var a,s,l,c,u=o.slice(1),h=r.getAttribute("x")||0,d=r.getAttribute("y")||0,f=A(e,u).cloneNode(!0),g=(f.getAttribute("transform")||"")+" translate("+h+", "+d+")",v=n.length,m=t.svgNS;if(y(f),/^svg$/i.test(f.nodeName)){var b=f.ownerDocument.createElementNS(m,"g");for(s=0,c=(l=f.attributes).length;s<c;s++)a=l.item(s),b.setAttributeNS(m,a.nodeName,a.nodeValue);for(;f.firstChild;)b.appendChild(f.firstChild);f=b}for(s=0,c=(l=r.attributes).length;s<c;s++)"x"!==(a=l.item(s)).nodeName&&"y"!==a.nodeName&&"xlink:href"!==a.nodeName&&"href"!==a.nodeName&&("transform"===a.nodeName?g=a.nodeValue+" "+g:f.setAttribute(a.nodeName,a.nodeValue));f.setAttribute("transform",g),f.setAttribute("instantiated_by_use","1"),f.removeAttribute("id"),r.parentNode.replaceChild(f,r),n.length===v&&i++}}(e);var a,s,l=t.Object.__uid++,c=y(e),u=t.util.toArray(e.getElementsByTagName("*"));if(c.crossOrigin=o&&o.crossOrigin,c.svgUid=l,0===u.length&&t.isLikelyNode){var h=[];for(a=0,s=(u=e.selectNodes('//*[name(.)!="svg"]')).length;a<s;a++)h[a]=u[a];u=h}var d=u.filter((function(e){return y(e),t.svgValidTagNamesRegEx.test(e.nodeName.replace("svg:",""))&&!function(e,t){for(;e&&(e=e.parentNode);)if(e.nodeName&&t.test(e.nodeName.replace("svg:",""))&&!e.getAttribute("instantiated_by_use"))return!0;return!1}(e,t.svgInvalidAncestorsRegEx)}));if(!d||d&&!d.length)n&&n([],{});else{var f={};u.filter((function(e){return"clipPath"===e.nodeName.replace("svg:","")})).forEach((function(e){var n=e.getAttribute("id");f[n]=t.util.toArray(e.getElementsByTagName("*")).filter((function(e){return t.svgValidTagNamesRegEx.test(e.nodeName.replace("svg:",""))}))})),t.gradientDefs[l]=t.getGradientDefs(e),t.cssRules[l]=t.getCSSRules(e),t.clipPaths[l]=f,t.parseElements(d,(function(e,i){n&&(n(e,c,i,u),delete t.gradientDefs[l],delete t.cssRules[l],delete t.clipPaths[l])}),i(c),r,o)}}};var C=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+t.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+t.reNum+"))?\\s+(.*)");n(t,{parseFontDeclaration:function(e,t){var n=e.match(C);if(n){var i=n[1],r=n[3],a=n[4],s=n[5],l=n[6];i&&(t.fontStyle=i),r&&(t.fontWeight=isNaN(parseFloat(r))?r:parseFloat(r)),a&&(t.fontSize=o(a)),l&&(t.fontFamily=l),s&&(t.lineHeight="normal"===s?1:s)}},getGradientDefs:function(e){var t,n=p(e,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),i=0,r={};for(i=n.length;i--;)(t=n[i]).getAttribute("xlink:href")&&b(e,t),r[t.getAttribute("id")]=t;return r},parseAttributes:function(e,i,a){if(e){var s,f,p,v={};void 0===a&&(a=e.getAttribute("svgUid")),e.parentNode&&t.svgValidParentsRegEx.test(e.parentNode.nodeName)&&(v=t.parseAttributes(e.parentNode,i,a));var A=i.reduce((function(t,n){return(s=e.getAttribute(n))&&(t[n]=s),t}),{}),m=n(function(e,n){var i={};for(var r in t.cssRules[n])if(g(e,r.split(" ")))for(var o in t.cssRules[n][r])i[o]=t.cssRules[n][r][o];return i}(e,a),t.parseStyleAttribute(e));A=n(A,m),m[u]&&e.setAttribute(u,m[u]),f=p=v.fontSize||t.Text.DEFAULT_SVG_FONT_SIZE,A[c]&&(A[c]=f=o(A[c],p));var y,b,C={};for(var w in A)b=d(y=h(w),A[w],v,f),C[y]=b;C&&C.font&&t.parseFontDeclaration(C.font,C);var x=n(v,C);return t.svgValidParentsRegEx.test(e.nodeName)?x:function(e){for(var n in l)if(void 0!==e[l[n]]&&""!==e[n]){if(void 0===e[n]){if(!t.Object.prototype[n])continue;e[n]=t.Object.prototype[n]}if(0!==e[n].indexOf("url(")){var i=new t.Color(e[n]);e[n]=i.setAlpha(r(i.getAlpha()*e[l[n]],2)).toRgba()}}return e}(x)}},parseElements:function(e,n,i,r,o){new t.ElementsParser(e,n,i,r,o).parse()},parseStyleAttribute:function(e){var t={},n=e.getAttribute("style");return n?("string"==typeof n?function(e,t){var n,i;e.replace(/;\s*$/,"").split(";").forEach((function(e){var r=e.split(":");n=r[0].trim().toLowerCase(),i=r[1].trim(),t[n]=i}))}(n,t):function(e,t){var n,i;for(var r in e)void 0!==e[r]&&(n=r.toLowerCase(),i=e[r],t[n]=i)}(n,t),t):t},parsePointsAttribute:function(e){if(!e)return null;var t,n,i=[];for(t=0,n=(e=(e=e.replace(/,/g," ").trim()).split(/\s+/)).length;t<n;t+=2)i.push({x:parseFloat(e[t]),y:parseFloat(e[t+1])});return i},getCSSRules:function(e){var n,i,r=e.getElementsByTagName("style"),o={};for(n=0,i=r.length;n<i;n++){var a=r[n].textContent;""!==(a=a.replace(/\/\*[\s\S]*?\*\//g,"")).trim()&&a.split("}").filter((function(e){return e.trim()})).forEach((function(e){var r=e.split("{"),a={},s=r[1].trim().split(";").filter((function(e){return e.trim()}));for(n=0,i=s.length;n<i;n++){var l=s[n].split(":"),c=l[0].trim(),u=l[1].trim();a[c]=u}(e=r[0].trim()).split(",").forEach((function(e){""!==(e=e.replace(/^svg/i,"").trim())&&(o[e]?t.util.object.extend(o[e],a):o[e]=t.util.object.clone(a))}))}))}return o},loadSVGFromURL:function(e,n,i,r){e=e.replace(/^\n\s*/,"").trim(),new t.util.request(e,{method:"get",onComplete:function(e){var o=e.responseXML;if(!o||!o.documentElement)return n&&n(null),!1;t.parseSVGDocument(o.documentElement,(function(e,t,i,r){n&&n(e,t,i,r)}),i,r)}})},loadSVGFromString:function(e,n,i,r){var o=(new t.window.DOMParser).parseFromString(e.trim(),"text/xml");t.parseSVGDocument(o.documentElement,(function(e,t,i,r){n(e,t,i,r)}),i,r)}})}(e),w.ElementsParser=function(e,t,n,i,r,o){this.elements=e,this.callback=t,this.options=n,this.reviver=i,this.svgUid=n&&n.svgUid||0,this.parsingOptions=r,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=o},(p=w.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},p.createObjects=function(){var e=this;this.elements.forEach((function(t,n){t.setAttribute("svgUid",e.svgUid),e.createObject(t,n)}))},p.findTag=function(e){return w[w.util.string.capitalize(e.tagName.replace("svg:",""))]},p.createObject=function(e,t){var n=this.findTag(e);if(n&&n.fromElement)try{n.fromElement(e,this.createCallback(t,e),this.options)}catch(i){w.log(i)}else this.checkIfDone()},p.createCallback=function(e,t){var n=this;return function(i){var r;n.resolveGradient(i,t,"fill"),n.resolveGradient(i,t,"stroke"),i instanceof w.Image&&i._originalElement&&(r=i.parsePreserveAspectRatioAttribute(t)),i._removeTransformMatrix(r),n.resolveClipPath(i,t),n.reviver&&n.reviver(t,i),n.instances[e]=i,n.checkIfDone()}},p.extractPropertyDefinition=function(e,t,n){var i=e[t],r=this.regexUrl;if(r.test(i)){r.lastIndex=0;var o=r.exec(i)[1];return r.lastIndex=0,w[n][this.svgUid][o]}},p.resolveGradient=function(e,t,n){var i=this.extractPropertyDefinition(e,n,"gradientDefs");if(i){var r=t.getAttribute(n+"-opacity"),o=w.Gradient.fromElement(i,e,r,this.options);e.set(n,o)}},p.createClipPathCallback=function(e,t){return function(e){e._removeTransformMatrix(),e.fillRule=e.clipRule,t.push(e)}},p.resolveClipPath=function(e,t){var n,i,r,o,a=this.extractPropertyDefinition(e,"clipPath","clipPaths");if(a){r=[],i=w.util.invertTransform(e.calcTransformMatrix());for(var s=a[0].parentNode,l=t;l.parentNode&&l.getAttribute("clip-path")!==e.clipPath;)l=l.parentNode;l.parentNode.appendChild(s);for(var c=0;c<a.length;c++)n=a[c],this.findTag(n).fromElement(n,this.createClipPathCallback(e,r),this.options);a=1===r.length?r[0]:new w.Group(r),o=w.util.multiplyTransformMatrices(i,a.calcTransformMatrix()),a.clipPath&&this.resolveClipPath(a,l);var u=w.util.qrDecompose(o);a.flipX=!1,a.flipY=!1,a.set("scaleX",u.scaleX),a.set("scaleY",u.scaleY),a.angle=u.angle,a.skewX=u.skewX,a.skewY=0,a.setPositionByOrigin({x:u.translateX,y:u.translateY},"center","center"),e.clipPath=a}else delete e.clipPath},p.checkIfDone=function(){0==--this.numElements&&(this.instances=this.instances.filter((function(e){return null!=e})),this.callback(this.instances,this.elements))},function(e){var t=e.fabric||(e.fabric={});function n(e,t){this.x=e,this.y=t}t.Point?t.warn("fabric.Point is already defined"):(t.Point=n,n.prototype={type:"point",constructor:n,add:function(e){return new n(this.x+e.x,this.y+e.y)},addEquals:function(e){return this.x+=e.x,this.y+=e.y,this},scalarAdd:function(e){return new n(this.x+e,this.y+e)},scalarAddEquals:function(e){return this.x+=e,this.y+=e,this},subtract:function(e){return new n(this.x-e.x,this.y-e.y)},subtractEquals:function(e){return this.x-=e.x,this.y-=e.y,this},scalarSubtract:function(e){return new n(this.x-e,this.y-e)},scalarSubtractEquals:function(e){return this.x-=e,this.y-=e,this},multiply:function(e){return new n(this.x*e,this.y*e)},multiplyEquals:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return new n(this.x/e,this.y/e)},divideEquals:function(e){return this.x/=e,this.y/=e,this},eq:function(e){return this.x===e.x&&this.y===e.y},lt:function(e){return this.x<e.x&&this.y<e.y},lte:function(e){return this.x<=e.x&&this.y<=e.y},gt:function(e){return this.x>e.x&&this.y>e.y},gte:function(e){return this.x>=e.x&&this.y>=e.y},lerp:function(e,t){return void 0===t&&(t=.5),t=Math.max(Math.min(1,t),0),new n(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)},distanceFrom:function(e){var t=this.x-e.x,n=this.y-e.y;return Math.sqrt(t*t+n*n)},midPointFrom:function(e){return this.lerp(e)},min:function(e){return new n(Math.min(this.x,e.x),Math.min(this.y,e.y))},max:function(e){return new n(Math.max(this.x,e.x),Math.max(this.y,e.y))},toString:function(){return this.x+","+this.y},setXY:function(e,t){return this.x=e,this.y=t,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setFromPoint:function(e){return this.x=e.x,this.y=e.y,this},swap:function(e){var t=this.x,n=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=n},clone:function(){return new n(this.x,this.y)}})}(e),function(e){var t=e.fabric||(e.fabric={});function n(e){this.status=e,this.points=[]}t.Intersection?t.warn("fabric.Intersection is already defined"):(t.Intersection=n,t.Intersection.prototype={constructor:n,appendPoint:function(e){return this.points.push(e),this},appendPoints:function(e){return this.points=this.points.concat(e),this}},t.Intersection.intersectLineLine=function(e,i,r,o){var a,s=(o.x-r.x)*(e.y-r.y)-(o.y-r.y)*(e.x-r.x),l=(i.x-e.x)*(e.y-r.y)-(i.y-e.y)*(e.x-r.x),c=(o.y-r.y)*(i.x-e.x)-(o.x-r.x)*(i.y-e.y);if(0!==c){var u=s/c,h=l/c;0<=u&&u<=1&&0<=h&&h<=1?(a=new n("Intersection")).appendPoint(new t.Point(e.x+u*(i.x-e.x),e.y+u*(i.y-e.y))):a=new n}else a=new n(0===s||0===l?"Coincident":"Parallel");return a},t.Intersection.intersectLinePolygon=function(e,t,i){var r,o,a,s,l=new n,c=i.length;for(s=0;s<c;s++)r=i[s],o=i[(s+1)%c],a=n.intersectLineLine(e,t,r,o),l.appendPoints(a.points);return l.points.length>0&&(l.status="Intersection"),l},t.Intersection.intersectPolygonPolygon=function(e,t){var i,r=new n,o=e.length;for(i=0;i<o;i++){var a=e[i],s=e[(i+1)%o],l=n.intersectLinePolygon(a,s,t);r.appendPoints(l.points)}return r.points.length>0&&(r.status="Intersection"),r},t.Intersection.intersectPolygonRectangle=function(e,i,r){var o=i.min(r),a=i.max(r),s=new t.Point(a.x,o.y),l=new t.Point(o.x,a.y),c=n.intersectLinePolygon(o,s,e),u=n.intersectLinePolygon(s,a,e),h=n.intersectLinePolygon(a,l,e),d=n.intersectLinePolygon(l,o,e),f=new n;return f.appendPoints(c.points),f.appendPoints(u.points),f.appendPoints(h.points),f.appendPoints(d.points),f.points.length>0&&(f.status="Intersection"),f})}(e),function(e){var t=e.fabric||(e.fabric={});function n(e){e?this._tryParsingColor(e):this.setSource([0,0,0,1])}function i(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}t.Color?t.warn("fabric.Color is already defined."):(t.Color=n,t.Color.prototype={_tryParsingColor:function(e){var t;e in n.colorNameMap&&(e=n.colorNameMap[e]),"transparent"===e&&(t=[255,255,255,0]),t||(t=n.sourceFromHex(e)),t||(t=n.sourceFromRgb(e)),t||(t=n.sourceFromHsl(e)),t||(t=[0,0,0,1]),t&&this.setSource(t)},_rgbToHsl:function(e,n,i){e/=255,n/=255,i/=255;var r,o,a,s=t.util.array.max([e,n,i]),l=t.util.array.min([e,n,i]);if(a=(s+l)/2,s===l)r=o=0;else{var c=s-l;switch(o=a>.5?c/(2-s-l):c/(s+l),s){case e:r=(n-i)/c+(n<i?6:0);break;case n:r=(i-e)/c+2;break;case i:r=(e-n)/c+4}r/=6}return[Math.round(360*r),Math.round(100*o),Math.round(100*a)]},getSource:function(){return this._source},setSource:function(e){this._source=e},toRgb:function(){var e=this.getSource();return"rgb("+e[0]+","+e[1]+","+e[2]+")"},toRgba:function(){var e=this.getSource();return"rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+")"},toHsl:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsl("+t[0]+","+t[1]+"%,"+t[2]+"%)"},toHsla:function(){var e=this.getSource(),t=this._rgbToHsl(e[0],e[1],e[2]);return"hsla("+t[0]+","+t[1]+"%,"+t[2]+"%,"+e[3]+")"},toHex:function(){var e,t,n,i=this.getSource();return e=1===(e=i[0].toString(16)).length?"0"+e:e,t=1===(t=i[1].toString(16)).length?"0"+t:t,n=1===(n=i[2].toString(16)).length?"0"+n:n,e.toUpperCase()+t.toUpperCase()+n.toUpperCase()},toHexa:function(){var e,t=this.getSource();return e=1===(e=(e=Math.round(255*t[3])).toString(16)).length?"0"+e:e,this.toHex()+e.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(e){var t=this.getSource();return t[3]=e,this.setSource(t),this},toGrayscale:function(){var e=this.getSource(),t=parseInt((.3*e[0]+.59*e[1]+.11*e[2]).toFixed(0),10),n=e[3];return this.setSource([t,t,t,n]),this},toBlackWhite:function(e){var t=this.getSource(),n=(.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),i=t[3];return e=e||127,n=Number(n)<Number(e)?0:255,this.setSource([n,n,n,i]),this},overlayWith:function(e){e instanceof n||(e=new n(e));var t,i=[],r=this.getAlpha(),o=this.getSource(),a=e.getSource();for(t=0;t<3;t++)i.push(Math.round(.5*o[t]+.5*a[t]));return i[3]=r,this.setSource(i),this}},t.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,t.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,t.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,t.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},t.Color.fromRgb=function(e){return n.fromSource(n.sourceFromRgb(e))},t.Color.sourceFromRgb=function(e){var t=e.match(n.reRGBa);if(t){var i=parseInt(t[1],10)/(/%$/.test(t[1])?100:1)*(/%$/.test(t[1])?255:1),r=parseInt(t[2],10)/(/%$/.test(t[2])?100:1)*(/%$/.test(t[2])?255:1),o=parseInt(t[3],10)/(/%$/.test(t[3])?100:1)*(/%$/.test(t[3])?255:1);return[parseInt(i,10),parseInt(r,10),parseInt(o,10),t[4]?parseFloat(t[4]):1]}},t.Color.fromRgba=n.fromRgb,t.Color.fromHsl=function(e){return n.fromSource(n.sourceFromHsl(e))},t.Color.sourceFromHsl=function(e){var t=e.match(n.reHSLa);if(t){var r,o,a,s=(parseFloat(t[1])%360+360)%360/360,l=parseFloat(t[2])/(/%$/.test(t[2])?100:1),c=parseFloat(t[3])/(/%$/.test(t[3])?100:1);if(0===l)r=o=a=c;else{var u=c<=.5?c*(l+1):c+l-c*l,h=2*c-u;r=i(h,u,s+1/3),o=i(h,u,s),a=i(h,u,s-1/3)}return[Math.round(255*r),Math.round(255*o),Math.round(255*a),t[4]?parseFloat(t[4]):1]}},t.Color.fromHsla=n.fromHsl,t.Color.fromHex=function(e){return n.fromSource(n.sourceFromHex(e))},t.Color.sourceFromHex=function(e){if(e.match(n.reHex)){var t=e.slice(e.indexOf("#")+1),i=3===t.length||4===t.length,r=8===t.length||4===t.length,o=i?t.charAt(0)+t.charAt(0):t.substring(0,2),a=i?t.charAt(1)+t.charAt(1):t.substring(2,4),s=i?t.charAt(2)+t.charAt(2):t.substring(4,6),l=r?i?t.charAt(3)+t.charAt(3):t.substring(6,8):"FF";return[parseInt(o,16),parseInt(a,16),parseInt(s,16),parseFloat((parseInt(l,16)/255).toFixed(2))]}},t.Color.fromSource=function(e){var t=new n;return t.setSource(e),t})}(e),function(e){var t=e.fabric||(e.fabric={}),n=["e","se","s","sw","w","nw","n","ne","e"],i=["ns","nesw","ew","nwse"],r={},o="left",a="top",s="right",l="bottom",c="center",u={top:l,bottom:a,left:s,right:o,center:c},h=t.util.radiansToDegrees,d=Math.sign||function(e){return(e>0)-(e<0)||+e};function f(e,t){var n=e.angle+h(Math.atan2(t.y,t.x))+360;return Math.round(n%360/45)}function p(e,n){var i=n.transform.target,r=i.canvas,o=t.util.object.clone(n);o.target=i,r&&r.fire("object:"+e,o),i.fire(e,n)}function g(e,t){var n=t.canvas,i=e[n.uniScaleKey];return n.uniformScaling&&!i||!n.uniformScaling&&i}function v(e){return e.originX===c&&e.originY===c}function A(e,t,n){var i=e.lockScalingX,r=e.lockScalingY;return!(!i||!r)||(!(t||!i&&!r||!n)||(!(!i||"x"!==t)||!(!r||"y"!==t)))}function m(e,t,n,i){return{e:e,transform:t,pointer:{x:n,y:i}}}function y(e){return function(t,n,i,r){var o=n.target,a=o.getCenterPoint(),s=o.translateToOriginPoint(a,n.originX,n.originY),l=e(t,n,i,r);return o.setPositionByOrigin(s,n.originX,n.originY),l}}function b(e,t){return function(n,i,r,o){var a=t(n,i,r,o);return a&&p(e,m(n,i,r,o)),a}}function C(e,n,i,r,o){var a=e.target,s=a.controls[e.corner],l=a.canvas.getZoom(),c=a.padding/l,u=a.toLocalPoint(new t.Point(r,o),n,i);return u.x>=c&&(u.x-=c),u.x<=-c&&(u.x+=c),u.y>=c&&(u.y-=c),u.y<=c&&(u.y+=c),u.x-=s.offsetX,u.y-=s.offsetY,u}function w(e){return e.flipX!==e.flipY}function x(e,t,n,i,r){if(0!==e[t]){var o=r/e._getTransformedDimensions()[i]*e[n];e.set(n,o)}}function _(e,t,n,i){var r,c=t.target,u=c._getTransformedDimensions(0,c.skewY),d=C(t,t.originX,t.originY,n,i),f=Math.abs(2*d.x)-u.x,p=c.skewX;f<2?r=0:(r=h(Math.atan2(f/c.scaleX,u.y/c.scaleY)),t.originX===o&&t.originY===l&&(r=-r),t.originX===s&&t.originY===a&&(r=-r),w(c)&&(r=-r));var g=p!==r;if(g){var v=c._getTransformedDimensions().y;c.set("skewX",r),x(c,"skewY","scaleY","y",v)}return g}function E(e,t,n,i){var r,c=t.target,u=c._getTransformedDimensions(c.skewX,0),d=C(t,t.originX,t.originY,n,i),f=Math.abs(2*d.y)-u.y,p=c.skewY;f<2?r=0:(r=h(Math.atan2(f/c.scaleY,u.x/c.scaleX)),t.originX===o&&t.originY===l&&(r=-r),t.originX===s&&t.originY===a&&(r=-r),w(c)&&(r=-r));var g=p!==r;if(g){var v=c._getTransformedDimensions().x;c.set("skewY",r),x(c,"skewX","scaleX","x",v)}return g}function S(e,t,n,i,r){r=r||{};var o,a,s,l,c,h,f=t.target,p=f.lockScalingX,m=f.lockScalingY,y=r.by,b=g(e,f),w=A(f,y,b),x=t.gestureScale;if(w)return!1;if(x)a=t.scaleX*x,s=t.scaleY*x;else{if(o=C(t,t.originX,t.originY,n,i),c="y"!==y?d(o.x):1,h="x"!==y?d(o.y):1,t.signX||(t.signX=c),t.signY||(t.signY=h),f.lockScalingFlip&&(t.signX!==c||t.signY!==h))return!1;if(l=f._getTransformedDimensions(),b&&!y){var _=Math.abs(o.x)+Math.abs(o.y),E=t.original,S=_/(Math.abs(l.x*E.scaleX/f.scaleX)+Math.abs(l.y*E.scaleY/f.scaleY));a=E.scaleX*S,s=E.scaleY*S}else a=Math.abs(o.x*f.scaleX/l.x),s=Math.abs(o.y*f.scaleY/l.y);v(t)&&(a*=2,s*=2),t.signX!==c&&"y"!==y&&(t.originX=u[t.originX],a*=-1,t.signX=c),t.signY!==h&&"x"!==y&&(t.originY=u[t.originY],s*=-1,t.signY=h)}var I=f.scaleX,k=f.scaleY;return y?("x"===y&&f.set("scaleX",a),"y"===y&&f.set("scaleY",s)):(!p&&f.set("scaleX",a),!m&&f.set("scaleY",s)),I!==f.scaleX||k!==f.scaleY}r.scaleCursorStyleHandler=function(e,t,i){var r=g(e,i),o="";if(0!==t.x&&0===t.y?o="x":0===t.x&&0!==t.y&&(o="y"),A(i,o,r))return"not-allowed";var a=f(i,t);return n[a]+"-resize"},r.skewCursorStyleHandler=function(e,t,n){var r="not-allowed";if(0!==t.x&&n.lockSkewingY)return r;if(0!==t.y&&n.lockSkewingX)return r;var o=f(n,t)%4;return i[o]+"-resize"},r.scaleSkewCursorStyleHandler=function(e,t,n){return e[n.canvas.altActionKey]?r.skewCursorStyleHandler(e,t,n):r.scaleCursorStyleHandler(e,t,n)},r.rotationWithSnapping=b("rotating",y((function(e,t,n,i){var r=t,o=r.target,a=o.translateToOriginPoint(o.getCenterPoint(),r.originX,r.originY);if(o.lockRotation)return!1;var s,l=Math.atan2(r.ey-a.y,r.ex-a.x),c=Math.atan2(i-a.y,n-a.x),u=h(c-l+r.theta);if(o.snapAngle>0){var d=o.snapAngle,f=o.snapThreshold||d,p=Math.ceil(u/d)*d,g=Math.floor(u/d)*d;Math.abs(u-g)<f?u=g:Math.abs(u-p)<f&&(u=p)}return u<0&&(u=360+u),u%=360,s=o.angle!==u,o.angle=u,s}))),r.scalingEqually=b("scaling",y((function(e,t,n,i){return S(e,t,n,i)}))),r.scalingX=b("scaling",y((function(e,t,n,i){return S(e,t,n,i,{by:"x"})}))),r.scalingY=b("scaling",y((function(e,t,n,i){return S(e,t,n,i,{by:"y"})}))),r.scalingYOrSkewingX=function(e,t,n,i){return e[t.target.canvas.altActionKey]?r.skewHandlerX(e,t,n,i):r.scalingY(e,t,n,i)},r.scalingXOrSkewingY=function(e,t,n,i){return e[t.target.canvas.altActionKey]?r.skewHandlerY(e,t,n,i):r.scalingX(e,t,n,i)},r.changeWidth=b("resizing",y((function(e,t,n,i){var r=t.target,o=C(t,t.originX,t.originY,n,i),a=r.strokeWidth/(r.strokeUniform?r.scaleX:1),s=v(t)?2:1,l=r.width,c=Math.abs(o.x*s/r.scaleX)-a;return r.set("width",Math.max(c,0)),l!==c}))),r.skewHandlerX=function(e,t,n,i){var r,l=t.target,u=l.skewX,h=t.originY;return!l.lockSkewingX&&(0===u?r=C(t,c,c,n,i).x>0?o:s:(u>0&&(r=h===a?o:s),u<0&&(r=h===a?s:o),w(l)&&(r=r===o?s:o)),t.originX=r,b("skewing",y(_))(e,t,n,i))},r.skewHandlerY=function(e,t,n,i){var r,s=t.target,u=s.skewY,h=t.originX;return!s.lockSkewingY&&(0===u?r=C(t,c,c,n,i).y>0?a:l:(u>0&&(r=h===o?a:l),u<0&&(r=h===o?l:a),w(s)&&(r=r===a?l:a)),t.originY=r,b("skewing",y(E))(e,t,n,i))},r.dragHandler=function(e,t,n,i){var r=t.target,o=n-t.offsetX,a=i-t.offsetY,s=!r.get("lockMovementX")&&r.left!==o,l=!r.get("lockMovementY")&&r.top!==a;return s&&r.set("left",o),l&&r.set("top",a),(s||l)&&p("moving",m(e,t,n,i)),s||l},r.scaleOrSkewActionName=function(e,t,n){var i=e[n.canvas.altActionKey];return 0===t.x?i?"skewX":"scaleY":0===t.y?i?"skewY":"scaleX":void 0},r.rotationStyleHandler=function(e,t,n){return n.lockRotation?"not-allowed":t.cursorStyle},r.fireEvent=p,r.wrapWithFixedAnchor=y,r.wrapWithFireEvent=b,r.getLocalPoint=C,t.controlsUtils=r}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.degreesToRadians,i=t.controlsUtils;i.renderCircleControl=function(e,t,n,i,r){i=i||{};var o,a=this.sizeX||i.cornerSize||r.cornerSize,s=this.sizeY||i.cornerSize||r.cornerSize,l=void 0!==i.transparentCorners?i.transparentCorners:r.transparentCorners,c=l?"stroke":"fill",u=!l&&(i.cornerStrokeColor||r.cornerStrokeColor),h=t,d=n;e.save(),e.fillStyle=i.cornerColor||r.cornerColor,e.strokeStyle=i.cornerStrokeColor||r.cornerStrokeColor,a>s?(o=a,e.scale(1,s/a),d=n*a/s):s>a?(o=s,e.scale(a/s,1),h=t*s/a):o=a,e.lineWidth=1,e.beginPath(),e.arc(h,d,o/2,0,2*Math.PI,!1),e[c](),u&&e.stroke(),e.restore()},i.renderSquareControl=function(e,t,i,r,o){r=r||{};var a=this.sizeX||r.cornerSize||o.cornerSize,s=this.sizeY||r.cornerSize||o.cornerSize,l=void 0!==r.transparentCorners?r.transparentCorners:o.transparentCorners,c=l?"stroke":"fill",u=!l&&(r.cornerStrokeColor||o.cornerStrokeColor),h=a/2,d=s/2;e.save(),e.fillStyle=r.cornerColor||o.cornerColor,e.strokeStyle=r.cornerStrokeColor||o.cornerStrokeColor,e.lineWidth=1,e.translate(t,i),e.rotate(n(o.angle)),e[c+"Rect"](-h,-d,a,s),u&&e.strokeRect(-h,-d,a,s),e.restore()}}(e),function(e){var t=e.fabric||(e.fabric={});t.Control=function(e){for(var t in e)this[t]=e[t]},t.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(e,t){return t.cursorStyle},getActionName:function(e,t){return t.actionName},getVisibility:function(e,t){var n=e._controlsVisibility;return n&&void 0!==n[t]?n[t]:this.visible},setVisibility:function(e){this.visible=e},positionHandler:function(e,n){return t.util.transformPoint({x:this.x*e.x+this.offsetX,y:this.y*e.y+this.offsetY},n)},calcCornerCoords:function(e,n,i,r,o){var a,s,l,c,u=o?this.touchSizeX:this.sizeX,h=o?this.touchSizeY:this.sizeY;if(u&&h&&u!==h){var d=Math.atan2(h,u),f=Math.sqrt(u*u+h*h)/2,p=d-t.util.degreesToRadians(e),g=Math.PI/2-d-t.util.degreesToRadians(e);a=f*t.util.cos(p),s=f*t.util.sin(p),l=f*t.util.cos(g),c=f*t.util.sin(g)}else{f=.7071067812*(u&&h?u:n);p=t.util.degreesToRadians(45-e);a=l=f*t.util.cos(p),s=c=f*t.util.sin(p)}return{tl:{x:i-c,y:r-l},tr:{x:i+a,y:r-s},bl:{x:i-a,y:r+s},br:{x:i+c,y:r+l}}},render:function(e,n,i,r,o){if("circle"===((r=r||{}).cornerStyle||o.cornerStyle))t.controlsUtils.renderCircleControl.call(this,e,n,i,r,o);else t.controlsUtils.renderSquareControl.call(this,e,n,i,r,o)}}}(e),function(){function e(e,t){var n,i,r,o,a=e.getAttribute("style"),s=e.getAttribute("offset")||0;if(s=(s=parseFloat(s)/(/%$/.test(s)?100:1))<0?0:s>1?1:s,a){var l=a.split(/\s*;\s*/);for(""===l[l.length-1]&&l.pop(),o=l.length;o--;){var c=l[o].split(/\s*:\s*/),u=c[0].trim(),h=c[1].trim();"stop-color"===u?n=h:"stop-opacity"===u&&(r=h)}}return n||(n=e.getAttribute("stop-color")||"rgb(0,0,0)"),r||(r=e.getAttribute("stop-opacity")),i=(n=new w.Color(n)).getAlpha(),r=isNaN(parseFloat(r))?1:parseFloat(r),r*=i*t,{offset:s,color:n.toRgb(),opacity:r}}var t=w.util.object.clone;w.Gradient=w.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(e){e||(e={}),e.coords||(e.coords={});var t,n=this;Object.keys(e).forEach((function(t){n[t]=e[t]})),this.id?this.id+="_"+w.Object.__uid++:this.id=w.Object.__uid++,t={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0},"radial"===this.type&&(t.r1=e.coords.r1||0,t.r2=e.coords.r2||0),this.coords=t,this.colorStops=e.colorStops.slice()},addColorStop:function(e){for(var t in e){var n=new w.Color(e[t]);this.colorStops.push({offset:parseFloat(t),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(e){var t={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return w.util.populateWithProperties(this,t,e),t},toSVG:function(e,n){var i,r,o,a,s=t(this.coords,!0),l=(n=n||{},t(this.colorStops,!0)),c=s.r1>s.r2,u=this.gradientTransform?this.gradientTransform.concat():w.iMatrix.concat(),h=-this.offsetX,d=-this.offsetY,f=!!n.additionalTransform,p="pixels"===this.gradientUnits?"userSpaceOnUse":"objectBoundingBox";if(l.sort((function(e,t){return e.offset-t.offset})),"objectBoundingBox"===p?(h/=e.width,d/=e.height):(h+=e.width/2,d+=e.height/2),"path"===e.type&&"percentage"!==this.gradientUnits&&(h-=e.pathOffset.x,d-=e.pathOffset.y),u[4]-=h,u[5]-=d,a='id="SVGID_'+this.id+'" gradientUnits="'+p+'"',a+=' gradientTransform="'+(f?n.additionalTransform+" ":"")+w.util.matrixToSVG(u)+'" ',"linear"===this.type?o=["<linearGradient ",a,' x1="',s.x1,'" y1="',s.y1,'" x2="',s.x2,'" y2="',s.y2,'">\n']:"radial"===this.type&&(o=["<radialGradient ",a,' cx="',c?s.x1:s.x2,'" cy="',c?s.y1:s.y2,'" r="',c?s.r1:s.r2,'" fx="',c?s.x2:s.x1,'" fy="',c?s.y2:s.y1,'">\n']),"radial"===this.type){if(c)for((l=l.concat()).reverse(),i=0,r=l.length;i<r;i++)l[i].offset=1-l[i].offset;var g=Math.min(s.r1,s.r2);if(g>0){var v=g/Math.max(s.r1,s.r2);for(i=0,r=l.length;i<r;i++)l[i].offset+=v*(1-l[i].offset)}}for(i=0,r=l.length;i<r;i++){var A=l[i];o.push("<stop ",'offset="',100*A.offset+"%",'" style="stop-color:',A.color,void 0!==A.opacity?";stop-opacity: "+A.opacity:";",'"/>\n')}return o.push("linear"===this.type?"</linearGradient>\n":"</radialGradient>\n"),o.join("")},toLive:function(e){var t,n,i,r=w.util.object.clone(this.coords);if(this.type){for("linear"===this.type?t=e.createLinearGradient(r.x1,r.y1,r.x2,r.y2):"radial"===this.type&&(t=e.createRadialGradient(r.x1,r.y1,r.r1,r.x2,r.y2,r.r2)),n=0,i=this.colorStops.length;n<i;n++){var o=this.colorStops[n].color,a=this.colorStops[n].opacity,s=this.colorStops[n].offset;void 0!==a&&(o=new w.Color(o).setAlpha(a).toRgba()),t.addColorStop(s,o)}return t}}}),w.util.object.extend(w.Gradient,{fromElement:function(t,n,i,r){var o=parseFloat(i)/(/%$/.test(i)?100:1);o=o<0?0:o>1?1:o,isNaN(o)&&(o=1);var a,s,l,c,u=t.getElementsByTagName("stop"),h="userSpaceOnUse"===t.getAttribute("gradientUnits")?"pixels":"percentage",d=t.getAttribute("gradientTransform")||"",f=[],p=0,g=0;for("linearGradient"===t.nodeName||"LINEARGRADIENT"===t.nodeName?(a="linear",s=function(e){return{x1:e.getAttribute("x1")||0,y1:e.getAttribute("y1")||0,x2:e.getAttribute("x2")||"100%",y2:e.getAttribute("y2")||0}}(t)):(a="radial",s=function(e){return{x1:e.getAttribute("fx")||e.getAttribute("cx")||"50%",y1:e.getAttribute("fy")||e.getAttribute("cy")||"50%",r1:0,x2:e.getAttribute("cx")||"50%",y2:e.getAttribute("cy")||"50%",r2:e.getAttribute("r")||"50%"}}(t)),l=u.length;l--;)f.push(e(u[l],o));return c=w.parseTransformAttribute(d),function(e,t,n,i){var r,o;Object.keys(t).forEach((function(e){"Infinity"===(r=t[e])?o=1:"-Infinity"===r?o=0:(o=parseFloat(t[e],10),"string"==typeof r&&/^(\d+\.\d+)%|(\d+)%$/.test(r)&&(o*=.01,"pixels"===i&&("x1"!==e&&"x2"!==e&&"r2"!==e||(o*=n.viewBoxWidth||n.width),"y1"!==e&&"y2"!==e||(o*=n.viewBoxHeight||n.height)))),t[e]=o}))}(0,s,r,h),"pixels"===h&&(p=-n.left,g=-n.top),new w.Gradient({id:t.getAttribute("id"),type:a,coords:s,colorStops:f,gradientUnits:h,gradientTransform:c,offsetX:p,offsetY:g})}})}(),g=w.util.toFixed,w.Pattern=w.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(e,t){if(e||(e={}),this.id=w.Object.__uid++,this.setOptions(e),!e.source||e.source&&"string"!=typeof e.source)t&&t(this);else{var n=this;this.source=w.util.createImage(),w.util.loadImage(e.source,(function(e,i){n.source=e,t&&t(n,i)}),null,this.crossOrigin)}},toObject:function(e){var t,n,i=w.Object.NUM_FRACTION_DIGITS;return"string"==typeof this.source.src?t=this.source.src:"object"==typeof this.source&&this.source.toDataURL&&(t=this.source.toDataURL()),n={type:"pattern",source:t,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:g(this.offsetX,i),offsetY:g(this.offsetY,i),patternTransform:this.patternTransform?this.patternTransform.concat():null},w.util.populateWithProperties(this,n,e),n},toSVG:function(e){var t="function"==typeof this.source?this.source():this.source,n=t.width/e.width,i=t.height/e.height,r=this.offsetX/e.width,o=this.offsetY/e.height,a="";return"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat||(i=1,o&&(i+=Math.abs(o))),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat||(n=1,r&&(n+=Math.abs(r))),t.src?a=t.src:t.toDataURL&&(a=t.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+r+'" y="'+o+'" width="'+n+'" height="'+i+'">\n<image x="0" y="0" width="'+t.width+'" height="'+t.height+'" xlink:href="'+a+'"></image>\n</pattern>\n'},setOptions:function(e){for(var t in e)this[t]=e[t]},toLive:function(e){var t=this.source;if(!t)return"";if(void 0!==t.src){if(!t.complete)return"";if(0===t.naturalWidth||0===t.naturalHeight)return""}return e.createPattern(t,this.repeat)}}),function(e){var t=e.fabric||(e.fabric={}),n=t.util.toFixed;t.Shadow?t.warn("fabric.Shadow is already defined."):(t.Shadow=t.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(e){for(var n in"string"==typeof e&&(e=this._parseShadow(e)),e)this[n]=e[n];this.id=t.Object.__uid++},_parseShadow:function(e){var n=e.trim(),i=t.Shadow.reOffsetsAndBlur.exec(n)||[];return{color:(n.replace(t.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(i[1],10)||0,offsetY:parseFloat(i[2],10)||0,blur:parseFloat(i[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(e){var i=40,r=40,o=t.Object.NUM_FRACTION_DIGITS,a=t.util.rotateVector({x:this.offsetX,y:this.offsetY},t.util.degreesToRadians(-e.angle)),s=new t.Color(this.color);return e.width&&e.height&&(i=100*n((Math.abs(a.x)+this.blur)/e.width,o)+20,r=100*n((Math.abs(a.y)+this.blur)/e.height,o)+20),e.flipX&&(a.x*=-1),e.flipY&&(a.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+r+'%" height="'+(100+2*r)+'%" x="-'+i+'%" width="'+(100+2*i)+'%" >\n\t<feGaussianBlur in="SourceAlpha" stdDeviation="'+n(this.blur?this.blur/2:0,o)+'"></feGaussianBlur>\n\t<feOffset dx="'+n(a.x,o)+'" dy="'+n(a.y,o)+'" result="oBlur" ></feOffset>\n\t<feFlood flood-color="'+s.toRgb()+'" flood-opacity="'+s.getAlpha()+'"/>\n\t<feComposite in2="oBlur" operator="in" />\n\t<feMerge>\n\t\t<feMergeNode></feMergeNode>\n\t\t<feMergeNode in="SourceGraphic"></feMergeNode>\n\t</feMerge>\n</filter>\n'},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var e={},n=t.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach((function(t){this[t]!==n[t]&&(e[t]=this[t])}),this),e}}),t.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(e),function(){if(w.StaticCanvas)w.warn("fabric.StaticCanvas is already defined.");else{var e=w.util.object.extend,t=w.util.getElementOffset,n=w.util.removeFromArray,i=w.util.toFixed,r=w.util.transformPoint,o=w.util.invertTransform,a=w.util.getNodeCanvas,s=w.util.createCanvasElement,l=new Error("Could not initialize `canvas` element");w.StaticCanvas=w.util.createClass(w.CommonMethods,{initialize:function(e,t){t||(t={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,t)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:w.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(e,t){var n=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(e),this._initOptions(t),this.interactive||this._initRetinaScaling(),t.overlayImage&&this.setOverlayImage(t.overlayImage,n),t.backgroundImage&&this.setBackgroundImage(t.backgroundImage,n),t.backgroundColor&&this.setBackgroundColor(t.backgroundColor,n),t.overlayColor&&this.setOverlayColor(t.overlayColor,n),this.calcOffset()},_isRetinaScaling:function(){return w.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,w.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var e=w.devicePixelRatio;this.__initRetinaScaling(e,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(e,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(e,t,n){t.setAttribute("width",this.width*e),t.setAttribute("height",this.height*e),n.scale(e,e)},calcOffset:function(){return this._offset=t(this.lowerCanvasEl),this},setOverlayImage:function(e,t,n){return this.__setBgOverlayImage("overlayImage",e,t,n)},setBackgroundImage:function(e,t,n){return this.__setBgOverlayImage("backgroundImage",e,t,n)},setOverlayColor:function(e,t){return this.__setBgOverlayColor("overlayColor",e,t)},setBackgroundColor:function(e,t){return this.__setBgOverlayColor("backgroundColor",e,t)},__setBgOverlayImage:function(e,t,n,i){return"string"==typeof t?w.util.loadImage(t,(function(t,r){if(t){var o=new w.Image(t,i);this[e]=o,o.canvas=this}n&&n(t,r)}),this,i&&i.crossOrigin):(i&&t.setOptions(i),this[e]=t,t&&(t.canvas=this),n&&n(t,!1)),this},__setBgOverlayColor:function(e,t,n){return this[e]=t,this._initGradient(t,e),this._initPattern(t,e,n),this},_createCanvasElement:function(){var e=s();if(!e)throw l;if(e.style||(e.style={}),void 0===e.getContext)throw l;return e},_initOptions:function(e){var t=this.lowerCanvasEl;this._setOptions(e),this.width=this.width||parseInt(t.width,10)||0,this.height=this.height||parseInt(t.height,10)||0,this.lowerCanvasEl.style&&(t.width=this.width,t.height=this.height,t.style.width=this.width+"px",t.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(e){e&&e.getContext?this.lowerCanvasEl=e:this.lowerCanvasEl=w.util.getById(e)||this._createCanvasElement(),w.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(e,t){return this.setDimensions({width:e},t)},setHeight:function(e,t){return this.setDimensions({height:e},t)},setDimensions:function(e,t){var n;for(var i in t=t||{},e)n=e[i],t.cssOnly||(this._setBackstoreDimension(i,e[i]),n+="px",this.hasLostContext=!0),t.backstoreOnly||this._setCssDimension(i,n);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),t.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(e,t){return this.lowerCanvasEl[e]=t,this.upperCanvasEl&&(this.upperCanvasEl[e]=t),this.cacheCanvasEl&&(this.cacheCanvasEl[e]=t),this[e]=t,this},_setCssDimension:function(e,t){return this.lowerCanvasEl.style[e]=t,this.upperCanvasEl&&(this.upperCanvasEl.style[e]=t),this.wrapperEl&&(this.wrapperEl.style[e]=t),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(e){var t,n,i,r=this._activeObject,o=this.backgroundImage,a=this.overlayImage;for(this.viewportTransform=e,n=0,i=this._objects.length;n<i;n++)(t=this._objects[n]).group||t.setCoords(!0);return r&&r.setCoords(),o&&o.setCoords(!0),a&&a.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(e,t){var n=e,i=this.viewportTransform.slice(0);e=r(e,o(this.viewportTransform)),i[0]=t,i[3]=t;var a=r(e,i);return i[4]+=n.x-a.x,i[5]+=n.y-a.y,this.setViewportTransform(i)},setZoom:function(e){return this.zoomToPoint(new w.Point(0,0),e),this},absolutePan:function(e){var t=this.viewportTransform.slice(0);return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)},relativePan:function(e){return this.absolutePan(new w.Point(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(e){this.stateful&&e.setupState(),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added")},_onObjectRemoved:function(e){this.fire("object:removed",{target:e}),e.fire("removed"),delete e.canvas},clearContext:function(e){return e.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var e=this.contextContainer;return this.renderCanvas(e,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=w.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var e={},t=this.width,n=this.height,i=o(this.viewportTransform);return e.tl=r({x:0,y:0},i),e.br=r({x:t,y:n},i),e.tr=new w.Point(e.br.x,e.tl.y),e.bl=new w.Point(e.tl.x,e.br.y),this.vptCoords=e,e},cancelRequestedRender:function(){this.isRendering&&(w.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(e,t){var n=this.viewportTransform,i=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(e),w.util.setImageSmoothing(e,this.imageSmoothingEnabled),this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._renderObjects(e,t),e.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),i&&(i.canvas=this,i.shouldCache(),i._transformDone=!0,i.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e)),this._renderOverlay(e),this.controlsAboveOverlay&&this.interactive&&this.drawControls(e),this.fire("after:render",{ctx:e})},drawClipPathOnCanvas:function(e){var t=this.viewportTransform,n=this.clipPath;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5]),e.globalCompositeOperation="destination-in",n.transform(e),e.scale(1/n.zoomX,1/n.zoomY),e.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),e.restore()},_renderObjects:function(e,t){var n,i;for(n=0,i=t.length;n<i;++n)t[n]&&t[n].render(e)},_renderBackgroundOrOverlay:function(e,t){var n=this[t+"Color"],i=this[t+"Image"],r=this.viewportTransform,o=this[t+"Vpt"];if(n||i){if(n){e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=n.toLive?n.toLive(e,this):n,o&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),e.transform(1,0,0,1,n.offsetX||0,n.offsetY||0);var a=n.gradientTransform||n.patternTransform;a&&e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),e.fill(),e.restore()}i&&(e.save(),o&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),i.render(e),e.restore())}},_renderBackground:function(e){this._renderBackgroundOrOverlay(e,"background")},_renderOverlay:function(e){this._renderBackgroundOrOverlay(e,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new w.Point(this.width/2,this.height/2)},centerObjectH:function(e){return this._centerObject(e,new w.Point(this.getCenterPoint().x,e.getCenterPoint().y))},centerObjectV:function(e){return this._centerObject(e,new w.Point(e.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(e){var t=this.getCenterPoint();return this._centerObject(e,t)},viewportCenterObject:function(e){var t=this.getVpCenter();return this._centerObject(e,t)},viewportCenterObjectH:function(e){var t=this.getVpCenter();return this._centerObject(e,new w.Point(t.x,e.getCenterPoint().y)),this},viewportCenterObjectV:function(e){var t=this.getVpCenter();return this._centerObject(e,new w.Point(e.getCenterPoint().x,t.y))},getVpCenter:function(){var e=this.getCenterPoint(),t=o(this.viewportTransform);return r(e,t)},_centerObject:function(e,t){return e.setPositionByOrigin(t,"center","center"),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(e){return this.toDatalessObject(e)},toObject:function(e){return this._toObjectMethod("toObject",e)},toDatalessObject:function(e){return this._toObjectMethod("toDatalessObject",e)},_toObjectMethod:function(t,n){var i=this.clipPath,r={version:w.version,objects:this._toObjects(t,n)};return i&&!i.excludeFromExport&&(r.clipPath=this._toObject(this.clipPath,t,n)),e(r,this.__serializeBgOverlay(t,n)),w.util.populateWithProperties(this,r,n),r},_toObjects:function(e,t){return this._objects.filter((function(e){return!e.excludeFromExport})).map((function(n){return this._toObject(n,e,t)}),this)},_toObject:function(e,t,n){var i;this.includeDefaultValues||(i=e.includeDefaultValues,e.includeDefaultValues=!1);var r=e[t](n);return this.includeDefaultValues||(e.includeDefaultValues=i),r},__serializeBgOverlay:function(e,t){var n={},i=this.backgroundImage,r=this.overlayImage,o=this.backgroundColor,a=this.overlayColor;return o&&o.toObject?o.excludeFromExport||(n.background=o.toObject(t)):o&&(n.background=o),a&&a.toObject?a.excludeFromExport||(n.overlay=a.toObject(t)):a&&(n.overlay=a),i&&!i.excludeFromExport&&(n.backgroundImage=this._toObject(i,e,t)),r&&!r.excludeFromExport&&(n.overlayImage=this._toObject(r,e,t)),n},svgViewportTransformation:!0,toSVG:function(e,t){e||(e={}),e.reviver=t;var n=[];return this._setSVGPreamble(n,e),this._setSVGHeader(n,e),this.clipPath&&n.push('<g clip-path="url(#'+this.clipPath.clipPathId+')" >\n'),this._setSVGBgOverlayColor(n,"background"),this._setSVGBgOverlayImage(n,"backgroundImage",t),this._setSVGObjects(n,t),this.clipPath&&n.push("</g>\n"),this._setSVGBgOverlayColor(n,"overlay"),this._setSVGBgOverlayImage(n,"overlayImage",t),n.push("</svg>"),n.join("")},_setSVGPreamble:function(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",'" standalone="no" ?>\n','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n')},_setSVGHeader:function(e,t){var n,r=t.width||this.width,o=t.height||this.height,a='viewBox="0 0 '+this.width+" "+this.height+'" ',s=w.Object.NUM_FRACTION_DIGITS;t.viewBox?a='viewBox="'+t.viewBox.x+" "+t.viewBox.y+" "+t.viewBox.width+" "+t.viewBox.height+'" ':this.svgViewportTransformation&&(n=this.viewportTransform,a='viewBox="'+i(-n[4]/n[0],s)+" "+i(-n[5]/n[3],s)+" "+i(this.width/n[0],s)+" "+i(this.height/n[3],s)+'" '),e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',o,'" ',a,'xml:space="preserve">\n',"<desc>Created with Fabric.js ",w.version,"</desc>\n","<defs>\n",this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),"</defs>\n")},createSVGClipPathMarkup:function(e){var t=this.clipPath;return t?(t.clipPathId="CLIPPATH_"+w.Object.__uid++,'<clipPath id="'+t.clipPathId+'" >\n'+this.clipPath.toClipPathSVG(e.reviver)+"</clipPath>\n"):""},createSVGRefElementsMarkup:function(){var e=this;return["background","overlay"].map((function(t){var n=e[t+"Color"];if(n&&n.toLive){var i=e[t+"Vpt"],r=e.viewportTransform,o={width:e.width/(i?r[0]:1),height:e.height/(i?r[3]:1)};return n.toSVG(o,{additionalTransform:i?w.util.matrixToSVG(r):""})}})).join("")},createSVGFontFacesMarkup:function(){var e,t,n,i,r,o,a,s,l="",c={},u=w.fontPaths,h=[];for(this._objects.forEach((function e(t){h.push(t),t._objects&&t._objects.forEach(e)})),a=0,s=h.length;a<s;a++)if(t=(e=h[a]).fontFamily,-1!==e.type.indexOf("text")&&!c[t]&&u[t]&&(c[t]=!0,e.styles))for(r in n=e.styles)for(o in i=n[r])!c[t=i[o].fontFamily]&&u[t]&&(c[t]=!0);for(var d in c)l+=["\t\t@font-face {\n","\t\t\tfont-family: '",d,"';\n","\t\t\tsrc: url('",u[d],"');\n","\t\t}\n"].join("");return l&&(l=['\t<style type="text/css">',"<![CDATA[\n",l,"]]>","</style>\n"].join("")),l},_setSVGObjects:function(e,t){var n,i,r,o=this._objects;for(i=0,r=o.length;i<r;i++)(n=o[i]).excludeFromExport||this._setSVGObject(e,n,t)},_setSVGObject:function(e,t,n){e.push(t.toSVG(n))},_setSVGBgOverlayImage:function(e,t,n){this[t]&&!this[t].excludeFromExport&&this[t].toSVG&&e.push(this[t].toSVG(n))},_setSVGBgOverlayColor:function(e,t){var n=this[t+"Color"],i=this.viewportTransform,r=this.width,o=this.height;if(n)if(n.toLive){var a=n.repeat,s=w.util.invertTransform(i),l=this[t+"Vpt"]?w.util.matrixToSVG(s):"";e.push('<rect transform="'+l+" translate(",r/2,",",o/2,')"',' x="',n.offsetX-r/2,'" y="',n.offsetY-o/2,'" ','width="',"repeat-y"===a||"no-repeat"===a?n.source.width:r,'" height="',"repeat-x"===a||"no-repeat"===a?n.source.height:o,'" fill="url(#SVGID_'+n.id+')"',"></rect>\n")}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',n,'"',"></rect>\n")},sendToBack:function(e){if(!e)return this;var t,i,r,o=this._activeObject;if(e===o&&"activeSelection"===e.type)for(t=(r=o._objects).length;t--;)i=r[t],n(this._objects,i),this._objects.unshift(i);else n(this._objects,e),this._objects.unshift(e);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(e){if(!e)return this;var t,i,r,o=this._activeObject;if(e===o&&"activeSelection"===e.type)for(r=o._objects,t=0;t<r.length;t++)i=r[t],n(this._objects,i),this._objects.push(i);else n(this._objects,e),this._objects.push(e);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(e,t){if(!e)return this;var i,r,o,a,s,l=this._activeObject,c=0;if(e===l&&"activeSelection"===e.type)for(s=l._objects,i=0;i<s.length;i++)r=s[i],(o=this._objects.indexOf(r))>0+c&&(a=o-1,n(this._objects,r),this._objects.splice(a,0,r)),c++;else 0!==(o=this._objects.indexOf(e))&&(a=this._findNewLowerIndex(e,o,t),n(this._objects,e),this._objects.splice(a,0,e));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(e,t,n){var i,r;if(n)for(i=t,r=t-1;r>=0;--r){if(e.intersectsWithObject(this._objects[r])||e.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(e)){i=r;break}}else i=t-1;return i},bringForward:function(e,t){if(!e)return this;var i,r,o,a,s,l=this._activeObject,c=0;if(e===l&&"activeSelection"===e.type)for(i=(s=l._objects).length;i--;)r=s[i],(o=this._objects.indexOf(r))<this._objects.length-1-c&&(a=o+1,n(this._objects,r),this._objects.splice(a,0,r)),c++;else(o=this._objects.indexOf(e))!==this._objects.length-1&&(a=this._findNewUpperIndex(e,o,t),n(this._objects,e),this._objects.splice(a,0,e));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(e,t,n){var i,r,o;if(n)for(i=t,r=t+1,o=this._objects.length;r<o;++r){if(e.intersectsWithObject(this._objects[r])||e.isContainedWithinObject(this._objects[r])||this._objects[r].isContainedWithinObject(e)){i=r;break}}else i=t+1;return i},moveTo:function(e,t){return n(this._objects,e),this._objects.splice(t,0,e),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(w.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject((function(e){e.dispose&&e.dispose()})),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),w.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),w.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),e(w.StaticCanvas.prototype,w.Observable),e(w.StaticCanvas.prototype,w.Collection),e(w.StaticCanvas.prototype,w.DataURLExporter),e(w.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(e){var t=s();if(!t||!t.getContext)return null;var n=t.getContext("2d");return n&&"setLineDash"===e?void 0!==n.setLineDash:null}}),w.StaticCanvas.prototype.toJSON=w.StaticCanvas.prototype.toObject,w.isLikelyNode&&(w.StaticCanvas.prototype.createPNGStream=function(){var e=a(this.lowerCanvasEl);return e&&e.createPNGStream()},w.StaticCanvas.prototype.createJPEGStream=function(e){var t=a(this.lowerCanvasEl);return t&&t.createJPEGStream(e)})}}(),w.BaseBrush=w.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(e){e.strokeStyle=this.color,e.lineWidth=this.width,e.lineCap=this.strokeLineCap,e.miterLimit=this.strokeMiterLimit,e.lineJoin=this.strokeLineJoin,e.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(e){var t=this.canvas.viewportTransform;e.save(),e.transform(t[0],t[1],t[2],t[3],t[4],t[5])},_setShadow:function(){if(this.shadow){var e=this.canvas,t=this.shadow,n=e.contextTop,i=e.getZoom();e&&e._isRetinaScaling()&&(i*=w.devicePixelRatio),n.shadowColor=t.color,n.shadowBlur=t.blur*i,n.shadowOffsetX=t.offsetX*i,n.shadowOffsetY=t.offsetY*i}},needsFullRender:function(){return new w.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var e=this.canvas.contextTop;e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0},_isOutSideCanvas:function(e){return e.x<0||e.x>this.canvas.getWidth()||e.y<0||e.y>this.canvas.getHeight()}}),w.PencilBrush=w.util.createClass(w.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(e){this.canvas=e,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(e,t,n){var i=t.midPointFrom(n);return e.quadraticCurveTo(t.x,t.y,i.x,i.y),i},onMouseDown:function(e,t){this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],this._prepareForDrawing(e),this._captureDrawingPath(e),this._render())},onMouseMove:function(e,t){if(this.canvas._isMainEvent(t.e)&&(this.drawStraightLine=t.e[this.straightLineKey],(!0!==this.limitedToCanvasSize||!this._isOutSideCanvas(e))&&this._captureDrawingPath(e)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var n=this._points,i=n.length,r=this.canvas.contextTop;this._saveAndTransform(r),this.oldEnd&&(r.beginPath(),r.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(r,n[i-2],n[i-1],!0),r.stroke(),r.restore()}},onMouseUp:function(e){return!this.canvas._isMainEvent(e.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(e){var t=new w.Point(e.x,e.y);this._reset(),this._addPoint(t),this.canvas.contextTop.moveTo(t.x,t.y)},_addPoint:function(e){return!(this._points.length>1&&e.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(e),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(e){var t=new w.Point(e.x,e.y);return this._addPoint(t)},_render:function(e){var t,n,i=this._points[0],r=this._points[1];if(e=e||this.canvas.contextTop,this._saveAndTransform(e),e.beginPath(),2===this._points.length&&i.x===r.x&&i.y===r.y){var o=this.width/1e3;i=new w.Point(i.x,i.y),r=new w.Point(r.x,r.y),i.x-=o,r.x+=o}for(e.moveTo(i.x,i.y),t=1,n=this._points.length;t<n;t++)this._drawSegment(e,i,r),i=this._points[t],r=this._points[t+1];e.lineTo(i.x,i.y),e.stroke(),e.restore()},convertPointsToSVGPath:function(e){var t=this.width/1e3;return w.util.getSmoothPathFromPoints(e,t)},_isEmptySVGPath:function(e){return"M 0 0 Q 0 0 0 0 L 0 0"===w.util.joinPath(e)},createPath:function(e){var t=new w.Path(e,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,t.shadow=new w.Shadow(this.shadow)),t},decimatePoints:function(e,t){if(e.length<=2)return e;var n,i=this.canvas.getZoom(),r=Math.pow(t/i,2),o=e.length-1,a=e[0],s=[a];for(n=1;n<o-1;n++)Math.pow(a.x-e[n].x,2)+Math.pow(a.y-e[n].y,2)>=r&&(a=e[n],s.push(a));return s.push(e[o]),s},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var e=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(e))this.canvas.requestRenderAll();else{var t=this.createPath(e);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:t}),this.canvas.add(t),this.canvas.requestRenderAll(),t.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:t})}}}),w.CircleBrush=w.util.createClass(w.BaseBrush,{width:10,initialize:function(e){this.canvas=e,this.points=[]},drawDot:function(e){var t=this.addPoint(e),n=this.canvas.contextTop;this._saveAndTransform(n),this.dot(n,t),n.restore()},dot:function(e,t){e.fillStyle=t.fill,e.beginPath(),e.arc(t.x,t.y,t.radius,0,2*Math.PI,!1),e.closePath(),e.fill()},onMouseDown:function(e){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(e)},_render:function(){var e,t,n=this.canvas.contextTop,i=this.points;for(this._saveAndTransform(n),e=0,t=i.length;e<t;e++)this.dot(n,i[e]);n.restore()},onMouseMove:function(e){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(e)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(e),this._render()):this.drawDot(e))},onMouseUp:function(){var e,t,n=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var i=[];for(e=0,t=this.points.length;e<t;e++){var r=this.points[e],o=new w.Circle({radius:r.radius,left:r.x,top:r.y,originX:"center",originY:"center",fill:r.fill});this.shadow&&(o.shadow=new w.Shadow(this.shadow)),i.push(o)}var a=new w.Group(i);a.canvas=this.canvas,this.canvas.fire("before:path:created",{path:a}),this.canvas.add(a),this.canvas.fire("path:created",{path:a}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=n,this.canvas.requestRenderAll()},addPoint:function(e){var t=new w.Point(e.x,e.y),n=w.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,i=new w.Color(this.color).setAlpha(w.util.getRandomInt(0,100)/100).toRgba();return t.radius=n,t.fill=i,this.points.push(t),t}}),w.SprayBrush=w.util.createClass(w.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(e){this.canvas=e,this.sprayChunks=[]},onMouseDown:function(e){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(e),this.render(this.sprayChunkPoints)},onMouseMove:function(e){!0===this.limitedToCanvasSize&&this._isOutSideCanvas(e)||(this.addSprayChunk(e),this.render(this.sprayChunkPoints))},onMouseUp:function(){var e=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var t=[],n=0,i=this.sprayChunks.length;n<i;n++)for(var r=this.sprayChunks[n],o=0,a=r.length;o<a;o++){var s=new w.Rect({width:r[o].width,height:r[o].width,left:r[o].x+1,top:r[o].y+1,originX:"center",originY:"center",fill:this.color});t.push(s)}this.optimizeOverlapping&&(t=this._getOptimizedRects(t));var l=new w.Group(t);this.shadow&&l.set("shadow",new w.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:l}),this.canvas.add(l),this.canvas.fire("path:created",{path:l}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=e,this.canvas.requestRenderAll()},_getOptimizedRects:function(e){var t,n,i,r={};for(n=0,i=e.length;n<i;n++)r[t=e[n].left+""+e[n].top]||(r[t]=e[n]);var o=[];for(t in r)o.push(r[t]);return o},render:function(e){var t,n,i=this.canvas.contextTop;for(i.fillStyle=this.color,this._saveAndTransform(i),t=0,n=e.length;t<n;t++){var r=e[t];void 0!==r.opacity&&(i.globalAlpha=r.opacity),i.fillRect(r.x,r.y,r.width,r.width)}i.restore()},_render:function(){var e,t,n=this.canvas.contextTop;for(n.fillStyle=this.color,this._saveAndTransform(n),e=0,t=this.sprayChunks.length;e<t;e++)this.render(this.sprayChunks[e]);n.restore()},addSprayChunk:function(e){this.sprayChunkPoints=[];var t,n,i,r,o=this.width/2;for(r=0;r<this.density;r++){t=w.util.getRandomInt(e.x-o,e.x+o),n=w.util.getRandomInt(e.y-o,e.y+o),i=this.dotWidthVariance?w.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var a=new w.Point(t,n);a.width=i,this.randomOpacity&&(a.opacity=w.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(a)}this.sprayChunks.push(this.sprayChunkPoints)}}),w.PatternBrush=w.util.createClass(w.PencilBrush,{getPatternSrc:function(){var e=w.util.createCanvasElement(),t=e.getContext("2d");return e.width=e.height=25,t.fillStyle=this.color,t.beginPath(),t.arc(10,10,10,0,2*Math.PI,!1),t.closePath(),t.fill(),e},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(e){return e.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(e){this.callSuper("_setBrushStyles",e),e.strokeStyle=this.getPattern(e)},createPath:function(e){var t=this.callSuper("createPath",e),n=t._getLeftTopCoords().scalarAdd(t.strokeWidth/2);return t.stroke=new w.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-n.x,offsetY:-n.y}),t}}),function(){var e=w.util.getPointer,t=w.util.degreesToRadians,n=w.util.isTouchEvent;for(var i in w.Canvas=w.util.createClass(w.StaticCanvas,{initialize:function(e,t){t||(t={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(e,t),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=w.PencilBrush&&new w.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var e,t,n,i=this.getActiveObjects();if(i.length>0&&!this.preserveObjectStacking){t=[],n=[];for(var r=0,o=this._objects.length;r<o;r++)e=this._objects[r],-1===i.indexOf(e)?t.push(e):n.push(e);i.length>1&&(this._activeObject._objects=n),t.push.apply(t,n)}else t=this._objects;return t},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var e=this.contextContainer;return this.renderCanvas(e,this._chooseObjectsToRender()),this},renderTopLayer:function(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()},renderTop:function(){var e=this.contextTop;return this.clearContext(e),this.renderTopLayer(e),this.fire("after:render"),this},_normalizePointer:function(e,t){var n=e.calcTransformMatrix(),i=w.util.invertTransform(n),r=this.restorePointerVpt(t);return w.util.transformPoint(r,i)},isTargetTransparent:function(e,t,n){if(e.shouldCache()&&e._cacheCanvas&&e!==this._activeObject){var i=this._normalizePointer(e,{x:t,y:n}),r=Math.max(e.cacheTranslationX+i.x*e.zoomX,0),o=Math.max(e.cacheTranslationY+i.y*e.zoomY,0);return w.util.isTransparent(e._cacheContext,Math.round(r),Math.round(o),this.targetFindTolerance)}var a=this.contextCache,s=e.selectionBackgroundColor,l=this.viewportTransform;return e.selectionBackgroundColor="",this.clearContext(a),a.save(),a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),e.render(a),a.restore(),e.selectionBackgroundColor=s,w.util.isTransparent(a,t,n,this.targetFindTolerance)},_isSelectionKeyPressed:function(e){return Array.isArray(this.selectionKey)?!!this.selectionKey.find((function(t){return!0===e[t]})):e[this.selectionKey]},_shouldClearSelection:function(e,t){var n=this.getActiveObjects(),i=this._activeObject;return!t||t&&i&&n.length>1&&-1===n.indexOf(t)&&i!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&i&&i!==t},_shouldCenterTransform:function(e,t,n){var i;if(e)return"scale"===t||"scaleX"===t||"scaleY"===t||"resizing"===t?i=this.centeredScaling||e.centeredScaling:"rotate"===t&&(i=this.centeredRotation||e.centeredRotation),i?!n:n},_getOriginFromCorner:function(e,t){var n={x:e.originX,y:e.originY};return"ml"===t||"tl"===t||"bl"===t?n.x="right":"mr"!==t&&"tr"!==t&&"br"!==t||(n.x="left"),"tl"===t||"mt"===t||"tr"===t?n.y="bottom":"bl"!==t&&"mb"!==t&&"br"!==t||(n.y="top"),n},_getActionFromCorner:function(e,t,n,i){if(!t||!e)return"drag";var r=i.controls[t];return r.getActionName(n,r,i)},_setupCurrentTransform:function(e,n,i){if(n){var r=this.getPointer(e),o=n.__corner,a=n.controls[o],s=i&&o?a.getActionHandler(e,n,a):w.controlsUtils.dragHandler,l=this._getActionFromCorner(i,o,e,n),c=this._getOriginFromCorner(n,o),u=e[this.centeredKey],h={target:n,action:l,actionHandler:s,corner:o,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:r.x-n.left,offsetY:r.y-n.top,originX:c.x,originY:c.y,ex:r.x,ey:r.y,lastX:r.x,lastY:r.y,theta:t(n.angle),width:n.width*n.scaleX,shiftKey:e.shiftKey,altKey:u,original:w.util.saveObjectTransform(n)};this._shouldCenterTransform(n,l,u)&&(h.originX="center",h.originY="center"),h.original.originX=c.x,h.original.originY=c.y,this._currentTransform=h,this._beforeTransform(e)}},setCursor:function(e){this.upperCanvasEl.style.cursor=e},_drawSelection:function(e){var t=this._groupSelector,n=new w.Point(t.ex,t.ey),i=w.util.transformPoint(n,this.viewportTransform),r=new w.Point(t.ex+t.left,t.ey+t.top),o=w.util.transformPoint(r,this.viewportTransform),a=Math.min(i.x,o.x),s=Math.min(i.y,o.y),l=Math.max(i.x,o.x),c=Math.max(i.y,o.y),u=this.selectionLineWidth/2;this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(a,s,l-a,c-s)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,a+=u,s+=u,l-=u,c-=u,w.Object.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(a,s,l-a,c-s))},findTarget:function(e,t){if(!this.skipTargetFind){var i,r,o=this.getPointer(e,!0),a=this._activeObject,s=this.getActiveObjects(),l=n(e),c=s.length>1&&!t||1===s.length;if(this.targets=[],c&&a._findTargetCorner(o,l))return a;if(s.length>1&&!t&&a===this._searchPossibleTargets([a],o))return a;if(1===s.length&&a===this._searchPossibleTargets([a],o)){if(!this.preserveObjectStacking)return a;i=a,r=this.targets,this.targets=[]}var u=this._searchPossibleTargets(this._objects,o);return e[this.altSelectionKey]&&u&&i&&u!==i&&(u=i,this.targets=r),u}},_checkTarget:function(e,t,n){if(t&&t.visible&&t.evented&&t.containsPoint(e)){if(!this.perPixelTargetFind&&!t.perPixelTargetFind||t.isEditing)return!0;if(!this.isTargetTransparent(t,n.x,n.y))return!0}},_searchPossibleTargets:function(e,t){for(var n,i,r=e.length;r--;){var o=e[r],a=o.group?this._normalizePointer(o.group,t):t;if(this._checkTarget(a,o,t)){(n=e[r]).subTargetCheck&&n instanceof w.Group&&(i=this._searchPossibleTargets(n._objects,t))&&this.targets.push(i);break}}return n},restorePointerVpt:function(e){return w.util.transformPoint(e,w.util.invertTransform(this.viewportTransform))},getPointer:function(t,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var i,r=e(t),o=this.upperCanvasEl,a=o.getBoundingClientRect(),s=a.width||0,l=a.height||0;s&&l||("top"in a&&"bottom"in a&&(l=Math.abs(a.top-a.bottom)),"right"in a&&"left"in a&&(s=Math.abs(a.right-a.left))),this.calcOffset(),r.x=r.x-this._offset.left,r.y=r.y-this._offset.top,n||(r=this.restorePointerVpt(r));var c=this.getRetinaScaling();return 1!==c&&(r.x/=c,r.y/=c),i=0===s||0===l?{width:1,height:1}:{width:o.width/s,height:o.height/l},{x:r.x*i.width,y:r.y*i.height}},_createUpperCanvas:function(){var e=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),t=this.lowerCanvasEl,n=this.upperCanvasEl;n?n.className="":(n=this._createCanvasElement(),this.upperCanvasEl=n),w.util.addClass(n,"upper-canvas "+e),this.wrapperEl.appendChild(n),this._copyCanvasStyle(t,n),this._applyCanvasStyle(n),this.contextTop=n.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=w.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),w.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),w.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(e){var t=this.width||e.width,n=this.height||e.height;w.util.setStyle(e,{position:"absolute",width:t+"px",height:n+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),e.width=t,e.height=n,w.util.makeElementUnselectable(e)},_copyCanvasStyle:function(e,t){t.style.cssText=e.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var e=this._activeObject;return e?"activeSelection"===e.type&&e._objects?e._objects.slice(0):[e]:[]},_onObjectRemoved:function(e){e===this._activeObject&&(this.fire("before:selection:cleared",{target:e}),this._discardActiveObject(),this.fire("selection:cleared",{target:e}),e.fire("deselected")),e===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",e)},_fireSelectionEvents:function(e,t){var n=!1,i=this.getActiveObjects(),r=[],o=[];e.forEach((function(e){-1===i.indexOf(e)&&(n=!0,e.fire("deselected",{e:t,target:e}),o.push(e))})),i.forEach((function(i){-1===e.indexOf(i)&&(n=!0,i.fire("selected",{e:t,target:i}),r.push(i))})),e.length>0&&i.length>0?n&&this.fire("selection:updated",{e:t,selected:r,deselected:o}):i.length>0?this.fire("selection:created",{e:t,selected:r}):e.length>0&&this.fire("selection:cleared",{e:t,deselected:o})},setActiveObject:function(e,t){var n=this.getActiveObjects();return this._setActiveObject(e,t),this._fireSelectionEvents(n,t),this},_setActiveObject:function(e,t){return this._activeObject!==e&&(!!this._discardActiveObject(t,e)&&(!e.onSelect({e:t})&&(this._activeObject=e,!0)))},_discardActiveObject:function(e,t){var n=this._activeObject;if(n){if(n.onDeselect({e:e,object:t}))return!1;this._activeObject=null}return!0},discardActiveObject:function(e){var t=this.getActiveObjects(),n=this.getActiveObject();return t.length&&this.fire("before:selection:cleared",{target:n,e:e}),this._discardActiveObject(e),this._fireSelectionEvents(t,e),this},dispose:function(){var e=this.wrapperEl;return this.removeListeners(),e.removeChild(this.upperCanvasEl),e.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(e){w.util.cleanUpJsdomNode(this[e]),this[e]=void 0}.bind(this)),e.parentNode&&e.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,w.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(e){var t=this._activeObject;t&&t._renderControls(e)},_toObject:function(e,t,n){var i=this._realizeGroupTransformOnObject(e),r=this.callSuper("_toObject",e,t,n);return this._unwindGroupTransformOnObject(e,i),r},_realizeGroupTransformOnObject:function(e){if(e.group&&"activeSelection"===e.group.type&&this._activeObject===e.group){var t={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach((function(n){t[n]=e[n]})),w.util.addTransformToObject(e,this._activeObject.calcOwnMatrix()),t}return null},_unwindGroupTransformOnObject:function(e,t){t&&e.set(t)},_setSVGObject:function(e,t,n){var i=this._realizeGroupTransformOnObject(t);this.callSuper("_setSVGObject",e,t,n),this._unwindGroupTransformOnObject(t,i)},setViewportTransform:function(e){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),w.StaticCanvas.prototype.setViewportTransform.call(this,e)}}),w.StaticCanvas)"prototype"!==i&&(w.Canvas[i]=w.StaticCanvas[i])}(),function(){var e=w.util.addListener,t=w.util.removeListener,n={passive:!1};function i(e,t){return e.button&&e.button===t-1}w.util.object.extend(w.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(e,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(e,t){var i=this.upperCanvasEl,r=this._getEventPrefix();e(w.window,"resize",this._onResize),e(i,r+"down",this._onMouseDown),e(i,r+"move",this._onMouseMove,n),e(i,r+"out",this._onMouseOut),e(i,r+"enter",this._onMouseEnter),e(i,"wheel",this._onMouseWheel),e(i,"contextmenu",this._onContextMenu),e(i,"dblclick",this._onDoubleClick),e(i,"dragover",this._onDragOver),e(i,"dragenter",this._onDragEnter),e(i,"dragleave",this._onDragLeave),e(i,"drop",this._onDrop),this.enablePointerEvents||e(i,"touchstart",this._onTouchStart,n),"undefined"!=typeof eventjs&&t in eventjs&&(eventjs[t](i,"gesture",this._onGesture),eventjs[t](i,"drag",this._onDrag),eventjs[t](i,"orientation",this._onOrientationChange),eventjs[t](i,"shake",this._onShake),eventjs[t](i,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(t,"remove");var e=this._getEventPrefix();t(w.document,e+"up",this._onMouseUp),t(w.document,"touchend",this._onTouchEnd,n),t(w.document,e+"move",this._onMouseMove,n),t(w.document,"touchmove",this._onMouseMove,n)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(e,t){this.__onTransformGesture&&this.__onTransformGesture(e,t)},_onDrag:function(e,t){this.__onDrag&&this.__onDrag(e,t)},_onMouseWheel:function(e){this.__onMouseWheel(e)},_onMouseOut:function(e){var t=this._hoveredTarget;this.fire("mouse:out",{target:t,e:e}),this._hoveredTarget=null,t&&t.fire("mouseout",{e:e});var n=this;this._hoveredTargets.forEach((function(i){n.fire("mouse:out",{target:t,e:e}),i&&t.fire("mouseout",{e:e})})),this._hoveredTargets=[]},_onMouseEnter:function(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",{target:null,e:e}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(e,t){this.__onOrientationChange&&this.__onOrientationChange(e,t)},_onShake:function(e,t){this.__onShake&&this.__onShake(e,t)},_onLongPress:function(e,t){this.__onLongPress&&this.__onLongPress(e,t)},_onDragOver:function(e){e.preventDefault();var t=this._simpleEventHandler("dragover",e);this._fireEnterLeaveEvents(t,e)},_onDrop:function(e){return this._simpleEventHandler("drop:before",e),this._simpleEventHandler("drop",e)},_onContextMenu:function(e){return this.stopContextMenu&&(e.stopPropagation(),e.preventDefault()),!1},_onDoubleClick:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData(e)},getPointerId:function(e){var t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1},_isMainEvent:function(e){return!0===e.isPrimary||!1!==e.isPrimary&&("touchend"===e.type&&0===e.touches.length||(!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId))},_onTouchStart:function(i){i.preventDefault(),null===this.mainTouchId&&(this.mainTouchId=this.getPointerId(i)),this.__onMouseDown(i),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();e(w.document,"touchend",this._onTouchEnd,n),e(w.document,"touchmove",this._onMouseMove,n),t(r,o+"down",this._onMouseDown)},_onMouseDown:function(i){this.__onMouseDown(i),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();t(r,o+"move",this._onMouseMove,n),e(w.document,o+"up",this._onMouseUp),e(w.document,o+"move",this._onMouseMove,n)},_onTouchEnd:function(i){if(!(i.touches.length>0)){this.__onMouseUp(i),this._resetTransformEventData(),this.mainTouchId=null;var r=this._getEventPrefix();t(w.document,"touchend",this._onTouchEnd,n),t(w.document,"touchmove",this._onMouseMove,n);var o=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout((function(){e(o.upperCanvasEl,r+"down",o._onMouseDown),o._willAddMouseDown=0}),400)}},_onMouseUp:function(i){this.__onMouseUp(i),this._resetTransformEventData();var r=this.upperCanvasEl,o=this._getEventPrefix();this._isMainEvent(i)&&(t(w.document,o+"up",this._onMouseUp),t(w.document,o+"move",this._onMouseMove,n),e(r,o+"move",this._onMouseMove,n))},_onMouseMove:function(e){!this.allowTouchScrolling&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)},_onResize:function(){this.calcOffset()},_shouldRender:function(e){var t=this._activeObject;return!!(!!t!=!!e||t&&e&&t!==e)||(t&&t.isEditing,!1)},__onMouseUp:function(e){var t,n=this._currentTransform,r=this._groupSelector,o=!1,a=!r||0===r.left&&0===r.top;if(this._cacheTransformEventData(e),t=this._target,this._handleEvent(e,"up:before"),i(e,3))this.fireRightClick&&this._handleEvent(e,"up",3,a);else{if(i(e,2))return this.fireMiddleClick&&this._handleEvent(e,"up",2,a),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(e);else if(this._isMainEvent(e)){if(n&&(this._finalizeCurrentTransform(e),o=n.actionPerformed),!a){var s=t===this._activeObject;this._maybeGroupObjects(e),o||(o=this._shouldRender(t)||!s&&t===this._activeObject)}var l,c;if(t){if(l=t._findTargetCorner(this.getPointer(e,!0),w.util.isTouchEvent(e)),t.selectable&&t!==this._activeObject&&"up"===t.activeOn)this.setActiveObject(t,e),o=!0;else{var u=t.controls[l],h=u&&u.getMouseUpHandler(e,t,u);h&&h(e,n,(c=this.getPointer(e)).x,c.y)}t.isMoving=!1}if(n&&(n.target!==t||n.corner!==l)){var d=n.target&&n.target.controls[n.corner],f=d&&d.getMouseUpHandler(e,t,u);c=c||this.getPointer(e),f&&f(e,n,c.x,c.y)}this._setCursorFromEvent(e,t),this._handleEvent(e,"up",1,a),this._groupSelector=null,this._currentTransform=null,t&&(t.__corner=0),o?this.requestRenderAll():a||this.renderTop()}}},_simpleEventHandler:function(e,t){var n=this.findTarget(t),i=this.targets,r={e:t,target:n,subTargets:i};if(this.fire(e,r),n&&n.fire(e,r),!i)return n;for(var o=0;o<i.length;o++)i[o].fire(e,r);return n},_handleEvent:function(e,t,n,i){var r=this._target,o=this.targets||[],a={e:e,target:r,subTargets:o,button:n||1,isClick:i||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};"up"===t&&(a.currentTarget=this.findTarget(e),a.currentSubTargets=this.targets),this.fire("mouse:"+t,a),r&&r.fire("mouse"+t,a);for(var s=0;s<o.length;s++)o[s].fire("mouse"+t,a)},_finalizeCurrentTransform:function(e){var t=this._currentTransform,n=t.target,i={e:e,target:n,transform:t,action:t.action};n._scaling&&(n._scaling=!1),n.setCoords(),(t.actionPerformed||this.stateful&&n.hasStateChanged())&&this._fire("modified",i)},_onMouseDownInDrawingMode:function(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(e).requestRenderAll();var t=this.getPointer(e);this.freeDrawingBrush.onMouseDown(t,{e:e,pointer:t}),this._handleEvent(e,"down")},_onMouseMoveInDrawingMode:function(e){if(this._isCurrentlyDrawing){var t=this.getPointer(e);this.freeDrawingBrush.onMouseMove(t,{e:e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")},_onMouseUpInDrawingMode:function(e){var t=this.getPointer(e);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:e,pointer:t}),this._handleEvent(e,"up")},__onMouseDown:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"down:before");var t=this._target;if(i(e,3))this.fireRightClick&&this._handleEvent(e,"down",3);else if(i(e,2))this.fireMiddleClick&&this._handleEvent(e,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(e);else if(this._isMainEvent(e)&&!this._currentTransform){var n=this._pointer;this._previousPointer=n;var r=this._shouldRender(t),o=this._shouldGroup(e,t);if(this._shouldClearSelection(e,t)?this.discardActiveObject(e):o&&(this._handleGrouping(e,t),t=this._activeObject),!this.selection||t&&(t.selectable||t.isEditing||t===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),t){var a=t===this._activeObject;t.selectable&&"down"===t.activeOn&&this.setActiveObject(t,e);var s=t._findTargetCorner(this.getPointer(e,!0),w.util.isTouchEvent(e));if(t.__corner=s,t===this._activeObject&&(s||!o)){this._setupCurrentTransform(e,t,a);var l=t.controls[s],c=(n=this.getPointer(e),l&&l.getMouseDownHandler(e,t,l));c&&c(e,this._currentTransform,n.x,n.y)}}this._handleEvent(e,"down"),(r||o)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(e){this._resetTransformEventData(),this._pointer=this.getPointer(e,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)||null},_beforeTransform:function(e){var t=this._currentTransform;this.stateful&&t.target.saveState(),this.fire("before:transform",{e:e,transform:t})},__onMouseMove:function(e){var t,n;if(this._handleEvent(e,"move:before"),this._cacheTransformEventData(e),this.isDrawingMode)this._onMouseMoveInDrawingMode(e);else if(this._isMainEvent(e)){var i=this._groupSelector;i?(n=this._absolutePointer,i.left=n.x-i.ex,i.top=n.y-i.ey,this.renderTop()):this._currentTransform?this._transformObject(e):(t=this.findTarget(e)||null,this._setCursorFromEvent(e,t),this._fireOverOutEvents(t,e)),this._handleEvent(e,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(e,t){var n=this._hoveredTarget,i=this._hoveredTargets,r=this.targets,o=Math.max(i.length,r.length);this.fireSyntheticInOutEvents(e,t,{oldTarget:n,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var a=0;a<o;a++)this.fireSyntheticInOutEvents(r[a],t,{oldTarget:i[a],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=e,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(e,t){var n=this._draggedoverTarget,i=this._hoveredTargets,r=this.targets,o=Math.max(i.length,r.length);this.fireSyntheticInOutEvents(e,t,{oldTarget:n,evtOut:"dragleave",evtIn:"dragenter"});for(var a=0;a<o;a++)this.fireSyntheticInOutEvents(r[a],t,{oldTarget:i[a],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=e},fireSyntheticInOutEvents:function(e,t,n){var i,r,o,a=n.oldTarget,s=a!==e,l=n.canvasEvtIn,c=n.canvasEvtOut;s&&(i={e:t,target:e,previousTarget:a},r={e:t,target:a,nextTarget:e}),o=e&&s,a&&s&&(c&&this.fire(c,r),a.fire(n.evtOut,r)),o&&(l&&this.fire(l,i),e.fire(n.evtIn,i))},__onMouseWheel:function(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()},_transformObject:function(e){var t=this.getPointer(e),n=this._currentTransform;n.reset=!1,n.shiftKey=e.shiftKey,n.altKey=e[this.centeredKey],this._performTransformAction(e,n,t),n.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(e,t,n){var i=n.x,r=n.y,o=t.action,a=!1,s=t.actionHandler;s&&(a=s(e,t,i,r)),"drag"===o&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a},_fire:w.controlsUtils.fireEvent,_setCursorFromEvent:function(e,t){if(!t)return this.setCursor(this.defaultCursor),!1;var n=t.hoverCursor||this.hoverCursor,i=this._activeObject&&"activeSelection"===this._activeObject.type?this._activeObject:null,r=(!i||!i.contains(t))&&t._findTargetCorner(this.getPointer(e,!0));r?this.setCursor(this.getCornerCursor(r,t,e)):(t.subTargetCheck&&this.targets.concat().reverse().map((function(e){n=e.hoverCursor||n})),this.setCursor(n))},getCornerCursor:function(e,t,n){var i=t.controls[e];return i.cursorStyleHandler(n,i,t)}})}(),v=Math.min,A=Math.max,w.util.object.extend(w.Canvas.prototype,{_shouldGroup:function(e,t){var n=this._activeObject;return n&&this._isSelectionKeyPressed(e)&&t&&t.selectable&&this.selection&&(n!==t||"activeSelection"===n.type)&&!t.onSelect({e:e})},_handleGrouping:function(e,t){var n=this._activeObject;n.__corner||(t!==n||(t=this.findTarget(e,!0))&&t.selectable)&&(n&&"activeSelection"===n.type?this._updateActiveSelection(t,e):this._createActiveSelection(t,e))},_updateActiveSelection:function(e,t){var n=this._activeObject,i=n._objects.slice(0);n.contains(e)?(n.removeWithUpdate(e),this._hoveredTarget=e,this._hoveredTargets=this.targets.concat(),1===n.size()&&this._setActiveObject(n.item(0),t)):(n.addWithUpdate(e),this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(i,t)},_createActiveSelection:function(e,t){var n=this.getActiveObjects(),i=this._createGroup(e);this._hoveredTarget=i,this._setActiveObject(i,t),this._fireSelectionEvents(n,t)},_createGroup:function(e){var t=this._objects,n=t.indexOf(this._activeObject)<t.indexOf(e)?[this._activeObject,e]:[e,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new w.ActiveSelection(n,{canvas:this})},_groupSelectedObjects:function(e){var t,n=this._collectObjects(e);1===n.length?this.setActiveObject(n[0],e):n.length>1&&(t=new w.ActiveSelection(n.reverse(),{canvas:this}),this.setActiveObject(t,e))},_collectObjects:function(e){for(var t,n=[],i=this._groupSelector.ex,r=this._groupSelector.ey,o=i+this._groupSelector.left,a=r+this._groupSelector.top,s=new w.Point(v(i,o),v(r,a)),l=new w.Point(A(i,o),A(r,a)),c=!this.selectionFullyContained,u=i===o&&r===a,h=this._objects.length;h--&&!((t=this._objects[h])&&t.selectable&&t.visible&&(c&&t.intersectsWithRect(s,l,!0)||t.isContainedWithinRect(s,l,!0)||c&&t.containsPoint(s,null,!0)||c&&t.containsPoint(l,null,!0))&&(n.push(t),u)););return n.length>1&&(n=n.filter((function(t){return!t.onSelect({e:e})}))),n},_maybeGroupObjects:function(e){this.selection&&this._groupSelector&&this._groupSelectedObjects(e),this.setCursor(this.defaultCursor),this._groupSelector=null}}),w.util.object.extend(w.StaticCanvas.prototype,{toDataURL:function(e){e||(e={});var t=e.format||"png",n=e.quality||1,i=(e.multiplier||1)*(e.enableRetinaScaling?this.getRetinaScaling():1),r=this.toCanvasElement(i,e);return w.util.toDataURL(r,t,n)},toCanvasElement:function(e,t){e=e||1;var n=((t=t||{}).width||this.width)*e,i=(t.height||this.height)*e,r=this.getZoom(),o=this.width,a=this.height,s=r*e,l=this.viewportTransform,c=(l[4]-(t.left||0))*e,u=(l[5]-(t.top||0))*e,h=this.interactive,d=[s,0,0,s,c,u],f=this.enableRetinaScaling,p=w.util.createCanvasElement(),g=this.contextTop;return p.width=n,p.height=i,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=d,this.width=n,this.height=i,this.calcViewportBoundaries(),this.renderCanvas(p.getContext("2d"),this._objects),this.viewportTransform=l,this.width=o,this.height=a,this.calcViewportBoundaries(),this.interactive=h,this.enableRetinaScaling=f,this.contextTop=g,p}}),w.util.object.extend(w.StaticCanvas.prototype,{loadFromJSON:function(e,t,n){if(e){var i="string"==typeof e?JSON.parse(e):w.util.object.clone(e),r=this,o=i.clipPath,a=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete i.clipPath,this._enlivenObjects(i.objects,(function(e){r.clear(),r._setBgOverlay(i,(function(){o?r._enlivenObjects([o],(function(n){r.clipPath=n[0],r.__setupCanvas.call(r,i,e,a,t)})):r.__setupCanvas.call(r,i,e,a,t)}))}),n),this}},__setupCanvas:function(e,t,n,i){var r=this;t.forEach((function(e,t){r.insertAt(e,t)})),this.renderOnAddRemove=n,delete e.objects,delete e.backgroundImage,delete e.overlayImage,delete e.background,delete e.overlay,this._setOptions(e),this.renderAll(),i&&i()},_setBgOverlay:function(e,t){var n={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(e.backgroundImage||e.overlayImage||e.background||e.overlay){var i=function(){n.backgroundImage&&n.overlayImage&&n.backgroundColor&&n.overlayColor&&t&&t()};this.__setBgOverlay("backgroundImage",e.backgroundImage,n,i),this.__setBgOverlay("overlayImage",e.overlayImage,n,i),this.__setBgOverlay("backgroundColor",e.background,n,i),this.__setBgOverlay("overlayColor",e.overlay,n,i)}else t&&t()},__setBgOverlay:function(e,t,n,i){var r=this;if(!t)return n[e]=!0,void(i&&i());"backgroundImage"===e||"overlayImage"===e?w.util.enlivenObjects([t],(function(t){r[e]=t[0],n[e]=!0,i&&i()})):this["set"+w.util.string.capitalize(e,!0)](t,(function(){n[e]=!0,i&&i()}))},_enlivenObjects:function(e,t,n){e&&0!==e.length?w.util.enlivenObjects(e,(function(e){t&&t(e)}),null,n):t&&t([])},_toDataURL:function(e,t){this.clone((function(n){t(n.toDataURL(e))}))},_toDataURLWithMultiplier:function(e,t,n){this.clone((function(i){n(i.toDataURLWithMultiplier(e,t))}))},clone:function(e,t){var n=JSON.stringify(this.toJSON(t));this.cloneWithoutData((function(t){t.loadFromJSON(n,(function(){e&&e(t)}))}))},cloneWithoutData:function(e){var t=w.util.createCanvasElement();t.width=this.width,t.height=this.height;var n=new w.Canvas(t);this.backgroundImage?(n.setBackgroundImage(this.backgroundImage.src,(function(){n.renderAll(),e&&e(n)})),n.backgroundImageOpacity=this.backgroundImageOpacity,n.backgroundImageStretch=this.backgroundImageStretch):e&&e(n)}}),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.object.clone,r=t.util.toFixed,o=t.util.string.capitalize,a=t.util.degreesToRadians,s=!t.isLikelyNode;t.Object||(t.Object=t.util.createClass(t.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:s,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(e){e&&this.setOptions(e)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=t.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(e){var n=t.perfLimitSizeTotal,i=e.width,r=e.height,o=t.maxCacheSideLimit,a=t.minCacheSideLimit;if(i<=o&&r<=o&&i*r<=n)return i<a&&(e.width=a),r<a&&(e.height=a),e;var s=i/r,l=t.util.limitDimsByArea(s,n),c=t.util.capValue,u=c(a,l.x,o),h=c(a,l.y,o);return i>u&&(e.zoomX/=i/u,e.width=u,e.capped=!0),r>h&&(e.zoomY/=r/h,e.height=h,e.capped=!0),e},_getCacheCanvasDimensions:function(){var e=this.getTotalObjectScaling(),t=this._getTransformedDimensions(0,0),n=t.x*e.scaleX/this.scaleX,i=t.y*e.scaleY/this.scaleY;return{width:n+2,height:i+2,zoomX:e.scaleX,zoomY:e.scaleY,x:n,y:i}},_updateCacheCanvas:function(){var e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){var n=e._currentTransform.target,i=e._currentTransform.action;if(this===n&&i.slice&&"scale"===i.slice(0,5))return!1}var r,o,a=this._cacheCanvas,s=this._limitCacheSize(this._getCacheCanvasDimensions()),l=t.minCacheSideLimit,c=s.width,u=s.height,h=s.zoomX,d=s.zoomY,f=c!==this.cacheWidth||u!==this.cacheHeight,p=this.zoomX!==h||this.zoomY!==d,g=f||p,v=0,A=0,m=!1;if(f){var y=this._cacheCanvas.width,b=this._cacheCanvas.height,C=c>y||u>b;m=C||(c<.9*y||u<.9*b)&&y>l&&b>l,C&&!s.capped&&(c>l||u>l)&&(v=.1*c,A=.1*u)}return this instanceof t.Text&&this.path&&(g=!0,m=!0,v+=this.getHeightOfLine(0)*this.zoomX,A+=this.getHeightOfLine(0)*this.zoomY),!!g&&(m?(a.width=Math.ceil(c+v),a.height=Math.ceil(u+A)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,a.width,a.height)),r=s.x/2,o=s.y/2,this.cacheTranslationX=Math.round(a.width/2-r)+r,this.cacheTranslationY=Math.round(a.height/2-o)+o,this.cacheWidth=c,this.cacheHeight=u,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(h,d),this.zoomX=h,this.zoomY=d,!0)},setOptions:function(e){this._setOptions(e),this._initGradient(e.fill,"fill"),this._initGradient(e.stroke,"stroke"),this._initPattern(e.fill,"fill"),this._initPattern(e.stroke,"stroke")},transform:function(e){var t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,n=this.calcTransformMatrix(!t);e.transform(n[0],n[1],n[2],n[3],n[4],n[5])},toObject:function(e){var n=t.Object.NUM_FRACTION_DIGITS,i={type:this.type,version:t.version,originX:this.originX,originY:this.originY,left:r(this.left,n),top:r(this.top,n),width:r(this.width,n),height:r(this.height,n),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:r(this.strokeWidth,n),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:r(this.strokeMiterLimit,n),scaleX:r(this.scaleX,n),scaleY:r(this.scaleY,n),angle:r(this.angle,n),flipX:this.flipX,flipY:this.flipY,opacity:r(this.opacity,n),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:r(this.skewX,n),skewY:r(this.skewY,n)};return this.clipPath&&!this.clipPath.excludeFromExport&&(i.clipPath=this.clipPath.toObject(e),i.clipPath.inverted=this.clipPath.inverted,i.clipPath.absolutePositioned=this.clipPath.absolutePositioned),t.util.populateWithProperties(this,i,e),this.includeDefaultValues||(i=this._removeDefaultValues(i)),i},toDatalessObject:function(e){return this.toObject(e)},_removeDefaultValues:function(e){var n=t.util.getKlass(e.type).prototype;return n.stateProperties.forEach((function(t){"left"!==t&&"top"!==t&&(e[t]===n[t]&&delete e[t],Array.isArray(e[t])&&Array.isArray(n[t])&&0===e[t].length&&0===n[t].length&&delete e[t])})),e},toString:function(){return"#<fabric."+o(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var e=t.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(e.scaleX),scaleY:Math.abs(e.scaleY)}},getTotalObjectScaling:function(){var e=this.getObjectScaling(),t=e.scaleX,n=e.scaleY;if(this.canvas){var i=this.canvas.getZoom(),r=this.canvas.getRetinaScaling();t*=i*r,n*=i*r}return{scaleX:t,scaleY:n}},getObjectOpacity:function(){var e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e},_set:function(e,n){var i="scaleX"===e||"scaleY"===e,r=this[e]!==n,o=!1;return i&&(n=this._constrainScale(n)),"scaleX"===e&&n<0?(this.flipX=!this.flipX,n*=-1):"scaleY"===e&&n<0?(this.flipY=!this.flipY,n*=-1):"shadow"!==e||!n||n instanceof t.Shadow?"dirty"===e&&this.group&&this.group.set("dirty",n):n=new t.Shadow(n),this[e]=n,r&&(o=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(e)>-1?(this.dirty=!0,o&&this.group.set("dirty",!0)):o&&this.stateProperties.indexOf(e)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:t.iMatrix.concat()},isNotVisible:function(){return 0===this.opacity||!this.width&&!this.height&&0===this.strokeWidth||!this.visible},render:function(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(e),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),e.restore())},renderCache:function(e){e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,e.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&"transparent"!==this.stroke&&0!==this.strokeWidth},hasFill:function(){return this.fill&&"transparent"!==this.fill},needsItsOwnCache:function(){return!("stroke"!==this.paintFirst||!this.hasFill()||!this.hasStroke()||"object"!=typeof this.shadow)||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(0!==this.shadow.offsetX||0!==this.shadow.offsetY)},drawClipPathOnCache:function(e,n){if(e.save(),n.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",n.absolutePositioned){var i=t.util.invertTransform(this.calcTransformMatrix());e.transform(i[0],i[1],i[2],i[3],i[4],i[5])}n.transform(e),e.scale(1/n.zoomX,1/n.zoomY),e.drawImage(n._cacheCanvas,-n.cacheTranslationX,-n.cacheTranslationY),e.restore()},drawObject:function(e,t){var n=this.fill,i=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath),this.fill=n,this.stroke=i},_drawClipPath:function(e,t){t&&(t.canvas=this.canvas,t.shouldCache(),t._transformDone=!0,t.renderCache({forClipping:!0}),this.drawClipPathOnCache(e,t))},drawCacheOnCanvas:function(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(e){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!e&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!e){var t=this.cacheWidth/this.zoomX,n=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-t/2,-n/2,t,n)}return!0}return!1},_renderBackground:function(e){if(this.backgroundColor){var t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}},_setOpacity:function(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity},_setStrokeStyles:function(e,t){var n=t.stroke;n&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,n.toLive?"percentage"===n.gradientUnits||n.gradientTransform||n.patternTransform?this._applyPatternForTransformedGradient(e,n):(e.strokeStyle=n.toLive(e,this),this._applyPatternGradientTransform(e,n)):e.strokeStyle=t.stroke)},_setFillStyles:function(e,t){var n=t.fill;n&&(n.toLive?(e.fillStyle=n.toLive(e,this),this._applyPatternGradientTransform(e,t.fill)):e.fillStyle=n)},_setClippingProperties:function(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"},_setLineDash:function(e,t){t&&0!==t.length&&(1&t.length&&t.push.apply(t,t),e.setLineDash(t))},_renderControls:function(e,n){var i,r,o,s=this.getViewportTransform(),l=this.calcTransformMatrix();r=void 0!==(n=n||{}).hasBorders?n.hasBorders:this.hasBorders,o=void 0!==n.hasControls?n.hasControls:this.hasControls,l=t.util.multiplyTransformMatrices(s,l),i=t.util.qrDecompose(l),e.save(),e.translate(i.translateX,i.translateY),e.lineWidth=1*this.borderScaleFactor,this.group||(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(i.angle-=180),e.rotate(a(this.group?i.angle:this.angle)),n.forActiveSelection||this.group?r&&this.drawBordersInGroup(e,i,n):r&&this.drawBorders(e,n),o&&this.drawControls(e,n),e.restore()},_setShadow:function(e){if(this.shadow){var n,i=this.shadow,r=this.canvas,o=r&&r.viewportTransform[0]||1,a=r&&r.viewportTransform[3]||1;n=i.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),r&&r._isRetinaScaling()&&(o*=t.devicePixelRatio,a*=t.devicePixelRatio),e.shadowColor=i.color,e.shadowBlur=i.blur*t.browserShadowBlurConstant*(o+a)*(n.scaleX+n.scaleY)/4,e.shadowOffsetX=i.offsetX*o*n.scaleX,e.shadowOffsetY=i.offsetY*a*n.scaleY}},_removeShadow:function(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)},_applyPatternGradientTransform:function(e,t){if(!t||!t.toLive)return{offsetX:0,offsetY:0};var n=t.gradientTransform||t.patternTransform,i=-this.width/2+t.offsetX||0,r=-this.height/2+t.offsetY||0;return"percentage"===t.gradientUnits?e.transform(this.width,0,0,this.height,i,r):e.transform(1,0,0,1,i,r),n&&e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),{offsetX:i,offsetY:r}},_renderPaintInOrder:function(e){"stroke"===this.paintFirst?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))},_render:function(){},_renderFill:function(e){this.fill&&(e.save(),this._setFillStyles(e,this),"evenodd"===this.fillRule?e.fill("evenodd"):e.fill(),e.restore())},_renderStroke:function(e){if(this.stroke&&0!==this.strokeWidth){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform&&this.group){var t=this.getObjectScaling();e.scale(1/t.scaleX,1/t.scaleY)}else this.strokeUniform&&e.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}},_applyPatternForTransformedGradient:function(e,n){var i,r=this._limitCacheSize(this._getCacheCanvasDimensions()),o=t.util.createCanvasElement(),a=this.canvas.getRetinaScaling(),s=r.x/this.scaleX/a,l=r.y/this.scaleY/a;o.width=s,o.height=l,(i=o.getContext("2d")).beginPath(),i.moveTo(0,0),i.lineTo(s,0),i.lineTo(s,l),i.lineTo(0,l),i.closePath(),i.translate(s/2,l/2),i.scale(r.zoomX/this.scaleX/a,r.zoomY/this.scaleY/a),this._applyPatternGradientTransform(i,n),i.fillStyle=n.toLive(e),i.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(a*this.scaleX/r.zoomX,a*this.scaleY/r.zoomY),e.strokeStyle=i.createPattern(o,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var e=t.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",e.scaleX),this.set("scaleY",e.scaleY),this.angle=e.angle,this.skewX=e.skewX,this.skewY=0}},_removeTransformMatrix:function(e){var n=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),n=t.util.transformPoint(n,this.transformMatrix)),this.transformMatrix=null,e&&(this.scaleX*=e.scaleX,this.scaleY*=e.scaleY,this.cropX=e.cropX,this.cropY=e.cropY,n.x+=e.offsetLeft,n.y+=e.offsetTop,this.width=e.width,this.height=e.height),this.setPositionByOrigin(n,"center","center")},clone:function(e,n){var i=this.toObject(n);this.constructor.fromObject?this.constructor.fromObject(i,e):t.Object._fromObject("Object",i,e)},cloneAsImage:function(e,n){var i=this.toCanvasElement(n);return e&&e(new t.Image(i)),this},toCanvasElement:function(e){e||(e={});var n=t.util,i=n.saveObjectTransform(this),r=this.group,o=this.shadow,a=Math.abs,s=(e.multiplier||1)*(e.enableRetinaScaling?t.devicePixelRatio:1);delete this.group,e.withoutTransform&&n.resetObjectTransform(this),e.withoutShadow&&(this.shadow=null);var l,c,u,h,d=t.util.createCanvasElement(),f=this.getBoundingRect(!0,!0),p=this.shadow,g={x:0,y:0};p&&(c=p.blur,l=p.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),g.x=2*Math.round(a(p.offsetX)+c)*a(l.scaleX),g.y=2*Math.round(a(p.offsetY)+c)*a(l.scaleY)),u=f.width+g.x,h=f.height+g.y,d.width=Math.ceil(u),d.height=Math.ceil(h);var v=new t.StaticCanvas(d,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});"jpeg"===e.format&&(v.backgroundColor="#fff"),this.setPositionByOrigin(new t.Point(v.width/2,v.height/2),"center","center");var A=this.canvas;v.add(this);var m=v.toCanvasElement(s||1,e);return this.shadow=o,this.set("canvas",A),r&&(this.group=r),this.set(i).setCoords(),v._objects=[],v.dispose(),v=null,m},toDataURL:function(e){return e||(e={}),t.util.toDataURL(this.toCanvasElement(e),e.format||"png",e.quality||1)},isType:function(e){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===e},complexity:function(){return 1},toJSON:function(e){return this.toObject(e)},rotate:function(e){var t=("center"!==this.originX||"center"!==this.originY)&&this.centeredRotation;return t&&this._setOriginToCenter(),this.set("angle",e),t&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(e,n){n=n||this.canvas.getPointer(e);var i=new t.Point(n.x,n.y),r=this._getLeftTopCoords();return this.angle&&(i=t.util.rotatePoint(i,r,a(-this.angle))),{x:i.x-r.x,y:i.y-r.y}},_setupCompositeOperation:function(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){t.runningAnimations&&t.runningAnimations.cancelByTarget(this)}}),t.util.createAccessors&&t.util.createAccessors(t.Object),n(t.Object.prototype,t.Observable),t.Object.NUM_FRACTION_DIGITS=2,t.Object.ENLIVEN_PROPS=["clipPath"],t.Object._fromObject=function(e,n,r,o){var a=t[e];n=i(n,!0),t.util.enlivenPatterns([n.fill,n.stroke],(function(e){void 0!==e[0]&&(n.fill=e[0]),void 0!==e[1]&&(n.stroke=e[1]),t.util.enlivenObjectEnlivables(n,n,(function(){var e=o?new a(n[o],n):new a(n);r&&r(e)}))}))},t.Object.__uid=0)}(e),m=w.util.degreesToRadians,y={left:-.5,center:0,right:.5},b={top:-.5,center:0,bottom:.5},w.util.object.extend(w.Object.prototype,{translateToGivenOrigin:function(e,t,n,i,r){var o,a,s,l=e.x,c=e.y;return"string"==typeof t?t=y[t]:t-=.5,"string"==typeof i?i=y[i]:i-=.5,"string"==typeof n?n=b[n]:n-=.5,"string"==typeof r?r=b[r]:r-=.5,a=r-n,((o=i-t)||a)&&(s=this._getTransformedDimensions(),l=e.x+o*s.x,c=e.y+a*s.y),new w.Point(l,c)},translateToCenterPoint:function(e,t,n){var i=this.translateToGivenOrigin(e,t,n,"center","center");return this.angle?w.util.rotatePoint(i,e,m(this.angle)):i},translateToOriginPoint:function(e,t,n){var i=this.translateToGivenOrigin(e,"center","center",t,n);return this.angle?w.util.rotatePoint(i,e,m(this.angle)):i},getCenterPoint:function(){var e=new w.Point(this.left,this.top);return this.translateToCenterPoint(e,this.originX,this.originY)},getPointByOrigin:function(e,t){var n=this.getCenterPoint();return this.translateToOriginPoint(n,e,t)},toLocalPoint:function(e,t,n){var i,r,o=this.getCenterPoint();return i=void 0!==t&&void 0!==n?this.translateToGivenOrigin(o,"center","center",t,n):new w.Point(this.left,this.top),r=new w.Point(e.x,e.y),this.angle&&(r=w.util.rotatePoint(r,o,-m(this.angle))),r.subtractEquals(i)},setPositionByOrigin:function(e,t,n){var i=this.translateToCenterPoint(e,t,n),r=this.translateToOriginPoint(i,this.originX,this.originY);this.set("left",r.x),this.set("top",r.y)},adjustPosition:function(e){var t,n,i=m(this.angle),r=this.getScaledWidth(),o=w.util.cos(i)*r,a=w.util.sin(i)*r;t="string"==typeof this.originX?y[this.originX]:this.originX-.5,n="string"==typeof e?y[e]:e-.5,this.left+=o*(n-t),this.top+=a*(n-t),this.setCoords(),this.originX=e},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var e=this.getCenterPoint();this.originX="center",this.originY="center",this.left=e.x,this.top=e.y},_resetOrigin:function(){var e=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=e.x,this.top=e.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var e=w.util,t=e.degreesToRadians,n=e.multiplyTransformMatrices,i=e.transformPoint;e.object.extend(w.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(e,t){return t?e?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),e?this.aCoords:this.lineCoords)},getCoords:function(e,t){return n=this._getCoords(e,t),[new w.Point(n.tl.x,n.tl.y),new w.Point(n.tr.x,n.tr.y),new w.Point(n.br.x,n.br.y),new w.Point(n.bl.x,n.bl.y)];var n},intersectsWithRect:function(e,t,n,i){var r=this.getCoords(n,i);return"Intersection"===w.Intersection.intersectPolygonRectangle(r,e,t).status},intersectsWithObject:function(e,t,n){return"Intersection"===w.Intersection.intersectPolygonPolygon(this.getCoords(t,n),e.getCoords(t,n)).status||e.isContainedWithinObject(this,t,n)||this.isContainedWithinObject(e,t,n)},isContainedWithinObject:function(e,t,n){for(var i=this.getCoords(t,n),r=t?e.aCoords:e.lineCoords,o=0,a=e._getImageLines(r);o<4;o++)if(!e.containsPoint(i[o],a))return!1;return!0},isContainedWithinRect:function(e,t,n,i){var r=this.getBoundingRect(n,i);return r.left>=e.x&&r.left+r.width<=t.x&&r.top>=e.y&&r.top+r.height<=t.y},containsPoint:function(e,t,n,i){var r=this._getCoords(n,i),o=(t=t||this._getImageLines(r),this._findCrossPoints(e,t));return 0!==o&&o%2==1},isOnScreen:function(e){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.getCoords(!0,e).some((function(e){return e.x<=n.x&&e.x>=t.x&&e.y<=n.y&&e.y>=t.y}))||(!!this.intersectsWithRect(t,n,!0,e)||this._containsCenterOfCanvas(t,n,e))},_containsCenterOfCanvas:function(e,t,n){var i={x:(e.x+t.x)/2,y:(e.y+t.y)/2};return!!this.containsPoint(i,null,!0,n)},isPartiallyOnScreen:function(e){if(!this.canvas)return!1;var t=this.canvas.vptCoords.tl,n=this.canvas.vptCoords.br;return!!this.intersectsWithRect(t,n,!0,e)||this.getCoords(!0,e).every((function(e){return(e.x>=n.x||e.x<=t.x)&&(e.y>=n.y||e.y<=t.y)}))&&this._containsCenterOfCanvas(t,n,e)},_getImageLines:function(e){return{topline:{o:e.tl,d:e.tr},rightline:{o:e.tr,d:e.br},bottomline:{o:e.br,d:e.bl},leftline:{o:e.bl,d:e.tl}}},_findCrossPoints:function(e,t){var n,i,r,o=0;for(var a in t)if(!((r=t[a]).o.y<e.y&&r.d.y<e.y||r.o.y>=e.y&&r.d.y>=e.y||(r.o.x===r.d.x&&r.o.x>=e.x?i=r.o.x:(n=(r.d.y-r.o.y)/(r.d.x-r.o.x),i=-(e.y-0*e.x-(r.o.y-n*r.o.x))/(0-n)),i>=e.x&&(o+=1),2!==o)))break;return o},getBoundingRect:function(t,n){var i=this.getCoords(t,n);return e.makeBoundingBoxFromPoints(i)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:0===e?1e-4:e},scale:function(e){return this._set("scaleX",e),this._set("scaleY",e),this.setCoords()},scaleToWidth:function(e,t){var n=this.getBoundingRect(t).width/this.getScaledWidth();return this.scale(e/this.width/n)},scaleToHeight:function(e,t){var n=this.getBoundingRect(t).height/this.getScaledHeight();return this.scale(e/this.height/n)},calcLineCoords:function(){var n=this.getViewportTransform(),r=this.padding,o=t(this.angle),a=e.cos(o)*r,s=e.sin(o)*r,l=a+s,c=a-s,u=this.calcACoords(),h={tl:i(u.tl,n),tr:i(u.tr,n),bl:i(u.bl,n),br:i(u.br,n)};return r&&(h.tl.x-=c,h.tl.y-=l,h.tr.x+=l,h.tr.y-=c,h.bl.x-=l,h.bl.y+=c,h.br.x+=c,h.br.y+=l),h},calcOCoords:function(){var e=this._calcRotateMatrix(),t=this._calcTranslateMatrix(),i=this.getViewportTransform(),r=n(i,t),o=n(r,e),a=(o=n(o,[1/i[0],0,0,1/i[3],0,0]),this._calculateCurrentDimensions()),s={};return this.forEachControl((function(e,t,n){s[t]=e.positionHandler(a,o,n)})),s},calcACoords:function(){var e=this._calcRotateMatrix(),t=this._calcTranslateMatrix(),r=n(t,e),o=this._getTransformedDimensions(),a=o.x/2,s=o.y/2;return{tl:i({x:-a,y:-s},r),tr:i({x:a,y:-s},r),bl:i({x:-a,y:s},r),br:i({x:a,y:s},r)}},setCoords:function(e){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),e||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return e.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var e=this.getCenterPoint();return[1,0,0,1,e.x,e.y]},transformMatrixKey:function(e){var t="_",n="";return!e&&this.group&&(n=this.group.transformMatrixKey(e)+t),n+this.top+t+this.left+t+this.scaleX+t+this.scaleY+t+this.skewX+t+this.skewY+t+this.angle+t+this.originX+t+this.originY+t+this.width+t+this.height+t+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(e){var t=this.calcOwnMatrix();if(e||!this.group)return t;var i=this.transformMatrixKey(e),r=this.matrixCache||(this.matrixCache={});return r.key===i?r.value:(this.group&&(t=n(this.group.calcTransformMatrix(!1),t)),r.key=i,r.value=t,t)},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===t)return n.value;var i=this._calcTranslateMatrix(),r={angle:this.angle,translateX:i[4],translateY:i[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return n.key=t,n.value=e.composeMatrix(r),n.value},_getNonTransformedDimensions:function(){var e=this.strokeWidth;return{x:this.width+e,y:this.height+e}},_getTransformedDimensions:function(t,n){void 0===t&&(t=this.skewX),void 0===n&&(n=this.skewY);var i,r,o,a=0===t&&0===n;if(this.strokeUniform?(r=this.width,o=this.height):(r=(i=this._getNonTransformedDimensions()).x,o=i.y),a)return this._finalizeDimensions(r*this.scaleX,o*this.scaleY);var s=e.sizeAfterTransform(r,o,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:t,skewY:n});return this._finalizeDimensions(s.x,s.y)},_finalizeDimensions:function(e,t){return this.strokeUniform?{x:e+this.strokeWidth,y:t+this.strokeWidth}:{x:e,y:t}},_calculateCurrentDimensions:function(){var e=this.getViewportTransform(),t=this._getTransformedDimensions();return i(t,e,!0).scalarAdd(2*this.padding)}})}(),w.util.object.extend(w.Object.prototype,{sendToBack:function(){return this.group?w.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?w.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(e){return this.group?w.StaticCanvas.prototype.sendBackwards.call(this.group,this,e):this.canvas&&this.canvas.sendBackwards(this,e),this},bringForward:function(e){return this.group?w.StaticCanvas.prototype.bringForward.call(this.group,this,e):this.canvas&&this.canvas.bringForward(this,e),this},moveTo:function(e){return this.group&&"activeSelection"!==this.group.type?w.StaticCanvas.prototype.moveTo.call(this.group,this,e):this.canvas&&this.canvas.moveTo(this,e),this}}),function(){function e(e,t){if(t){if(t.toLive)return e+": url(#SVGID_"+t.id+"); ";var n=new w.Color(t),i=e+": "+n.toRgb()+"; ",r=n.getAlpha();return 1!==r&&(i+=e+"-opacity: "+r.toString()+"; "),i}return e+": none; "}var t=w.util.toFixed;w.util.object.extend(w.Object.prototype,{getSvgStyles:function(t){var n=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):"none",o=this.strokeDashOffset?this.strokeDashOffset:"0",a=this.strokeLineCap?this.strokeLineCap:"butt",s=this.strokeLineJoin?this.strokeLineJoin:"miter",l=this.strokeMiterLimit?this.strokeMiterLimit:"4",c=void 0!==this.opacity?this.opacity:"1",u=this.visible?"":" visibility: hidden;",h=t?"":this.getSvgFilter(),d=e("fill",this.fill);return[e("stroke",this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",a,"; ","stroke-dashoffset: ",o,"; ","stroke-linejoin: ",s,"; ","stroke-miterlimit: ",l,"; ",d,"fill-rule: ",n,"; ","opacity: ",c,";",h,u].join("")},getSvgSpanStyles:function(t,n){var i="; ",r=t.fontFamily?"font-family: "+(-1===t.fontFamily.indexOf("'")&&-1===t.fontFamily.indexOf('"')?"'"+t.fontFamily+"'":t.fontFamily)+i:"",o=t.strokeWidth?"stroke-width: "+t.strokeWidth+i:"",a=(r=r,t.fontSize?"font-size: "+t.fontSize+"px"+i:""),s=t.fontStyle?"font-style: "+t.fontStyle+i:"",l=t.fontWeight?"font-weight: "+t.fontWeight+i:"",c=t.fill?e("fill",t.fill):"",u=t.stroke?e("stroke",t.stroke):"",h=this.getSvgTextDecoration(t);return h&&(h="text-decoration: "+h+i),[u,o,r,a,s,l,h,c,t.deltaY?"baseline-shift: "+-t.deltaY+"; ":"",n?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(e){return["overline","underline","line-through"].filter((function(t){return e[t.replace("-","")]})).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(e,t){var n=e?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+w.util.matrixToSVG(n)+(t||"")+'" '},_setSVGBg:function(e){if(this.backgroundColor){var n=w.Object.NUM_FRACTION_DIGITS;e.push("\t\t<rect ",this._getFillAttributes(this.backgroundColor),' x="',t(-this.width/2,n),'" y="',t(-this.height/2,n),'" width="',t(this.width,n),'" height="',t(this.height,n),'"></rect>\n')}},toSVG:function(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})},toClipPathSVG:function(e){return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})},_createBaseClipPathSVGMarkup:function(e,t){var n=(t=t||{}).reviver,i=t.additionalTransform||"",r=[this.getSvgTransform(!0,i),this.getSvgCommons()].join(""),o=e.indexOf("COMMON_PARTS");return e[o]=r,n?n(e.join("")):e.join("")},_createBaseSVGMarkup:function(e,t){var n,i,r=(t=t||{}).noStyle,o=t.reviver,a=r?"":'style="'+this.getSvgStyles()+'" ',s=t.withShadow?'style="'+this.getSvgFilter()+'" ':"",l=this.clipPath,c=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",u=l&&l.absolutePositioned,h=this.stroke,d=this.fill,f=this.shadow,p=[],g=e.indexOf("COMMON_PARTS"),v=t.additionalTransform;return l&&(l.clipPathId="CLIPPATH_"+w.Object.__uid++,i='<clipPath id="'+l.clipPathId+'" >\n'+l.toClipPathSVG(o)+"</clipPath>\n"),u&&p.push("<g ",s,this.getSvgCommons()," >\n"),p.push("<g ",this.getSvgTransform(!1),u?"":s+this.getSvgCommons()," >\n"),n=[a,c,r?"":this.addPaintOrder()," ",v?'transform="'+v+'" ':""].join(""),e[g]=n,d&&d.toLive&&p.push(d.toSVG(this)),h&&h.toLive&&p.push(h.toSVG(this)),f&&p.push(f.toSVG(this)),l&&p.push(i),p.push(e.join("")),p.push("</g>\n"),u&&p.push("</g>\n"),o?o(p.join("")):p.join("")},addPaintOrder:function(){return"fill"!==this.paintFirst?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var e=w.util.object.extend,t="stateProperties";function n(t,n,i){var r={};i.forEach((function(e){r[e]=t[e]})),e(t[n],r,!0)}function i(e,t,n){if(e===t)return!0;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0,o=e.length;r<o;r++)if(!i(e[r],t[r]))return!1;return!0}if(e&&"object"==typeof e){var a,s=Object.keys(e);if(!t||"object"!=typeof t||!n&&s.length!==Object.keys(t).length)return!1;for(r=0,o=s.length;r<o;r++)if("canvas"!==(a=s[r])&&"group"!==a&&!i(e[a],t[a]))return!1;return!0}}w.util.object.extend(w.Object.prototype,{hasStateChanged:function(e){var n="_"+(e=e||t);return Object.keys(this[n]).length<this[e].length||!i(this[n],this,!0)},saveState:function(e){var i=e&&e.propertySet||t,r="_"+i;return this[r]?(n(this,r,this[i]),e&&e.stateProperties&&n(this,r,e.stateProperties),this):this.setupState(e)},setupState:function(e){var n=(e=e||{}).propertySet||t;return e.propertySet=n,this["_"+n]={},this.saveState(e),this}})}(),function(){var e=w.util.degreesToRadians;w.util.object.extend(w.Object.prototype,{_findTargetCorner:function(e,t){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var n,i,r,o=e.x,a=e.y,s=Object.keys(this.oCoords),l=s.length-1;for(this.__corner=0;l>=0;l--)if(r=s[l],this.isControlVisible(r)&&(i=this._getImageLines(t?this.oCoords[r].touchCorner:this.oCoords[r].corner),0!==(n=this._findCrossPoints({x:o,y:a},i))&&n%2==1))return this.__corner=r,r;return!1},forEachControl:function(e){for(var t in this.controls)e(this.controls[t],t,this)},_setCornerCoords:function(){var e=this.oCoords;for(var t in e){var n=this.controls[t];e[t].corner=n.calcCornerCoords(this.angle,this.cornerSize,e[t].x,e[t].y,!1),e[t].touchCorner=n.calcCornerCoords(this.angle,this.touchCornerSize,e[t].x,e[t].y,!0)}},drawSelectionBackground:function(t){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;t.save();var n=this.getCenterPoint(),i=this._calculateCurrentDimensions(),r=this.canvas.viewportTransform;return t.translate(n.x,n.y),t.scale(1/r[0],1/r[3]),t.rotate(e(this.angle)),t.fillStyle=this.selectionBackgroundColor,t.fillRect(-i.x/2,-i.y/2,i.x,i.y),t.restore(),this},drawBorders:function(e,t){t=t||{};var n=this._calculateCurrentDimensions(),i=this.borderScaleFactor,r=n.x+i,o=n.y+i,a=void 0!==t.hasControls?t.hasControls:this.hasControls,s=!1;return e.save(),e.strokeStyle=t.borderColor||this.borderColor,this._setLineDash(e,t.borderDashArray||this.borderDashArray),e.strokeRect(-r/2,-o/2,r,o),a&&(e.beginPath(),this.forEachControl((function(t,n,i){t.withConnection&&t.getVisibility(i,n)&&(s=!0,e.moveTo(t.x*r,t.y*o),e.lineTo(t.x*r+t.offsetX,t.y*o+t.offsetY))})),s&&e.stroke()),e.restore(),this},drawBordersInGroup:function(e,t,n){n=n||{};var i=w.util.sizeAfterTransform(this.width,this.height,t),r=this.strokeWidth,o=this.strokeUniform,a=this.borderScaleFactor,s=i.x+r*(o?this.canvas.getZoom():t.scaleX)+a,l=i.y+r*(o?this.canvas.getZoom():t.scaleY)+a;return e.save(),this._setLineDash(e,n.borderDashArray||this.borderDashArray),e.strokeStyle=n.borderColor||this.borderColor,e.strokeRect(-s/2,-l/2,s,l),e.restore(),this},drawControls:function(e,t){t=t||{},e.save();var n,i,r=this.canvas.getRetinaScaling();return e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=t.cornerColor||this.cornerColor,this.transparentCorners||(e.strokeStyle=t.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(e,t.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(n=this.group.calcTransformMatrix()),this.forEachControl((function(r,o,a){i=a.oCoords[o],r.getVisibility(a,o)&&(n&&(i=w.util.transformPoint(i,n)),r.render(e,i.x,i.y,t,a))})),e.restore(),this},isControlVisible:function(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)},setControlVisible:function(e,t){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t,this},setControlsVisibility:function(e){for(var t in e||(e={}),e)this.setControlVisible(t,e[t]);return this},onDeselect:function(){},onSelect:function(){}})}(),w.util.object.extend(w.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(e,t){var n=function(){},i=(t=t||{}).onComplete||n,r=t.onChange||n,o=this;return w.util.animate({target:this,startValue:e.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(t){e.set("left",t),o.requestRenderAll(),r()},onComplete:function(){e.setCoords(),i()}})},fxCenterObjectV:function(e,t){var n=function(){},i=(t=t||{}).onComplete||n,r=t.onChange||n,o=this;return w.util.animate({target:this,startValue:e.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(t){e.set("top",t),o.requestRenderAll(),r()},onComplete:function(){e.setCoords(),i()}})},fxRemove:function(e,t){var n=function(){},i=(t=t||{}).onComplete||n,r=t.onChange||n,o=this;return w.util.animate({target:this,startValue:e.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(t){e.set("opacity",t),o.requestRenderAll(),r()},onComplete:function(){o.remove(e),i()}})}}),w.util.object.extend(w.Object.prototype,{animate:function(){if(arguments[0]&&"object"==typeof arguments[0]){var e,t,n=[],i=[];for(e in arguments[0])n.push(e);for(var r=0,o=n.length;r<o;r++)e=n[r],t=r!==o-1,i.push(this._animate(e,arguments[0][e],arguments[1],t));return i}return this._animate.apply(this,arguments)},_animate:function(e,t,n,i){var r,o=this;t=t.toString(),n=n?w.util.object.clone(n):{},~e.indexOf(".")&&(r=e.split("."));var a=o.colorProperties.indexOf(e)>-1||r&&o.colorProperties.indexOf(r[1])>-1,s=r?this.get(r[0])[r[1]]:this.get(e);"from"in n||(n.from=s),a||(t=~t.indexOf("=")?s+parseFloat(t.replace("=","")):parseFloat(t));var l={target:this,startValue:n.from,endValue:t,byValue:n.by,easing:n.easing,duration:n.duration,abort:n.abort&&function(e,t,i){return n.abort.call(o,e,t,i)},onChange:function(t,a,s){r?o[r[0]][r[1]]=t:o.set(e,t),i||n.onChange&&n.onChange(t,a,s)},onComplete:function(e,t,r){i||(o.setCoords(),n.onComplete&&n.onComplete(e,t,r))}};return a?w.util.animateColor(l.startValue,l.endValue,l.duration,l):w.util.animate(l)}}),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.object.clone,r={x1:1,x2:1,y1:1,y2:1};function o(e,t){var n=e.origin,i=e.axis1,r=e.axis2,o=e.dimension,a=t.nearest,s=t.center,l=t.farthest;return function(){switch(this.get(n)){case a:return Math.min(this.get(i),this.get(r));case s:return Math.min(this.get(i),this.get(r))+.5*this.get(o);case l:return Math.max(this.get(i),this.get(r))}}}t.Line?t.warn("fabric.Line is already defined"):(t.Line=t.util.createClass(t.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:t.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(e,t){e||(e=[0,0,0,0]),this.callSuper("initialize",t),this.set("x1",e[0]),this.set("y1",e[1]),this.set("x2",e[2]),this.set("y2",e[3]),this._setWidthHeight(t)},_setWidthHeight:function(e){e||(e={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in e?e.left:this._getLeftToOriginX(),this.top="top"in e?e.top:this._getTopToOriginY()},_set:function(e,t){return this.callSuper("_set",e,t),void 0!==r[e]&&this._setWidthHeight(),this},_getLeftToOriginX:o({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:o({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(e){e.beginPath();var t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;var n=e.strokeStyle;e.strokeStyle=this.stroke||e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=n},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(e){return n(this.callSuper("toObject",e),this.calcLinePoints())},_getNonTransformedDimensions:function(){var e=this.callSuper("_getNonTransformedDimensions");return"butt"===this.strokeLineCap&&(0===this.width&&(e.y-=this.strokeWidth),0===this.height&&(e.x-=this.strokeWidth)),e},calcLinePoints:function(){var e=this.x1<=this.x2?-1:1,t=this.y1<=this.y2?-1:1,n=e*this.width*.5,i=t*this.height*.5;return{x1:n,x2:e*this.width*-.5,y1:i,y2:t*this.height*-.5}},_toSVG:function(){var e=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',e.x1,'" y1="',e.y1,'" x2="',e.x2,'" y2="',e.y2,'" />\n']}}),t.Line.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),t.Line.fromElement=function(e,i,r){r=r||{};var o=t.parseAttributes(e,t.Line.ATTRIBUTE_NAMES),a=[o.x1||0,o.y1||0,o.x2||0,o.y2||0];i(new t.Line(a,n(o,r)))},t.Line.fromObject=function(e,n){var r=i(e,!0);r.points=[e.x1,e.y1,e.x2,e.y2],t.Object._fromObject("Line",r,(function(e){delete e.points,n&&n(e)}),"points")})}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.degreesToRadians;t.Circle?t.warn("fabric.Circle is already defined."):(t.Circle=t.util.createClass(t.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:t.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(e,t){return this.callSuper("_set",e,t),"radius"===e&&this.setRadius(t),this},toObject:function(e){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(e))},_toSVG:function(){var e,i=(this.endAngle-this.startAngle)%360;if(0===i)e=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,'" />\n'];else{var r=n(this.startAngle),o=n(this.endAngle),a=this.radius;e=['<path d="M '+t.util.cos(r)*a+" "+t.util.sin(r)*a," A "+a+" "+a," 0 ",+(i>180?"1":"0")+" 1"," "+t.util.cos(o)*a+" "+t.util.sin(o)*a,'" ',"COMMON_PARTS"," />\n"]}return e},_render:function(e){e.beginPath(),e.arc(0,0,this.radius,n(this.startAngle),n(this.endAngle),!1),this._renderPaintInOrder(e)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(e){return this.radius=e,this.set("width",2*e).set("height",2*e)}}),t.Circle.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),t.Circle.fromElement=function(e,n){var i,r=t.parseAttributes(e,t.Circle.ATTRIBUTE_NAMES);if(!("radius"in(i=r)&&i.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");r.left=(r.left||0)-r.radius,r.top=(r.top||0)-r.radius,n(new t.Circle(r))},t.Circle.fromObject=function(e,n){t.Object._fromObject("Circle",e,n)})}(e),function(e){var t=e.fabric||(e.fabric={});t.Triangle?t.warn("fabric.Triangle is already defined"):(t.Triangle=t.util.createClass(t.Object,{type:"triangle",width:100,height:100,_render:function(e){var t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,n),e.lineTo(0,-n),e.lineTo(t,n),e.closePath(),this._renderPaintInOrder(e)},_toSVG:function(){var e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-e+" "+t,"0 "+-t,e+" "+t].join(","),'" />']}}),t.Triangle.fromObject=function(e,n){return t.Object._fromObject("Triangle",e,n)})}(e),function(e){var t=e.fabric||(e.fabric={}),n=2*Math.PI;t.Ellipse?t.warn("fabric.Ellipse is already defined."):(t.Ellipse=t.util.createClass(t.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(e){this.callSuper("initialize",e),this.set("rx",e&&e.rx||0),this.set("ry",e&&e.ry||0)},_set:function(e,t){switch(this.callSuper("_set",e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(e){return this.callSuper("toObject",["rx","ry"].concat(e))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,'" />\n']},_render:function(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,n,!1),e.restore(),this._renderPaintInOrder(e)}}),t.Ellipse.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),t.Ellipse.fromElement=function(e,n){var i=t.parseAttributes(e,t.Ellipse.ATTRIBUTE_NAMES);i.left=(i.left||0)-i.rx,i.top=(i.top||0)-i.ry,n(new t.Ellipse(i))},t.Ellipse.fromObject=function(e,n){t.Object._fromObject("Ellipse",e,n)})}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend;t.Rect?t.warn("fabric.Rect is already defined"):(t.Rect=t.util.createClass(t.Object,{stateProperties:t.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:t.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(e){this.callSuper("initialize",e),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(e){var t=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,i=this.width,r=this.height,o=-this.width/2,a=-this.height/2,s=0!==t||0!==n,l=.4477152502;e.beginPath(),e.moveTo(o+t,a),e.lineTo(o+i-t,a),s&&e.bezierCurveTo(o+i-l*t,a,o+i,a+l*n,o+i,a+n),e.lineTo(o+i,a+r-n),s&&e.bezierCurveTo(o+i,a+r-l*n,o+i-l*t,a+r,o+i-t,a+r),e.lineTo(o+t,a+r),s&&e.bezierCurveTo(o+l*t,a+r,o,a+r-l*n,o,a+r-n),e.lineTo(o,a+n),s&&e.bezierCurveTo(o,a+l*n,o+l*t,a,o+t,a),e.closePath(),this._renderPaintInOrder(e)},toObject:function(e){return this.callSuper("toObject",["rx","ry"].concat(e))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,'" />\n']}}),t.Rect.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),t.Rect.fromElement=function(e,i,r){if(!e)return i(null);r=r||{};var o=t.parseAttributes(e,t.Rect.ATTRIBUTE_NAMES);o.left=o.left||0,o.top=o.top||0,o.height=o.height||0,o.width=o.width||0;var a=new t.Rect(n(r?t.util.object.clone(r):{},o));a.visible=a.visible&&a.width>0&&a.height>0,i(a)},t.Rect.fromObject=function(e,n){return t.Object._fromObject("Rect",e,n)})}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.util.array.min,r=t.util.array.max,o=t.util.toFixed,a=t.util.projectStrokeOnPoints;t.Polyline?t.warn("fabric.Polyline is already defined"):(t.Polyline=t.util.createClass(t.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:t.Object.prototype.cacheProperties.concat("points"),initialize:function(e,t){t=t||{},this.points=e||[],this.callSuper("initialize",t),this._setPositionDimensions(t)},_projectStrokeOnPoints:function(){return a(this.points,this,!0)},_setPositionDimensions:function(e){var t,n=this._calcDimensions(e),i=this.exactBoundingBox?this.strokeWidth:0;this.width=n.width-i,this.height=n.height-i,e.fromSVG||(t=this.translateToGivenOrigin({x:n.left-this.strokeWidth/2+i/2,y:n.top-this.strokeWidth/2+i/2},"left","top",this.originX,this.originY)),void 0===e.left&&(this.left=e.fromSVG?n.left:t.x),void 0===e.top&&(this.top=e.fromSVG?n.top:t.y),this.pathOffset={x:n.left+this.width/2+i/2,y:n.top+this.height/2+i/2}},_calcDimensions:function(){var e=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,t=i(e,"x")||0,n=i(e,"y")||0;return{left:t,top:n,width:(r(e,"x")||0)-t,height:(r(e,"y")||0)-n}},toObject:function(e){return n(this.callSuper("toObject",e),{points:this.points.concat()})},_toSVG:function(){for(var e=[],n=this.pathOffset.x,i=this.pathOffset.y,r=t.Object.NUM_FRACTION_DIGITS,a=0,s=this.points.length;a<s;a++)e.push(o(this.points[a].x-n,r),",",o(this.points[a].y-i,r)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',e.join(""),'" />\n']},commonRender:function(e){var t,n=this.points.length,i=this.pathOffset.x,r=this.pathOffset.y;if(!n||isNaN(this.points[n-1].y))return!1;e.beginPath(),e.moveTo(this.points[0].x-i,this.points[0].y-r);for(var o=0;o<n;o++)t=this.points[o],e.lineTo(t.x-i,t.y-r);return!0},_render:function(e){this.commonRender(e)&&this._renderPaintInOrder(e)},complexity:function(){return this.get("points").length}}),t.Polyline.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polyline.fromElementGenerator=function(e){return function(i,r,o){if(!i)return r(null);o||(o={});var a=t.parsePointsAttribute(i.getAttribute("points")),s=t.parseAttributes(i,t[e].ATTRIBUTE_NAMES);s.fromSVG=!0,r(new t[e](a,n(s,o)))}},t.Polyline.fromElement=t.Polyline.fromElementGenerator("Polyline"),t.Polyline.fromObject=function(e,n){return t.Object._fromObject("Polyline",e,n,"points")})}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.projectStrokeOnPoints;t.Polygon?t.warn("fabric.Polygon is already defined"):(t.Polygon=t.util.createClass(t.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return n(this.points,this)},_render:function(e){this.commonRender(e)&&(e.closePath(),this._renderPaintInOrder(e))}}),t.Polygon.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(),t.Polygon.fromElement=t.Polyline.fromElementGenerator("Polygon"),t.Polygon.fromObject=function(e,n){t.Object._fromObject("Polygon",e,n,"points")})}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.array.min,i=t.util.array.max,r=t.util.object.extend,o=t.util.object.clone,a=t.util.toFixed;t.Path?t.warn("fabric.Path is already defined"):(t.Path=t.util.createClass(t.Object,{type:"path",path:null,cacheProperties:t.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:t.Object.prototype.stateProperties.concat("path"),initialize:function(e,t){delete(t=o(t||{})).path,this.callSuper("initialize",t),this._setPath(e||[],t)},_setPath:function(e,n){this.path=t.util.makePathSimpler(Array.isArray(e)?e:t.util.parsePath(e)),t.Polyline.prototype._setPositionDimensions.call(this,n||{})},_renderPathCommands:function(e){var t,n=0,i=0,r=0,o=0,a=0,s=0,l=-this.pathOffset.x,c=-this.pathOffset.y;e.beginPath();for(var u=0,h=this.path.length;u<h;++u)switch((t=this.path[u])[0]){case"L":r=t[1],o=t[2],e.lineTo(r+l,o+c);break;case"M":n=r=t[1],i=o=t[2],e.moveTo(r+l,o+c);break;case"C":r=t[5],o=t[6],a=t[3],s=t[4],e.bezierCurveTo(t[1]+l,t[2]+c,a+l,s+c,r+l,o+c);break;case"Q":e.quadraticCurveTo(t[1]+l,t[2]+c,t[3]+l,t[4]+c),r=t[3],o=t[4],a=t[1],s=t[2];break;case"z":case"Z":r=n,o=i,e.closePath()}},_render:function(e){this._renderPathCommands(e),this._renderPaintInOrder(e)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(e){return r(this.callSuper("toObject",e),{path:this.path.map((function(e){return e.slice()}))})},toDatalessObject:function(e){var t=this.toObject(["sourcePath"].concat(e));return t.sourcePath&&delete t.path,t},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',t.util.joinPath(this.path),'" stroke-linecap="round" ',"/>\n"]},_getOffsetTransform:function(){var e=t.Object.NUM_FRACTION_DIGITS;return" translate("+a(-this.pathOffset.x,e)+", "+a(-this.pathOffset.y,e)+")"},toClipPathSVG:function(e){var t=this._getOffsetTransform();return"\t"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})},toSVG:function(e){var t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var e,r,o=[],a=[],s=0,l=0,c=0,u=0,h=0,d=this.path.length;h<d;++h){switch((e=this.path[h])[0]){case"L":c=e[1],u=e[2],r=[];break;case"M":s=c=e[1],l=u=e[2],r=[];break;case"C":r=t.util.getBoundsOfCurve(c,u,e[1],e[2],e[3],e[4],e[5],e[6]),c=e[5],u=e[6];break;case"Q":r=t.util.getBoundsOfCurve(c,u,e[1],e[2],e[1],e[2],e[3],e[4]),c=e[3],u=e[4];break;case"z":case"Z":c=s,u=l}r.forEach((function(e){o.push(e.x),a.push(e.y)})),o.push(c),a.push(u)}var f=n(o)||0,p=n(a)||0;return{left:f,top:p,width:(i(o)||0)-f,height:(i(a)||0)-p}}}),t.Path.fromObject=function(e,n){if("string"==typeof e.sourcePath){var i=e.sourcePath;t.loadSVGFromURL(i,(function(i){var r=i[0];r.setOptions(e),e.clipPath?t.util.enlivenObjects([e.clipPath],(function(e){r.clipPath=e[0],n&&n(r)})):n&&n(r)}))}else t.Object._fromObject("Path",e,n,"path")},t.Path.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat(["d"]),t.Path.fromElement=function(e,n,i){var o=t.parseAttributes(e,t.Path.ATTRIBUTE_NAMES);o.fromSVG=!0,n(new t.Path(o.d,r(o,i)))})}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.array.min,i=t.util.array.max;t.Group||(t.Group=t.util.createClass(t.Object,t.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(e,t,n){t=t||{},this._objects=[],n&&this.callSuper("initialize",t),this._objects=e||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;if(n)this._updateObjectsACoords();else{var r=t&&t.centerPoint;void 0!==t.originX&&(this.originX=t.originX),void 0!==t.originY&&(this.originY=t.originY),r||this._calcBounds(),this._updateObjectsCoords(r),delete t.centerPoint,this.callSuper("initialize",t)}this.setCoords()},_updateObjectsACoords:function(){for(var e=this._objects.length;e--;)this._objects[e].setCoords(true)},_updateObjectsCoords:function(e){e=e||this.getCenterPoint();for(var t=this._objects.length;t--;)this._updateObjectCoords(this._objects[t],e)},_updateObjectCoords:function(e,t){var n=e.left,i=e.top;e.set({left:n-t.x,top:i-t.y}),e.group=this,e.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(e){var n=!!this.group;return this._restoreObjectsState(),t.util.resetObjectTransform(this),e&&(n&&t.util.removeTransformFromObject(e,this.group.calcTransformMatrix()),this._objects.push(e),e.group=this,e._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(e){return this._restoreObjectsState(),t.util.resetObjectTransform(this),this.remove(e),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(e){this.dirty=!0,e.group=this,e._set("canvas",this.canvas)},_onObjectRemoved:function(e){this.dirty=!0,delete e.group},_set:function(e,n){var i=this._objects.length;if(this.useSetOnGroup)for(;i--;)this._objects[i].setOnGroup(e,n);if("canvas"===e)for(;i--;)this._objects[i]._set(e,n);t.Object.prototype._set.call(this,e,n)},toObject:function(e){var n=this.includeDefaultValues,i=this._objects.filter((function(e){return!e.excludeFromExport})).map((function(t){var i=t.includeDefaultValues;t.includeDefaultValues=n;var r=t.toObject(e);return t.includeDefaultValues=i,r})),r=t.Object.prototype.toObject.call(this,e);return r.objects=i,r},toDatalessObject:function(e){var n,i=this.sourcePath;if(i)n=i;else{var r=this.includeDefaultValues;n=this._objects.map((function(t){var n=t.includeDefaultValues;t.includeDefaultValues=r;var i=t.toDatalessObject(e);return t.includeDefaultValues=n,i}))}var o=t.Object.prototype.toDatalessObject.call(this,e);return o.objects=n,o},render:function(e){this._transformDone=!0,this.callSuper("render",e),this._transformDone=!1},shouldCache:function(){var e=t.Object.prototype.shouldCache.call(this);if(e)for(var n=0,i=this._objects.length;n<i;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1;return e},willDrawShadow:function(){if(t.Object.prototype.willDrawShadow.call(this))return!0;for(var e=0,n=this._objects.length;e<n;e++)if(this._objects[e].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(e){for(var t=0,n=this._objects.length;t<n;t++)this._objects[t].render(e);this._drawClipPath(e,this.clipPath)},isCacheDirty:function(e){if(this.callSuper("isCacheDirty",e))return!0;if(!this.statefullCache)return!1;for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].isCacheDirty(!0)){if(this._cacheCanvas){var i=this.cacheWidth/this.zoomX,r=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-i/2,-r/2,i,r)}return!0}return!1},_restoreObjectsState:function(){var e=this.calcOwnMatrix();return this._objects.forEach((function(n){t.util.addTransformToObject(n,e),delete n.group,n.setCoords()})),this},destroy:function(){return this._objects.forEach((function(e){e.set("dirty",!0)})),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject((function(e){e.dispose&&e.dispose()})),this._objects=[]},toActiveSelection:function(){if(this.canvas){var e=this._objects,n=this.canvas;this._objects=[];var i=this.toObject();delete i.objects;var r=new t.ActiveSelection([]);return r.set(i),r.type="activeSelection",n.remove(this),e.forEach((function(e){e.group=r,e.dirty=!0,n.add(e)})),r.canvas=n,r._objects=e,n._activeObject=r,r.setCoords(),r}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject((function(e){e.setCoords(true)})),this},_calcBounds:function(e){for(var t,n,i,r,o=[],a=[],s=["tr","br","bl","tl"],l=0,c=this._objects.length,u=s.length;l<c;++l){for(i=(t=this._objects[l]).calcACoords(),r=0;r<u;r++)n=s[r],o.push(i[n].x),a.push(i[n].y);t.aCoords=i}this._getBounds(o,a,e)},_getBounds:function(e,r,o){var a=new t.Point(n(e),n(r)),s=new t.Point(i(e),i(r)),l=a.y||0,c=a.x||0,u=s.x-a.x||0,h=s.y-a.y||0;this.width=u,this.height=h,o||this.setPositionByOrigin({x:c,y:l},"left","top")},_toSVG:function(e){for(var t=["<g ","COMMON_PARTS"," >\n"],n=0,i=this._objects.length;n<i;n++)t.push("\t\t",this._objects[n].toSVG(e));return t.push("</g>\n"),t},getSvgStyles:function(){var e=void 0!==this.opacity&&1!==this.opacity?"opacity: "+this.opacity+";":"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")},toClipPathSVG:function(e){for(var t=[],n=0,i=this._objects.length;n<i;n++)t.push("\t",this._objects[n].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}}),t.Group.fromObject=function(e,n){var i=e.objects,r=t.util.object.clone(e,!0);delete r.objects,"string"!=typeof i?t.util.enlivenObjects(i,(function(i){t.util.enlivenObjectEnlivables(e,r,(function(){n&&n(new t.Group(i,r,!0))}))})):t.loadSVGFromURL(i,(function(o){var a=t.util.groupSVGElements(o,e,i),s=r.clipPath;delete r.clipPath,a.set(r),s?t.util.enlivenObjects([s],(function(e){a.clipPath=e[0],n&&n(a)})):n&&n(a)}))})}(e),function(e){var t=e.fabric||(e.fabric={});t.ActiveSelection||(t.ActiveSelection=t.util.createClass(t.Group,{type:"activeSelection",initialize:function(e,n){n=n||{},this._objects=e||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;n.originX&&(this.originX=n.originX),n.originY&&(this.originY=n.originY),this._calcBounds(),this._updateObjectsCoords(),t.Object.prototype.initialize.call(this,n),this.setCoords()},toGroup:function(){var e=this._objects.concat();this._objects=[];var n=t.Object.prototype.toObject.call(this),i=new t.Group([]);if(delete n.type,i.set(n),e.forEach((function(e){e.canvas.remove(e),e.group=i})),i._objects=e,!this.canvas)return i;var r=this.canvas;return r.add(i),r._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(e,t,n){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",e,t),void 0===(n=n||{}).hasControls&&(n.hasControls=!1),n.forActiveSelection=!0;for(var i=0,r=this._objects.length;i<r;i++)this._objects[i]._renderControls(e,n);e.restore()}}),t.ActiveSelection.fromObject=function(e,n){t.util.enlivenObjects(e.objects,(function(i){delete e.objects,n&&n(new t.ActiveSelection(i,e,!0))}))})}(e),function(e){var t=w.util.object.extend;e.fabric||(e.fabric={}),e.fabric.Image?w.warn("fabric.Image is already defined."):(w.Image=w.util.createClass(w.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:w.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:w.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(e,t){t||(t={}),this.filters=[],this.cacheKey="texture"+w.Object.__uid++,this.callSuper("initialize",t),this._initElement(e,t)},getElement:function(){return this._element||{}},setElement:function(e,t){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=e,this._originalElement=e,this._initConfig(t),0!==this.filters.length&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(e){var t=w.filterBackend;t&&t.evictCachesForKey&&t.evictCachesForKey(e)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(e){w.util.cleanUpJsdomNode(this[e]),this[e]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var e=this.getElement();return{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}},_stroke:function(e){if(this.stroke&&0!==this.strokeWidth){var t=this.width/2,n=this.height/2;e.beginPath(),e.moveTo(-t,-n),e.lineTo(t,-n),e.lineTo(t,n),e.lineTo(-t,n),e.lineTo(-t,-n),e.closePath()}},toObject:function(e){var n=[];this.filters.forEach((function(e){e&&n.push(e.toObject())}));var i=t(this.callSuper("toObject",["cropX","cropY"].concat(e)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:n});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var e,t=[],n=[],i=this._element,r=-this.width/2,o=-this.height/2,a="",s="";if(!i)return[];if(this.hasCrop()){var l=w.Object.__uid++;t.push('<clipPath id="imageCrop_'+l+'">\n','\t<rect x="'+r+'" y="'+o+'" width="'+this.width+'" height="'+this.height+'" />\n',"</clipPath>\n"),a=' clip-path="url(#imageCrop_'+l+')" '}if(this.imageSmoothing||(s='" image-rendering="optimizeSpeed'),n.push("\t<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',r-this.cropX,'" y="',o-this.cropY,'" width="',i.width||i.naturalWidth,'" height="',i.height||i.height,s,'"',a,"></image>\n"),this.stroke||this.strokeDashArray){var c=this.fill;this.fill=null,e=["\t<rect ",'x="',r,'" y="',o,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'"/>\n'],this.fill=c}return t="fill"!==this.paintFirst?t.concat(e,n):t.concat(n,e)},getSrc:function(e){var t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src"):t.src:this.src||""},setSrc:function(e,t,n){return w.util.loadImage(e,(function(e,i){this.setElement(e,n),this._setWidthHeight(),t&&t(this,i)}),this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var e=this.resizeFilter,t=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),i=n.scaleX,r=n.scaleY,o=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||i>t&&r>t)return this._element=o,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=i,void(this._lastScaleY=r);w.filterBackend||(w.filterBackend=w.initFilterBackend());var a=w.util.createCanvasElement(),s=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,l=o.width,c=o.height;a.width=l,a.height=c,this._element=a,this._lastScaleX=e.scaleX=i,this._lastScaleY=e.scaleY=r,w.filterBackend.applyFilters([e],o,l,c,this._element,s),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height},applyFilters:function(e){if(e=(e=e||this.filters||[]).filter((function(e){return e&&!e.isNeutralState()})),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),0===e.length)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var t=this._originalElement,n=t.naturalWidth||t.width,i=t.naturalHeight||t.height;if(this._element===this._originalElement){var r=w.util.createCanvasElement();r.width=n,r.height=i,this._element=r,this._filteredEl=r}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,i),this._lastScaleX=1,this._lastScaleY=1;return w.filterBackend||(w.filterBackend=w.initFilterBackend()),w.filterBackend.applyFilters(e,this._originalElement,n,i,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(e){w.util.setImageSmoothing(e,this.imageSmoothing),!0!==this.isMoving&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)},drawCacheOnCanvas:function(e){w.util.setImageSmoothing(e,this.imageSmoothing),w.Object.prototype.drawCacheOnCanvas.call(this,e)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(e){var t=this._element;if(t){var n=this._filterScalingX,i=this._filterScalingY,r=this.width,o=this.height,a=Math.min,s=Math.max,l=s(this.cropX,0),c=s(this.cropY,0),u=t.naturalWidth||t.width,h=t.naturalHeight||t.height,d=l*n,f=c*i,p=a(r*n,u-d),g=a(o*i,h-f),v=-r/2,A=-o/2,m=a(r,u/n-l),y=a(o,h/i-c);t&&e.drawImage(t,d,f,p,g,v,A,m,y)}},_needsResize:function(){var e=this.getTotalObjectScaling();return e.scaleX!==this._lastScaleX||e.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(e,t){this.setElement(w.util.getById(e),t),w.util.addClass(this.getElement(),w.Image.CSS_CANVAS)},_initConfig:function(e){e||(e={}),this.setOptions(e),this._setWidthHeight(e)},_initFilters:function(e,t){e&&e.length?w.util.enlivenObjects(e,(function(e){t&&t(e)}),"fabric.Image.filters"):t&&t()},_setWidthHeight:function(e){e||(e={});var t=this.getElement();this.width=e.width||t.naturalWidth||t.width||0,this.height=e.height||t.naturalHeight||t.height||0},parsePreserveAspectRatioAttribute:function(){var e,t=w.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,i=this._element.height,r=1,o=1,a=0,s=0,l=0,c=0,u=this.width,h=this.height,d={width:u,height:h};return!t||"none"===t.alignX&&"none"===t.alignY?(r=u/n,o=h/i):("meet"===t.meetOrSlice&&(e=(u-n*(r=o=w.util.findScaleToFit(this._element,d)))/2,"Min"===t.alignX&&(a=-e),"Max"===t.alignX&&(a=e),e=(h-i*o)/2,"Min"===t.alignY&&(s=-e),"Max"===t.alignY&&(s=e)),"slice"===t.meetOrSlice&&(e=n-u/(r=o=w.util.findScaleToCover(this._element,d)),"Mid"===t.alignX&&(l=e/2),"Max"===t.alignX&&(l=e),e=i-h/o,"Mid"===t.alignY&&(c=e/2),"Max"===t.alignY&&(c=e),n=u/r,i=h/o)),{width:n,height:i,scaleX:r,scaleY:o,offsetLeft:a,offsetTop:s,cropX:l,cropY:c}}}),w.Image.CSS_CANVAS="canvas-img",w.Image.prototype.getSvgSrc=w.Image.prototype.getSrc,w.Image.fromObject=function(e,t){var n=w.util.object.clone(e);w.util.loadImage(n.src,(function(e,i){i?t&&t(null,!0):w.Image.prototype._initFilters.call(n,n.filters,(function(i){n.filters=i||[],w.Image.prototype._initFilters.call(n,[n.resizeFilter],(function(i){n.resizeFilter=i[0],w.util.enlivenObjectEnlivables(n,n,(function(){var i=new w.Image(e,n);t(i,!1)}))}))}))}),null,n.crossOrigin)},w.Image.fromURL=function(e,t,n){w.util.loadImage(e,(function(e,i){t&&t(new w.Image(e,n),i)}),null,n&&n.crossOrigin)},w.Image.ATTRIBUTE_NAMES=w.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),w.Image.fromElement=function(e,n,i){var r=w.parseAttributes(e,w.Image.ATTRIBUTE_NAMES);w.Image.fromURL(r["xlink:href"],n,t(i?w.util.object.clone(i):{},r))})}(e),w.util.object.extend(w.Object.prototype,{_getAngleValueForStraighten:function(){var e=this.angle%360;return e>0?90*Math.round((e-1)/90):90*Math.round(e/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(e){var t=function(){},n=(e=e||{}).onComplete||t,i=e.onChange||t,r=this;return w.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(e){r.rotate(e),i()},onComplete:function(){r.setCoords(),n()}})}}),w.util.object.extend(w.StaticCanvas.prototype,{straightenObject:function(e){return e.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(e){return e.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function e(e,t){var n="precision "+t+" float;\nvoid main(){}",i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,n),e.compileShader(i),!!e.getShaderParameter(i,e.COMPILE_STATUS)}function t(e){e&&e.tileSize&&(this.tileSize=e.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}w.isWebglSupported=function(t){if(w.isLikelyNode)return!1;t=t||w.WebglFilterBackend.prototype.tileSize;var n=document.createElement("canvas"),i=n.getContext("webgl")||n.getContext("experimental-webgl"),r=!1;if(i){w.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),r=w.maxTextureSize>=t;for(var o=["highp","mediump","lowp"],a=0;a<3;a++)if(e(i,o[a])){w.webGlPrecision=o[a];break}}return this.isSupported=r,r},w.WebglFilterBackend=t,t.prototype={tileSize:2048,resources:{},setupGLContext:function(e,t){this.dispose(),this.createWebGLCanvas(e,t),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(e,t)},chooseFastestCopyGLTo2DMethod:function(e,t){var n,i=void 0!==window.performance;try{new ImageData(1,1),n=!0}catch(h){n=!1}var r="undefined"!=typeof ArrayBuffer,o="undefined"!=typeof Uint8ClampedArray;if(i&&n&&r&&o){var a=w.util.createCanvasElement(),s=new ArrayBuffer(e*t*4);if(w.forceGLPutImageData)return this.imageBuffer=s,void(this.copyGLTo2D=E);var l,c,u={imageBuffer:s,destinationWidth:e,destinationHeight:t,targetCanvas:a};a.width=e,a.height=t,l=window.performance.now(),_.call(u,this.gl,u),c=window.performance.now()-l,l=window.performance.now(),E.call(u,this.gl,u),c>window.performance.now()-l?(this.imageBuffer=s,this.copyGLTo2D=E):this.copyGLTo2D=_}},createWebGLCanvas:function(e,t){var n=w.util.createCanvasElement();n.width=e,n.height=t;var i={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},r=n.getContext("webgl",i);r||(r=n.getContext("experimental-webgl",i)),r&&(r.clearColor(0,0,0,0),this.canvas=n,this.gl=r)},applyFilters:function(e,t,n,i,r,o){var a,s=this.gl;o&&(a=this.getCachedTexture(o,t));var l={originalWidth:t.width||t.originalWidth,originalHeight:t.height||t.originalHeight,sourceWidth:n,sourceHeight:i,destinationWidth:n,destinationHeight:i,context:s,sourceTexture:this.createTexture(s,n,i,!a&&t),targetTexture:this.createTexture(s,n,i),originalTexture:a||this.createTexture(s,n,i,!a&&t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:r},c=s.createFramebuffer();return s.bindFramebuffer(s.FRAMEBUFFER,c),e.forEach((function(e){e&&e.applyTo(l)})),function(e){var t=e.targetCanvas,n=t.width,i=t.height,r=e.destinationWidth,o=e.destinationHeight;n===r&&i===o||(t.width=r,t.height=o)}(l),this.copyGLTo2D(s,l),s.bindTexture(s.TEXTURE_2D,null),s.deleteTexture(l.sourceTexture),s.deleteTexture(l.targetTexture),s.deleteFramebuffer(c),r.getContext("2d").setTransform(1,0,0,1,0,0),l},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(e,t,n,i,r){var o=e.createTexture();return e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r||e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,r||e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),i?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,i):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,t,n,0,e.RGBA,e.UNSIGNED_BYTE,null),o},getCachedTexture:function(e,t){if(this.textureCache[e])return this.textureCache[e];var n=this.createTexture(this.gl,t.width,t.height,t);return this.textureCache[e]=n,n},evictCachesForKey:function(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])},copyGLTo2D:_,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var e=this.gl,t={renderer:"",vendor:""};if(!e)return t;var n=e.getExtension("WEBGL_debug_renderer_info");if(n){var i=e.getParameter(n.UNMASKED_RENDERER_WEBGL),r=e.getParameter(n.UNMASKED_VENDOR_WEBGL);i&&(t.renderer=i.toLowerCase()),r&&(t.vendor=r.toLowerCase())}return this.gpuInfo=t,t}}}(),function(){var e=function(){};function t(){}w.Canvas2dFilterBackend=t,t.prototype={evictCachesForKey:e,dispose:e,clearWebGLCaches:e,resources:{},applyFilters:function(e,t,n,i,r){var o=r.getContext("2d");o.drawImage(t,0,0,n,i);var a={sourceWidth:n,sourceHeight:i,imageData:o.getImageData(0,0,n,i),originalEl:t,originalImageData:o.getImageData(0,0,n,i),canvasEl:r,ctx:o,filterBackend:this};return e.forEach((function(e){e.applyTo(a)})),a.imageData.width===n&&a.imageData.height===i||(r.width=a.imageData.width,r.height=a.imageData.height),o.putImageData(a.imageData,0,0),a}}}(),w.Image=w.Image||{},w.Image.filters=w.Image.filters||{},w.Image.filters.BaseFilter=w.util.createClass({type:"BaseFilter",vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvoid main() {\nvTexCoord = aPosition;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:"precision highp float;\nvarying vec2 vTexCoord;\nuniform sampler2D uTexture;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\n}",initialize:function(e){e&&this.setOptions(e)},setOptions:function(e){for(var t in e)this[t]=e[t]},createProgram:function(e,t,n){t=t||this.fragmentSource,n=n||this.vertexSource,"highp"!==w.webGlPrecision&&(t=t.replace(/precision highp float/g,"precision "+w.webGlPrecision+" float"));var i=e.createShader(e.VERTEX_SHADER);if(e.shaderSource(i,n),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+e.getShaderInfoLog(i));var r=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+e.getShaderInfoLog(r));var o=e.createProgram();if(e.attachShader(o,i),e.attachShader(o,r),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+e.getProgramInfoLog(o));var a=this.getAttributeLocations(e,o),s=this.getUniformLocations(e,o)||{};return s.uStepW=e.getUniformLocation(o,"uStepW"),s.uStepH=e.getUniformLocation(o,"uStepH"),{program:o,attributeLocations:a,uniformLocations:s}},getAttributeLocations:function(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(e,t,n){var i=t.aPosition,r=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,r),e.enableVertexAttribArray(i),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)},_setupFrameBuffer:function(e){var t,n,i=e.context;e.passes>1?(t=e.destinationWidth,n=e.destinationHeight,e.sourceWidth===t&&e.sourceHeight===n||(i.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(i,t,n)),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,e.targetTexture,0)):(i.bindFramebuffer(i.FRAMEBUFFER,null),i.finish())},_swapTextures:function(e){e.passes--,e.pass++;var t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t},isNeutralState:function(){var e=this.mainParameter,t=w.Image.filters[this.type].prototype;if(e){if(Array.isArray(t[e])){for(var n=t[e].length;n--;)if(this[e][n]!==t[e][n])return!1;return!0}return t[e]===this[e]}return!1},applyTo:function(e){e.webgl?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},retrieveShader:function(e){return e.programCache.hasOwnProperty(this.type)||(e.programCache[this.type]=this.createProgram(e.context)),e.programCache[this.type]},applyToWebGL:function(e){var t=e.context,n=this.retrieveShader(e);0===e.pass&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(n.program),this.sendAttributeData(t,n.attributeLocations,e.aPosition),t.uniform1f(n.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(n.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,n.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(e,t,n){e.activeTexture(n),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)},unbindAdditionalTexture:function(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(e){this[this.mainParameter]=e},sendUniformData:function(){},createHelpLayer:function(e){if(!e.helpLayer){var t=document.createElement("canvas");t.width=e.sourceWidth,t.height=e.sourceHeight,e.helpLayer=t}},toObject:function(){var e={type:this.type},t=this.mainParameter;return t&&(e[t]=this[t]),e},toJSON:function(){return this.toObject()}}),w.Image.filters.BaseFilter.fromObject=function(e,t){var n=new w.Image.filters[e.type](e);return t&&t(n),n},function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.ColorMatrix=i(n.BaseFilter,{type:"ColorMatrix",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nuniform mat4 uColorMatrix;\nuniform vec4 uConstants;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor *= uColorMatrix;\ncolor += uConstants;\ngl_FragColor = color;\n}",matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(e){this.callSuper("initialize",e),this.matrix=this.matrix.slice(0)},applyTo2d:function(e){var t,n,i,r,o,a=e.imageData.data,s=a.length,l=this.matrix,c=this.colorsOnly;for(o=0;o<s;o+=4)t=a[o],n=a[o+1],i=a[o+2],c?(a[o]=t*l[0]+n*l[1]+i*l[2]+255*l[4],a[o+1]=t*l[5]+n*l[6]+i*l[7]+255*l[9],a[o+2]=t*l[10]+n*l[11]+i*l[12]+255*l[14]):(r=a[o+3],a[o]=t*l[0]+n*l[1]+i*l[2]+r*l[3]+255*l[4],a[o+1]=t*l[5]+n*l[6]+i*l[7]+r*l[8]+255*l[9],a[o+2]=t*l[10]+n*l[11]+i*l[12]+r*l[13]+255*l[14],a[o+3]=t*l[15]+n*l[16]+i*l[17]+r*l[18]+255*l[19])},getUniformLocations:function(e,t){return{uColorMatrix:e.getUniformLocation(t,"uColorMatrix"),uConstants:e.getUniformLocation(t,"uConstants")}},sendUniformData:function(e,t){var n=this.matrix,i=[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]],r=[n[4],n[9],n[14],n[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,i),e.uniform4fv(t.uConstants,r)}}),t.Image.filters.ColorMatrix.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Brightness=i(n.BaseFilter,{type:"Brightness",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBrightness;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += uBrightness;\ngl_FragColor = color;\n}",brightness:0,mainParameter:"brightness",applyTo2d:function(e){if(0!==this.brightness){var t,n=e.imageData.data,i=n.length,r=Math.round(255*this.brightness);for(t=0;t<i;t+=4)n[t]=n[t]+r,n[t+1]=n[t+1]+r,n[t+2]=n[t+2]+r}},getUniformLocations:function(e,t){return{uBrightness:e.getUniformLocation(t,"uBrightness")}},sendUniformData:function(e,t){e.uniform1f(t.uBrightness,this.brightness)}}),t.Image.filters.Brightness.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.Image.filters,r=t.util.createClass;i.Convolute=r(i.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_3_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[9];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 3.0; h+=1.0) {\nfor (float w = 0.0; w < 3.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_5_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_5_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[25];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 5.0; h+=1.0) {\nfor (float w = 0.0; w < 5.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_7_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_7_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[49];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 7.0; h+=1.0) {\nfor (float w = 0.0; w < 7.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}",Convolute_9_1:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 0);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];\n}\n}\ngl_FragColor = color;\n}",Convolute_9_0:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uMatrix[81];\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = vec4(0, 0, 0, 1);\nfor (float h = 0.0; h < 9.0; h+=1.0) {\nfor (float w = 0.0; w < 9.0; w+=1.0) {\nvec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));\ncolor.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];\n}\n}\nfloat alpha = texture2D(uTexture, vTexCoord).a;\ngl_FragColor = color;\ngl_FragColor.a = alpha;\n}"},retrieveShader:function(e){var t=Math.sqrt(this.matrix.length),n=this.type+"_"+t+"_"+(this.opaque?1:0),i=this.fragmentSource[n];return e.programCache.hasOwnProperty(n)||(e.programCache[n]=this.createProgram(e.context,i)),e.programCache[n]},applyTo2d:function(e){var t,n,i,r,o,a,s,l,c,u,h,d,f,p=e.imageData,g=p.data,v=this.matrix,A=Math.round(Math.sqrt(v.length)),m=Math.floor(A/2),y=p.width,b=p.height,C=e.ctx.createImageData(y,b),w=C.data,x=this.opaque?1:0;for(h=0;h<b;h++)for(u=0;u<y;u++){for(o=4*(h*y+u),t=0,n=0,i=0,r=0,f=0;f<A;f++)for(d=0;d<A;d++)a=u+d-m,(s=h+f-m)<0||s>=b||a<0||a>=y||(l=4*(s*y+a),c=v[f*A+d],t+=g[l]*c,n+=g[l+1]*c,i+=g[l+2]*c,x||(r+=g[l+3]*c));w[o]=t,w[o+1]=n,w[o+2]=i,w[o+3]=x?g[o+3]:r}e.imageData=C},getUniformLocations:function(e,t){return{uMatrix:e.getUniformLocation(t,"uMatrix"),uOpaque:e.getUniformLocation(t,"uOpaque"),uHalfSize:e.getUniformLocation(t,"uHalfSize"),uSize:e.getUniformLocation(t,"uSize")}},sendUniformData:function(e,t){e.uniform1fv(t.uMatrix,this.matrix)},toObject:function(){return n(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),t.Image.filters.Convolute.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Grayscale=i(n.BaseFilter,{type:"Grayscale",fragmentSource:{average:"precision highp float;\nuniform sampler2D uTexture;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat average = (color.r + color.b + color.g) / 3.0;\ngl_FragColor = vec4(average, average, average, color.a);\n}",lightness:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;\ngl_FragColor = vec4(average, average, average, col.a);\n}",luminosity:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uMode;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 col = texture2D(uTexture, vTexCoord);\nfloat average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;\ngl_FragColor = vec4(average, average, average, col.a);\n}"},mode:"average",mainParameter:"mode",applyTo2d:function(e){var t,n,i=e.imageData.data,r=i.length,o=this.mode;for(t=0;t<r;t+=4)"average"===o?n=(i[t]+i[t+1]+i[t+2])/3:"lightness"===o?n=(Math.min(i[t],i[t+1],i[t+2])+Math.max(i[t],i[t+1],i[t+2]))/2:"luminosity"===o&&(n=.21*i[t]+.72*i[t+1]+.07*i[t+2]),i[t]=n,i[t+1]=n,i[t+2]=n},retrieveShader:function(e){var t=this.type+"_"+this.mode;if(!e.programCache.hasOwnProperty(t)){var n=this.fragmentSource[this.mode];e.programCache[t]=this.createProgram(e.context,n)}return e.programCache[t]},getUniformLocations:function(e,t){return{uMode:e.getUniformLocation(t,"uMode")}},sendUniformData:function(e,t){e.uniform1i(t.uMode,1)},isNeutralState:function(){return!1}}),t.Image.filters.Grayscale.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Invert=i(n.BaseFilter,{type:"Invert",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform int uInvert;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nif (uInvert == 1) {\ngl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);\n} else {\ngl_FragColor = color;\n}\n}",invert:!0,mainParameter:"invert",applyTo2d:function(e){var t,n=e.imageData.data,i=n.length;for(t=0;t<i;t+=4)n[t]=255-n[t],n[t+1]=255-n[t+1],n[t+2]=255-n[t+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(e,t){return{uInvert:e.getUniformLocation(t,"uInvert")}},sendUniformData:function(e,t){e.uniform1i(t.uInvert,this.invert)}}),t.Image.filters.Invert.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.Image.filters,r=t.util.createClass;i.Noise=r(i.BaseFilter,{type:"Noise",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uStepH;\nuniform float uNoise;\nuniform float uSeed;\nvarying vec2 vTexCoord;\nfloat rand(vec2 co, float seed, float vScale) {\nreturn fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);\n}\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ncolor.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;\ngl_FragColor = color;\n}",mainParameter:"noise",noise:0,applyTo2d:function(e){if(0!==this.noise){var t,n,i=e.imageData.data,r=i.length,o=this.noise;for(t=0,r=i.length;t<r;t+=4)n=(.5-Math.random())*o,i[t]+=n,i[t+1]+=n,i[t+2]+=n}},getUniformLocations:function(e,t){return{uNoise:e.getUniformLocation(t,"uNoise"),uSeed:e.getUniformLocation(t,"uSeed")}},sendUniformData:function(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())},toObject:function(){return n(this.callSuper("toObject"),{noise:this.noise})}}),t.Image.filters.Noise.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Pixelate=i(n.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uBlocksize;\nuniform float uStepW;\nuniform float uStepH;\nvarying vec2 vTexCoord;\nvoid main() {\nfloat blockW = uBlocksize * uStepW;\nfloat blockH = uBlocksize * uStepW;\nint posX = int(vTexCoord.x / blockW);\nint posY = int(vTexCoord.y / blockH);\nfloat fposX = float(posX);\nfloat fposY = float(posY);\nvec2 squareCoords = vec2(fposX * blockW, fposY * blockH);\nvec4 color = texture2D(uTexture, squareCoords);\ngl_FragColor = color;\n}",applyTo2d:function(e){var t,n,i,r,o,a,s,l,c,u,h,d=e.imageData,f=d.data,p=d.height,g=d.width;for(n=0;n<p;n+=this.blocksize)for(i=0;i<g;i+=this.blocksize)for(r=f[t=4*n*g+4*i],o=f[t+1],a=f[t+2],s=f[t+3],u=Math.min(n+this.blocksize,p),h=Math.min(i+this.blocksize,g),l=n;l<u;l++)for(c=i;c<h;c++)f[t=4*l*g+4*c]=r,f[t+1]=o,f[t+2]=a,f[t+3]=s},isNeutralState:function(){return 1===this.blocksize},getUniformLocations:function(e,t){return{uBlocksize:e.getUniformLocation(t,"uBlocksize"),uStepW:e.getUniformLocation(t,"uStepW"),uStepH:e.getUniformLocation(t,"uStepH")}},sendUniformData:function(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}),t.Image.filters.Pixelate.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.extend,i=t.Image.filters,r=t.util.createClass;i.RemoveColor=r(i.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uLow;\nuniform vec4 uHigh;\nvarying vec2 vTexCoord;\nvoid main() {\ngl_FragColor = texture2D(uTexture, vTexCoord);\nif(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {\ngl_FragColor.a = 0.0;\n}\n}",distance:.02,useAlpha:!1,applyTo2d:function(e){var n,i,r,o,a=e.imageData.data,s=255*this.distance,l=new t.Color(this.color).getSource(),c=[l[0]-s,l[1]-s,l[2]-s],u=[l[0]+s,l[1]+s,l[2]+s];for(n=0;n<a.length;n+=4)i=a[n],r=a[n+1],o=a[n+2],i>c[0]&&r>c[1]&&o>c[2]&&i<u[0]&&r<u[1]&&o<u[2]&&(a[n+3]=0)},getUniformLocations:function(e,t){return{uLow:e.getUniformLocation(t,"uLow"),uHigh:e.getUniformLocation(t,"uHigh")}},sendUniformData:function(e,n){var i=new t.Color(this.color).getSource(),r=parseFloat(this.distance),o=[0+i[0]/255-r,0+i[1]/255-r,0+i[2]/255-r,1],a=[i[0]/255+r,i[1]/255+r,i[2]/255+r,1];e.uniform4fv(n.uLow,o),e.uniform4fv(n.uHigh,a)},toObject:function(){return n(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),t.Image.filters.RemoveColor.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass,r={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var o in r)n[o]=i(n.ColorMatrix,{type:o,matrix:r[o],mainParameter:!1,colorsOnly:!0}),t.Image.filters[o].fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric,n=t.Image.filters,i=t.util.createClass;n.BlendColor=i(n.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:"gl_FragColor.rgb *= uColor.rgb;\n",screen:"gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);\n",add:"gl_FragColor.rgb += uColor.rgb;\n",diff:"gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);\n",subtract:"gl_FragColor.rgb -= uColor.rgb;\n",lighten:"gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);\n",darken:"gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);\n",exclusion:"gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);\n",overlay:"if (uColor.r < 0.5) {\ngl_FragColor.r *= 2.0 * uColor.r;\n} else {\ngl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);\n}\nif (uColor.g < 0.5) {\ngl_FragColor.g *= 2.0 * uColor.g;\n} else {\ngl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);\n}\nif (uColor.b < 0.5) {\ngl_FragColor.b *= 2.0 * uColor.b;\n} else {\ngl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);\n}\n",tint:"gl_FragColor.rgb *= (1.0 - uColor.a);\ngl_FragColor.rgb += uColor.rgb;\n"},buildSource:function(e){return"precision highp float;\nuniform sampler2D uTexture;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\ngl_FragColor = color;\nif (color.a > 0.0) {\n"+this.fragmentSource[e]+"}\n}"},retrieveShader:function(e){var t,n=this.type+"_"+this.mode;return e.programCache.hasOwnProperty(n)||(t=this.buildSource(this.mode),e.programCache[n]=this.createProgram(e.context,t)),e.programCache[n]},applyTo2d:function(e){var n,i,r,o,a,s,l,c=e.imageData.data,u=c.length,h=1-this.alpha;n=(l=new t.Color(this.color).getSource())[0]*this.alpha,i=l[1]*this.alpha,r=l[2]*this.alpha;for(var d=0;d<u;d+=4)switch(o=c[d],a=c[d+1],s=c[d+2],this.mode){case"multiply":c[d]=o*n/255,c[d+1]=a*i/255,c[d+2]=s*r/255;break;case"screen":c[d]=255-(255-o)*(255-n)/255,c[d+1]=255-(255-a)*(255-i)/255,c[d+2]=255-(255-s)*(255-r)/255;break;case"add":c[d]=o+n,c[d+1]=a+i,c[d+2]=s+r;break;case"diff":case"difference":c[d]=Math.abs(o-n),c[d+1]=Math.abs(a-i),c[d+2]=Math.abs(s-r);break;case"subtract":c[d]=o-n,c[d+1]=a-i,c[d+2]=s-r;break;case"darken":c[d]=Math.min(o,n),c[d+1]=Math.min(a,i),c[d+2]=Math.min(s,r);break;case"lighten":c[d]=Math.max(o,n),c[d+1]=Math.max(a,i),c[d+2]=Math.max(s,r);break;case"overlay":c[d]=n<128?2*o*n/255:255-2*(255-o)*(255-n)/255,c[d+1]=i<128?2*a*i/255:255-2*(255-a)*(255-i)/255,c[d+2]=r<128?2*s*r/255:255-2*(255-s)*(255-r)/255;break;case"exclusion":c[d]=n+o-2*n*o/255,c[d+1]=i+a-2*i*a/255,c[d+2]=r+s-2*r*s/255;break;case"tint":c[d]=n+o*h,c[d+1]=i+a*h,c[d+2]=r+s*h}},getUniformLocations:function(e,t){return{uColor:e.getUniformLocation(t,"uColor")}},sendUniformData:function(e,n){var i=new t.Color(this.color).getSource();i[0]=this.alpha*i[0]/255,i[1]=this.alpha*i[1]/255,i[2]=this.alpha*i[2]/255,i[3]=this.alpha,e.uniform4fv(n.uColor,i)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendColor.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric,n=t.Image.filters,i=t.util.createClass;n.BlendImage=i(n.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:"attribute vec2 aPosition;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nuniform mat3 uTransformMatrix;\nvoid main() {\nvTexCoord = aPosition;\nvTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;\ngl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);\n}",fragmentSource:{multiply:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.rgba *= color2.rgba;\ngl_FragColor = color;\n}",mask:"precision highp float;\nuniform sampler2D uTexture;\nuniform sampler2D uImage;\nuniform vec4 uColor;\nvarying vec2 vTexCoord;\nvarying vec2 vTexCoord2;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec4 color2 = texture2D(uImage, vTexCoord2);\ncolor.a = color2.a;\ngl_FragColor = color;\n}"},retrieveShader:function(e){var t=this.type+"_"+this.mode,n=this.fragmentSource[this.mode];return e.programCache.hasOwnProperty(t)||(e.programCache[t]=this.createProgram(e.context,n)),e.programCache[t]},applyToWebGL:function(e){var t=e.context,n=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,n,t.TEXTURE1),this.callSuper("applyToWebGL",e),this.unbindAdditionalTexture(t,t.TEXTURE1)},createTexture:function(e,t){return e.getCachedTexture(t.cacheKey,t._element)},calculateMatrix:function(){var e=this.image,t=e._element.width,n=e._element.height;return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/n,1]},applyTo2d:function(e){var n,i,r,o,a,s,l,c,u,h,d,f=e.imageData,p=e.filterBackend.resources,g=f.data,v=g.length,A=f.width,m=f.height,y=this.image;p.blendImage||(p.blendImage=t.util.createCanvasElement()),h=(u=p.blendImage).getContext("2d"),u.width!==A||u.height!==m?(u.width=A,u.height=m):h.clearRect(0,0,A,m),h.setTransform(y.scaleX,0,0,y.scaleY,y.left,y.top),h.drawImage(y._element,0,0,A,m),d=h.getImageData(0,0,A,m).data;for(var b=0;b<v;b+=4)switch(a=g[b],s=g[b+1],l=g[b+2],c=g[b+3],n=d[b],i=d[b+1],r=d[b+2],o=d[b+3],this.mode){case"multiply":g[b]=a*n/255,g[b+1]=s*i/255,g[b+2]=l*r/255,g[b+3]=c*o/255;break;case"mask":g[b+3]=o}},getUniformLocations:function(e,t){return{uTransformMatrix:e.getUniformLocation(t,"uTransformMatrix"),uImage:e.getUniformLocation(t,"uImage")}},sendUniformData:function(e,t){var n=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,n)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),t.Image.filters.BlendImage.fromObject=function(e,n){t.Image.fromObject(e.image,(function(i){var r=t.util.object.clone(e);r.image=i,n(new t.Image.filters.BlendImage(r))}))}}(e),function(e){var t=e.fabric||(e.fabric={}),n=Math.pow,i=Math.floor,r=Math.sqrt,o=Math.abs,a=Math.round,s=Math.sin,l=Math.ceil,c=t.Image.filters,u=t.util.createClass;c.Resize=u(c.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(e,t){return{uDelta:e.getUniformLocation(t,"uDelta"),uTaps:e.getUniformLocation(t,"uTaps")}},sendUniformData:function(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)},retrieveShader:function(e){var t=this.getFilterWindow(),n=this.type+"_"+t;if(!e.programCache.hasOwnProperty(n)){var i=this.generateShader(t);e.programCache[n]=this.createProgram(e.context,i)}return e.programCache[n]},getFilterWindow:function(){var e=this.tempScale;return Math.ceil(this.lanczosLobes/e)},getTaps:function(){for(var e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,n=this.getFilterWindow(),i=new Array(n),r=1;r<=n;r++)i[r-1]=e(r*t);return i},generateShader:function(e){for(var t=new Array(e),n=this.fragmentSourceTOP,i=1;i<=e;i++)t[i-1]=i+".0 * uDelta";return n+="uniform float uTaps["+e+"];\n",n+="void main() {\n",n+="  vec4 color = texture2D(uTexture, vTexCoord);\n",n+="  float sum = 1.0;\n",t.forEach((function(e,t){n+="  color += texture2D(uTexture, vTexCoord + "+e+") * uTaps["+t+"];\n",n+="  color += texture2D(uTexture, vTexCoord - "+e+") * uTaps["+t+"];\n",n+="  sum += 2.0 * uTaps["+t+"];\n"})),n+="  gl_FragColor = color / sum;\n",n+="}"},fragmentSourceTOP:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\n",applyTo:function(e){e.webgl?(e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e),e.sourceHeight=e.destinationHeight):this.applyTo2d(e)},isNeutralState:function(){return 1===this.scaleX&&1===this.scaleY},lanczosCreate:function(e){return function(t){if(t>=e||t<=-e)return 0;if(t<1.1920929e-7&&t>-1.1920929e-7)return 1;var n=(t*=Math.PI)/e;return s(t)/t*s(n)/n}},applyTo2d:function(e){var t=e.imageData,n=this.scaleX,i=this.scaleY;this.rcpScaleX=1/n,this.rcpScaleY=1/i;var r,o=t.width,s=t.height,l=a(o*n),c=a(s*i);"sliceHack"===this.resizeType?r=this.sliceByTwo(e,o,s,l,c):"hermite"===this.resizeType?r=this.hermiteFastResize(e,o,s,l,c):"bilinear"===this.resizeType?r=this.bilinearFiltering(e,o,s,l,c):"lanczos"===this.resizeType&&(r=this.lanczosResize(e,o,s,l,c)),e.imageData=r},sliceByTwo:function(e,n,r,o,a){var s,l,c=e.imageData,u=.5,h=!1,d=!1,f=n*u,p=r*u,g=t.filterBackend.resources,v=0,A=0,m=n,y=0;for(g.sliceByTwo||(g.sliceByTwo=document.createElement("canvas")),((s=g.sliceByTwo).width<1.5*n||s.height<r)&&(s.width=1.5*n,s.height=r),(l=s.getContext("2d")).clearRect(0,0,1.5*n,r),l.putImageData(c,0,0),o=i(o),a=i(a);!h||!d;)n=f,r=p,o<i(f*u)?f=i(f*u):(f=o,h=!0),a<i(p*u)?p=i(p*u):(p=a,d=!0),l.drawImage(s,v,A,n,r,m,y,f,p),v=m,A=y,y+=p;return l.getImageData(v,A,o,a)},lanczosResize:function(e,t,a,s,c){var u=e.imageData.data,h=e.ctx.createImageData(s,c),d=h.data,f=this.lanczosCreate(this.lanczosLobes),p=this.rcpScaleX,g=this.rcpScaleY,v=2/this.rcpScaleX,A=2/this.rcpScaleY,m=l(p*this.lanczosLobes/2),y=l(g*this.lanczosLobes/2),b={},C={},w={};return function e(l){var x,_,E,S,I,k,B,O,T,D,M;for(C.x=(l+.5)*p,w.x=i(C.x),x=0;x<c;x++){for(C.y=(x+.5)*g,w.y=i(C.y),I=0,k=0,B=0,O=0,T=0,_=w.x-m;_<=w.x+m;_++)if(!(_<0||_>=t)){D=i(1e3*o(_-C.x)),b[D]||(b[D]={});for(var Q=w.y-y;Q<=w.y+y;Q++)Q<0||Q>=a||(M=i(1e3*o(Q-C.y)),b[D][M]||(b[D][M]=f(r(n(D*v,2)+n(M*A,2))/1e3)),(E=b[D][M])>0&&(I+=E,k+=E*u[S=4*(Q*t+_)],B+=E*u[S+1],O+=E*u[S+2],T+=E*u[S+3]))}d[S=4*(x*s+l)]=k/I,d[S+1]=B/I,d[S+2]=O/I,d[S+3]=T/I}return++l<s?e(l):h}(0)},bilinearFiltering:function(e,t,n,r,o){var a,s,l,c,u,h,d,f,p,g=0,v=this.rcpScaleX,A=this.rcpScaleY,m=4*(t-1),y=e.imageData.data,b=e.ctx.createImageData(r,o),C=b.data;for(l=0;l<o;l++)for(c=0;c<r;c++)for(u=v*c-(a=i(v*c)),h=A*l-(s=i(A*l)),p=4*(s*t+a),d=0;d<4;d++)f=y[p+d]*(1-u)*(1-h)+y[p+4+d]*u*(1-h)+y[p+m+d]*h*(1-u)+y[p+m+4+d]*u*h,C[g++]=f;return b},hermiteFastResize:function(e,t,n,a,s){for(var c=this.rcpScaleX,u=this.rcpScaleY,h=l(c/2),d=l(u/2),f=e.imageData.data,p=e.ctx.createImageData(a,s),g=p.data,v=0;v<s;v++)for(var A=0;A<a;A++){for(var m=4*(A+v*a),y=0,b=0,C=0,w=0,x=0,_=0,E=0,S=(v+.5)*u,I=i(v*u);I<(v+1)*u;I++)for(var k=o(S-(I+.5))/d,B=(A+.5)*c,O=k*k,T=i(A*c);T<(A+1)*c;T++){var D=o(B-(T+.5))/h,M=r(O+D*D);M>1&&M<-1||(y=2*M*M*M-3*M*M+1)>0&&(E+=y*f[(D=4*(T+I*t))+3],C+=y,f[D+3]<255&&(y=y*f[D+3]/250),w+=y*f[D],x+=y*f[D+1],_+=y*f[D+2],b+=y)}g[m]=w/b,g[m+1]=x/b,g[m+2]=_/b,g[m+3]=E/C}return p},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),t.Image.filters.Resize.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Contrast=i(n.BaseFilter,{type:"Contrast",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uContrast;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));\ncolor.rgb = contrastF * (color.rgb - 0.5) + 0.5;\ngl_FragColor = color;\n}",contrast:0,mainParameter:"contrast",applyTo2d:function(e){if(0!==this.contrast){var t,n=e.imageData.data,i=n.length,r=Math.floor(255*this.contrast),o=259*(r+255)/(255*(259-r));for(t=0;t<i;t+=4)n[t]=o*(n[t]-128)+128,n[t+1]=o*(n[t+1]-128)+128,n[t+2]=o*(n[t+2]-128)+128}},getUniformLocations:function(e,t){return{uContrast:e.getUniformLocation(t,"uContrast")}},sendUniformData:function(e,t){e.uniform1f(t.uContrast,this.contrast)}}),t.Image.filters.Contrast.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Saturation=i(n.BaseFilter,{type:"Saturation",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uSaturation;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat rgMax = max(color.r, color.g);\nfloat rgbMax = max(rgMax, color.b);\ncolor.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;\ncolor.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;\ncolor.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;\ngl_FragColor = color;\n}",saturation:0,mainParameter:"saturation",applyTo2d:function(e){if(0!==this.saturation){var t,n,i=e.imageData.data,r=i.length,o=-this.saturation;for(t=0;t<r;t+=4)n=Math.max(i[t],i[t+1],i[t+2]),i[t]+=n!==i[t]?(n-i[t])*o:0,i[t+1]+=n!==i[t+1]?(n-i[t+1])*o:0,i[t+2]+=n!==i[t+2]?(n-i[t+2])*o:0}},getUniformLocations:function(e,t){return{uSaturation:e.getUniformLocation(t,"uSaturation")}},sendUniformData:function(e,t){e.uniform1f(t.uSaturation,-this.saturation)}}),t.Image.filters.Saturation.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Vibrance=i(n.BaseFilter,{type:"Vibrance",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform float uVibrance;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nfloat max = max(color.r, max(color.g, color.b));\nfloat avg = (color.r + color.g + color.b) / 3.0;\nfloat amt = (abs(max - avg) * 2.0) * uVibrance;\ncolor.r += max != color.r ? (max - color.r) * amt : 0.00;\ncolor.g += max != color.g ? (max - color.g) * amt : 0.00;\ncolor.b += max != color.b ? (max - color.b) * amt : 0.00;\ngl_FragColor = color;\n}",vibrance:0,mainParameter:"vibrance",applyTo2d:function(e){if(0!==this.vibrance){var t,n,i,r,o=e.imageData.data,a=o.length,s=-this.vibrance;for(t=0;t<a;t+=4)n=Math.max(o[t],o[t+1],o[t+2]),i=(o[t]+o[t+1]+o[t+2])/3,r=2*Math.abs(n-i)/255*s,o[t]+=n!==o[t]?(n-o[t])*r:0,o[t+1]+=n!==o[t+1]?(n-o[t+1])*r:0,o[t+2]+=n!==o[t+2]?(n-o[t+2])*r:0}},getUniformLocations:function(e,t){return{uVibrance:e.getUniformLocation(t,"uVibrance")}},sendUniformData:function(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}}),t.Image.filters.Vibrance.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Blur=i(n.BaseFilter,{type:"Blur",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec2 uDelta;\nvarying vec2 vTexCoord;\nconst float nSamples = 15.0;\nvec3 v3offset = vec3(12.9898, 78.233, 151.7182);\nfloat random(vec3 scale) {\nreturn fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);\n}\nvoid main() {\nvec4 color = vec4(0.0);\nfloat total = 0.0;\nfloat offset = random(v3offset);\nfor (float t = -nSamples; t <= nSamples; t++) {\nfloat percent = (t + offset - 0.5) / nSamples;\nfloat weight = 1.0 - abs(percent);\ncolor += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;\ntotal += weight;\n}\ngl_FragColor = color / total;\n}",blur:0,mainParameter:"blur",applyTo:function(e){e.webgl?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)},applyTo2d:function(e){e.imageData=this.simpleBlur(e)},simpleBlur:function(e){var n,i,r=e.filterBackend.resources,o=e.imageData.width,a=e.imageData.height;r.blurLayer1||(r.blurLayer1=t.util.createCanvasElement(),r.blurLayer2=t.util.createCanvasElement()),n=r.blurLayer1,i=r.blurLayer2,n.width===o&&n.height===a||(i.width=n.width=o,i.height=n.height=a);var s,l,c,u,h=n.getContext("2d"),d=i.getContext("2d"),f=15,p=.06*this.blur*.5;for(h.putImageData(e.imageData,0,0),d.clearRect(0,0,o,a),u=-15;u<=f;u++)c=p*(l=u/f)*o+(s=(Math.random()-.5)/4),d.globalAlpha=1-Math.abs(l),d.drawImage(n,c,s),h.drawImage(i,0,0),d.globalAlpha=1,d.clearRect(0,0,i.width,i.height);for(u=-15;u<=f;u++)c=p*(l=u/f)*a+(s=(Math.random()-.5)/4),d.globalAlpha=1-Math.abs(l),d.drawImage(n,s,c),h.drawImage(i,0,0),d.globalAlpha=1,d.clearRect(0,0,i.width,i.height);e.ctx.drawImage(n,0,0);var g=e.ctx.getImageData(0,0,n.width,n.height);return h.globalAlpha=1,h.clearRect(0,0,n.width,n.height),g},getUniformLocations:function(e,t){return{delta:e.getUniformLocation(t,"uDelta")}},sendUniformData:function(e,t){var n=this.chooseRightDelta();e.uniform2fv(t.delta,n)},chooseRightDelta:function(){var e,t=1,n=[0,0];return this.horizontal?this.aspectRatio>1&&(t=1/this.aspectRatio):this.aspectRatio<1&&(t=this.aspectRatio),e=t*this.blur*.12,this.horizontal?n[0]=e:n[1]=e,n}}),n.Blur.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Gamma=i(n.BaseFilter,{type:"Gamma",fragmentSource:"precision highp float;\nuniform sampler2D uTexture;\nuniform vec3 uGamma;\nvarying vec2 vTexCoord;\nvoid main() {\nvec4 color = texture2D(uTexture, vTexCoord);\nvec3 correction = (1.0 / uGamma);\ncolor.r = pow(color.r, correction.r);\ncolor.g = pow(color.g, correction.g);\ncolor.b = pow(color.b, correction.b);\ngl_FragColor = color;\ngl_FragColor.rgb *= color.a;\n}",gamma:[1,1,1],mainParameter:"gamma",initialize:function(e){this.gamma=[1,1,1],n.BaseFilter.prototype.initialize.call(this,e)},applyTo2d:function(e){var t,n=e.imageData.data,i=this.gamma,r=n.length,o=1/i[0],a=1/i[1],s=1/i[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),t=0,r=256;t<r;t++)this.rVals[t]=255*Math.pow(t/255,o),this.gVals[t]=255*Math.pow(t/255,a),this.bVals[t]=255*Math.pow(t/255,s);for(t=0,r=n.length;t<r;t+=4)n[t]=this.rVals[n[t]],n[t+1]=this.gVals[n[t+1]],n[t+2]=this.bVals[n[t+2]]},getUniformLocations:function(e,t){return{uGamma:e.getUniformLocation(t,"uGamma")}},sendUniformData:function(e,t){e.uniform3fv(t.uGamma,this.gamma)}}),t.Image.filters.Gamma.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.Composed=i(n.BaseFilter,{type:"Composed",subFilters:[],initialize:function(e){this.callSuper("initialize",e),this.subFilters=this.subFilters.slice(0)},applyTo:function(e){e.passes+=this.subFilters.length-1,this.subFilters.forEach((function(t){t.applyTo(e)}))},toObject:function(){return t.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map((function(e){return e.toObject()}))})},isNeutralState:function(){return!this.subFilters.some((function(e){return!e.isNeutralState()}))}}),t.Image.filters.Composed.fromObject=function(e,n){var i=(e.subFilters||[]).map((function(e){return new t.Image.filters[e.type](e)})),r=new t.Image.filters.Composed({subFilters:i});return n&&n(r),r}}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.Image.filters,i=t.util.createClass;n.HueRotation=i(n.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var e=this.rotation*Math.PI,n=t.util.cos(e),i=t.util.sin(e),r=1/3,o=Math.sqrt(r)*i,a=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+a/3,this.matrix[1]=r*a-o,this.matrix[2]=r*a+o,this.matrix[5]=r*a+o,this.matrix[6]=n+r*a,this.matrix[7]=r*a-o,this.matrix[10]=r*a-o,this.matrix[11]=r*a+o,this.matrix[12]=n+r*a},isNeutralState:function(e){return this.calculateMatrix(),n.BaseFilter.prototype.isNeutralState.call(this,e)},applyTo:function(e){this.calculateMatrix(),n.BaseFilter.prototype.applyTo.call(this,e)}}),t.Image.filters.HueRotation.fromObject=t.Image.filters.BaseFilter.fromObject}(e),function(e){var t=e.fabric||(e.fabric={}),n=t.util.object.clone;if(t.Text)t.warn("fabric.Text is already defined");else{var i="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");t.Text=t.util.createClass(t.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:t.Object.prototype.stateProperties.concat(i),cacheProperties:t.Object.prototype.cacheProperties.concat(i),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(e,t){this.styles=t&&t.styles||{},this.text=e,this.__skipDimension=!0,this.callSuper("initialize",t),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var e=this.path;e&&(e.segmentsInfo=t.util.getPathSegmentsInfo(e.path))},getMeasuringContext:function(){return t._measuringContext||(t._measuringContext=this.canvas&&this.canvas.contextCache||t.util.createCanvasElement().getContext("2d")),t._measuringContext},_splitText:function(){var e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var e,t,n,i,r,o,a,s=0,l=this._textLines.length;s<l;s++)if(("justify"===this.textAlign||s!==l-1&&!this.isEndOfWrapping(s))&&(i=0,r=this._textLines[s],(t=this.getLineWidth(s))<this.width&&(a=this.textLines[s].match(this._reSpacesAndTabs)))){n=a.length,e=(this.width-t)/n;for(var c=0,u=r.length;c<=u;c++)o=this.__charBounds[s][c],this._reSpaceAndTab.test(r[c])?(o.width+=e,o.kernedWidth+=e,o.left+=i,i+=e):o.left+=i}},isEndOfWrapping:function(e){return e===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var e=this.callSuper("_getCacheCanvasDimensions"),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e},_render:function(e){var t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")},_renderText:function(e){"stroke"===this.paintFirst?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))},_setTextStyles:function(e,t,n){if(e.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":e.textBaseline="middle";break;case"ascender":e.textBaseline="top";break;case"descender":e.textBaseline="bottom"}e.font=this._getFontDeclaration(t,n)},calcTextWidth:function(){for(var e=this.getLineWidth(0),t=1,n=this._textLines.length;t<n;t++){var i=this.getLineWidth(t);i>e&&(e=i)}return e},_renderTextLine:function(e,t,n,i,r,o){this._renderChars(e,t,n,i,r,o)},_renderTextLinesBackground:function(e){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var t,n,i,r,o,a,s,l=e.fillStyle,c=this._getLeftOffset(),u=this._getTopOffset(),h=0,d=0,f=this.path,p=0,g=this._textLines.length;p<g;p++)if(t=this.getHeightOfLine(p),this.textBackgroundColor||this.styleHas("textBackgroundColor",p)){i=this._textLines[p],n=this._getLineLeftOffset(p),d=0,h=0,r=this.getValueOfPropertyAt(p,0,"textBackgroundColor");for(var v=0,A=i.length;v<A;v++)o=this.__charBounds[p][v],a=this.getValueOfPropertyAt(p,v,"textBackgroundColor"),f?(e.save(),e.translate(o.renderLeft,o.renderTop),e.rotate(o.angle),e.fillStyle=a,a&&e.fillRect(-o.width/2,-t/this.lineHeight*(1-this._fontSizeFraction),o.width,t/this.lineHeight),e.restore()):a!==r?(s=c+n+h,"rtl"===this.direction&&(s=this.width-s-d),e.fillStyle=r,r&&e.fillRect(s,u,d,t/this.lineHeight),h=o.left,d=o.width,r=a):d+=o.kernedWidth;a&&!f&&(s=c+n+h,"rtl"===this.direction&&(s=this.width-s-d),e.fillStyle=a,e.fillRect(s,u,d,t/this.lineHeight)),u+=t}else u+=t;e.fillStyle=l,this._removeShadow(e)}},getFontCache:function(e){var n=e.fontFamily.toLowerCase();t.charWidthsCache[n]||(t.charWidthsCache[n]={});var i=t.charWidthsCache[n],r=e.fontStyle.toLowerCase()+"_"+(e.fontWeight+"").toLowerCase();return i[r]||(i[r]={}),i[r]},_measureChar:function(e,t,n,i){var r,o,a,s,l=this.getFontCache(t),c=n+e,u=this._getFontDeclaration(t)===this._getFontDeclaration(i),h=t.fontSize/this.CACHE_FONT_SIZE;if(n&&void 0!==l[n]&&(a=l[n]),void 0!==l[e]&&(s=r=l[e]),u&&void 0!==l[c]&&(s=(o=l[c])-a),void 0===r||void 0===a||void 0===o){var d=this.getMeasuringContext();this._setTextStyles(d,t,!0)}return void 0===r&&(s=r=d.measureText(e).width,l[e]=r),void 0===a&&u&&n&&(a=d.measureText(n).width,l[n]=a),u&&void 0===o&&(o=d.measureText(c).width,l[c]=o,s=o-a),{width:r*h,kernedWidth:s*h}},getHeightOfChar:function(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")},measureLine:function(e){var t=this._measureLine(e);return 0!==this.charSpacing&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t},_measureLine:function(e){var n,i,r,o,a,s,l=0,c=this._textLines[e],u=new Array(c.length),h=0,d=this.path,f="right"===this.pathSide;for(this.__charBounds[e]=u,n=0;n<c.length;n++)i=c[n],o=this._getGraphemeBox(i,e,n,r),u[n]=o,l+=o.kernedWidth,r=i;if(u[n]={left:o?o.left+o.width:0,width:0,kernedWidth:0,height:this.fontSize},d){switch(s=d.segmentsInfo[d.segmentsInfo.length-1].length,(a=t.util.getPointOnPath(d.path,0,d.segmentsInfo)).x+=d.pathOffset.x,a.y+=d.pathOffset.y,this.textAlign){case"left":h=f?s-l:0;break;case"center":h=(s-l)/2;break;case"right":h=f?0:s-l}for(h+=this.pathStartOffset*(f?-1:1),n=f?c.length-1:0;f?n>=0:n<c.length;f?n--:n++)o=u[n],h>s?h%=s:h<0&&(h+=s),this._setGraphemeOnPath(h,o,a),h+=o.kernedWidth}return{width:l,numOfSpaces:0}},_setGraphemeOnPath:function(e,n,i){var r=e+n.kernedWidth/2,o=this.path,a=t.util.getPointOnPath(o.path,r,o.segmentsInfo);n.renderLeft=a.x-i.x,n.renderTop=a.y-i.y,n.angle=a.angle+("right"===this.pathSide?Math.PI:0)},_getGraphemeBox:function(e,t,n,i,r){var o,a=this.getCompleteStyleDeclaration(t,n),s=i?this.getCompleteStyleDeclaration(t,n-1):{},l=this._measureChar(e,a,i,s),c=l.kernedWidth,u=l.width;0!==this.charSpacing&&(u+=o=this._getWidthOfCharSpacing(),c+=o);var h={width:u,left:0,height:a.fontSize,kernedWidth:c,deltaY:a.deltaY};if(n>0&&!r){var d=this.__charBounds[t][n-1];h.left=d.left+d.width+l.kernedWidth-l.width}return h},getHeightOfLine:function(e){if(this.__lineHeights[e])return this.__lineHeights[e];for(var t=this._textLines[e],n=this.getHeightOfChar(e,0),i=1,r=t.length;i<r;i++)n=Math.max(this.getHeightOfChar(e,i),n);return this.__lineHeights[e]=n*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var e,t=0,n=0,i=this._textLines.length;n<i;n++)e=this.getHeightOfLine(n),t+=n===i-1?e/this.lineHeight:e;return t},_getLeftOffset:function(){return"ltr"===this.direction?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(e,t){e.save();for(var n=0,i=this._getLeftOffset(),r=this._getTopOffset(),o=0,a=this._textLines.length;o<a;o++){var s=this.getHeightOfLine(o),l=s/this.lineHeight,c=this._getLineLeftOffset(o);this._renderTextLine(t,e,this._textLines[o],i+c,r+n+l,o),n+=s}e.restore()},_renderTextFill:function(e){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(e,"fillText")},_renderTextStroke:function(e){(this.stroke&&0!==this.strokeWidth||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())},_renderChars:function(e,n,i,r,o,a){var s,l,c,u,h,d=this.getHeightOfLine(a),f=-1!==this.textAlign.indexOf("justify"),p="",g=0,v=this.path,A=!f&&0===this.charSpacing&&this.isEmptyStyles(a)&&!v,m="ltr"===this.direction,y="ltr"===this.direction?1:-1,b=n.canvas.getAttribute("dir");if(n.save(),b!==this.direction&&(n.canvas.setAttribute("dir",m?"ltr":"rtl"),n.direction=m?"ltr":"rtl",n.textAlign=m?"left":"right"),o-=d*this._fontSizeFraction/this.lineHeight,A)return this._renderChar(e,n,a,0,i.join(""),r,o,d),void n.restore();for(var C=0,w=i.length-1;C<=w;C++)u=C===w||this.charSpacing||v,p+=i[C],c=this.__charBounds[a][C],0===g?(r+=y*(c.kernedWidth-c.width),g+=c.width):g+=c.kernedWidth,f&&!u&&this._reSpaceAndTab.test(i[C])&&(u=!0),u||(s=s||this.getCompleteStyleDeclaration(a,C),l=this.getCompleteStyleDeclaration(a,C+1),u=t.util.hasStyleChanged(s,l,!1)),u&&(v?(n.save(),n.translate(c.renderLeft,c.renderTop),n.rotate(c.angle),this._renderChar(e,n,a,C,p,-g/2,0,d),n.restore()):(h=r,this._renderChar(e,n,a,C,p,h,o,d)),p="",s=l,r+=y*g,g=0);n.restore()},_applyPatternGradientTransformText:function(e){var n,i=t.util.createCanvasElement(),r=this.width+this.strokeWidth,o=this.height+this.strokeWidth;return i.width=r,i.height=o,(n=i.getContext("2d")).beginPath(),n.moveTo(0,0),n.lineTo(r,0),n.lineTo(r,o),n.lineTo(0,o),n.closePath(),n.translate(r/2,o/2),n.fillStyle=e.toLive(n),this._applyPatternGradientTransform(n,e),n.fill(),n.createPattern(i,"no-repeat")},handleFiller:function(e,t,n){var i,r;return n.toLive?"percentage"===n.gradientUnits||n.gradientTransform||n.patternTransform?(i=-this.width/2,r=-this.height/2,e.translate(i,r),e[t]=this._applyPatternGradientTransformText(n),{offsetX:i,offsetY:r}):(e[t]=n.toLive(e,this),this._applyPatternGradientTransform(e,n)):(e[t]=n,{offsetX:0,offsetY:0})},_setStrokeStyles:function(e,t){return e.lineWidth=t.strokeWidth,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",t.stroke)},_setFillStyles:function(e,t){return this.handleFiller(e,"fillStyle",t.fill)},_renderChar:function(e,t,n,i,r,o,a){var s,l,c=this._getStyleDeclaration(n,i),u=this.getCompleteStyleDeclaration(n,i),h="fillText"===e&&u.fill,d="strokeText"===e&&u.stroke&&u.strokeWidth;(d||h)&&(t.save(),h&&(s=this._setFillStyles(t,u)),d&&(l=this._setStrokeStyles(t,u)),t.font=this._getFontDeclaration(u),c&&c.textBackgroundColor&&this._removeShadow(t),c&&c.deltaY&&(a+=c.deltaY),h&&t.fillText(r,o-s.offsetX,a-s.offsetY),d&&t.strokeText(r,o-l.offsetX,a-l.offsetY),t.restore())},setSuperscript:function(e,t){return this._setScript(e,t,this.superscript)},setSubscript:function(e,t){return this._setScript(e,t,this.subscript)},_setScript:function(e,t,n){var i=this.get2DCursorLocation(e,!0),r=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"fontSize"),o=this.getValueOfPropertyAt(i.lineIndex,i.charIndex,"deltaY"),a={fontSize:r*n.size,deltaY:o+r*n.baseline};return this.setSelectionStyles(a,e,t),this},_getLineLeftOffset:function(e){var t=this.getLineWidth(e),n=this.width-t,i=this.textAlign,r=this.direction,o=0,a=this.isEndOfWrapping(e);return"justify"===i||"justify-center"===i&&!a||"justify-right"===i&&!a||"justify-left"===i&&!a?0:("center"===i&&(o=n/2),"right"===i&&(o=n),"justify-center"===i&&(o=n/2),"justify-right"===i&&(o=n),"rtl"===r&&(o-=n),o)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var e=this._forceClearCache;return e||(e=this.hasStateChanged("_dimensionAffectingProps")),e&&(this.dirty=!0,this._forceClearCache=!1),e},getLineWidth:function(e){if(void 0!==this.__lineWidths[e])return this.__lineWidths[e];var t=this.measureLine(e).width;return this.__lineWidths[e]=t,t},_getWidthOfCharSpacing:function(){return 0!==this.charSpacing?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(e,t,n){var i=this._getStyleDeclaration(e,t);return i&&void 0!==i[n]?i[n]:this[n]},_renderTextDecoration:function(e,t){if(this[t]||this.styleHas(t)){for(var n,i,r,o,a,s,l,c,u,h,d,f,p,g,v,A,m=this._getLeftOffset(),y=this._getTopOffset(),b=this.path,C=this._getWidthOfCharSpacing(),w=this.offsets[t],x=0,_=this._textLines.length;x<_;x++)if(n=this.getHeightOfLine(x),this[t]||this.styleHas(t,x)){l=this._textLines[x],g=n/this.lineHeight,o=this._getLineLeftOffset(x),h=0,d=0,c=this.getValueOfPropertyAt(x,0,t),A=this.getValueOfPropertyAt(x,0,"fill"),u=y+g*(1-this._fontSizeFraction),i=this.getHeightOfChar(x,0),a=this.getValueOfPropertyAt(x,0,"deltaY");for(var E=0,S=l.length;E<S;E++)if(f=this.__charBounds[x][E],p=this.getValueOfPropertyAt(x,E,t),v=this.getValueOfPropertyAt(x,E,"fill"),r=this.getHeightOfChar(x,E),s=this.getValueOfPropertyAt(x,E,"deltaY"),b&&p&&v)e.save(),e.fillStyle=A,e.translate(f.renderLeft,f.renderTop),e.rotate(f.angle),e.fillRect(-f.kernedWidth/2,w*r+s,f.kernedWidth,this.fontSize/15),e.restore();else if((p!==c||v!==A||r!==i||s!==a)&&d>0){var I=m+o+h;"rtl"===this.direction&&(I=this.width-I-d),c&&A&&(e.fillStyle=A,e.fillRect(I,u+w*i+a,d,this.fontSize/15)),h=f.left,d=f.width,c=p,A=v,i=r,a=s}else d+=f.kernedWidth;I=m+o+h;"rtl"===this.direction&&(I=this.width-I-d),e.fillStyle=v,p&&v&&e.fillRect(I,u+w*i+a,d-C,this.fontSize/15),y+=n}else y+=n;this._removeShadow(e)}},_getFontDeclaration:function(e,n){var i=e||this,r=this.fontFamily,o=t.Text.genericFonts.indexOf(r.toLowerCase())>-1,a=void 0===r||r.indexOf("'")>-1||r.indexOf(",")>-1||r.indexOf('"')>-1||o?i.fontFamily:'"'+i.fontFamily+'"';return[t.isLikelyNode?i.fontWeight:i.fontStyle,t.isLikelyNode?i.fontStyle:i.fontWeight,n?this.CACHE_FONT_SIZE+"px":i.fontSize+"px",a].join(" ")},render:function(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",e)))},_splitTextIntoLines:function(e){for(var n=e.split(this._reNewline),i=new Array(n.length),r=["\n"],o=[],a=0;a<n.length;a++)i[a]=t.util.string.graphemeSplit(n[a]),o=o.concat(i[a],r);return o.pop(),{_unwrappedLines:i,lines:n,graphemeText:o,graphemeLines:i}},toObject:function(e){var n=i.concat(e),r=this.callSuper("toObject",n);return r.styles=t.util.stylesToArray(this.styles,this.text),r.path&&(r.path=this.path.toObject()),r},set:function(e,t){this.callSuper("set",e,t);var n=!1,i=!1;if("object"==typeof e)for(var r in e)"path"===r&&this.setPathInfo(),n=n||-1!==this._dimensionAffectingProps.indexOf(r),i=i||"path"===r;else n=-1!==this._dimensionAffectingProps.indexOf(e),i="path"===e;return i&&this.setPathInfo(),n&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),t.Text.ATTRIBUTE_NAMES=t.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),t.Text.DEFAULT_SVG_FONT_SIZE=16,t.Text.fromElement=function(e,i,r){if(!e)return i(null);var o=t.parseAttributes(e,t.Text.ATTRIBUTE_NAMES),a=o.textAnchor||"left";if((r=t.util.object.extend(r?n(r):{},o)).top=r.top||0,r.left=r.left||0,o.textDecoration){var s=o.textDecoration;-1!==s.indexOf("underline")&&(r.underline=!0),-1!==s.indexOf("overline")&&(r.overline=!0),-1!==s.indexOf("line-through")&&(r.linethrough=!0),delete r.textDecoration}"dx"in o&&(r.left+=o.dx),"dy"in o&&(r.top+=o.dy),"fontSize"in r||(r.fontSize=t.Text.DEFAULT_SVG_FONT_SIZE);var l="";"textContent"in e?l=e.textContent:"firstChild"in e&&null!==e.firstChild&&"data"in e.firstChild&&null!==e.firstChild.data&&(l=e.firstChild.data),l=l.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var c=r.strokeWidth;r.strokeWidth=0;var u=new t.Text(l,r),h=u.getScaledHeight()/u.height,d=((u.height+u.strokeWidth)*u.lineHeight-u.height)*h,f=u.getScaledHeight()+d,p=0;"center"===a&&(p=u.getScaledWidth()/2),"right"===a&&(p=u.getScaledWidth()),u.set({left:u.left-p,top:u.top-(f-u.fontSize*(.07+u._fontSizeFraction))/u.lineHeight,strokeWidth:void 0!==c?c:1}),i(u)},t.Text.fromObject=function(e,i){var r=n(e),o=e.path;return delete r.path,t.Object._fromObject("Text",r,(function(n){n.styles=t.util.stylesFromArray(e.styles,e.text),o?t.Object._fromObject("Path",o,(function(e){n.set("path",e),i(n)}),"path"):i(n)}),"text")},t.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],t.util.createAccessors&&t.util.createAccessors(t.Text)}}(e),w.util.object.extend(w.Text.prototype,{isEmptyStyles:function(e){if(!this.styles)return!0;if(void 0!==e&&!this.styles[e])return!0;var t=void 0===e?this.styles:{line:this.styles[e]};for(var n in t)for(var i in t[n])for(var r in t[n][i])return!1;return!0},styleHas:function(e,t){if(!this.styles||!e||""===e)return!1;if(void 0!==t&&!this.styles[t])return!1;var n=void 0===t?this.styles:{0:this.styles[t]};for(var i in n)for(var r in n[i])if(void 0!==n[i][r][e])return!0;return!1},cleanStyle:function(e){if(!this.styles||!e||""===e)return!1;var t,n,i=this.styles,r=0,o=!0,a=0;for(var s in i){for(var l in t=0,i[s]){var c;r++,(c=i[s][l]).hasOwnProperty(e)?(n?c[e]!==n&&(o=!1):n=c[e],c[e]===this[e]&&delete c[e]):o=!1,0!==Object.keys(c).length?t++:delete i[s][l]}0===t&&delete i[s]}for(var u=0;u<this._textLines.length;u++)a+=this._textLines[u].length;o&&r===a&&(this[e]=n,this.removeStyle(e))},removeStyle:function(e){if(this.styles&&e&&""!==e){var t,n,i,r=this.styles;for(n in r){for(i in t=r[n])delete t[i][e],0===Object.keys(t[i]).length&&delete t[i];0===Object.keys(t).length&&delete r[n]}}},_extendStyles:function(e,t){var n=this.get2DCursorLocation(e);this._getLineStyle(n.lineIndex)||this._setLineStyle(n.lineIndex),this._getStyleDeclaration(n.lineIndex,n.charIndex)||this._setStyleDeclaration(n.lineIndex,n.charIndex,{}),w.util.object.extend(this._getStyleDeclaration(n.lineIndex,n.charIndex),t)},get2DCursorLocation:function(e,t){void 0===e&&(e=this.selectionStart);for(var n=t?this._unwrappedTextLines:this._textLines,i=n.length,r=0;r<i;r++){if(e<=n[r].length)return{lineIndex:r,charIndex:e};e-=n[r].length+this.missingNewlineOffset(r)}return{lineIndex:r-1,charIndex:n[r-1].length<e?n[r-1].length:e}},getSelectionStyles:function(e,t,n){void 0===e&&(e=this.selectionStart||0),void 0===t&&(t=this.selectionEnd||e);for(var i=[],r=e;r<t;r++)i.push(this.getStyleAtPosition(r,n));return i},getStyleAtPosition:function(e,t){var n=this.get2DCursorLocation(e);return(t?this.getCompleteStyleDeclaration(n.lineIndex,n.charIndex):this._getStyleDeclaration(n.lineIndex,n.charIndex))||{}},setSelectionStyles:function(e,t,n){void 0===t&&(t=this.selectionStart||0),void 0===n&&(n=this.selectionEnd||t);for(var i=t;i<n;i++)this._extendStyles(i,e);return this._forceClearCache=!0,this},_getStyleDeclaration:function(e,t){var n=this.styles&&this.styles[e];return n?n[t]:null},getCompleteStyleDeclaration:function(e,t){for(var n,i=this._getStyleDeclaration(e,t)||{},r={},o=0;o<this._styleProperties.length;o++)r[n=this._styleProperties[o]]=void 0===i[n]?this[n]:i[n];return r},_setStyleDeclaration:function(e,t,n){this.styles[e][t]=n},_deleteStyleDeclaration:function(e,t){delete this.styles[e][t]},_getLineStyle:function(e){return!!this.styles[e]},_setLineStyle:function(e){this.styles[e]={}},_deleteLineStyle:function(e){delete this.styles[e]}}),function(){function e(e){e.textDecoration&&(e.textDecoration.indexOf("underline")>-1&&(e.underline=!0),e.textDecoration.indexOf("line-through")>-1&&(e.linethrough=!0),e.textDecoration.indexOf("overline")>-1&&(e.overline=!0),delete e.textDecoration)}w.IText=w.util.createClass(w.Text,w.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(e,t){this.callSuper("initialize",e,t),this.initBehavior()},setSelectionStart:function(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)},setSelectionEnd:function(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)},_updateAndFire:function(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(e){this.clearContextTop(),this.callSuper("render",e),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(e){this.callSuper("_render",e)},clearContextTop:function(e){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var t=this.canvas.contextTop,n=this.canvas.viewportTransform;t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this.transform(t),this._clearTextArea(t),e||t.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var e=this._getCursorBoundaries(),t=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(e,t):this.renderSelection(e,t),t.restore()}},_clearTextArea:function(e){var t=this.width+4,n=this.height+4;e.clearRect(-t/2,-n/2,t,n)},_getCursorBoundaries:function(e){void 0===e&&(e=this.selectionStart);var t=this._getLeftOffset(),n=this._getTopOffset(),i=this._getCursorBoundariesOffsets(e);return{left:t,top:n,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(e){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var t,n,i,r,o=0,a=0,s=this.get2DCursorLocation(e);i=s.charIndex,n=s.lineIndex;for(var l=0;l<n;l++)o+=this.getHeightOfLine(l);t=this._getLineLeftOffset(n);var c=this.__charBounds[n][i];return c&&(a=c.left),0!==this.charSpacing&&i===this._textLines[n].length&&(a-=this._getWidthOfCharSpacing()),r={top:o,left:t+(a>0?a:0)},"rtl"===this.direction&&(r.left*=-1),this.cursorOffsetCache=r,this.cursorOffsetCache},renderCursor:function(e,t){var n=this.get2DCursorLocation(),i=n.lineIndex,r=n.charIndex>0?n.charIndex-1:0,o=this.getValueOfPropertyAt(i,r,"fontSize"),a=this.scaleX*this.canvas.getZoom(),s=this.cursorWidth/a,l=e.topOffset,c=this.getValueOfPropertyAt(i,r,"deltaY");l+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-o*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(e,t),t.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,r,"fill"),t.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,t.fillRect(e.left+e.leftOffset-s/2,l+e.top+c,s,o)},renderSelection:function(e,t){for(var n=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,r=-1!==this.textAlign.indexOf("justify"),o=this.get2DCursorLocation(n),a=this.get2DCursorLocation(i),s=o.lineIndex,l=a.lineIndex,c=o.charIndex<0?0:o.charIndex,u=a.charIndex<0?0:a.charIndex,h=s;h<=l;h++){var d,f=this._getLineLeftOffset(h)||0,p=this.getHeightOfLine(h),g=0,v=0;if(h===s&&(g=this.__charBounds[s][c].left),h>=s&&h<l)v=r&&!this.isEndOfWrapping(h)?this.width:this.getLineWidth(h)||5;else if(h===l)if(0===u)v=this.__charBounds[l][u].left;else{var A=this._getWidthOfCharSpacing();v=this.__charBounds[l][u-1].left+this.__charBounds[l][u-1].width-A}d=p,(this.lineHeight<1||h===l&&this.lineHeight>1)&&(p/=this.lineHeight);var m=e.left+f+g,y=v-g,b=p,C=0;this.inCompositionMode?(t.fillStyle=this.compositionColor||"black",b=1,C=p):t.fillStyle=this.selectionColor,"rtl"===this.direction&&(m=this.width-m-y),t.fillRect(m,e.top+e.topOffset+C,y,b),e.topOffset+=d}},getCurrentCharFontSize:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")},getCurrentCharColor:function(){var e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fill")},_getCurrentCharIndex:function(){var e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}}),w.IText.fromObject=function(t,n){var i=w.util.stylesFromArray(t.styles,t.text),r=Object.assign({},t,{styles:i});if(e(r),r.styles)for(var o in r.styles)for(var a in r.styles[o])e(r.styles[o][a]);w.Object._fromObject("IText",r,n,"text")}}(),C=w.util.object.clone,w.util.object.extend(w.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var e=this;this.on("added",(function(){var t=e.canvas;t&&(t._hasITextHandlers||(t._hasITextHandlers=!0,e._initCanvasHandlers(t)),t._iTextInstances=t._iTextInstances||[],t._iTextInstances.push(e))}))},initRemovedHandler:function(){var e=this;this.on("removed",(function(){var t=e.canvas;t&&(t._iTextInstances=t._iTextInstances||[],w.util.removeFromArray(t._iTextInstances,e),0===t._iTextInstances.length&&(t._hasITextHandlers=!1,e._removeCanvasHandlers(t)))}))},_initCanvasHandlers:function(e){e._mouseUpITextHandler=function(){e._iTextInstances&&e._iTextInstances.forEach((function(e){e.__isMousedown=!1}))},e.on("mouse:up",e._mouseUpITextHandler)},_removeCanvasHandlers:function(e){e.off("mouse:up",e._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(e,t,n,i){var r;return r={isAborted:!1,abort:function(){this.isAborted=!0}},e.animate("_currentCursorOpacity",t,{duration:n,onComplete:function(){r.isAborted||e[i]()},onChange:function(){e.canvas&&e.selectionStart===e.selectionEnd&&e.renderCursorOrSelection()},abort:function(){return r.isAborted}}),r},_onTickComplete:function(){var e=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout((function(){e._currentTickCompleteState=e._animateCursor(e,0,this.cursorDuration/2,"_tick")}),100)},initDelayedCursor:function(e){var t=this,n=e?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout((function(){t._tick()}),n)},abortCursorAnimation:function(){var e=this._currentTickState||this._currentTickCompleteState,t=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,e&&t&&t.clearContext(t.contextTop||t.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(e){var t=0,n=e-1;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n--;for(;/\S/.test(this._text[n])&&n>-1;)t++,n--;return e-t},findWordBoundaryRight:function(e){var t=0,n=e;if(this._reSpace.test(this._text[n]))for(;this._reSpace.test(this._text[n]);)t++,n++;for(;/\S/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t},findLineBoundaryLeft:function(e){for(var t=0,n=e-1;!/\n/.test(this._text[n])&&n>-1;)t++,n--;return e-t},findLineBoundaryRight:function(e){for(var t=0,n=e;!/\n/.test(this._text[n])&&n<this._text.length;)t++,n++;return e+t},searchWordBoundary:function(e,t){for(var n=this._text,i=this._reSpace.test(n[e])?e-1:e,r=n[i],o=w.reNonWord;!o.test(r)&&i>0&&i<n.length;)r=n[i+=t];return o.test(r)&&(i+=1===t?0:1),i},selectWord:function(e){e=e||this.selectionStart;var t=this.searchWordBoundary(e,-1),n=this.searchWordBoundary(e,1);this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(e){e=e||this.selectionStart;var t=this.findLineBoundaryLeft(e),n=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=n,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(e){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(e),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(e){e._iTextInstances&&e._iTextInstances.forEach((function(e){e.selected=!1,e.isEditing&&e.exitEditing()}))},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(e){if(this.__isMousedown&&this.isEditing){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var t=this.getSelectionStartFromPointer(e.e),n=this.selectionStart,i=this.selectionEnd;(t===this.__selectionStartOnMouseDown&&n!==i||n!==t&&i!==t)&&(t>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=t):(this.selectionStart=t,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===n&&this.selectionEnd===i||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(e,t,n){var i=n.slice(0,e),r=w.util.string.graphemeSplit(i).length;if(e===t)return{selectionStart:r,selectionEnd:r};var o=n.slice(e,t);return{selectionStart:r,selectionEnd:r+w.util.string.graphemeSplit(o).length}},fromGraphemeToStringSelection:function(e,t,n){var i=n.slice(0,e).join("").length;return e===t?{selectionStart:i,selectionEnd:i}:{selectionStart:i,selectionEnd:i+n.slice(e,t).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var e=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=e.selectionEnd,this.inCompositionMode||(this.selectionStart=e.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),n=this.get2DCursorLocation(e),i=n.lineIndex,r=n.charIndex,o=this.getValueOfPropertyAt(i,r,"fontSize")*this.lineHeight,a=t.leftOffset,s=this.calcTransformMatrix(),l={x:t.left+a,y:t.top+t.topOffset+o},c=this.canvas.getRetinaScaling(),u=this.canvas.upperCanvasEl,h=u.width/c,d=u.height/c,f=h-o,p=d-o,g=u.clientWidth/h,v=u.clientHeight/d;return l=w.util.transformPoint(l,s),(l=w.util.transformPoint(l,this.canvas.viewportTransform)).x*=g,l.y*=v,l.x<0&&(l.x=0),l.x>f&&(l.x=f),l.y<0&&(l.y=0),l.y>p&&(l.y=p),l.x+=this.canvas._offset.left,l.y+=this.canvas._offset.top,{left:l.x+"px",top:l.y+"px",fontSize:o+"px",charHeight:o}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var e=this._textBeforeEdit!==this.text,t=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,t&&(t.blur&&t.blur(),t.parentNode&&t.parentNode.removeChild(t)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),e&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var e in this.styles)this._textLines[e]||delete this.styles[e]},removeStyleFromTo:function(e,t){var n,i,r=this.get2DCursorLocation(e,!0),o=this.get2DCursorLocation(t,!0),a=r.lineIndex,s=r.charIndex,l=o.lineIndex,c=o.charIndex;if(a!==l){if(this.styles[a])for(n=s;n<this._unwrappedTextLines[a].length;n++)delete this.styles[a][n];if(this.styles[l])for(n=c;n<this._unwrappedTextLines[l].length;n++)(i=this.styles[l][n])&&(this.styles[a]||(this.styles[a]={}),this.styles[a][s+n-c]=i);for(n=a+1;n<=l;n++)delete this.styles[n];this.shiftLineStyles(l,a-l)}else if(this.styles[a]){i=this.styles[a];var u,h,d=c-s;for(n=s;n<c;n++)delete i[n];for(h in this.styles[a])(u=parseInt(h,10))>=c&&(i[u-d]=i[h],delete i[h])}},shiftLineStyles:function(e,t){var n=C(this.styles);for(var i in this.styles){var r=parseInt(i,10);r>e&&(this.styles[r+t]=n[r],n[r-t]||delete this.styles[r])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(e,t,n,i){var r,o={},a=!1,s=this._unwrappedTextLines[e].length===t;for(var l in n||(n=1),this.shiftLineStyles(e,n),this.styles[e]&&(r=this.styles[e][0===t?t:t-1]),this.styles[e]){var c=parseInt(l,10);c>=t&&(a=!0,o[c-t]=this.styles[e][l],s&&0===t||delete this.styles[e][l])}var u=!1;for(a&&!s&&(this.styles[e+n]=o,u=!0),u&&n--;n>0;)i&&i[n-1]?this.styles[e+n]={0:C(i[n-1])}:r?this.styles[e+n]={0:C(r)}:delete this.styles[e+n],n--;this._forceClearCache=!0},insertCharStyleObject:function(e,t,n,i){this.styles||(this.styles={});var r=this.styles[e],o=r?C(r):{};for(var a in n||(n=1),o){var s=parseInt(a,10);s>=t&&(r[s+n]=o[s],o[s-n]||delete r[s])}if(this._forceClearCache=!0,i)for(;n--;)Object.keys(i[n]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+n]=C(i[n]));else if(r)for(var l=r[t?t-1:1];l&&n--;)this.styles[e][t+n]=C(l)},insertNewStyleBlock:function(e,t,n){for(var i=this.get2DCursorLocation(t,!0),r=[0],o=0,a=0;a<e.length;a++)"\n"===e[a]?r[++o]=0:r[o]++;for(r[0]>0&&(this.insertCharStyleObject(i.lineIndex,i.charIndex,r[0],n),n=n&&n.slice(r[0]+1)),o&&this.insertNewlineStyleObject(i.lineIndex,i.charIndex+r[0],o),a=1;a<o;a++)r[a]>0?this.insertCharStyleObject(i.lineIndex+a,0,r[a],n):n&&this.styles[i.lineIndex+a]&&n[0]&&(this.styles[i.lineIndex+a][0]=n[0]),n=n&&n.slice(r[a]+1);r[a]>0&&this.insertCharStyleObject(i.lineIndex+a,0,r[a],n)},setSelectionStartEndWithShift:function(e,t,n){n<=e?(t===e?this._selectionDirection="left":"right"===this._selectionDirection&&(this._selectionDirection="left",this.selectionEnd=e),this.selectionStart=n):n>e&&n<t?"right"===this._selectionDirection?this.selectionEnd=n:this.selectionStart=n:(t===e?this._selectionDirection="right":"left"===this._selectionDirection&&(this._selectionDirection="right",this.selectionStart=t),this.selectionEnd=n)},setSelectionInBoundaries:function(){var e=this.text.length;this.selectionStart>e?this.selectionStart=e:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>e?this.selectionEnd=e:this.selectionEnd<0&&(this.selectionEnd=0)}}),w.util.object.extend(w.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(e){if(this.canvas){this.__newClickTime=+new Date;var t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),this._stopEvent(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y},_stopEvent:function(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))},tripleClickHandler:function(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(e){!this.canvas||!this.editable||e.e.button&&1!==e.e.button||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(e.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(e){!this.canvas||!this.editable||e.e.button&&1!==e.e.button||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(e){if(this.__isMousedown=!1,!(!this.editable||this.group||e.transform&&e.transform.actionPerformed||e.e.button&&1!==e.e.button)){if(this.canvas){var t=this.canvas._activeObject;if(t&&t!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(e.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(e){var t=this.getSelectionStartFromPointer(e),n=this.selectionStart,i=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(n,i,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(e){for(var t,n=this.getLocalPointer(e),i=0,r=0,o=0,a=0,s=0,l=0,c=this._textLines.length;l<c&&o<=n.y;l++)o+=this.getHeightOfLine(l)*this.scaleY,s=l,l>0&&(a+=this._textLines[l-1].length+this.missingNewlineOffset(l-1));r=this._getLineLeftOffset(s)*this.scaleX,t=this._textLines[s],"rtl"===this.direction&&(n.x=this.width*this.scaleX-n.x+r);for(var u=0,h=t.length;u<h&&(i=r,(r+=this.__charBounds[s][u].kernedWidth*this.scaleX)<=n.x);u++)a++;return this._getNewSelectionStartFromOffset(n,i,r,a,h)},_getNewSelectionStartFromOffset:function(e,t,n,i,r){var o=e.x-t,a=n-e.x,s=i+(a>o||a<0?0:1);return this.flipX&&(s=r-s),s>this._text.length&&(s=this._text.length),s}}),w.util.object.extend(w.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=w.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var e=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+e.top+"; left: "+e.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+e.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):w.document.body.appendChild(this.hiddenTextarea),w.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),w.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),w.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),w.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),w.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),w.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),w.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),w.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),w.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(w.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(e){if(this.isEditing){var t="rtl"===this.direction?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(e){var t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),this.isEditing){var n,i,r,o,a,s=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,l=this._text.length,c=s.length,u=c-l,h=this.selectionStart,d=this.selectionEnd,f=h!==d;if(""===this.hiddenTextarea.value)return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var p=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),g=h>p.selectionStart;f?(n=this._text.slice(h,d),u+=d-h):c<l&&(n=g?this._text.slice(d+u,d):this._text.slice(h,h-u)),i=s.slice(p.selectionEnd-u,p.selectionEnd),n&&n.length&&(i.length&&(r=this.getSelectionStyles(h,h+1,!1),r=i.map((function(){return r[0]}))),f?(o=h,a=d):g?(o=d-n.length,a=d):(o=d,a=d+n.length),this.removeStyleFromTo(o,a)),i.length&&(t&&i.join("")===w.copiedText&&!w.disableStyleCopyPaste&&(r=w.copiedTextStyle),this.insertNewStyleBlock(i,h,r)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(e){this.compositionStart=e.target.selectionStart,this.compositionEnd=e.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(w.copiedText=this.getSelectedText(),w.disableStyleCopyPaste?w.copiedTextStyle=null:w.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(e){return e&&e.clipboardData||w.window.clipboardData},_getWidthBeforeCursor:function(e,t){var n,i=this._getLineLeftOffset(e);return t>0&&(i+=(n=this.__charBounds[e][t-1]).left+n.width),i},getDownCursorOffset:function(e,t){var n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),r=i.lineIndex;if(r===this._textLines.length-1||e.metaKey||34===e.keyCode)return this._text.length-n;var o=i.charIndex,a=this._getWidthBeforeCursor(r,o),s=this._getIndexOnLine(r+1,a);return this._textLines[r].slice(o).length+s+1+this.missingNewlineOffset(r)},_getSelectionForOffset:function(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(e,t){var n=this._getSelectionForOffset(e,t),i=this.get2DCursorLocation(n),r=i.lineIndex;if(0===r||e.metaKey||33===e.keyCode)return-n;var o=i.charIndex,a=this._getWidthBeforeCursor(r,o),s=this._getIndexOnLine(r-1,a),l=this._textLines[r].slice(0,o),c=this.missingNewlineOffset(r-1);return-this._textLines[r-1].length+s-l.length+(1-c)},_getIndexOnLine:function(e,t){for(var n,i,r=this._textLines[e],o=this._getLineLeftOffset(e),a=0,s=0,l=r.length;s<l;s++)if((o+=n=this.__charBounds[e][s].width)>t){i=!0;var c=o-n,u=o,h=Math.abs(c-t);a=Math.abs(u-t)<h?s:s-1;break}return i||(a=r.length-1),a},moveCursorDown:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)},moveCursorUp:function(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorUpOrDown("Up",e)},_moveCursorUpOrDown:function(e,t){var n=this["get"+e+"CursorOffset"](t,"right"===this._selectionDirection);t.shiftKey?this.moveCursorWithShift(n):this.moveCursorWithoutShift(n),0!==n&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(e){var t="left"===this._selectionDirection?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),0!==e},moveCursorWithoutShift:function(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),0!==e},moveCursorLeft:function(e){0===this.selectionStart&&0===this.selectionEnd||this._moveCursorLeftOrRight("Left",e)},_move:function(e,t,n){var i;if(e.altKey)i=this["findWordBoundary"+n](this[t]);else{if(!e.metaKey&&35!==e.keyCode&&36!==e.keyCode)return this[t]+="Left"===n?-1:1,!0;i=this["findLineBoundary"+n](this[t])}if(void 0!==i&&this[t]!==i)return this[t]=i,!0},_moveLeft:function(e,t){return this._move(e,t,"Left")},_moveRight:function(e,t){return this._move(e,t,"Right")},moveCursorLeftWithoutShift:function(e){var t=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&0!==this.selectionStart&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t},moveCursorLeftWithShift:function(e){return"right"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):0!==this.selectionStart?(this._selectionDirection="left",this._moveLeft(e,"selectionStart")):void 0},moveCursorRight:function(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)},_moveCursorLeftOrRight:function(e,t){var n="moveCursor"+e+"With";this._currentCursorOpacity=1,t.shiftKey?n+="Shift":n+="outShift",this[n](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(e){return"left"===this._selectionDirection&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(e,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(e){var t=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t},removeChars:function(e,t){void 0===t&&(t=e+1),this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(e,t,n,i){void 0===i&&(i=n),i>n&&this.removeStyleFromTo(n,i);var r=w.util.string.graphemeSplit(e);this.insertNewStyleBlock(r,n,t),this._text=[].concat(this._text.slice(0,n),r,this._text.slice(i)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var e=w.util.toFixed,t=/  +/g;w.util.object.extend(w.Text.prototype,{_toSVG:function(){var e=this._getSVGLeftTopOffsets(),t=this._getSVGTextAndBg(e.textTop,e.textLeft);return this._wrapSVGTextAndBg(t)},toSVG:function(e){return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(e){var t=this.getSvgTextDecoration(this);return[e.textBgRects.join(""),'\t\t<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",t?'text-decoration="'+t+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",e.textSpans.join(""),"</text>\n"]},_getSVGTextAndBg:function(e,t){var n,i=[],r=[],o=e;this._setSVGBg(r);for(var a=0,s=this._textLines.length;a<s;a++)n=this._getLineLeftOffset(a),(this.textBackgroundColor||this.styleHas("textBackgroundColor",a))&&this._setSVGTextLineBg(r,a,t+n,o),this._setSVGTextLineText(i,a,t+n,o),o+=this.getHeightOfLine(a);return{textSpans:i,textBgRects:r}},_createTextCharSpan:function(n,i,r,o){var a=n!==n.trim()||n.match(t),s=this.getSvgSpanStyles(i,a),l=s?'style="'+s+'"':"",c=i.deltaY,u="",h=w.Object.NUM_FRACTION_DIGITS;return c&&(u=' dy="'+e(c,h)+'" '),['<tspan x="',e(r,h),'" y="',e(o,h),'" ',u,l,">",w.util.string.escapeXml(n),"</tspan>"].join("")},_setSVGTextLineText:function(e,t,n,i){var r,o,a,s,l,c=this.getHeightOfLine(t),u=-1!==this.textAlign.indexOf("justify"),h="",d=0,f=this._textLines[t];i+=c*(1-this._fontSizeFraction)/this.lineHeight;for(var p=0,g=f.length-1;p<=g;p++)l=p===g||this.charSpacing,h+=f[p],a=this.__charBounds[t][p],0===d?(n+=a.kernedWidth-a.width,d+=a.width):d+=a.kernedWidth,u&&!l&&this._reSpaceAndTab.test(f[p])&&(l=!0),l||(r=r||this.getCompleteStyleDeclaration(t,p),o=this.getCompleteStyleDeclaration(t,p+1),l=w.util.hasStyleChanged(r,o,!0)),l&&(s=this._getStyleDeclaration(t,p)||{},e.push(this._createTextCharSpan(h,s,n,i)),h="",r=o,n+=d,d=0)},_pushTextBgRect:function(t,n,i,r,o,a){var s=w.Object.NUM_FRACTION_DIGITS;t.push("\t\t<rect ",this._getFillAttributes(n),' x="',e(i,s),'" y="',e(r,s),'" width="',e(o,s),'" height="',e(a,s),'"></rect>\n')},_setSVGTextLineBg:function(e,t,n,i){for(var r,o,a=this._textLines[t],s=this.getHeightOfLine(t)/this.lineHeight,l=0,c=0,u=this.getValueOfPropertyAt(t,0,"textBackgroundColor"),h=0,d=a.length;h<d;h++)r=this.__charBounds[t][h],(o=this.getValueOfPropertyAt(t,h,"textBackgroundColor"))!==u?(u&&this._pushTextBgRect(e,u,n+c,i,l,s),c=r.left,l=r.width,u=o):l+=r.kernedWidth;o&&this._pushTextBgRect(e,o,n+c,i,l,s)},_getFillAttributes:function(e){var t=e&&"string"==typeof e?new w.Color(e):"";return t&&t.getSource()&&1!==t.getAlpha()?'opacity="'+t.getAlpha()+'" fill="'+t.setAlpha(1).toRgb()+'"':'fill="'+e+'"'},_getSVGLineTopOffset:function(e){for(var t,n=0,i=0;i<e;i++)n+=this.getHeightOfLine(i);return t=this.getHeightOfLine(i),{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*t/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(e){return w.Object.prototype.getSvgStyles.call(this,e)+" white-space: pre;"}})}(),function(e){var t=e.fabric||(e.fabric={});t.Textbox=t.util.createClass(t.IText,t.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:t.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),-1!==this.textAlign.indexOf("justify")&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(e){for(var t=0,n=0,i=0,r={},o=0;o<e.graphemeLines.length;o++)"\n"===e.graphemeText[i]&&o>0?(n=0,i++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[i])&&o>0&&(n++,i++),r[o]={line:t,offset:n},i+=e.graphemeLines[o].length,n+=e.graphemeLines[o].length;return r},styleHas:function(e,n){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[n];i&&(n=i.line)}return t.Text.prototype.styleHas.call(this,e,n)},isEmptyStyles:function(e){if(!this.styles)return!0;var t,n,i=0,r=!1,o=this._styleMap[e],a=this._styleMap[e+1];for(var s in o&&(e=o.line,i=o.offset),a&&(r=a.line===e,t=a.offset),n=void 0===e?this.styles:{line:this.styles[e]})for(var l in n[s])if(l>=i&&(!r||l<t))for(var c in n[s][l])return!1;return!0},_getStyleDeclaration:function(e,t){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[e];if(!n)return null;e=n.line,t=n.offset+t}return this.callSuper("_getStyleDeclaration",e,t)},_setStyleDeclaration:function(e,t,n){var i=this._styleMap[e];e=i.line,t=i.offset+t,this.styles[e][t]=n},_deleteStyleDeclaration:function(e,t){var n=this._styleMap[e];e=n.line,t=n.offset+t,delete this.styles[e][t]},_getLineStyle:function(e){var t=this._styleMap[e];return!!this.styles[t.line]},_setLineStyle:function(e){var t=this._styleMap[e];this.styles[t.line]={}},_wrapText:function(e,t){var n,i=[];for(this.isWrapping=!0,n=0;n<e.length;n++)i=i.concat(this._wrapLine(e[n],n,t));return this.isWrapping=!1,i},_measureWord:function(e,t,n){var i,r=0;n=n||0;for(var o=0,a=e.length;o<a;o++){r+=this._getGraphemeBox(e[o],t,o+n,i,true).kernedWidth,i=e[o]}return r},_wrapLine:function(e,n,i,r){var o=0,a=this.splitByGrapheme,s=[],l=[],c=a?t.util.string.graphemeSplit(e):e.split(this._wordJoiners),u="",h=0,d=a?"":" ",f=0,p=0,g=0,v=!0,A=this._getWidthOfCharSpacing();r=r||0;0===c.length&&c.push([]),i-=r;for(var m=0;m<c.length;m++)u=a?c[m]:t.util.string.graphemeSplit(c[m]),f=this._measureWord(u,n,h),h+=u.length,(o+=p+f-A)>i&&!v?(s.push(l),l=[],o=f,v=!0):o+=A,v||a||l.push(d),l=l.concat(u),p=a?0:this._measureWord([d],n,h),h++,v=!1,f>g&&(g=f);return m&&s.push(l),g+r>this.dynamicMinWidth&&(this.dynamicMinWidth=g-A+r),s},isEndOfWrapping:function(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line},missingNewlineOffset:function(e){return this.splitByGrapheme?this.isEndOfWrapping(e)?1:0:1},_splitTextIntoLines:function(e){for(var n=t.Text.prototype._splitTextIntoLines.call(this,e),i=this._wrapText(n.lines,this.width),r=new Array(i.length),o=0;o<i.length;o++)r[o]=i[o].join("");return n.lines=r,n.graphemeLines=i,n},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var e={};for(var t in this._styleMap)this._textLines[t]&&(e[this._styleMap[t].line]=1);for(var t in this.styles)e[t]||delete this.styles[t]},toObject:function(e){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(e))}}),t.Textbox.fromObject=function(e,n){var i=t.util.stylesFromArray(e.styles,e.text),r=Object.assign({},e,{styles:i});return t.Object._fromObject("Textbox",r,n,"text")}}(e),function(){var e=w.controlsUtils,t=e.scaleSkewCursorStyleHandler,n=e.scaleCursorStyleHandler,i=e.scalingEqually,r=e.scalingYOrSkewingX,o=e.scalingXOrSkewingY,a=e.scaleOrSkewActionName,s=w.Object.prototype.controls;if(s.ml=new w.Control({x:-.5,y:0,cursorStyleHandler:t,actionHandler:o,getActionName:a}),s.mr=new w.Control({x:.5,y:0,cursorStyleHandler:t,actionHandler:o,getActionName:a}),s.mb=new w.Control({x:0,y:.5,cursorStyleHandler:t,actionHandler:r,getActionName:a}),s.mt=new w.Control({x:0,y:-.5,cursorStyleHandler:t,actionHandler:r,getActionName:a}),s.tl=new w.Control({x:-.5,y:-.5,cursorStyleHandler:n,actionHandler:i}),s.tr=new w.Control({x:.5,y:-.5,cursorStyleHandler:n,actionHandler:i}),s.bl=new w.Control({x:-.5,y:.5,cursorStyleHandler:n,actionHandler:i}),s.br=new w.Control({x:.5,y:.5,cursorStyleHandler:n,actionHandler:i}),s.mtr=new w.Control({x:0,y:-.5,actionHandler:e.rotationWithSnapping,cursorStyleHandler:e.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),w.Textbox){var l=w.Textbox.prototype.controls={};l.mtr=s.mtr,l.tr=s.tr,l.br=s.br,l.tl=s.tl,l.bl=s.bl,l.mt=s.mt,l.mb=s.mb,l.mr=new w.Control({x:.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"}),l.ml=new w.Control({x:-.5,y:0,actionHandler:e.changeWidth,cursorStyleHandler:t,actionName:"resizing"})}}()}(vA);var AA,mA={exports:{}},yA="object"==typeof Reflect?Reflect:null,bA=yA&&"function"==typeof yA.apply?yA.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};AA=yA&&"function"==typeof yA.ownKeys?yA.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var CA=Number.isNaN||function(e){return e!=e};function wA(){wA.init.call(this)}mA.exports=wA,mA.exports.once=function(e,t){return new Promise((function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}DA(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&DA(e,"error",t,n)}(e,r,{once:!0})}))},wA.EventEmitter=wA,wA.prototype._events=void 0,wA.prototype._eventsCount=0,wA.prototype._maxListeners=void 0;var xA=10;function _A(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function EA(e){return void 0===e._maxListeners?wA.defaultMaxListeners:e._maxListeners}function SA(e,t,n,i){var r,o,a;if(_A(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),(r=EA(e))>0&&a.length>r&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=a.length,console&&console.warn}return e}function IA(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function kA(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=IA.bind(i);return r.listener=n,i.wrapFn=r,r}function BA(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):TA(r,r.length)}function OA(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function TA(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function DA(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function r(o){i.once&&e.removeEventListener(t,r),n(o)}))}}Object.defineProperty(wA,"defaultMaxListeners",{enumerable:!0,get:function(){return xA},set:function(e){if("number"!=typeof e||e<0||CA(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");xA=e}}),wA.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},wA.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||CA(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},wA.prototype.getMaxListeners=function(){return EA(this)},wA.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var s=r[e];if(void 0===s)return!1;if("function"==typeof s)bA(s,this,t);else{var l=s.length,c=TA(s,l);for(n=0;n<l;++n)bA(c[n],this,t)}return!0},wA.prototype.addListener=function(e,t){return SA(this,e,t,!1)},wA.prototype.on=wA.prototype.addListener,wA.prototype.prependListener=function(e,t){return SA(this,e,t,!0)},wA.prototype.once=function(e,t){return _A(t),this.on(e,kA(this,e,t)),this},wA.prototype.prependOnceListener=function(e,t){return _A(t),this.prependListener(e,kA(this,e,t)),this},wA.prototype.removeListener=function(e,t){var n,i,r,o,a;if(_A(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,a||t)}return this},wA.prototype.off=wA.prototype.removeListener,wA.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},wA.prototype.listeners=function(e){return BA(this,e,!0)},wA.prototype.rawListeners=function(e){return BA(this,e,!1)},wA.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):OA.call(e,t)},wA.prototype.listenerCount=OA,wA.prototype.eventNames=function(){return this._eventsCount>0?AA(this._events):[]};const MA=xi(mA.exports),QA="undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().indexOf("firefox")>0;function LA(e,t,n,i){e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on".concat(t),n)}function PA(e,t,n,i){e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on".concat(t),n)}function jA(e,t){const n=t.slice(0,t.length-1);for(let i=0;i<n.length;i++)n[i]=e[n[i].toLowerCase()];return n}function RA(e){"string"!=typeof e&&(e="");const t=(e=e.replace(/\s/g,"")).split(",");let n=t.lastIndexOf("");for(;n>=0;)t[n-1]+=",",t.splice(n,1),n=t.lastIndexOf("");return t}const FA={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":QA?173:189,"=":QA?61:187,";":QA?59:186,"'":222,"[":219,"]":221,"\\":220},NA={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},VA={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},UA={16:!1,18:!1,17:!1,91:!1},zA={};for(let uj=1;uj<20;uj++)FA["f".concat(uj)]=111+uj;let HA=[],YA=null,GA="all";const WA=new Map,XA=e=>FA[e.toLowerCase()]||NA[e.toLowerCase()]||e.toUpperCase().charCodeAt(0);function $A(e){GA=e||"all"}function qA(){return GA||"all"}function KA(e){if(void 0===e)Object.keys(zA).forEach((e=>{Array.isArray(zA[e])&&zA[e].forEach((e=>JA(e))),delete zA[e]})),nm(null);else if(Array.isArray(e))e.forEach((e=>{e.key&&JA(e)}));else if("object"==typeof e)e.key&&JA(e);else if("string"==typeof e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];let[r,o]=n;"function"==typeof r&&(o=r,r=""),JA({key:e,scope:r,method:o,splitKey:"+"})}}const JA=e=>{let{key:t,scope:n,method:i,splitKey:r="+"}=e;RA(t).forEach((e=>{const t=e.split(r),o=t.length,a=t[o-1],s="*"===a?"*":XA(a);if(!zA[s])return;n||(n=qA());const l=o>1?jA(NA,t):[],c=[];zA[s]=zA[s].filter((e=>{const t=(!i||e.method===i)&&e.scope===n&&function(e,t){const n=e.length>=t.length?e:t,i=e.length>=t.length?t:e;let r=!0;for(let o=0;o<n.length;o++)-1===i.indexOf(n[o])&&(r=!1);return r}(e.mods,l);return t&&c.push(e.element),!t})),c.forEach((e=>nm(e)))}))};function ZA(e,t,n,i){if(t.element!==i)return;let r;if(t.scope===n||"all"===t.scope){r=t.mods.length>0;for(const e in UA)Object.prototype.hasOwnProperty.call(UA,e)&&(!UA[e]&&t.mods.indexOf(+e)>-1||UA[e]&&-1===t.mods.indexOf(+e))&&(r=!1);(0!==t.mods.length||UA[16]||UA[18]||UA[17]||UA[91])&&!r&&"*"!==t.shortcut||(t.keys=[],t.keys=t.keys.concat(HA),!1===t.method(e,t)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0)))}}function em(e,t){const n=zA["*"];let i=e.keyCode||e.which||e.charCode;if(!tm.filter.call(this,e))return;if(93!==i&&224!==i||(i=91),-1===HA.indexOf(i)&&229!==i&&HA.push(i),["ctrlKey","altKey","shiftKey","metaKey"].forEach((t=>{const n=VA[t];e[t]&&-1===HA.indexOf(n)?HA.push(n):!e[t]&&HA.indexOf(n)>-1?HA.splice(HA.indexOf(n),1):"metaKey"===t&&e[t]&&3===HA.length&&(e.ctrlKey||e.shiftKey||e.altKey||(HA=HA.slice(HA.indexOf(n))))})),i in UA){UA[i]=!0;for(const e in NA)NA[e]===i&&(tm[e]=!0);if(!n)return}for(const s in UA)Object.prototype.hasOwnProperty.call(UA,s)&&(UA[s]=e[VA[s]]);e.getModifierState&&(!e.altKey||e.ctrlKey)&&e.getModifierState("AltGraph")&&(-1===HA.indexOf(17)&&HA.push(17),-1===HA.indexOf(18)&&HA.push(18),UA[17]=!0,UA[18]=!0);const r=qA();if(n)for(let s=0;s<n.length;s++)n[s].scope===r&&("keydown"===e.type&&n[s].keydown||"keyup"===e.type&&n[s].keyup)&&ZA(e,n[s],r,t);if(!(i in zA))return;const o=zA[i],a=o.length;for(let s=0;s<a;s++)if(("keydown"===e.type&&o[s].keydown||"keyup"===e.type&&o[s].keyup)&&o[s].key){const n=o[s],{splitKey:i}=n,a=n.key.split(i),l=[];for(let e=0;e<a.length;e++)l.push(XA(a[e]));l.sort().join("")===HA.sort().join("")&&ZA(e,n,r,t)}}function tm(e,t,n){HA=[];const i=RA(e);let r=[],o="all",a=document,s=0,l=!1,c=!0,u="+",h=!1,d=!1;for(void 0===n&&"function"==typeof t&&(n=t),"[object Object]"===Object.prototype.toString.call(t)&&(t.scope&&(o=t.scope),t.element&&(a=t.element),t.keyup&&(l=t.keyup),void 0!==t.keydown&&(c=t.keydown),void 0!==t.capture&&(h=t.capture),"string"==typeof t.splitKey&&(u=t.splitKey),!0===t.single&&(d=!0)),"string"==typeof t&&(o=t),d&&KA(e,o);s<i.length;s++)r=[],(e=i[s].split(u)).length>1&&(r=jA(NA,e)),(e="*"===(e=e[e.length-1])?"*":XA(e))in zA||(zA[e]=[]),zA[e].push({keyup:l,keydown:c,scope:o,mods:r,shortcut:i[s],method:n,key:i[s],splitKey:u,element:a});if(void 0!==a&&window){if(!WA.has(a)){const e=function(){return em(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event,a)},t=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.event;em(e,a),function(e){let t=e.keyCode||e.which||e.charCode;const n=HA.indexOf(t);if(n>=0&&HA.splice(n,1),e.key&&"meta"===e.key.toLowerCase()&&HA.splice(0,HA.length),93!==t&&224!==t||(t=91),t in UA){UA[t]=!1;for(const e in NA)NA[e]===t&&(tm[e]=!1)}}(e)};WA.set(a,{keydownListener:e,keyupListenr:t,capture:h}),LA(a,"keydown",e,h),LA(a,"keyup",t,h)}if(!YA){const e=()=>{HA=[]};YA={listener:e,capture:h},LA(window,"focus",e,h)}}}function nm(e){const t=Object.values(zA).flat();if(t.findIndex((t=>{let{element:n}=t;return n===e}))<0){const{keydownListener:t,keyupListenr:n,capture:i}=WA.get(e)||{};t&&n&&(PA(e,"keyup",n,i),PA(e,"keydown",t,i),WA.delete(e))}if(t.length<=0||WA.size<=0){if(Object.keys(WA).forEach((e=>{const{keydownListener:t,keyupListenr:n,capture:i}=WA.get(e)||{};t&&n&&(PA(e,"keyup",n,i),PA(e,"keydown",t,i),WA.delete(e))})),WA.clear(),Object.keys(zA).forEach((e=>delete zA[e])),YA){const{listener:e,capture:t}=YA;PA(window,"focus",e,t),YA=null}}}const im={getPressedKeyString:function(){return HA.map((e=>{return t=e,Object.keys(FA).find((e=>FA[e]===t))||(e=>Object.keys(NA).find((t=>NA[t]===e)))(e)||String.fromCharCode(e);var t}))},setScope:$A,getScope:qA,deleteScope:function(e,t){let n,i;e||(e=qA());for(const r in zA)if(Object.prototype.hasOwnProperty.call(zA,r))for(n=zA[r],i=0;i<n.length;)if(n[i].scope===e){n.splice(i,1).forEach((e=>{let{element:t}=e;return nm(t)}))}else i++;qA()===e&&$A(t||"all")},getPressedKeyCodes:function(){return HA.slice(0)},getAllKeyCodes:function(){const e=[];return Object.keys(zA).forEach((t=>{zA[t].forEach((t=>{let{key:n,scope:i,mods:r,shortcut:o}=t;e.push({scope:i,shortcut:o,mods:r,keys:n.split("+").map((e=>XA(e)))})}))})),e},isPressed:function(e){return"string"==typeof e&&(e=XA(e)),-1!==HA.indexOf(e)},filter:function(e){const t=e.target||e.srcElement,{tagName:n}=t;let i=!0;const r="INPUT"===n&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(t.type);return(t.isContentEditable||(r||"TEXTAREA"===n||"SELECT"===n)&&!t.readOnly)&&(i=!1),i},trigger:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all";Object.keys(zA).forEach((n=>{zA[n].filter((n=>n.scope===t&&n.shortcut===e)).forEach((e=>{e&&e.method&&e.method()}))}))},unbind:KA,keyMap:FA,modifier:NA,modifierMap:VA};for(const uj in im)Object.prototype.hasOwnProperty.call(im,uj)&&(tm[uj]=im[uj]);if("undefined"!=typeof window){const e=window.hotkeys;tm.noConflict=t=>(t&&window.hotkeys===tm&&(window.hotkeys=e),tm),window.hotkeys=tm}class rm{constructor(e,t){this.container=e,this.dom=null,this.shown=!1,this.root=!0,this.parent=null,this.submenus=[],this.items=t,this._onclick=e=>{!this.dom||e.target==this.dom||e.target.parentElement==this.dom||e.target.classList.contains("item")||e.target.parentElement.classList.contains("item")||this.hideAll()},this._oncontextmenu=e=>{e.preventDefault(),e.target==this.dom||e.target.parentElement==this.dom||e.target.classList.contains("item")||e.target.parentElement.classList.contains("item")||(this.hideAll(),this.show(e.clientX,e.clientY))},this._oncontextmenu_keydown=e=>{93==e.keyCode&&(e.preventDefault(),this.hideAll(),this.show(e.clientX,e.clientY))},this._onblur=()=>{this.hideAll()}}getMenuDom(){const e=document.createElement("div");e.classList.add("context");for(const t of this.items)e.appendChild(this.itemToDomEl(t));return e}itemToDomEl(e){const t=document.createElement("div");if(null===e)return t.classList="separator",t;e.hasOwnProperty("color")&&/^#([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e.color.toString())&&(t.style.cssText=`color: ${e.color}`),t.classList.add("item");const n=document.createElement("span");n.classList="label",n.innerText=e.hasOwnProperty("text")?e.text.toString():"",t.appendChild(n),e.hasOwnProperty("disabled")&&e.disabled?t.classList.add("disabled"):t.classList.add("enabled");const i=document.createElement("span");if(i.classList="hotkey",i.innerText=e.hasOwnProperty("hotkey")?e.hotkey.toString():"",t.appendChild(i),e.hasOwnProperty("subitems")&&Array.isArray(e.subitems)&&e.subitems.length>0){const n=new rm(this.container,e.subitems);n.root=!1,n.parent=this;const i=()=>{if(e.hasOwnProperty("disabled")&&1==e.disabled)return;this.hideSubMenus();const i=this.dom.offsetLeft+this.dom.clientWidth+t.offsetLeft,r=this.dom.offsetTop+t.offsetTop;n.shown?n.hide():n.show(i,r)};this.submenus.push(n),t.classList.add("has-subitems"),t.addEventListener("click",i),t.addEventListener("mousemove",i)}else if(e.hasOwnProperty("submenu")&&e.submenu instanceof rm){const n=e.submenu;n.root=!1,n.parent=this;const i=()=>{if(e.hasOwnProperty("disabled")&&1==e.disabled)return;this.hideSubMenus();const i=this.dom.offsetLeft+this.dom.clientWidth+t.offsetLeft,r=this.dom.offsetTop+t.offsetTop;n.shown?n.hide():n.show(i,r)};this.submenus.push(n),t.classList.add("has-subitems"),t.addEventListener("click",i),t.addEventListener("mousemove",i)}else t.addEventListener("click",(()=>{if(this.hideSubMenus(),!t.classList.contains("disabled"))if(e.hasOwnProperty("onclick")&&"function"==typeof e.onclick){const r={handled:!1,item:t,label:n,hotkey:i,items:this.items,data:e};e.onclick(r),r.handled||this.hide()}else this.hide()})),t.addEventListener("mousemove",(()=>{this.hideSubMenus()}));return t}hideAll(){!this.root||this.parent?this.parent.hide():this.shown&&(this.hideSubMenus(),this.shown=!1,this.container.removeChild(this.dom),this.parent&&this.parent.shown&&this.parent.hide())}hide(){this.dom&&this.shown&&(this.shown=!1,this.hideSubMenus(),this.container.removeChild(this.dom),this.parent&&this.parent.shown&&this.parent.hide())}hideSubMenus(){for(const e of this.submenus)e.shown&&(e.shown=!1,e.container.removeChild(e.dom)),e.hideSubMenus()}show(e,t){this.dom=this.getMenuDom(),this.dom.style.left=`${e}px`,this.dom.style.top=`${t}px`,this.shown=!0,this.container.appendChild(this.dom)}install(){this.container.addEventListener("contextmenu",this._oncontextmenu),this.container.addEventListener("keydown",this._oncontextmenu_keydown),this.container.addEventListener("click",this._onclick),window.addEventListener("blur",this._onblur)}setData(e){this.items=e}uninstall(){this.dom=null,this.container.removeEventListener("keydown",this._oncontextmenu_keydown),this.container.removeEventListener("click",this._onclick),window.removeEventListener("blur",this._onblur)}}for(var om,am=[],sm=0;sm<256;++sm)am.push((sm+256).toString(16).slice(1));var lm=new Uint8Array(16);function cm(){if(!om&&!(om="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return om(lm)}const um={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function hm(e,t,n){if(um.randomUUID&&!t&&!e)return um.randomUUID();var i=(e=e||{}).random||(e.rng||cm)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=i[r];return t}return function(e,t=0){return(am[e[t+0]]+am[e[t+1]]+am[e[t+2]]+am[e[t+3]]+"-"+am[e[t+4]]+am[e[t+5]]+"-"+am[e[t+6]]+am[e[t+7]]+"-"+am[e[t+8]]+am[e[t+9]]+"-"+am[e[t+10]]+am[e[t+11]]+am[e[t+12]]+am[e[t+13]]+am[e[t+14]]+am[e[t+15]]).toLowerCase()}(i)}var dm=(e=>(e.EMPTY="",e.ONE="one",e.MULTI="multiple",e))(dm||{}),fm=(e=>(e.ONE="selectOne",e.MULTI="selectMultiple",e.CANCEL="selectCancel",e))(fm||{});const pm={SelectMode:dm,SelectEvent:fm};function gm(e){return!!pr()&&(gr(e),!0)}function vm(e){return"function"==typeof e?e():pi(e)}const Am="undefined"!=typeof window&&"undefined"!=typeof document;"undefined"!=typeof WorkerGlobalScope&&(globalThis,WorkerGlobalScope);const mm=Object.prototype.toString,ym=()=>{};function bm(e,t=!0,n){Ci()?ci(e,n):t?e():ki(e)}function Cm(e){var t;const n=vm(e);return null!=(t=null==n?void 0:n.$el)?t:n}const wm=Am?window:void 0,xm=Am?window.document:void 0,_m=Am?window.navigator:void 0;function Em(...e){let t,n,i,r;if("string"==typeof e[0]||Array.isArray(e[0])?([n,i,r]=e,t=wm):[t,n,i,r]=e,!t)return ym;Array.isArray(n)||(n=[n]),Array.isArray(i)||(i=[i]);const o=[],a=()=>{o.forEach((e=>e())),o.length=0},s=Ii((()=>[Cm(t),vm(r)]),(([e,t])=>{if(a(),!e)return;const r=(s=t,"[object Object]"===mm.call(s)?l({},t):t);var s;o.push(...n.flatMap((t=>i.map((n=>((e,t,n,i)=>(e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)))(e,t,n,r))))))}),{immediate:!0,flush:"post"}),c=()=>{s(),a()};return gm(c),c}function Sm(e){const t=function(){const e=si(!1),t=Ci();return t&&ci((()=>{e.value=!0}),t),e}();return Si((()=>(t.value,Boolean(e()))))}const Im=e=>JSON.stringify(e),km=e=>JSON.stringify(e),Bm=e=>JSON.stringify(Array.from(e)),Om=e=>JSON.stringify(Object.fromEntries(e)),Tm=()=>"";function Dm(e,t){const n=si(""),i=si();function r(){if(Am)return i.value=new Promise(((n,i)=>{try{const r=vm(e);if(null==r)n("");else if("string"==typeof r)n(Mm(new Blob([r],{type:"text/plain"})));else if(r instanceof Blob)n(Mm(r));else if(r instanceof ArrayBuffer)n(window.btoa(String.fromCharCode(...new Uint8Array(r))));else if(r instanceof HTMLCanvasElement)n(r.toDataURL(null==t?void 0:t.type,null==t?void 0:t.quality));else if(r instanceof HTMLImageElement){const e=r.cloneNode(!1);e.crossOrigin="Anonymous",function(e){return new Promise(((t,n)=>{e.complete?t():(e.onload=()=>{t()},e.onerror=n)}))}(e).then((()=>{const i=document.createElement("canvas"),r=i.getContext("2d");i.width=e.width,i.height=e.height,r.drawImage(e,0,0,i.width,i.height),n(i.toDataURL(null==t?void 0:t.type,null==t?void 0:t.quality))})).catch(i)}else{if("object"==typeof r){const e=(null==t?void 0:t.serializer)||function(e){return e?e instanceof Map?Om:e instanceof Set?Bm:Array.isArray(e)?Im:km:Tm}(r),i=e(r);return n(Mm(new Blob([i],{type:"application/json"})))}i(new Error("target is unsupported types"))}}catch(r){i(r)}})),i.value.then((e=>n.value=e)),i.value}return Qi(e)||"function"==typeof e?Ii(e,r,{immediate:!0}):r(),{base64:n,promise:i,execute:r}}function Mm(e){return new Promise(((t,n)=>{const i=new FileReader;i.onload=e=>{t(e.target.result)},i.onerror=n,i.readAsDataURL(e)}))}function Qm(e,t={}){const{controls:n=!1,navigator:i=_m}=t,r=Sm((()=>i&&"permissions"in i));let o;const a="string"==typeof e?{name:e}:e,s=si(),l=()=>{o&&(s.value=o.state)},c=function(e){let t;function n(){return t||(t=e()),t}return n.reset=()=>h(this,null,(function*(){const e=t;t=void 0,e&&(yield e)})),n}((()=>h(this,null,(function*(){if(r.value){if(!o)try{o=yield i.permissions.query(a),Em(o,"change",l),l()}catch(e){s.value="prompt"}return o}}))));return c(),n?{state:s,isSupported:r,query:c}:s}function Lm(e={}){const{navigator:t=_m,read:n=!1,source:i,copiedDuring:r=1500,legacy:o=!1}=e,a=Sm((()=>t&&"clipboard"in t)),s=Qm("clipboard-read"),l=Qm("clipboard-write"),c=Si((()=>a.value||o)),u=si(""),d=si(!1),f=function(e,t,n={}){const{immediate:i=!0}=n,r=si(!1);let o=null;function a(){o&&(clearTimeout(o),o=null)}function s(){r.value=!1,a()}function l(...n){a(),r.value=!0,o=setTimeout((()=>{r.value=!1,o=null,e(...n)}),vm(t))}return i&&(r.value=!0,Am&&l()),gm(s),{isPending:fr(r),start:l,stop:s}}((()=>d.value=!1),r);function p(e){return"granted"===e||"prompt"===e}return c.value&&n&&Em(["copy","cut"],(function(){var e,n,i;a.value&&p(s.value)?t.clipboard.readText().then((e=>{u.value=e})):u.value=null!=(i=null==(n=null==(e=null==document?void 0:document.getSelection)?void 0:e.call(document))?void 0:n.toString())?i:""})),{isSupported:c,text:u,copied:d,copy:function(){return h(this,arguments,(function*(e=vm(i)){c.value&&null!=e&&(a.value&&p(l.value)?yield t.clipboard.writeText(e):function(e){const t=document.createElement("textarea");t.value=null!=e?e:"",t.style.position="absolute",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove()}(e),u.value=e,d.value=!0,f.start())}))}}}const Pm={multiple:!0,accept:"*",reset:!1,directory:!1};function jm(e={}){const{document:t=xm}=e,n=si(null),{on:i,trigger:r}=function(){const e=new Set,t=t=>{e.delete(t)};return{on:n=>{e.add(n);const i=()=>t(n);return gm(i),{off:i}},off:t,trigger:(...t)=>Promise.all(Array.from(e).map((e=>e(...t))))}}();let o;t&&(o=t.createElement("input"),o.type="file",o.onchange=e=>{const t=e.target;n.value=t.files,r(n.value)});const a=()=>{n.value=null,o&&o.value&&(o.value="",r(null))};return{files:fr(n),open:t=>{if(!o)return;const n=l(l(l({},Pm),e),t);var i,r;o.multiple=n.multiple,o.accept=n.accept,o.webkitdirectory=n.directory,i=n,r="capture",Object.prototype.hasOwnProperty.call(i,r)&&(o.capture=n.capture),n.reset&&a(),o.click()},reset:a,onChange:i}}function Rm(e,t={}){const n=function(...e){if(1!==e.length)return vr(...e);const t=e[0];return"function"==typeof t?fr(Ar((()=>({get:t,set:ym})))):si(t)}(e),{threshold:i=50,onSwipe:r,onSwipeEnd:o,onSwipeStart:a,disableTextSelect:s=!1}=t,l=zi({x:0,y:0}),c=zi({x:0,y:0}),u=(e,t)=>{c.x=e,c.y=t},h=Si((()=>l.x-c.x)),d=Si((()=>l.y-c.y)),{max:f,abs:p}=Math,g=Si((()=>f(p(h.value),p(d.value))>=i)),v=si(!1),A=si(!1),m=Si((()=>g.value?p(h.value)>p(d.value)?h.value>0?"left":"right":d.value>0?"up":"down":"none")),y=e=>{var n,i,r;const o=0===e.buttons,a=1===e.buttons;return null==(r=null!=(i=null==(n=t.pointerTypes)?void 0:n.includes(e.pointerType))?i:o||a)||r},b=[Em(e,"pointerdown",(e=>{if(!y(e))return;A.value=!0;const t=e.target;null==t||t.setPointerCapture(e.pointerId);const{clientX:n,clientY:i}=e;((e,t)=>{l.x=e,l.y=t})(n,i),u(n,i),null==a||a(e)})),Em(e,"pointermove",(e=>{if(!y(e))return;if(!A.value)return;const{clientX:t,clientY:n}=e;u(t,n),!v.value&&g.value&&(v.value=!0),v.value&&(null==r||r(e))})),Em(e,"pointerup",(e=>{y(e)&&(v.value&&(null==o||o(e,m.value)),A.value=!1,v.value=!1)}))];bm((()=>{var e,t,i,r,o,a,l,c;null==(t=null==(e=n.value)?void 0:e.style)||t.setProperty("touch-action","none"),s&&(null==(r=null==(i=n.value)?void 0:i.style)||r.setProperty("-webkit-user-select","none"),null==(a=null==(o=n.value)?void 0:o.style)||a.setProperty("-ms-user-select","none"),null==(c=null==(l=n.value)?void 0:l.style)||c.setProperty("user-select","none"))}));return{isSwiping:fr(v),direction:fr(m),posStart:fr(l),posEnd:fr(c),distanceX:h,distanceY:d,stop:()=>b.forEach((e=>e()))}}function Fm(e){return Dm(e).promise.value}function Nm(e){return new Promise((t=>{const{onChange:n,open:i}=jm(e);n((e=>{t(e)})),i()}))}const Vm=(e,t)=>Lm(l({source:e},t)).copy();function Um(e,t){const n=document.createElement("a");n.href=e,n.download=`${hm()}.${t}`,document.body.appendChild(n),n.click(),n.remove()}function zm(e,t,n,i,r,o,a){void 0!==a&&(e.save(),e.translate(t,n),e.rotate(a),e.drawImage(i,-r/2,-o/2,r,o),e.restore())}const Hm=e=>e instanceof fabric.Group,Ym=e=>e instanceof fabric.ActiveSelection;function Gm(e){return new Promise((t=>{const n=new FileReader;n.addEventListener("load",(()=>{t(n.result)})),n.readAsDataURL(e)}))}const Wm={getImgStr:Fm,downFile:Um,selectFiles:Nm,insertImgFile:function(e){return new Promise((t=>{const n=document.createElement("img");n.src=e,document.body.appendChild(n),n.onload=()=>{t(n)}}))},clipboardText:Vm,drawImg:zm,isImage:e=>e instanceof fabric.Image,isGroup:Hm,isIText:e=>e instanceof fabric.IText,isActiveSelection:Ym,blobToBase64:Gm,base64ToBlob:function(e){var t;if(!e)return null;const n=e.split(","),i=null==(t=n[0])?void 0:t.match(/:(.*?);/)[1],r=window.atob(n[1]),o=new ArrayBuffer(r.length),a=new Uint8Array(o);for(let s=0;s<r.length;s++)a[s]=r.charCodeAt(s);return[new Blob([o],{type:i}),i.slice(6)]}};var Xm=(e=>(e.create="CGRATE",e.template="TEMPLATE",e.element="ELEMENT",e.text="TEXT",e.material="Material",e.ai="AI",e.mine="MINE",e.none="",e))(Xm||{}),$m=(e=>(e.canvas="CANVASLIST",e.layer="LAYER",e.menu="MENU",e))($m||{}),qm=(e=>(e.h1="TEXT-H1,",e.h2="TEXT-H2",e.normal="TEXT-NORMAL",e))(qm||{}),Km=(e=>(e.react="REACT",e.triangle="Triangle",e.around="Around",e.polygon="Polygon",e.line="LINE",e))(Km||{}),Jm=(e=>(e.qrcode="QRCODE",e.barCode="BARCODE",e))(Jm||{}),Zm=(e=>(e.design="DESIGN",e.img="IMAGE",e.json="JSON",e.svg="SVG",e.psd="PSD",e))(Zm||{});const ey=yr({id:"editor",state:()=>({editor:null,canvas:null,zoom:1,rulerEnable:!0,tabType:Xm.template,panelType:$m.menu,showPanel:!0,panelPositoin:"left"}),actions:{setEditor(e){this.editor=e},setCanvas(e){this.canvas=e},setScale(e){this.zoom=e},updateRulerEnable(e){this.rulerEnable=e},setTabType(e){this.tabType=e},setPanelType(e){this.panelType=e},setShowPanel(e){this.showPanel=e},setPanelPositoin(e){this.panelPositoin=e}}});function ty(){return ey(mr)}const ny=ty(),iy=yr({id:"Template",state:()=>({templateList:[],curTempIdx:-1}),getters:{curTemplate:e=>e.templateList[e.curTempIdx]},actions:{setTemplateIndex(e){this.curTempIdx=e},addTemplate(e){const t=Array.isArray(e)?e:[e],n=this.curTempIdx+1;this.curTempIdx=n,this.templateList=this.templateList.concat(t),this.renderTemplate()},renderTemplate(){return h(this,null,(function*(){ny.canvas}))},updateTemplate(e){const t=this.curTempIdx;this.templateList[t]=l(l({},this.templateList[t]),e)},setTemplatePreview(e){return h(this,null,(function*(){Ht(e)||(e=`${window.location.origin}/${e}`);const t=yield Yt(e);t&&(this.templateList[this.curTempIdx].preview=t)}))},deleteTemplate(e){const t=this.templateList.length;if(1==t)return Gt.warning("删除失败，至少要有一个模板");if(this.templateList.splice(e,1),t>e){const e=this.curTempIdx-1;this.curTempIdx=e<=0?0:e}this.renderTemplate()},clearTemplate(){const e=this.templateList[this.curTempIdx].objects.filter((e=>"workspace"===e.id));this.templateList[this.curTempIdx].objects=e,this.renderTemplate()}}});const ry=iy(mr);function oy(e){e&&e.forEach((e=>{e.objects?oy(e.objects):"text"===e.type&&(e.type="textbox")}))}class ay{constructor(e,t){u(this,"canvas"),u(this,"editor"),u(this,"selectedMode"),this.canvas=e,this.editor=t,this.selectedMode=dm.EMPTY,this._initSelectEvent()}_initSelectEvent(){this.canvas.on("selection:created",(()=>this._emitSelectEvent())),this.canvas.on("selection:updated",(()=>this._emitSelectEvent())),this.canvas.on("selection:cleared",(()=>this._emitSelectEvent()))}_emitSelectEvent(){if(!this.canvas)throw TypeError("还未初始化");const e=this.canvas.getActiveObjects().filter((e=>!(e instanceof vA.fabric.GuideLine)));e&&1===e.length?(this.selectedMode=dm.ONE,this.editor.emit(fm.ONE,e)):e&&e.length>1?(this.selectedMode=dm.MULTI,this.editor.emit(fm.MULTI,e)):this.editor.emit(fm.CANCEL)}getSelectMode(){return String(this.selectedMode)}insert(e){Nm({accept:".json"}).then((t=>{if(t&&t.length>0){const n=t[0],i=new FileReader;i.readAsText(n,"UTF-8"),i.onload=()=>{this.loadJSON(i.result,e)}}}))}renderITextPath(e){e.forEach((e=>{const t=this.canvas.getObjects().find((t=>t.id===e.id));t&&vA.fabric.Path.fromObject(e.path,(e=>{t.set("path",e)}))}))}loadJSON(e,t){return h(this,null,(function*(){const n="string"==typeof e?JSON.parse(e):e,i=[];n.objects.forEach((e=>{!e.id&&(e.id=hm()),"i-text"===e.type&&e.path&&(i.push({id:e.id,path:e.path}),e.path=null)}));const r=yield this._transform(n);e=JSON.stringify(r),this.editor.hooksEntity.hookImportBefore.callAsync(e,(()=>{this.canvas.loadFromJSON(e,(()=>{this.renderITextPath(i),this.editor.hooksEntity.hookImportAfter.callAsync(e,(()=>{var i;(null==(i=this.editor)?void 0:i.updateDrawStatus)&&"function"==typeof this.editor.updateDrawStatus&&this.editor.updateDrawStatus(!!n.overlayImage),this.canvas.renderAll(),t&&t(),this.canvas.renderAll();const r=JSON.parse(e);this.canvas.toCanvasElement(1).toBlob((e=>{e&&(r.image=URL.createObjectURL(e)),ry.addTemplate(r)})),this.editor.emit("loadJson")}))}))}))}))}_transform(e){return h(this,null,(function*(){if(yield this.promiseCallAsync(e),e.objects){const t=e.objects.map((e=>this._transform(e)));yield Promise.all(t)}return e}))}promiseCallAsync(e){return new Promise((t=>{this.editor.hooksEntity.hookTransform.callAsync(e,(()=>{t(e)}))}))}getJson(){const e=this.getExtensionKey();return this.canvas.toJSON(e)}getExtensionKey(){return["id","gradientAngle","selectable","hasControls","linkData","editable","extensionType","extension","verticalAlign"]}dragAddItem(e,t){if(t){const{left:n,top:i}=this.canvas.getSelectionElement().getBoundingClientRect();if(t.x<n||t.y<i||void 0===e.width)return;const r={x:t.x-n,y:t.y-i},o=this.canvas.restorePointerVpt(r);e.left=o.x-e.width/2,e.top=o.y}const{width:n}=this._getSaveOption();n&&e.scaleToWidth(n/2),this.canvas.add(e),this.canvas.setActiveObject(e),!t&&this.editor.position("center"),this.canvas.requestRenderAll()}clipboard(){const e=this.getJson();return Vm(JSON.stringify(e,null,"\t"))}clipboardBase64(){return h(this,null,(function*(){const e=yield this.preview();return Vm(e)}))}saveJson(){return h(this,null,(function*(){const e=this.getJson();yield oy(e.objects);Um(`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(e,null,"\t"))}`,"json")}))}saveSvg(){this.editor.hooksEntity.hookSaveBefore.callAsync("",(()=>{const{fontOption:e,svgOption:t}=this._getSaveSvgOption();vA.fabric.fontPaths=l({},e);const n=this.canvas.toSVG(t),i=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(n)}`;this.editor.hooksEntity.hookSaveAfter.callAsync(i,(()=>{Um(i,"svg")}))}))}saveImg(){this.editor.hooksEntity.hookSaveBefore.callAsync("",(()=>{const e=this._getSaveOption();this.canvas.setViewportTransform([1,0,0,1,0,0]);const t=this.canvas.toDataURL(e);this.editor.hooksEntity.hookSaveAfter.callAsync(t,(()=>{Um(t,"png")}))}))}preview(){return new Promise((e=>{this.editor.hooksEntity.hookSaveBefore.callAsync("",(()=>{const t=this._getSaveOption();this.canvas.setViewportTransform([1,0,0,1,0,0]),this.canvas.renderAll();const n=this.canvas.toDataURL(t);this.editor.hooksEntity.hookSaveAfter.callAsync(n,(()=>{e(n)}))}))}))}_getSaveSvgOption(){const e=this.canvas.getObjects().find((e=>"workspace"===e.id));let t=this.canvas.getObjects().filter((e=>"textbox"==e.type)).map((e=>e.fontFamily));t=Array.from(new Set(t));const n=this.editor.getPlugin("FontPlugin").cacheList,i={};for(const l of t){const e=n.find((e=>e.name===l));i[l]=e.file}const{left:r,top:o,width:a,height:s}=e;return{fontOption:i,svgOption:{width:a,height:s,viewBox:{x:r,y:o,width:a,height:s}}}}_getSaveOption(){const e=this.canvas.getObjects().find((e=>"workspace"===e.id)),{left:t,top:n,width:i,height:r}=e;return{name:"New Image",format:"png",quality:1,width:i,height:r,left:t,top:n}}clear(){var e;this.canvas.getObjects().forEach((e=>{"workspace"!==e.id&&this.canvas.remove(e)})),null==(e=this.editor)||e.setWorkspaseBg("#fff"),this.canvas.discardActiveObject(),this.canvas.renderAll()}destroy(){}}u(ay,"pluginName","ServersPlugin"),u(ay,"apis",["insert","loadJSON","getJson","dragAddItem","clipboard","clipboardBase64","saveJson","saveSvg","saveImg","clear","preview","getSelectMode","getExtensionKey"]),u(ay,"events",[dm.ONE,dm.MULTI,fm.CANCEL]);var sy={};sy.deprecate=(e,t)=>{let n=!0;return function(){return n&&(n=!1),e.apply(this,arguments)}};const ly=sy.deprecate((()=>{}),"Hook.context is deprecated and will be removed"),cy=function(...e){return this.call=this._createCall("sync"),this.call(...e)},uy=function(...e){return this.callAsync=this._createCall("async"),this.callAsync(...e)},hy=function(...e){return this.promise=this._createCall("promise"),this.promise(...e)};let dy=class{constructor(e=[],t=void 0){this._args=e,this.name=t,this.taps=[],this.interceptors=[],this._call=cy,this.call=cy,this._callAsync=uy,this.callAsync=uy,this._promise=hy,this.promise=hy,this._x=void 0,this.compile=this.compile,this.tap=this.tap,this.tapAsync=this.tapAsync,this.tapPromise=this.tapPromise}compile(e){throw new Error("Abstract: should be overridden")}_createCall(e){return this.compile({taps:this.taps,interceptors:this.interceptors,args:this._args,type:e})}_tap(e,t,n){if("string"==typeof t)t={name:t.trim()};else if("object"!=typeof t||null===t)throw new Error("Invalid tap options");if("string"!=typeof t.name||""===t.name)throw new Error("Missing name for tap");void 0!==t.context&&ly(),t=Object.assign({type:e,fn:n},t),t=this._runRegisterInterceptors(t),this._insert(t)}tap(e,t){this._tap("sync",e,t)}tapAsync(e,t){this._tap("async",e,t)}tapPromise(e,t){this._tap("promise",e,t)}_runRegisterInterceptors(e){for(const t of this.interceptors)if(t.register){const n=t.register(e);void 0!==n&&(e=n)}return e}withOptions(e){const t=t=>Object.assign({},e,"string"==typeof t?{name:t}:t);return{name:this.name,tap:(e,n)=>this.tap(t(e),n),tapAsync:(e,n)=>this.tapAsync(t(e),n),tapPromise:(e,n)=>this.tapPromise(t(e),n),intercept:e=>this.intercept(e),isUsed:()=>this.isUsed(),withOptions:e=>this.withOptions(t(e))}}isUsed(){return this.taps.length>0||this.interceptors.length>0}intercept(e){if(this._resetCompilation(),this.interceptors.push(Object.assign({},e)),e.register)for(let t=0;t<this.taps.length;t++)this.taps[t]=e.register(this.taps[t])}_resetCompilation(){this.call=this._call,this.callAsync=this._callAsync,this.promise=this._promise}_insert(e){let t;this._resetCompilation(),"string"==typeof e.before?t=new Set([e.before]):Array.isArray(e.before)&&(t=new Set(e.before));let n=0;"number"==typeof e.stage&&(n=e.stage);let i=this.taps.length;for(;i>0;){i--;const e=this.taps[i];this.taps[i+1]=e;const r=e.stage||0;if(t){if(t.has(e.name)){t.delete(e.name);continue}if(t.size>0)continue}if(!(r>n)){i++;break}}this.taps[i]=e}};Object.setPrototypeOf(dy.prototype,null);var fy=dy;var py=class{constructor(e){this.config=e,this.options=void 0,this._args=void 0}create(e){let t;switch(this.init(e),this.options.type){case"sync":t=new Function(this.args(),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:e=>`throw ${e};\n`,onResult:e=>`return ${e};\n`,resultReturns:!0,onDone:()=>"",rethrowIfPossible:!0}));break;case"async":t=new Function(this.args({after:"_callback"}),'"use strict";\n'+this.header()+this.contentWithInterceptors({onError:e=>`_callback(${e});\n`,onResult:e=>`_callback(null, ${e});\n`,onDone:()=>"_callback();\n"}));break;case"promise":let e=!1;const n=this.contentWithInterceptors({onError:t=>(e=!0,`_error(${t});\n`),onResult:e=>`_resolve(${e});\n`,onDone:()=>"_resolve();\n"});let i="";i+='"use strict";\n',i+=this.header(),i+="return new Promise((function(_resolve, _reject) {\n",e&&(i+="var _sync = true;\n",i+="function _error(_err) {\n",i+="if(_sync)\n",i+="_resolve(Promise.resolve().then((function() { throw _err; })));\n",i+="else\n",i+="_reject(_err);\n",i+="};\n"),i+=n,e&&(i+="_sync = false;\n"),i+="}));\n",t=new Function(this.args(),i)}return this.deinit(),t}setup(e,t){e._x=t.taps.map((e=>e.fn))}init(e){this.options=e,this._args=e.args.slice()}deinit(){this.options=void 0,this._args=void 0}contentWithInterceptors(e){if(this.options.interceptors.length>0){const t=e.onError,n=e.onResult,i=e.onDone;let r="";for(let e=0;e<this.options.interceptors.length;e++){const t=this.options.interceptors[e];t.call&&(r+=`${this.getInterceptor(e)}.call(${this.args({before:t.context?"_context":void 0})});\n`)}return r+=this.content(Object.assign(e,{onError:t&&(e=>{let n="";for(let t=0;t<this.options.interceptors.length;t++){this.options.interceptors[t].error&&(n+=`${this.getInterceptor(t)}.error(${e});\n`)}return n+=t(e),n}),onResult:n&&(e=>{let t="";for(let n=0;n<this.options.interceptors.length;n++){this.options.interceptors[n].result&&(t+=`${this.getInterceptor(n)}.result(${e});\n`)}return t+=n(e),t}),onDone:i&&(()=>{let e="";for(let t=0;t<this.options.interceptors.length;t++){this.options.interceptors[t].done&&(e+=`${this.getInterceptor(t)}.done();\n`)}return e+=i(),e})})),r}return this.content(e)}header(){let e="";return this.needContext()?e+="var _context = {};\n":e+="var _context;\n",e+="var _x = this._x;\n",this.options.interceptors.length>0&&(e+="var _taps = this.taps;\n",e+="var _interceptors = this.interceptors;\n"),e}needContext(){for(const e of this.options.taps)if(e.context)return!0;return!1}callTap(e,{onError:t,onResult:n,onDone:i,rethrowIfPossible:r}){let o="",a=!1;for(let l=0;l<this.options.interceptors.length;l++){const t=this.options.interceptors[l];t.tap&&(a||(o+=`var _tap${e} = ${this.getTap(e)};\n`,a=!0),o+=`${this.getInterceptor(l)}.tap(${t.context?"_context, ":""}_tap${e});\n`)}o+=`var _fn${e} = ${this.getTapFn(e)};\n`;const s=this.options.taps[e];switch(s.type){case"sync":r||(o+=`var _hasError${e} = false;\n`,o+="try {\n"),o+=n?`var _result${e} = _fn${e}(${this.args({before:s.context?"_context":void 0})});\n`:`_fn${e}(${this.args({before:s.context?"_context":void 0})});\n`,r||(o+="} catch(_err) {\n",o+=`_hasError${e} = true;\n`,o+=t("_err"),o+="}\n",o+=`if(!_hasError${e}) {\n`),n&&(o+=n(`_result${e}`)),i&&(o+=i()),r||(o+="}\n");break;case"async":let a="";a+=n?`(function(_err${e}, _result${e}) {\n`:`(function(_err${e}) {\n`,a+=`if(_err${e}) {\n`,a+=t(`_err${e}`),a+="} else {\n",n&&(a+=n(`_result${e}`)),i&&(a+=i()),a+="}\n",a+="})",o+=`_fn${e}(${this.args({before:s.context?"_context":void 0,after:a})});\n`;break;case"promise":o+=`var _hasResult${e} = false;\n`,o+=`var _promise${e} = _fn${e}(${this.args({before:s.context?"_context":void 0})});\n`,o+=`if (!_promise${e} || !_promise${e}.then)\n`,o+=`  throw new Error('Tap function (tapPromise) did not return promise (returned ' + _promise${e} + ')');\n`,o+=`_promise${e}.then((function(_result${e}) {\n`,o+=`_hasResult${e} = true;\n`,n&&(o+=n(`_result${e}`)),i&&(o+=i()),o+=`}), function(_err${e}) {\n`,o+=`if(_hasResult${e}) throw _err${e};\n`,o+=t(`_err${e}`),o+="});\n"}return o}callTapsSeries({onError:e,onResult:t,resultReturns:n,onDone:i,doneReturns:r,rethrowIfPossible:o}){if(0===this.options.taps.length)return i();const a=this.options.taps.findIndex((e=>"sync"!==e.type)),s=n||r;let l="",c=i,u=0;for(let h=this.options.taps.length-1;h>=0;h--){const n=h;c!==i&&("sync"!==this.options.taps[n].type||u++>20)&&(u=0,l+=`function _next${n}() {\n`,l+=c(),l+="}\n",c=()=>`${s?"return ":""}_next${n}();\n`);const r=c,d=e=>e?"":i(),f=this.callTap(n,{onError:t=>e(n,t,r,d),onResult:t&&(e=>t(n,e,r,d)),onDone:!t&&r,rethrowIfPossible:o&&(a<0||n<a)});c=()=>f}return l+=c(),l}callTapsLooping({onError:e,onDone:t,rethrowIfPossible:n}){if(0===this.options.taps.length)return t();const i=this.options.taps.every((e=>"sync"===e.type));let r="";i||(r+="var _looper = (function() {\n",r+="var _loopAsync = false;\n"),r+="var _loop;\n",r+="do {\n",r+="_loop = false;\n";for(let o=0;o<this.options.interceptors.length;o++){const e=this.options.interceptors[o];e.loop&&(r+=`${this.getInterceptor(o)}.loop(${this.args({before:e.context?"_context":void 0})});\n`)}return r+=this.callTapsSeries({onError:e,onResult:(e,t,n,r)=>{let o="";return o+=`if(${t} !== undefined) {\n`,o+="_loop = true;\n",i||(o+="if(_loopAsync) _looper();\n"),o+=r(!0),o+="} else {\n",o+=n(),o+="}\n",o},onDone:t&&(()=>{let e="";return e+="if(!_loop) {\n",e+=t(),e+="}\n",e}),rethrowIfPossible:n&&i}),r+="} while(_loop);\n",i||(r+="_loopAsync = true;\n",r+="});\n",r+="_looper();\n"),r}callTapsParallel({onError:e,onResult:t,onDone:n,rethrowIfPossible:i,onTap:r=(e,t)=>t()}){if(this.options.taps.length<=1)return this.callTapsSeries({onError:e,onResult:t,onDone:n,rethrowIfPossible:i});let o="";o+="do {\n",o+=`var _counter = ${this.options.taps.length};\n`,n&&(o+="var _done = (function() {\n",o+=n(),o+="});\n");for(let a=0;a<this.options.taps.length;a++){const s=()=>n?"if(--_counter === 0) _done();\n":"--_counter;",l=e=>e||!n?"_counter = 0;\n":"_counter = 0;\n_done();\n";o+="if(_counter <= 0) break;\n",o+=r(a,(()=>this.callTap(a,{onError:t=>{let n="";return n+="if(_counter > 0) {\n",n+=e(a,t,s,l),n+="}\n",n},onResult:t&&(e=>{let n="";return n+="if(_counter > 0) {\n",n+=t(a,e,s,l),n+="}\n",n}),onDone:!t&&(()=>s()),rethrowIfPossible:i})),s,l)}return o+="} while(false);\n",o}args({before:e,after:t}={}){let n=this._args;return e&&(n=[e].concat(n)),t&&(n=n.concat(t)),0===n.length?"":n.join(", ")}getTapFn(e){return`_x[${e}]`}getTap(e){return`_taps[${e}]`}getInterceptor(e){return`_interceptors[${e}]`}};const gy=py;new class extends gy{content({onError:e,onDone:t,rethrowIfPossible:n}){return this.callTapsSeries({onError:(t,n)=>e(n),onDone:t,rethrowIfPossible:n})}};const vy=py;new class extends vy{content({onError:e,onResult:t,resultReturns:n,onDone:i,rethrowIfPossible:r}){return this.callTapsSeries({onError:(t,n)=>e(n),onResult:(e,n,i)=>`if(${n} !== undefined) {\n${t(n)};\n} else {\n${i()}}\n`,resultReturns:n,onDone:i,rethrowIfPossible:r})}};const Ay=py;new class extends Ay{content({onError:e,onResult:t,resultReturns:n,rethrowIfPossible:i}){return this.callTapsSeries({onError:(t,n)=>e(n),onResult:(e,t,n)=>{let i="";return i+=`if(${t} !== undefined) {\n`,i+=`${this._args[0]} = ${t};\n`,i+="}\n",i+=n(),i},onDone:()=>t(this._args[0]),doneReturns:n,rethrowIfPossible:i})}};const my=py;new class extends my{content({onError:e,onDone:t,rethrowIfPossible:n}){return this.callTapsLooping({onError:(t,n)=>e(n),onDone:t,rethrowIfPossible:n})}};const yy=py;new class extends yy{content({onError:e,onDone:t}){return this.callTapsParallel({onError:(t,n,i,r)=>e(n)+r(!0),onDone:t})}};const by=py;new class extends by{content({onError:e,onResult:t,onDone:n}){let i="";return i+=`var _results = new Array(${this.options.taps.length});\n`,i+="var _checkDone = function() {\n",i+="for(var i = 0; i < _results.length; i++) {\n",i+="var item = _results[i];\n",i+="if(item === undefined) return false;\n",i+="if(item.result !== undefined) {\n",i+=t("item.result"),i+="return true;\n",i+="}\n",i+="if(item.error) {\n",i+=e("item.error"),i+="return true;\n",i+="}\n",i+="}\n",i+="return false;\n",i+="}\n",i+=this.callTapsParallel({onError:(e,t,n,i)=>{let r="";return r+=`if(${e} < _results.length && ((_results.length = ${e+1}), (_results[${e}] = { error: ${t} }), _checkDone())) {\n`,r+=i(!0),r+="} else {\n",r+=n(),r+="}\n",r},onResult:(e,t,n,i)=>{let r="";return r+=`if(${e} < _results.length && (${t} !== undefined && (_results.length = ${e+1}), (_results[${e}] = { result: ${t} }), _checkDone())) {\n`,r+=i(!0),r+="} else {\n",r+=n(),r+="}\n",r},onTap:(e,t,n,i)=>{let r="";return e>0&&(r+=`if(${e} >= _results.length) {\n`,r+=n(),r+="} else {\n"),r+=t(),e>0&&(r+="}\n"),r},onDone:n}),i}};const Cy=fy,wy=py;const xy=new class extends wy{content({onError:e,onDone:t}){return this.callTapsSeries({onError:(t,n,i,r)=>e(n)+r(!0),onDone:t})}},_y=function(e){return xy.setup(this,e),xy.create(e)};function Ey(e=[],t=void 0){const n=new Cy(e,t);return n.constructor=Ey,n.compile=_y,n._call=void 0,n.call=void 0,n}Ey.prototype=null;var Sy=Ey;const Iy=py;new class extends Iy{content({onError:e,onResult:t,resultReturns:n,onDone:i}){return this.callTapsSeries({onError:(t,n,i,r)=>e(n)+r(!0),onResult:(e,n,i)=>`if(${n} !== undefined) {\n${t(n)}\n} else {\n${i()}}\n`,resultReturns:n,onDone:i})}};const ky=py;new class extends ky{content({onError:e,onDone:t}){return this.callTapsLooping({onError:(t,n,i,r)=>e(n)+r(!0),onDone:t})}};const By=py;new class extends By{content({onError:e,onResult:t,onDone:n}){return this.callTapsSeries({onError:(t,n,i,r)=>e(n)+r(!0),onResult:(e,t,n)=>{let i="";return i+=`if(${t} !== undefined) {\n`,i+=`${this._args[0]} = ${t};\n`,i+="}\n",i+=n(),i},onDone:()=>t(this._args[0])})}};const Oy=sy,Ty=(e,t)=>t;class Dy{constructor(e,t=void 0){this._map=new Map,this.name=t,this._factory=e,this._interceptors=[]}get(e){return this._map.get(e)}for(e){const t=this.get(e);if(void 0!==t)return t;let n=this._factory(e);const i=this._interceptors;for(let r=0;r<i.length;r++)n=i[r].factory(e,n);return this._map.set(e,n),n}intercept(e){this._interceptors.push(Object.assign({factory:Ty},e))}}Dy.prototype.tap=Oy.deprecate((function(e,t,n){return this.for(e).tap(t,n)}),"HookMap#tap(key,…) is deprecated. Use HookMap#for(key).tap(…) instead."),Dy.prototype.tapAsync=Oy.deprecate((function(e,t,n){return this.for(e).tapAsync(t,n)}),"HookMap#tapAsync(key,…) is deprecated. Use HookMap#for(key).tapAsync(…) instead."),Dy.prototype.tapPromise=Oy.deprecate((function(e,t,n){return this.for(e).tapPromise(t,n)}),"HookMap#tapPromise(key,…) is deprecated. Use HookMap#for(key).tapPromise(…) instead.");var My=Sy;class Qy extends MA{constructor(){super(...arguments),u(this,"canvas",null),u(this,"contextMenu",null),u(this,"pluginMap",{}),u(this,"customEvents",[]),u(this,"customApis",[]),u(this,"hooks",["hookImportBefore","hookImportAfter","hookSaveBefore","hookSaveAfter","hookTransform"]),u(this,"hooksEntity",{})}init(e){this.canvas=e,this._initContextMenu(),this._bindContextMenu(),this._initActionHooks(),this._initServersPlugin(),this.Utils=Wm}get fabricCanvas(){return this.canvas}use(e,t){if(this._checkPlugin(e)&&this.canvas){this._saveCustomAttr(e);const n=new e(this.canvas,this,t||{});n.pluginName=e.pluginName,this.pluginMap[e.pluginName]=n,this._bindingHooks(n),this._bindingHotkeys(n),this._bindingApis(n)}return this}destory(){this.canvas=null,this.contextMenu=null,this.pluginMap={},this.customEvents=[],this.customApis=[],this.hooksEntity={}}getPlugin(e){if(this.pluginMap[e])return this.pluginMap[e]}_checkPlugin(e){const{pluginName:t,events:n=[],apis:i=[]}=e;if(this.pluginMap[t])throw new Error(t+"插件重复初始化");return n.forEach((e=>{if(this.customEvents.find((t=>t===e)))throw new Error(t+"插件中"+e+"重复")})),i.forEach((e=>{if(this.customApis.find((t=>t===e)))throw new Error(t+"插件中"+e+"重复")})),!0}_bindingHooks(e){this.hooks.forEach((t=>{const n=e[t];n&&this.hooksEntity[t].tapPromise(e.pluginName+t,(function(){const t=n.apply(e,[...arguments]);return t instanceof Promise?t:Promise.resolve(t)}))}))}_bindingHotkeys(e){var t;null==(t=null==e?void 0:e.hotkeys)||t.forEach((t=>{tm(t,{keyup:!0},(n=>{e.hotkeyEvent&&e.hotkeyEvent(t,n)}))}))}_saveCustomAttr(e){const{events:t=[],apis:n=[]}=e;this.customApis=this.customApis.concat(n),this.customEvents=this.customEvents.concat(t)}_bindingApis(e){const{apis:t=[]}=e.constructor||{};t.forEach((t=>{this[t]=function(){return e[t].apply(e,[...arguments])}}))}_bindContextMenu(){this.canvas&&this.canvas.on("mouse:down",(e=>{if(3===e.button){let t=[];Object.keys(this.pluginMap).forEach((e=>{const n=this.pluginMap[e],i=n.contextMenu&&n.contextMenu();i&&(t=t.concat(i))})),this._renderMenu(e,t)}}))}_renderMenu(e,t){0!==t.length&&this.contextMenu&&(this.contextMenu.hideAll(),this.contextMenu.setData(t),this.contextMenu.show(e.e.clientX,e.e.clientY))}_initActionHooks(){this.hooks.forEach((e=>{this.hooksEntity[e]=new My(["data"])}))}_initContextMenu(){this.contextMenu=new rm(this.canvas.wrapperEl,[]),this.contextMenu.install()}_initServersPlugin(){this.use(ay)}off(e,t){return t?super.off(e,t):this}}class Ly{constructor(e,t){u(this,"defautOption",{}),u(this,"hotkeys",["space"]),u(this,"dragMode",!1),this.canvas=e,this.editor=t,this.dragMode=!1,this.init()}init(){this._initDring()}startDring(){this.dragMode=!0,this.canvas.setCursor("grab"),this.editor.emit("startDring"),this.canvas.renderAll()}endDring(){this.dragMode=!1,this.canvas.setCursor("default"),this.canvas.isDragging=!1,this.editor.emit("endDring"),this.canvas.renderAll()}_initDring(){const e=this;this.canvas.on("mouse:down",(function(t){const n=t.e;(n.altKey||e.dragMode||1===n.button)&&(e.canvas.setCursor("grabbing"),e.canvas.discardActiveObject(),e._setDring(),this.selection=!1,this.isDragging=!0,this.lastPosX=n.clientX,this.lastPosY=n.clientY,this.requestRenderAll())})),this.canvas.on("mouse:move",(function(t){if(e.dragMode&&e.canvas.setCursor("grab"),this.isDragging){e.canvas.discardActiveObject(),e.canvas.setCursor("grabbing");const{e:n}=t;if(!this.viewportTransform)return;const i=this.viewportTransform;i[4]+=n.clientX-this.lastPosX,i[5]+=n.clientY-this.lastPosY,this.lastPosX=n.clientX,this.lastPosY=n.clientY,this.requestRenderAll()}})),this.canvas.on("mouse:up",(function(){this.viewportTransform&&(this.setViewportTransform(this.viewportTransform),this.isDragging=!1,this.selection=!0,this.getObjects().forEach((e=>{"workspace"!==e.id&&e.hasControls&&(e.selectable=!0)})),e.dragMode&&e.canvas.setCursor("grab"),this.requestRenderAll())}))}_setDring(){this.canvas.selection=!1,this.canvas.getObjects().forEach((e=>{e.selectable=!1})),this.canvas.requestRenderAll()}destroy(){}hotkeyEvent(e,t){"Space"===t.code&&"keydown"===t.type&&(this.dragMode||this.startDring()),"Space"===t.code&&"keyup"===t.type&&this.endDring()}}u(Ly,"pluginName","DringPlugin"),u(Ly,"events",["startDring","endDring"]),u(Ly,"apis",["startDring","endDring"]);class Py{constructor(e,t){u(this,"defautOption",{color:"rgba(255,95,95,1)",width:1}),u(this,"dragMode",!1),this.canvas=e,this.editor=t,this.dragMode=!1,this.init()}init(){const{canvas:e}=this,t=e.getSelectionContext(),n=this;let i,r=1;function o(e){a(e.x1>e.x2?e.x2:e.x1,e.y+.5,e.x2>e.x1?e.x2:e.x1,e.y+.5)}function a(e,n,o,a){null!=i&&(t.moveTo(e*r+i[4],n*r+i[5]),t.lineTo(o*r+i[4],a*r+i[5]))}function s(e,t){e=Math.round(e),t=Math.round(t);for(let n=e-4,i=e+4;n<=i;n++)if(n===t)return!0;return!1}const l=[],c=[];e.on("mouse:down",(()=>{i=e.viewportTransform,r=e.getZoom()})),e.on("object:moving",(t=>{if(void 0===i||void 0===t.target)return;const n=t.target,r=e.getObjects(),o=n.getCenterPoint(),a=o.x,u=o.y,h=n.getBoundingRect(),d=h.height/i[3],f=h.width/i[0];let p=!1,g=!1;if(e._currentTransform){for(let e=r.length;e--;){if(r[e]===n)continue;if(n instanceof vA.fabric.GuideLine&&r[e]instanceof vA.fabric.GuideLine)continue;const t=r[e].getCenterPoint(),o=t.x,h=t.y,v=r[e].getBoundingRect(),A=v.height/i[3],m=v.width/i[0];s(o,a)&&(g=!0,l.push({x:o,y1:h<u?h-A/2-5:h+A/2+5,y2:u>h?u+d/2+5:u-d/2-5}),n.setPositionByOrigin(new vA.fabric.Point(o,u),"center","center")),s(o-m/2,a-f/2)&&(g=!0,l.push({x:o-m/2,y1:h<u?h-A/2-5:h+A/2+5,y2:u>h?u+d/2+5:u-d/2-5}),n.setPositionByOrigin(new vA.fabric.Point(o-m/2+f/2,u),"center","center")),s(o+m/2,a+f/2)&&(g=!0,l.push({x:o+m/2,y1:h<u?h-A/2-5:h+A/2+5,y2:u>h?u+d/2+5:u-d/2-5}),n.setPositionByOrigin(new vA.fabric.Point(o+m/2-f/2,u),"center","center")),s(h,u)&&(p=!0,c.push({y:h,x1:o<a?o-m/2-5:o+m/2+5,x2:a>o?a+f/2+5:a-f/2-5}),n.setPositionByOrigin(new vA.fabric.Point(a,h),"center","center")),s(h-A/2,u-d/2)&&(p=!0,c.push({y:h-A/2,x1:o<a?o-m/2-5:o+m/2+5,x2:a>o?a+f/2+5:a-f/2-5}),n.setPositionByOrigin(new vA.fabric.Point(a,h-A/2+d/2),"center","center")),s(h+A/2,u+d/2)&&(p=!0,c.push({y:h+A/2,x1:o<a?o-m/2-5:o+m/2+5,x2:a>o?a+f/2+5:a-f/2-5}),n.setPositionByOrigin(new vA.fabric.Point(a,h+A/2-d/2),"center","center"))}p||(c.length=0),g||(l.length=0)}})),e.on("before:render",(()=>{if(null!==e.contextTop)try{e.clearContext(e.contextTop)}catch(t){}})),e.on("after:render",(()=>{t.save(),t.beginPath(),t.lineWidth=n.defautOption.width,t.strokeStyle=n.defautOption.color;for(let t=l.length;t--;)a((e=l[t]).x+.5,e.y1>e.y2?e.y2:e.y1,e.x+.5,e.y2>e.y1?e.y2:e.y1);var e;for(let t=c.length;t--;)o(c[t]);t.stroke(),t.restore(),l.length=0,c.length=0})),e.on("mouse:up",(()=>{l.length=0,c.length=0,e.renderAll()}))}destroy(){}}u(Py,"pluginName","AlignGuidLinePlugin");const jy="data:image/svg+xml,%3csvg%20width='19'%20height='18'%20viewBox='0%200%2019%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d)'%3e%3ccircle%20cx='9.99609'%20cy='9'%20r='5'%20fill='white'/%3e%3ccircle%20cx='9.99609'%20cy='9'%20r='4.75'%20stroke='black'%20stroke-opacity='0.3'%20stroke-width='0.5'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0.996094'%20y='0'%20width='18'%20height='18'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.137674%200%200%200%200%200.190937%200%200%200%200%200.270833%200%200%200%200.15%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e";function Ry(e,t,n,i,r,o,a){void 0!==a&&(e.save(),e.translate(t,n),e.rotate(vA.fabric.util.degreesToRadians(a)),e.drawImage(i,-r/2,-o/2,r,o),e.restore())}vA.fabric.Object.NUM_FRACTION_DIGITS=4;class Fy{constructor(e,t){this.canvas=e,this.editor=t,this.init()}init(){!function(){const e=document.createElement("img");function t(t,n,i,r,o){Ry(t,n,i,e,25,25,o.angle)}e.src=jy,vA.fabric.Object.prototype.controls.tl=new vA.fabric.Control({x:-.5,y:-.5,cursorStyleHandler:vA.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingEqually,render:t}),vA.fabric.Object.prototype.controls.bl=new vA.fabric.Control({x:-.5,y:.5,cursorStyleHandler:vA.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingEqually,render:t}),vA.fabric.Object.prototype.controls.tr=new vA.fabric.Control({x:.5,y:-.5,cursorStyleHandler:vA.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingEqually,render:t}),vA.fabric.Object.prototype.controls.br=new vA.fabric.Control({x:.5,y:.5,cursorStyleHandler:vA.fabric.controlsUtils.scaleCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingEqually,render:t})}(),function(){const e=document.createElement("img");e.src="data:image/svg+xml,%3csvg%20width='12'%20height='24'%20viewBox='0%200%2012%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d)'%3e%3crect%20x='4'%20y='4'%20width='4'%20height='16'%20rx='2'%20fill='white'/%3e%3crect%20x='4.25'%20y='4.25'%20width='3.5'%20height='15.5'%20rx='1.75'%20stroke='black'%20stroke-opacity='0.3'%20stroke-width='0.5'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0'%20y='0'%20width='12'%20height='24'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.137674%200%200%200%200%200.190937%200%200%200%200%200.270833%200%200%200%200.15%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e";const t=document.createElement("img");function n(t,n,i,r,o){Ry(t,n,i,e,20,25,o.angle)}function i(e,n,i,r,o){Ry(e,n,i,t,25,20,o.angle)}t.src="data:image/svg+xml,%3csvg%20width='24'%20height='12'%20viewBox='0%200%2024%2012'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d)'%3e%3crect%20x='20'%20y='4'%20width='4'%20height='16'%20rx='2'%20transform='rotate(90%2020%204)'%20fill='white'/%3e%3crect%20x='19.75'%20y='4.25'%20width='3.5'%20height='15.5'%20rx='1.75'%20transform='rotate(90%2019.75%204.25)'%20stroke='black'%20stroke-opacity='0.3'%20stroke-width='0.5'/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0'%20y='0'%20width='24'%20height='12'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.137674%200%200%200%200%200.190937%200%200%200%200%200.270833%200%200%200%200.15%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",vA.fabric.Object.prototype.controls.ml=new vA.fabric.Control({x:-.5,y:0,offsetX:-1,cursorStyleHandler:vA.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingXOrSkewingY,getActionName:vA.fabric.controlsUtils.scaleOrSkewActionName,render:n}),vA.fabric.Object.prototype.controls.mr=new vA.fabric.Control({x:.5,y:0,offsetX:1,cursorStyleHandler:vA.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingXOrSkewingY,getActionName:vA.fabric.controlsUtils.scaleOrSkewActionName,render:n}),vA.fabric.Object.prototype.controls.mb=new vA.fabric.Control({x:0,y:.5,offsetY:1,cursorStyleHandler:vA.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingYOrSkewingX,getActionName:vA.fabric.controlsUtils.scaleOrSkewActionName,render:i}),vA.fabric.Object.prototype.controls.mt=new vA.fabric.Control({x:0,y:-.5,offsetY:-1,cursorStyleHandler:vA.fabric.controlsUtils.scaleSkewCursorStyleHandler,actionHandler:vA.fabric.controlsUtils.scalingYOrSkewingX,getActionName:vA.fabric.controlsUtils.scaleOrSkewActionName,render:i})}(),function(){const e=document.createElement("img");e.src="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20filter='url(%23filter0_d)'%3e%3ccircle%20cx='9'%20cy='9'%20r='5'%20fill='white'/%3e%3ccircle%20cx='9'%20cy='9'%20r='4.75'%20stroke='black'%20stroke-opacity='0.3'%20stroke-width='0.5'/%3e%3c/g%3e%3cpath%20d='M10.8047%2011.1242L9.49934%2011.1242L9.49934%209.81885'%20stroke='black'%20stroke-width='0.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M6.94856%206.72607L8.25391%206.72607L8.25391%208.03142'%20stroke='black'%20stroke-width='0.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M9.69517%206.92267C10.007%207.03301%2010.2858%207.22054%2010.5055%207.46776C10.7252%207.71497%2010.8787%208.01382%2010.9517%208.33642C11.0247%208.65902%2011.0148%208.99485%2010.9229%209.31258C10.831%209.63031%2010.6601%209.91958%2010.4262%2010.1534L9.49701%2011.0421M8.25792%206.72607L7.30937%207.73554C7.07543%207.96936%206.90454%208.25863%206.81264%208.57636C6.72073%208.89408%206.71081%209.22992%206.78381%209.55251C6.8568%209.87511%207.01032%2010.174%207.23005%2010.4212C7.44978%2010.6684%207.72855%2010.8559%208.04036%2010.9663'%20stroke='black'%20stroke-width='0.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cdefs%3e%3cfilter%20id='filter0_d'%20x='0'%20y='0'%20width='18'%20height='18'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'/%3e%3cfeOffset/%3e%3cfeGaussianBlur%20stdDeviation='2'/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200.137674%200%200%200%200%200.190937%200%200%200%200%200.270833%200%200%200%200.15%200'/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow'/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow'%20result='shape'/%3e%3c/filter%3e%3c/defs%3e%3c/svg%3e",vA.fabric.Object.prototype.controls.mtr=new vA.fabric.Control({x:0,y:.5,cursorStyleHandler:vA.fabric.controlsUtils.rotationStyleHandler,actionHandler:vA.fabric.controlsUtils.rotationWithSnapping,offsetY:30,actionName:"rotate",render:function(t,n,i,r,o){Ry(t,n,i,e,40,40,o.angle)}})}(),vA.fabric.Object.prototype.set({transparentCorners:!1,borderColor:"#51B9F9",cornerColor:"#FFF",borderScaleFactor:2.5,cornerStyle:"circle",cornerStrokeColor:"#0E98FC",borderOpacityWhenMoving:1})}destroy(){}}u(Fy,"pluginName","ControlsPlugin");class Ny{constructor(e,t){this.canvas=e,this.editor=t}center(e,t){const n=e.getCenterPoint();return this.canvas._centerObject(t,n)}centerV(e,t){return this.canvas._centerObject(t,new vA.fabric.Point(t.getCenterPoint().x,e.getCenterPoint().y))}centerH(e,t){return this.canvas._centerObject(t,new vA.fabric.Point(e.getCenterPoint().x,t.getCenterPoint().y))}position(e){const t=this.canvas.getActiveObject();if(["centerH","center","centerV"].includes(e)&&t){const n=this.canvas.getObjects().find((e=>"workspace"===e.id));n&&this[e](n,t),this.canvas.renderAll()}}contextMenu(){if(this.canvas.getActiveObject())return[{text:"水平垂直居中",hotkey:"",disabled:!1,onclick:()=>this.position("center")}]}destroy(){}}u(Ny,"pluginName","CenterAlignPlugin"),u(Ny,"apis",["centerH","center","position","centerV"]);class Vy{constructor(e,t){this.canvas=e,this.editor=t}_getWorkspace(){return this.canvas.getObjects().find((e=>"workspace"===e.id))}_workspaceSendToBack(){const e=this._getWorkspace();e&&e.sendToBack()}up(){const e=this.canvas.getActiveObjects();if(e&&1===e.length){const e=this.canvas.getActiveObjects()[0];e&&e.bringForward(),this.canvas.renderAll(),this._workspaceSendToBack()}}down(){const e=this.canvas.getActiveObjects();if(e&&1===e.length){const e=this.canvas.getActiveObjects()[0];e&&e.sendBackwards(),this.canvas.renderAll(),this._workspaceSendToBack()}}toFront(){const e=this.canvas.getActiveObjects();if(e&&1===e.length){const e=this.canvas.getActiveObjects()[0];e&&e.bringToFront(),this.canvas.renderAll(),this._workspaceSendToBack()}}toBack(){const e=this.canvas.getActiveObjects();if(e&&1===e.length){const e=this.canvas.getActiveObjects()[0];e&&e.sendToBack(),this.canvas.renderAll(),this._workspaceSendToBack()}}contextMenu(){if(this.canvas.getActiveObject())return[{text:"图层管理",hotkey:"❯",subitems:[{text:"上一个",hotkey:"",onclick:()=>this.up()},{text:"下一个",hotkey:"",onclick:()=>this.down()},{text:"置顶",hotkey:"",onclick:()=>this.toFront()},{text:"置底",hotkey:"",onclick:()=>this.toBack()}]}]}destroy(){}}u(Vy,"pluginName","LayerPlugin"),u(Vy,"apis",["up","down","toFront","toBack"]);class Uy{constructor(e,t){u(this,"hotkeys",["ctrl+v","ctrl+c"]),u(this,"cache",null),this.canvas=e,this.editor=t,this.initPaste()}_copyActiveSelection(e){const t=this.canvas,n=this.editor.getExtensionKey();null==e||e.clone((e=>{e.clone((e=>{t.discardActiveObject(),void 0!==e.left&&void 0!==e.top&&(e.canvas=t,e.set({left:e.left+10,top:e.top+10,evented:!0,id:hm()}),e.forEachObject((e=>{e.id=hm(),t.add(e)})),e.setCoords(),t.setActiveObject(e),t.requestRenderAll())}))}),n)}_copyObject(e){const t=this.canvas,n=this.editor.getExtensionKey();null==e||e.clone((e=>{void 0!==e.left&&void 0!==e.top&&(t.discardActiveObject(),e.set({left:e.left+10,top:e.top+10,evented:!0,id:hm()}),t.add(e),t.setActiveObject(e),t.requestRenderAll())}),n)}clone(e){const t=e||this.canvas.getActiveObject();t&&("activeSelection"===(null==t?void 0:t.type)?this._copyActiveSelection(t):this._copyObject(t))}hotkeyEvent(e,t){if("ctrl+c"===e&&"keydown"===t.type){const e=this.canvas.getActiveObject();this.cache=e,navigator.clipboard.writeText("")}"ctrl+v"===e&&"keydown"===t.type&&setTimeout((()=>{this.cache&&this.clone(this.cache)}),0)}contextMenu(){if(this.canvas.getActiveObject())return[{text:"复制",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.clone()}]}destroy(){window.removeEventListener("paste",(e=>this.pasteListener(e)))}initPaste(){window.addEventListener("paste",(e=>this.pasteListener(e)))}pasteListener(e){return h(this,null,(function*(){const t=this.canvas;if(document.activeElement!==document.body)return;e.preventDefault();const n=(e.clipboardData||e.originalEvent.clipboardData).items;for(const e of n)if("file"===e.kind){const n=e.getAsFile(),i=n.name.split(".").pop();if(!".pdf,.psd,.cdr,.ai,.svg,.jpg,.jpeg,.png,.webp,.json".split(",").includes(`.${i}`))return;if("svg"===i){const e=yield Fm(n);if(!e)throw new Error("file is undefined");vA.fabric.loadSVGFromURL(e,((e,n)=>{const i=vA.fabric.util.groupSVGElements(e,c(l({},n),{name:"defaultSVG",id:hm()}));t.add(i).centerObject(i).renderAll()}))}if(0===e.type.indexOf("image/")){const e=URL.createObjectURL(n),i=document.createElement("img");i.src=e,document.body.appendChild(i),i.onload=()=>{const e=new vA.fabric.Image(i,{id:hm(),name:"图片1",left:100,top:100});t.add(e),t.setActiveObject(e),t.renderAll(),i.remove()}}}else"string"===e.kind&&0===e.type.indexOf("text/plain")&&e.getAsString((e=>{const n=t.getActiveObject();if(n&&("textbox"===n.type||"i-text"===n.type)&&n.text){const i=n.selectionStart,r=n.text.substring(0,i),o=n.text.substring(i);n.set("text",r+e+o),n.selectionStart=i+e.length,n.selectionEnd=i+e.length,n.dirty=!0,t.renderAll()}else{const n=new vA.fabric.IText(e,{left:100,top:100,fontSize:80,id:hm()});t.add(n),t.setActiveObject(n)}}));n.length&&(this.cache=null)}))}}u(Uy,"pluginName","CopyPlugin"),u(Uy,"apis",["clone"]);class zy{constructor(e,t){u(this,"hotkeys",["left","right","down","up"]),this.canvas=e,this.editor=t}hotkeyEvent(e,t){if("keydown"===t.type){const{canvas:t}=this,n=t.getActiveObject();if(!n)return;switch(e){case"left":if(void 0===n.left)return;n.set("left",n.left-1);break;case"right":if(void 0===n.left)return;n.set("left",n.left+1);break;case"down":if(void 0===n.top)return;n.set("top",n.top+1);break;case"up":if(void 0===n.top)return;n.set("top",n.top-1)}t.renderAll()}}destroy(){}}u(zy,"pluginName","MoveHotKeyPlugin");class Hy{constructor(e,t){u(this,"hotkeys",["backspace"]),this.canvas=e,this.editor=t}hotkeyEvent(e,t){"keydown"===t.type&&"backspace"===e&&this.del()}del(){const{canvas:e}=this,t=e.getActiveObjects();t&&(t.map((t=>e.remove(t))),e.requestRenderAll(),e.discardActiveObject())}contextMenu(){if(this.canvas.getActiveObject())return[null,{text:"删除",hotkey:"Backspace",disabled:!1,onclick:()=>this.del()}]}destroy(){}}u(Hy,"pluginName","DeleteHotKeyPlugin"),u(Hy,"apis",["del"]);class Yy{constructor(e,t){this.canvas=e,this.editor=t}unGroup(){const e=this.canvas.getActiveObject();if(!e)return;const t=e.getObjects();e.toActiveSelection();for(const n of t)n.set("id",hm());this.canvas.discardActiveObject().renderAll()}group(){const e=this.canvas.getActiveObject();if(!e)return;const t=e.toGroup(),n=t.getObjects();t.clone((e=>{e.set("id",hm()),this.canvas.remove(t),n.forEach((e=>{this.canvas.remove(e)})),this.canvas.add(e),this.canvas.setActiveObject(e)}))}contextMenu(){const e=this.canvas.getActiveObject();return Ym(e)?[{text:"组合",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.group()}]:Hm(e)?[{text:"拆分组合",hotkey:"Ctrl+V",disabled:!1,onclick:()=>this.unGroup()}]:void 0}destroy(){}}u(Yy,"pluginName","GroupPlugin"),u(Yy,"apis",["unGroup","group"]),vA.fabric.Arrow=vA.fabric.util.createClass(vA.fabric.Line,{type:"arrow",superType:"drawing",initialize(e,t){if(!e){const{x1:n,x2:i,y1:r,y2:o}=t;e=[n,r,i,o]}t=t||{},this.callSuper("initialize",e,t)},_render(e){this.callSuper("_render",e),e.save(),e.scale(1/this.scaleX,1/this.scaleY);const t=(this.x2-this.x1)*this.scaleX,n=(this.y2-this.y1)*this.scaleY,i=Math.atan2(n,t);e.translate((this.x2-this.x1)/2*this.scaleX,(this.y2-this.y1)/2*this.scaleY),e.rotate(i),e.beginPath(),e.moveTo(5,0),e.lineTo(-5,5),e.lineTo(-5,-5),e.closePath(),e.lineWidth=this.lineWidth,e.strokeStyle=this.stroke,e.fillStyle=this.fill,e.stroke(),e.fill(),e.restore()}}),vA.fabric.Arrow.fromObject=(e,t)=>{const{x1:n,x2:i,y1:r,y2:o}=e;return t(new vA.fabric.Arrow([n,r,i,o],e))};const Gy=vA.fabric.Arrow;vA.fabric.ThinTailArrow=vA.fabric.util.createClass(vA.fabric.Line,{type:"thinTailArrow",superType:"drawing",initialize(e,t){if(!e){const{x1:n,x2:i,y1:r,y2:o}=t;e=[n,r,i,o]}t=t||{},this.callSuper("initialize",e,t)},_render(e){e.save(),e.scale(1/this.scaleX,1/this.scaleY);const t=(this.x2-this.x1)*this.scaleX,n=(this.y2-this.y1)*this.scaleY;e.translate(-t/2,-n/2);const i=Math.atan2(n,t);e.rotate(i);let r=Math.hypot(t,n);r=r<20?20:r,e.beginPath(),e.moveTo(0,0),e.lineTo(r-18,-5),e.lineTo(r-20,-12),e.lineTo(r,0),e.lineTo(r-20,12),e.lineTo(r-18,5),e.lineTo(0,0),e.lineWidth=this.strokeWidth,e.strokeStyle=this.stroke,e.fillStyle=this.fill,e.stroke(),e.fill(),e.restore()}}),vA.fabric.ThinTailArrow.fromObject=(e,t)=>{const{x1:n,x2:i,y1:r,y2:o}=e;return t(new vA.fabric.ThinTailArrow([n,r,i,o],e))};const Wy=vA.fabric.ThinTailArrow;class Xy{constructor(e,t){u(this,"isDrawingLineMode"),u(this,"lineType"),u(this,"lineToDraw"),u(this,"pointer"),u(this,"pointerPoints"),u(this,"isDrawingLine"),this.canvas=e,this.editor=t,this.isDrawingLine=!1,this.isDrawingLineMode=!1,this.lineType="",this.lineToDraw=null,this.pointer=null,this.pointerPoints=null,this.init()}init(){const{canvas:e}=this;e.on("mouse:down",(t=>{if(!this.isDrawingLineMode)return;let n;e.discardActiveObject(),e.getObjects().forEach((e=>{e.selectable=!1,e.hasControls=!1})),e.requestRenderAll(),this.isDrawingLine=!0,this.pointer=e.getPointer(t.e),this.pointerPoints=[this.pointer.x,this.pointer.y,this.pointer.x,this.pointer.y];let i={strokeWidth:2,stroke:"#000000",id:hm()};switch(this.lineType){case"line":n=vA.fabric.Line;break;case"arrow":n=Gy;break;case"thinTailArrow":n=Wy,i={strokeWidth:2,stroke:"#ff0000",fill:"#ff0000",id:hm()}}if(!n)throw new Error("Draw failed: invalid lineType.");this.lineToDraw=new n(this.pointerPoints,i),this.lineToDraw.selectable=!1,this.lineToDraw.evented=!1,this.lineToDraw.strokeUniform=!0,e.add(this.lineToDraw)})),e.on("mouse:move",(t=>{if(!this.isDrawingLine||!["line","arrow","thinTailArrow"].includes(this.lineType))return;e.discardActiveObject();if(!e.getActiveObject()){if(this.pointer=e.getPointer(t.e),t.e.shiftKey){const e=this.pointerPoints[0],t=this.pointerPoints[1],n=this.pointer.x-e,i=this.pointer.y-t,r=Math.sqrt(n*n+i*i);let o=Math.atan2(i,n)/Math.PI*180;o=15*~~((o+7.5)%360/15);const a=r*Math.cos(o*Math.PI/180),s=r*Math.sin(o*Math.PI/180);this.lineToDraw.set({x2:a+e,y2:s+t})}else this.lineToDraw.set({x2:this.pointer.x,y2:this.pointer.y});e.renderAll()}})),e.on("mouse:up",(()=>{this.isDrawingLine&&(this.lineToDraw.setCoords(),this.isDrawingLine=!1,e.discardActiveObject())}))}setLineType(e){this.lineType=e}setMode(e){this.isDrawingLineMode=e,this.isDrawingLineMode||this.endRest()}endRest(){this.canvas.getObjects().forEach((e=>{"workspace"!==e.id&&(e.selectable=!0,e.hasControls=!0)}))}destroy(){}}u(Xy,"pluginName","DrawLinePlugin"),u(Xy,"apis",["setLineType","setMode"]);class $y{constructor(e,t){u(this,"isDown",!1),this.canvas=e,this.editor=t,this._init()}_init(){this.canvas.on("mouse:down",(e=>{this.isDown=!0,!e.target||e.target.lockMovementX||e.target.lockMovementY||e.target.lockRotation||e.target.lockScalingX||e.target.lockScalingY||(e.target.hasControls=!0)})),this.canvas.on("mouse:up",(()=>{this.isDown=!1})),this.canvas.on("mouse:dblclick",(e=>{if(Hm(e.target)){const t=this._getGroupObj(e);if(!t)return;if(t.selectable=!0,t.hasControls&&(t.hasControls=!1),this.isText(t))return void this._bedingTextEditingEvent(t,e.target);this.canvas.setActiveObject(t),this.canvas.renderAll()}}))}_getGroupTextObj(e){const t=this.canvas.getPointer(e.e,!0);if(!Hm(e.target))return!1;const n=this.canvas._searchPossibleTargets(e.target._objects,t);return!(!n||!this.isText(n))&&n}_getGroupObj(e){const t=this.canvas.getPointer(e.e,!0);if(!Hm(e.target))return!1;return this.canvas._searchPossibleTargets(e.target._objects,t)}_bedingTextEditingEvent(e,t){var n,i,r,o,a;const s=e.toObject(),u=t.calcTransformMatrix(),h=u[0],d=u[1],f=u[2],p=u[3],g=u[4],v=u[5],A=h*(null!=(n=e.left)?n:0)+f*(null!=(i=e.top)?i:0)+g,m=d*(null!=(r=e.left)?r:0)+p*(null!=(o=e.top)?o:0)+v,y=new e.constructor(null!=(a=e.text)?a:"",c(l({},s),{scaleX:s.scaleX*h,scaleY:s.scaleY*h,textAlign:e.textAlign,left:A,top:m,styles:e.styles,groupCopyed:e.group}));y.id=hm(),e.visible=!1,t.addWithUpdate(),y.visible=!0,y.selectable=!0,y.hasControls=!1,y.editable=!0,this.canvas.add(y),this.canvas.setActiveObject(y),y.enterEditing(),y.selectAll(),y.on("editing:exited",(()=>{const n=y.toObject();e.set(c(l({},Ae(n,["fill","fontSize","fontStyle","fontFamily","lineHeight","backgroundColor"])),{text:y.text,visible:!0})),t.addWithUpdate(),y.visible=!1,this.canvas.remove(y),this.canvas.setActiveObject(t)}))}_bedingEditingEvent(e,t){if(!t.target)return;const n=t.target.left,i=t.target.top,r=this._unGroup()||[],o=()=>{const t=this.canvas.getObjects().filter((e=>e.id&&r.includes(e.id)));t.forEach((e=>this.canvas.remove(e)));const a=new vA.fabric.Group([...t]);a.set("left",n),a.set("top",i),a.set("id",hm()),e.off("editing:exited",o),this.canvas.add(a),this.canvas.discardActiveObject().renderAll()};e.on("editing:exited",o)}_unGroup(){const e=[],t=this.canvas.getActiveObject();if(t)return t.getObjects().forEach((t=>{const n=hm();e.push(n),t.set("id",n)})),t.toActiveSelection(),e}isText(e){return e.type&&["i-text","text","textbox"].includes(e.type)}destroy(){}}u($y,"pluginName","GroupTextEditorPlugin");class qy{constructor(e,t){this.canvas=e,this.editor=t}left(){const{canvas:e}=this,t=e.getActiveObject(),n=e.getActiveObjects();if(t){const{left:i=0}=t;e.discardActiveObject(),n.forEach((e=>{const t=e.getBoundingRect(!0);e.set({left:i-t.left+Number(e.left)}),e.setCoords()}));const r=new vA.fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(r),e.requestRenderAll()}}right(){const{canvas:e}=this,t=e.getActiveObject(),n=e.getActiveObjects();if(t){const{left:i=0,width:r=0}=t;e.discardActiveObject(),n.forEach((e=>{const t=e.getBoundingRect(!0);e.set({left:i+r-(t.left+t.width)+Number(e.left)})}));const o=new vA.fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(o),e.requestRenderAll()}}xcenter(){const{canvas:e}=this,t=e.getActiveObject(),n=e.getActiveObjects();if(t){const{left:i=0,width:r=0}=t;e.discardActiveObject(),n.forEach((e=>{const t=e.getBoundingRect(!0);e.set({left:i+r/2-(t.left+t.width/2)+Number(e.left)})}));const o=new vA.fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(o),e.requestRenderAll()}}ycenter(){const{canvas:e}=this,t=e.getActiveObject(),n=e.getActiveObjects();if(t){const{top:i=0,height:r=0}=t;e.discardActiveObject(),n.forEach((e=>{const t=e.getBoundingRect(!0);e.set({top:i+r/2-(t.top+t.height/2)+Number(e.top)})}));const o=new vA.fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(o),e.requestRenderAll()}}top(){const{canvas:e}=this,t=e.getActiveObject(),n=e.getActiveObjects();if(t){const{top:i=0}=t;e.discardActiveObject(),n.forEach((e=>{const t=e.getBoundingRect(!0);e.set({top:i-t.top+Number(e.top)})}));const r=new vA.fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(r),e.requestRenderAll()}}bottom(){const{canvas:e}=this,t=e.getActiveObject(),n=e.getActiveObjects();if(t){const{top:i=0,height:r=0}=t;e.discardActiveObject(),n.forEach((e=>{const t=e.getBoundingRect(!0);e.set({top:i+r-(t.top+t.height)+Number(e.top)})}));const o=new vA.fabric.ActiveSelection(n,{canvas:e});e.setActiveObject(o),e.requestRenderAll()}}xequation(){const{canvas:e}=this,t=e.getActiveObject();function n(e){let t=1/0,n=-1/0;for(const i in e.aCoords)e.aCoords[i].x<t&&(t=e.aCoords[i].x),e.aCoords[i].x>n&&(n=e.aCoords[i].x);return n-t}if(t&&"activeSelection"===t.type){t._objects.sort(((e,t)=>e.left-t.left));const e=function(){const e=function(){let e=0;return t&&t.forEachObject((t=>{e+=n(t)})),e}();if(t)return(Number(t.width)-e)/(t._objects.length-1)}(),i=Number(t.width)/2;t.forEachObject(((r,o)=>{const a=function(e){if(0===e)return 0;let i=0;if(t)for(let r=0;r<e;r++)i+=n(t._objects[r]);return i}(o),s=e*o+a-i;r.set("left",s)}))}const i=e.getActiveObjects();e.discardActiveObject(),i.forEach((e=>{let t=1/0;for(const n in e.aCoords)e.aCoords[n].x<t&&(t=e.aCoords[n].x);e.set("left",2*e.left-t)}));const r=new vA.fabric.ActiveSelection(i,{canvas:e});e.setActiveObject(r),e.requestRenderAll()}yequation(){const{canvas:e}=this,t=e.getActiveObject()||{top:0,height:0};function n(e){let t=1/0,n=-1/0;for(const i in e.aCoords)e.aCoords[i].y<t&&(t=e.aCoords[i].y),e.aCoords[i].y>n&&(n=e.aCoords[i].y);return n-t}if(t&&"activeSelection"===t.type){t._objects.sort(((e,t)=>e.top-t.top));const e=function(){const e=function(){let e=0;return t.forEachObject((t=>{e+=n(t)})),e}();return(t.height-e)/(t._objects.length-1)}(),i=Number(t.height)/2;t.forEachObject(((r,o)=>{const a=function(e){if(0===e)return 0;let i=0;for(let r=0;r<e;r++)i+=n(t._objects[r]);return i}(o),s=e*o+a-i;r.set("top",s)}))}const i=e.getActiveObjects();e.discardActiveObject(),i.forEach((e=>{let t=1/0;for(const n in e.aCoords)e.aCoords[n].y<t&&(t=e.aCoords[n].y);e.set("top",2*e.top-t)}));const r=new vA.fabric.ActiveSelection(i,{canvas:e});e.setActiveObject(r),e.requestRenderAll()}destroy(){}}u(qy,"pluginName","GroupAlignPlugin"),u(qy,"apis",["left","right","xcenter","ycenter","top","bottom","xequation","yequation"]);class Ky{constructor(e,t){u(this,"workspaceEl"),u(this,"workspace"),u(this,"resizeObserver"),u(this,"option"),u(this,"zoomRatio"),this.canvas=e,this.editor=t,this.workspace=null,this.init({width:900,height:2e3}),this.zoomRatio=.85}init(e){const t=document.querySelector("#workspace");if(!t)throw new Error("element #workspace is missing, plz check!");this.workspaceEl=t,this.workspace=null,this.option=e,this._initBackground(),this._initWorkspace(),this._initResizeObserve(),this._bindWheel()}hookImportAfter(){return new Promise((e=>{const t=this.canvas.getObjects().find((e=>"workspace"===e.id));t&&(t.set("selectable",!1),t.set("hasControls",!1),t.set("evented",!1),t.width&&t.height&&(this.setSize(t.width,t.height),this.editor.emit("sizeChange",t.width,t.height))),e("")}))}hookSaveAfter(){return new Promise((e=>{this.auto(),e(!0)}))}_initBackground(){this.canvas.backgroundImage="",this.canvas.setBackgroundColor("#ffffff",this.canvas.renderAll.bind(this.canvas)),this.canvas.setWidth(this.workspaceEl.offsetWidth),this.canvas.setHeight(this.workspaceEl.offsetHeight)}_initWorkspace(){const{width:e,height:t}=this.option,n=new vA.fabric.Rect({fill:"transparent",width:e,height:t,id:"workspace",strokeWidth:0});n.set("selectable",!1),n.set("hasControls",!1),n.hoverCursor="default",this.canvas.add(n),this.canvas.renderAll(),this.workspace=n,this.canvas.clearHistory&&this.canvas.clearHistory(),this.auto()}getWorkspase(){return this.canvas.getObjects().find((e=>"workspace"===e.id))}setCenterFromObject(e){const{canvas:t}=this,n=e.getCenterPoint(),i=t.viewportTransform;void 0!==t.width&&void 0!==t.height&&i&&(i[4]=t.width/2-n.x*i[0],i[5]=t.height/2-n.y*i[3],t.setViewportTransform(i),t.renderAll())}getWorkspaceSize(){return this.option}_initResizeObserve(){const e=new ResizeObserver(ce((()=>{this.auto()}),50));this.resizeObserver=e,this.resizeObserver.observe(this.workspaceEl)}setSize(e,t){this._initBackground(),this.option.width=e,this.option.height=t,this.workspace=this.canvas.getObjects().find((e=>"workspace"===e.id)),this.workspace.set("width",e),this.workspace.set("height",t),this.editor.emit("sizeChange",this.workspace.width,this.workspace.height),this.auto()}setZoomAuto(e,t){const{workspaceEl:n}=this,i=n.offsetWidth,r=n.offsetHeight;this.canvas.setWidth(i),this.canvas.setHeight(r);const o=this.canvas.getCenter();this.canvas.setViewportTransform(vA.fabric.iMatrix.concat()),this.canvas.zoomToPoint(new vA.fabric.Point(o.left,o.top),e),this.workspace&&(this.setCenterFromObject(this.workspace),this.workspace.clone((e=>{this.canvas.clipPath=e,this.canvas.requestRenderAll()})),t&&t(this.workspace.left,this.workspace.top))}getScale(){return vA.fabric.util.findScaleToFit(this.getWorkspase(),{width:this.workspaceEl.offsetWidth,height:this.workspaceEl.offsetHeight})}big(){let e=this.canvas.getZoom();e+=.05;const t=this.canvas.getCenter();this.canvas.zoomToPoint(new vA.fabric.Point(t.left,t.top),e)}small(){let e=this.canvas.getZoom();e-=.05;const t=this.canvas.getCenter();this.canvas.zoomToPoint(new vA.fabric.Point(t.left,t.top),e<0?.01:e)}auto(){const e=this.getScale();this.setZoomAuto(e*this.zoomRatio)}one(){this.setZoomAuto(1*this.zoomRatio),this.canvas.requestRenderAll()}setWorkspaseBg(e){const t=this.getWorkspase();null==t||t.set("fill",e)}_bindWheel(){this.canvas.on("mouse:wheel",(function(e){const t=e.e.deltaY;let n=this.getZoom();n*=a(.999,t),n>20&&(n=20),n<.01&&(n=.01);const i=this.getCenter();this.zoomToPoint(new vA.fabric.Point(i.left,i.top),n),e.e.preventDefault(),e.e.stopPropagation()}))}destroy(){this.resizeObserver.disconnect(),this.canvas.off()}}u(Ky,"pluginName","WorkspacePlugin"),u(Ky,"events",["sizeChange"]),u(Ky,"apis",["big","small","auto","one","setSize","getWorkspase","setWorkspaseBg","setCenterFromObject","getScale","getWorkspaceSize"]),vA.fabric.Canvas.prototype.initialize=function(e){return function(...t){return e.call(this,...t),this._historyInit(),this}}(vA.fabric.Canvas.prototype.initialize),vA.fabric.Canvas.prototype.dispose=function(e){return function(...t){return e.call(this,...t),this._historyDispose(),this}}(vA.fabric.Canvas.prototype.dispose),vA.fabric.Canvas.prototype._historyNext=function(){return JSON.stringify(this.toDatalessJSON(this.extraProps))},vA.fabric.Canvas.prototype._historyEvents=function(){return{"object:added":e=>this._historySaveAction(e),"object:removed":e=>this._historySaveAction(e),"object:modified":e=>this._historySaveAction(e),"object:skewing":e=>this._historySaveAction(e)}},vA.fabric.Canvas.prototype._historyInit=function(){this.historyStack=[],this.historyIndex=0,this.historyMaxLength=100,this.extraProps=["id","gradientAngle","selectable","hasControls","linkData","editable","extensionType","extension"],this.historyNextState=this._historyNext(),this.isLatestHistoryState=!0,this.isLoadingHistory=!1,this.on(this._historyEvents())},vA.fabric.Canvas.prototype._historyDispose=function(){this.off(this._historyEvents())},vA.fabric.Canvas.prototype._historySaveAction=function(e){if(!this.historyProcessing&&(!e||e.target&&!e.target.excludeFromExport)){const e=this._historyNext();!this.isLatestHistoryState&&(this.isLatestHistoryState=!0)&&this.historyIndex<this.historyMaxLength&&this.historyIndex++,this.historyStack.length>this.historyIndex&&this.historyStack.splice(this.historyIndex),this.historyIndex>=this.historyMaxLength&&this.historyStack.shift(),this.historyIndex<this.historyMaxLength&&this.historyIndex++,this.historyStack.push(e),this.historyNextState=this._historyNext(),this.fire("history:append",{json:e})}},vA.fabric.Canvas.prototype.undo=function(e){if(this.isLoadingHistory)return;if(this.historyIndex<=0)return;this.historyProcessing=!0,this.isLatestHistoryState&&this.historyIndex--&&(this.isLatestHistoryState=!1);const t=this.historyStack[--this.historyIndex];t?(this.historyNextState=t,this._loadHistory(t,"history:undo",e)):(this.historyIndex<0&&(this.historyIndex=0),this.historyProcessing=!1)},vA.fabric.Canvas.prototype.redo=function(e){if(this.isLoadingHistory)return;if(this.historyIndex>=this.historyStack.length)return;this.historyProcessing=!0,!this.isLatestHistoryState&&++this.historyIndex&&(this.isLatestHistoryState=!0);const t=this.historyStack[this.historyIndex];t?(this.historyNextState=t,this._loadHistory(t,"history:redo",e),this.historyIndex++):this.historyProcessing=!1},vA.fabric.Canvas.prototype._loadHistory=function(e,t,n){var i;this.isLoadingHistory=!0;var r=this;const o=null==(i=e.objects)?void 0:i.find((e=>"workspace"===e.id));o&&(o.evented=!1),this.loadFromJSON(e,(function(){r.renderAll(),r.fire(t),r.historyProcessing=!1,r.isLoadingHistory=!1,n&&"function"==typeof n&&n()}))},vA.fabric.Canvas.prototype.clearHistory=function(e){const t=this.historyStack.pop();e&&t?(this.historyStack=[t],this.historyIndex=1,this.fire("history:clear")):(this.historyStack=[],this.historyIndex=0,this.fire("history:clear")),this.isLatestHistoryState=!0},vA.fabric.Canvas.prototype.clearUndo=function(){this.historyStack.splice(this.historyIndex)},vA.fabric.Canvas.prototype.refreshHistory=function(){this.historyProcessing=!1,this.historyStack.splice(--this.historyIndex),this._historySaveAction()},vA.fabric.Canvas.prototype.onHistory=function(){this.historyProcessing=!1,this._historySaveAction()},vA.fabric.Canvas.prototype.canUndo=function(){return this.historyIndex>0},vA.fabric.Canvas.prototype.canRedo=function(){return this.historyStack.length>this.historyIndex},vA.fabric.Canvas.prototype.offHistory=function(){this.historyProcessing=!0};class Jy{constructor(e,t){u(this,"hotkeys",["ctrl+z","ctrl+shift+z","⌘+z","⌘+shift+z"]),this.canvas=e,this.editor=t,vA.fabric.Canvas.prototype._historyNext=()=>this.editor.getJson(),this._init()}_init(){this.canvas.on("history:append",(()=>{this.historyUpdate()})),window.addEventListener("beforeunload",(e=>{this.canvas.historyStack.length>0&&((e||window.event).returnValue="确认离开")}))}historyUpdate(){const{historyStack:e,historyIndex:t}=this.canvas;this.editor.emit("historyUpdate",t,e.length-t)}hookImportAfter(){return this.canvas.clearHistory(!0),this.historyUpdate(),Promise.resolve()}undo(){this.canvas.undo(),this.historyUpdate()}redo(){this.canvas.redo(),this.historyUpdate()}hotkeyEvent(e,t){if("keydown"===t.type)switch(e){case"ctrl+z":case"⌘+z":this.undo();break;case"ctrl+shift+z":case"⌘+shift+z":this.redo()}}}u(Jy,"pluginName","HistoryPlugin"),u(Jy,"apis",["undo","redo","historyUpdate"]),u(Jy,"events",[]);class Zy{constructor(e,t){this.canvas=e,this.editor=t}flip(e){const t=this.canvas.getActiveObject();t&&(t.set(`flip${e}`,!t[`flip${e}`]).setCoords(),this.canvas.requestRenderAll())}contextMenu(){if(this.editor.getSelectMode()===dm.ONE)return[{text:"翻转",hotkey:"❯",subitems:[{text:br.global.t("editor.flip.x"),hotkey:"|",onclick:()=>this.flip("X")},{text:br.global.t("editor.flip.y"),hotkey:"-",onclick:()=>this.flip("Y")}]}]}destroy(){}}u(Zy,"pluginName","FlipPlugin"),u(Zy,"apis",["flip"]);const eb=(e,t)=>{const n=t?"left":"top",i=t?"width":"height";e.sort(((e,t)=>e[n]-t[n]));const r=[];let o=Object.assign({},e[0]);for(const a of e){const e=Object.assign({},a);o[n]+o[i]>=e[n]?o[i]=Math.max(o[n]+o[i],e[n]+e[i])-o[n]:(r.push(o),o=Object.assign({},e))}return r.push(o),r},tb=(e,t)=>{e.save();const{left:n,top:i,width:r,height:o,stroke:a,lineWidth:s}=t;e.beginPath(),a&&(e.strokeStyle=a),e.lineWidth=null!=s?s:1,e.moveTo(n,i),e.lineTo(n+r,i+o),e.stroke(),e.restore()},nb=(e,t)=>{e.save();const{left:n,top:i,text:r,fill:o,align:a,angle:s,fontSize:l}=t;o&&(e.fillStyle=o),e.textAlign=null!=a?a:"left",e.textBaseline="top",e.font=`${null!=l?l:10}px sans-serif`,s&&(e.translate(n,i),e.rotate(Math.PI/180*s),e.translate(-n,-i)),e.fillText(r,n,i),e.restore()},ib=(e,t)=>{e.save();const{left:n,top:i,width:r,height:o,fill:a,stroke:s,strokeWidth:l}=t;e.beginPath(),a&&(e.fillStyle=a),e.rect(n,i,r,o),e.fill(),s&&(e.strokeStyle=s,e.lineWidth=null!=l?l:1,e.stroke()),e.restore()},rb=(e,t)=>{e.save();const{isHorizontal:n,left:i,top:r,width:o,height:a,backgroundColor:s}=t,l=n?e.createLinearGradient(i,a/2,i+o,a/2):e.createLinearGradient(o/2,r,o/2,a+r),c=new vA.fabric.Color(s);c.setAlpha(0),l.addColorStop(0,c.toRgba()),l.addColorStop(.33,s),l.addColorStop(.67,s),l.addColorStop(1,c.toRgba()),ib(e,{left:i,top:r,width:o,height:a,fill:l}),e.restore()};vA.fabric.GuideLine;class ob{constructor(e){u(this,"ctx"),u(this,"options"),u(this,"startCalibration"),u(this,"activeOn","up"),u(this,"objectRect"),u(this,"eventHandler",{calcObjectRect:ce(this.calcObjectRect.bind(this),15),clearStatus:this.clearStatus.bind(this),canvasMouseDown:this.canvasMouseDown.bind(this),canvasMouseMove:ce(this.canvasMouseMove.bind(this),15),canvasMouseUp:this.canvasMouseUp.bind(this),render:e=>{e.ctx&&this.render()}}),u(this,"lastAttr",{status:"out",cursor:void 0,selection:void 0}),u(this,"tempGuidelLine"),u(this,"getCommonEventInfo",(e=>{if(this.tempGuidelLine&&e.absolutePointer)return{e:e.e,transform:this.tempGuidelLine.get("transform"),pointer:{x:e.absolutePointer.x,y:e.absolutePointer.y},target:this.tempGuidelLine}})),this.options=Object.assign({ruleSize:20,fontSize:10,enabled:!1,backgroundColor:"#fff",borderColor:"transparent",highlightColor:"#007fff",textColor:"#888"},e),this.ctx=this.options.canvas.getContext(),vA.fabric.util.object.extend(this.options.canvas,{ruler:this}),vA.fabric.GuideLine||(vA.fabric.GuideLine=vA.fabric.util.createClass(vA.fabric.Line,{type:"GuideLine",selectable:!1,hasControls:!1,hasBorders:!1,stroke:"#4bec13",originX:"center",originY:"center",padding:4,globalCompositeOperation:"difference",axis:"horizontal",initialize(e,t){const n="horizontal"===t.axis;this.hoverCursor=n?"ns-resize":"ew-resize";const i=n?[-999999,e,999999,e]:[e,-999999,e,999999];t[n?"lockMovementX":"lockMovementY"]=!0,this.callSuper("initialize",i,t),this.on("mousedown:before",(e=>{"down"===this.activeOn&&this.canvas&&this.canvas.setActiveObject(this,e.e)})),this.on("moving",(e=>{this.canvas&&this.canvas.ruler.options.enabled&&this.isPointOnRuler(e.e)?this.moveCursor="not-allowed":this.moveCursor=this.isHorizontal()?"ns-resize":"ew-resize",this.canvas&&this.canvas.fire("guideline:moving",{target:this,e:e.e})})),this.on("mouseup",(e=>{this.canvas&&this.canvas.ruler.options.enabled&&this.isPointOnRuler(e.e)?this.canvas.remove(this):(this.moveCursor=this.isHorizontal()?"ns-resize":"ew-resize",this.canvas&&this.canvas.fire("guideline:mouseup",{target:this,e:e.e}))})),this.on("removed",(()=>{this.off("removed"),this.off("mousedown:before"),this.off("moving"),this.off("mouseup")}))},getBoundingRect(e,t){this.bringToFront();const n=this.isHorizontal(),i=this.callSuper("getBoundingRect",e,t);return i[n?"top":"left"]+=i[n?"height":"width"]/2,i[n?"height":"width"]=0,i},isPointOnRuler(e){const t=this.isHorizontal(),n=this.canvas&&this.canvas.ruler.isPointOnRuler(new vA.fabric.Point(e.offsetX,e.offsetY));return!!(t&&"horizontal"===n||!t&&"vertical"===n)&&n},isHorizontal(){return 0===this.height}}),vA.fabric.GuideLine.fromObject=function(e,t){const n=(0,vA.fabric.util.object.clone)(e,!0),i=0===n.height;n.xy=i?n.y1:n.x1,n.axis=i?"horizontal":"vertical",vA.fabric.Object._fromObject(n.type,n,(function(e){delete e.xy,t&&t(e)}),"xy")}),this.options.enabled&&this.enable()}destroy(){this.disable()}clearGuideline(){this.options.canvas.remove(...this.options.canvas.getObjects(vA.fabric.GuideLine.prototype.type))}showGuideline(){this.options.canvas.getObjects(vA.fabric.GuideLine.prototype.type).forEach((e=>{e.set("visible",!0)})),this.options.canvas.renderAll()}hideGuideline(){this.options.canvas.getObjects(vA.fabric.GuideLine.prototype.type).forEach((e=>{e.set("visible",!1)})),this.options.canvas.renderAll()}enable(){this.options.enabled=!0,this.options.canvas.on("after:render",this.eventHandler.calcObjectRect),this.options.canvas.on("after:render",this.eventHandler.render),this.options.canvas.on("mouse:down",this.eventHandler.canvasMouseDown),this.options.canvas.on("mouse:move",this.eventHandler.canvasMouseMove),this.options.canvas.on("mouse:up",this.eventHandler.canvasMouseUp),this.options.canvas.on("selection:cleared",this.eventHandler.clearStatus),this.showGuideline(),this.render()}disable(){this.options.canvas.off("after:render",this.eventHandler.calcObjectRect),this.options.canvas.off("after:render",this.eventHandler.render),this.options.canvas.off("mouse:down",this.eventHandler.canvasMouseDown),this.options.canvas.off("mouse:move",this.eventHandler.canvasMouseMove),this.options.canvas.off("mouse:up",this.eventHandler.canvasMouseUp),this.options.canvas.off("selection:cleared",this.eventHandler.clearStatus),this.hideGuideline(),this.options.enabled=!1}render(){var e,t;const n=this.options.canvas.viewportTransform;n&&(this.draw({isHorizontal:!0,rulerLength:this.getSize().width,startCalibration:(null==(e=this.startCalibration)?void 0:e.x)?this.startCalibration.x:-n[4]/n[0]}),this.draw({isHorizontal:!1,rulerLength:this.getSize().height,startCalibration:(null==(t=this.startCalibration)?void 0:t.y)?this.startCalibration.y:-n[5]/n[3]}),rb(this.ctx,{isHorizontal:!0,left:-10,top:-10,width:2*this.options.ruleSize+10,height:this.options.ruleSize+10,backgroundColor:this.options.backgroundColor}),rb(this.ctx,{isHorizontal:!1,left:-10,top:-10,width:this.options.ruleSize+10,height:2*this.options.ruleSize+10,backgroundColor:this.options.backgroundColor}))}getSize(){var e,t;return{width:null!=(e=this.options.canvas.width)?e:0,height:null!=(t=this.options.canvas.height)?t:0}}getZoom(){return this.options.canvas.getZoom()}draw(e){const{isHorizontal:t,rulerLength:n,startCalibration:i}=e,r=this.getZoom(),o=(e=>{const t=[.02,.03,.05,.1,.2,.5,1,2,5,10,18];let n=0;for(;n<t.length&&t[n]<e;)n++;return[5e3,2500,1e3,500,250,100,50,25,10,5,2][n-1]||5e3})(r),a=n/r,s=Math[i>0?"floor":"ceil"](i/o)*o,u=s-i,h=this.getSize();ib(this.ctx,{left:0,top:0,width:t?h.width:this.options.ruleSize,height:t?this.options.ruleSize:h.height,fill:this.options.backgroundColor,stroke:this.options.borderColor});const d=new vA.fabric.Color(this.options.textColor);for(let l=0;l+u<=Math.ceil(a);l+=o){const e=(u+l)*r,n=s+l+"",i=10*n.length/4,o=t?e-i-1:this.options.ruleSize/2-this.options.fontSize/2-4,a=t?this.options.ruleSize/2-this.options.fontSize/2-4:e+i;nb(this.ctx,{text:n,left:o,top:a,fill:d.toRgb(),angle:t?0:-90})}for(let l=0;l+u<=Math.ceil(a);l+=o){const e=Math.round((u+l)*r),n=t?e:this.options.ruleSize-8,i=t?this.options.ruleSize-8:e,o=t?0:8,a=t?8:0;tb(this.ctx,{left:n,top:i,width:o,height:a,stroke:d.toRgb()})}if(this.objectRect){const e=t?"x":"y";this.objectRect[e].forEach((n=>{if(n.skip===e)return;const o=e=>Math.round(e/r+i)+"",a=o(t?n.left:n.top),s=o(t?n.left+n.width:n.top+n.height),u=a===s,h={isHorizontal:t,width:t?160:this.options.ruleSize-8,height:t?this.options.ruleSize-8:160,backgroundColor:this.options.backgroundColor};rb(this.ctx,c(l({},h),{left:t?n.left-80:0,top:t?0:n.top-80})),u||rb(this.ctx,c(l({},h),{left:t?n.width+n.left-80:0,top:t?0:n.height+n.top-80}));const d=new vA.fabric.Color(this.options.highlightColor);d.setAlpha(.5),ib(this.ctx,{left:t?n.left:this.options.ruleSize-8,top:t?this.options.ruleSize-8:n.top,width:t?n.width:8,height:t?8:n.height,fill:d.toRgba()});const f=this.options.ruleSize/2-this.options.fontSize/2-4,p={fill:d.toRgba(),angle:t?0:-90};nb(this.ctx,c(l({},p),{text:a,left:t?n.left-2:f,top:t?f:n.top-2,align:u?"center":t?"right":"left"})),u||nb(this.ctx,c(l({},p),{text:s,left:t?n.left+n.width+2:f,top:t?f:n.top+n.height+2,align:t?"left":"right"}));const g=u?8:14;d.setAlpha(1);const v={width:t?0:g,height:t?g:0,stroke:d.toRgba()};tb(this.ctx,c(l({},v),{left:t?n.left:this.options.ruleSize-g,top:t?this.options.ruleSize-g:n.top})),u||tb(this.ctx,c(l({},v),{left:t?n.left+n.width:this.options.ruleSize-g,top:t?this.options.ruleSize-g:n.top+n.height}))}))}}calcObjectRect(){const e=this.options.canvas.getActiveObjects();if(0===e.length)return;const t=e.reduce(((e,t)=>{var n,i;const r=t.getBoundingRect(!1,!0);if(t.group){const e=l({top:0,left:0,width:0,height:0,scaleX:1,scaleY:1},t.group);r.width*=e.scaleX,r.height*=e.scaleY;const o=e.width/2+e.left,a=(e.width/2+(null!=(n=t.left)?n:0))*(1-e.scaleX);r.left+=(o-a)*this.getZoom();const s=e.height/2+e.top,c=(e.height/2+(null!=(i=t.top)?i:0))*(1-e.scaleY);r.top+=(s-c)*this.getZoom()}return t instanceof vA.fabric.GuideLine&&(r.skip=t.isHorizontal()?"x":"y"),e.push(r),e}),[]);0!==t.length&&(this.objectRect={x:eb(t,!0),y:eb(t,!1)})}clearStatus(){this.objectRect=void 0}isPointOnRuler(e){return new vA.fabric.Rect({left:0,top:0,width:this.options.ruleSize,height:this.options.canvas.height}).containsPoint(e)?"vertical":!!new vA.fabric.Rect({left:0,top:0,width:this.options.canvas.width,height:this.options.ruleSize}).containsPoint(e)&&"horizontal"}canvasMouseDown(e){if(!e.pointer||!e.absolutePointer)return;const t=this.isPointOnRuler(e.pointer);t&&"up"===this.activeOn&&(this.lastAttr.selection=this.options.canvas.selection,this.options.canvas.selection=!1,this.activeOn="down",this.tempGuidelLine=new vA.fabric.GuideLine("horizontal"===t?e.absolutePointer.y:e.absolutePointer.x,{axis:t,visible:!1}),this.options.canvas.add(this.tempGuidelLine),this.options.canvas.setActiveObject(this.tempGuidelLine),this.options.canvas._setupCurrentTransform(e.e,this.tempGuidelLine,!0),this.tempGuidelLine.fire("down",this.getCommonEventInfo(e)))}canvasMouseMove(e){if(!e.pointer)return;if(this.tempGuidelLine&&e.absolutePointer){const t={};"horizontal"===this.tempGuidelLine.axis?t.top=e.absolutePointer.y:t.left=e.absolutePointer.x,this.tempGuidelLine.set(c(l({},t),{visible:!0})),this.options.canvas.requestRenderAll();const n=this.getCommonEventInfo(e);this.options.canvas.fire("object:moving",n),this.tempGuidelLine.fire("moving",n)}const t=this.isPointOnRuler(e.pointer);t?"out"!==this.lastAttr.status&&t===this.lastAttr.status||(this.lastAttr.cursor=this.options.canvas.defaultCursor,this.options.canvas.defaultCursor="horizontal"===t?"ns-resize":"ew-resize",this.lastAttr.status=t):"out"!==this.lastAttr.status&&(this.options.canvas.defaultCursor=this.lastAttr.cursor,this.lastAttr.status="out")}canvasMouseUp(e){var t;"down"===this.activeOn&&(this.options.canvas.selection=this.lastAttr.selection,this.activeOn="up",null==(t=this.tempGuidelLine)||t.fire("up",this.getCommonEventInfo(e)),this.tempGuidelLine=void 0)}}class ab{constructor(e,t){u(this,"ruler"),this.canvas=e,this.editor=t,this.init()}hookSaveBefore(){return new Promise((e=>{this.hideGuideline(),e(!0)}))}hookSaveAfter(){return new Promise((e=>{this.showGuideline(),e(!0)}))}init(){this.ruler=function(e,t){const n=new ob(l({canvas:e},t));let i;const r=()=>{i=e.getObjects().find((e=>"workspace"===e.id))},o=(e,t)=>{const{top:n,height:i,left:r,width:o}=e;if(void 0===n||void 0===i||void 0===r||void 0===o)return!1;const a=t.getBoundingRect(!0,!0),{top:s,height:l,left:c,width:u}=a;return!(!t.isHorizontal()||!(n>s+1||n+i<s+l-1))||!t.isHorizontal()&&(r>c+1||r+o<c+u-1)};return e.on("guideline:moving",(e=>{if(!i)return void r();const{target:t}=e;o(i,t)&&(t.moveCursor="not-allowed")})),e.on("guideline:mouseup",(t=>{var n;if(!i)return void r();const{target:a}=t;o(i,a)&&(e.remove(a),e.setCursor(null!=(n=e.defaultCursor)?n:""))})),n}(this.canvas)}hideGuideline(){this.ruler.hideGuideline()}showGuideline(){this.ruler.showGuideline()}rulerEnable(){this.ruler.enable()}rulerDisable(){this.ruler.disable()}destroy(){}}u(ab,"pluginName","RulerPlugin"),u(ab,"apis",["hideGuideline","showGuideline","rulerEnable","rulerDisable"]);class sb{constructor(e,t,n){u(this,"apiMapUrl"),u(this,"repoSrc"),this.canvas=e,this.editor=t,this.repoSrc=n.repoSrc,this.apiMapUrl={template:n.repoSrc+"/template/type.json",svg:n.repoSrc+"/svg/type.json"}}getTemplTypeList(){return Cr.get(`${this.repoSrc}/api/templ-types?pagination[pageSize]=100`).then((e=>e.data.data.map((e=>({value:e.id,label:e.attributes.name})))))}getTemplList(e="",t=1,n=""){const i={fields:"*",populate:{img:"*"},filters:{},pagination:{page:t,pageSize:10}},r=this._getQueryParams(i,[{key:"templ_type",value:e,type:"$eq"},{key:"name",value:n,type:"$contains"}]);return Cr.get(`${this.repoSrc}/api/templs?${r}`).then((e=>{var t,n;return{list:e.data.data.map((e=>({name:e.attributes.name,desc:e.attributes.desc,src:this._getMaterialPreviewUrl(e.attributes.img),json:e.attributes.json}))),pagination:null==(n=null==(t=null==e?void 0:e.data)?void 0:t.meta)?void 0:n.pagination}}))}getMaterialTypeList(){return Cr.get(`${this.repoSrc}/api/material-types?pagination[pageSize]=100`).then((e=>e.data.data.map((e=>({value:e.id,label:e.attributes.name})))))}getMaterialList(e="",t=1,n=""){const i={populate:{img:"*"},filters:{},pagination:{page:t,pageSize:50}},r=this._getQueryParams(i,[{key:"material_type",value:e,type:"$eq"},{key:"name",value:n,type:"$contains"}]);return Cr.get(`${this.repoSrc}/api/materials?${r}`).then((e=>{var t,n;return{list:e.data.data.map((e=>({name:e.attributes.name,desc:e.attributes.desc,src:this._getMaterialInfoUrl(e.attributes.img),previewSrc:this._getMaterialPreviewUrl(e.attributes.img)}))),pagination:null==(n=null==(t=null==e?void 0:e.data)?void 0:t.meta)?void 0:n.pagination}}))}getSizeList(){return Cr.get(`${this.repoSrc}/api/sizes?pagination[pageSize]=100`).then((e=>e.data.data.map((e=>({value:e.id,name:e.attributes.name,width:Number(e.attributes.width),height:Number(e.attributes.height),unit:e.attributes.unit})))))}getFontList(){return Cr.get(`${this.repoSrc}/api/fonts?pagination[pageSize]=100`).then((e=>e.data.data.map((e=>({value:e.id,label:e.attributes.name})))))}_getMaterialInfoUrl(e){var t,n;const i=(null==(n=null==(t=null==e?void 0:e.data)?void 0:t.attributes)?void 0:n.url)||"";return this.repoSrc+i}_getMaterialPreviewUrl(e){var t,n,i,r,o,a;const s=(null==(r=null==(i=null==(n=null==(t=null==e?void 0:e.data)?void 0:t.attributes)?void 0:n.formats)?void 0:i.small)?void 0:r.url)||(null==(a=null==(o=null==e?void 0:e.data)?void 0:o.attributes)?void 0:a.url)||"";return this.repoSrc+s}_getQueryParams(e,t){return t.forEach((t=>{const{key:n,value:i,type:r}=t;i&&(e.filters[n]={[r]:i})})),Wt.stringify(e)}getMaterialInfo(e){return h(this,null,(function*(){const t=this.apiMapUrl[e];return(yield Cr.get(t,{params:{typeId:e}})).data.data}))}}u(sb,"pluginName","MaterialPlugin"),u(sb,"apis",["getTemplTypeList","getTemplList","getMaterialTypeList","getMaterialList","getSizeList"]);var lb,cb={exports:{}};lb=cb,function(){function e(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function t(e){this.g=document.createElement("div"),this.g.setAttribute("aria-hidden","true"),this.g.appendChild(document.createTextNode(e)),this.h=document.createElement("span"),this.i=document.createElement("span"),this.m=document.createElement("span"),this.j=document.createElement("span"),this.l=-1,this.h.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.i.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.j.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.m.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.h.appendChild(this.m),this.i.appendChild(this.j),this.g.appendChild(this.h),this.g.appendChild(this.i)}function n(e,t){e.g.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function i(e){var t=e.g.offsetWidth,n=t+100;return e.j.style.width=n+"px",e.i.scrollLeft=n,e.h.scrollLeft=e.h.scrollWidth+100,e.l!==t&&(e.l=t,!0)}function r(t,n){function r(){var e=o;i(e)&&null!==e.g.parentNode&&n(e.l)}var o=t;e(t.h,r),e(t.i,r),i(t)}function o(e,t,n){t=t||{},n=n||window,this.family=e,this.style=t.style||"normal",this.weight=t.weight||"normal",this.stretch=t.stretch||"normal",this.context=n}var a=null,s=null,l=null,c=null;function u(e){return null===c&&(c=!!e.document.fonts),c}function h(e,t){var n=e.style,i=e.weight;if(null===l){var r=document.createElement("div");try{r.style.font="condensed 100px sans-serif"}catch(o){}l=""!==r.style.font}return[n,i,l?e.stretch:"","100px",t].join(" ")}o.prototype.load=function(e,i){var o=this,l=e||"BESbswy",c=0,d=i||3e3,f=(new Date).getTime();return new Promise((function(e,i){if(u(o.context)&&!function(e){return null===s&&(u(e)&&/Apple/.test(window.navigator.vendor)?(e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent),s=!!e&&603>parseInt(e[1],10)):s=!1),s}(o.context)){var p=new Promise((function(e,t){!function n(){(new Date).getTime()-f>=d?t(Error(d+"ms timeout exceeded")):o.context.document.fonts.load(h(o,'"'+o.family+'"'),l).then((function(t){1<=t.length?e():setTimeout(n,25)}),t)}()})),g=new Promise((function(e,t){c=setTimeout((function(){t(Error(d+"ms timeout exceeded"))}),d)}));Promise.race([g,p]).then((function(){clearTimeout(c),e(o)}),i)}else!function(e){document.body?e():document.addEventListener?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),e()})):document.attachEvent("onreadystatechange",(function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),e())}))}((function(){function s(){var t;(t=-1!=v&&-1!=A||-1!=v&&-1!=m||-1!=A&&-1!=m)&&((t=v!=A&&v!=m&&A!=m)||(null===a&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),a=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))),t=a&&(v==y&&A==y&&m==y||v==b&&A==b&&m==b||v==C&&A==C&&m==C)),t=!t),t&&(null!==w.parentNode&&w.parentNode.removeChild(w),clearTimeout(c),e(o))}var u=new t(l),p=new t(l),g=new t(l),v=-1,A=-1,m=-1,y=-1,b=-1,C=-1,w=document.createElement("div");w.dir="ltr",n(u,h(o,"sans-serif")),n(p,h(o,"serif")),n(g,h(o,"monospace")),w.appendChild(u.g),w.appendChild(p.g),w.appendChild(g.g),o.context.document.body.appendChild(w),y=u.g.offsetWidth,b=p.g.offsetWidth,C=g.g.offsetWidth,function e(){if((new Date).getTime()-f>=d)null!==w.parentNode&&w.parentNode.removeChild(w),i(Error(d+"ms timeout exceeded"));else{var t=o.context.document.hidden;!0!==t&&void 0!==t||(v=u.g.offsetWidth,A=p.g.offsetWidth,m=g.g.offsetWidth,s()),c=setTimeout(e,50)}}(),r(u,(function(e){v=e,s()})),n(u,h(o,'"'+o.family+'",sans-serif')),r(p,(function(e){A=e,s()})),n(p,h(o,'"'+o.family+'",serif')),r(g,(function(e){m=e,s()})),n(g,h(o,'"'+o.family+'",monospace'))}))}))},lb.exports=o}();const ub=xi(cb.exports);class hb{constructor(e,t,n){u(this,"tempPromise"),u(this,"repoSrc"),u(this,"cacheList"),this.canvas=e,this.editor=t,this.repoSrc=n.repoSrc,this.cacheList=[],this.tempPromise=null}hookImportBefore(e){return this.downFontByJSON(e)}getFontList(){return this.cacheList.length?Promise.resolve(this.cacheList):(this.tempPromise||(this.tempPromise=Cr.get(`${this.repoSrc}/api/fonts?populate=*&pagination[pageSize]=100`).then((e=>{var t;const n=null==(t=e.data.data)?void 0:t.map((e=>({name:e.attributes.name,type:e.attributes.type,file:this.repoSrc+e.attributes.file.data.attributes.url,img:this.repoSrc+e.attributes.img.data.attributes.url})));return this.cacheList=n,this.createFontCSS(n),n}))),this.tempPromise)}downFontByJSON(e){const t=JSON.parse(e);let n=[];const i=["arial"];n=t.objects?JSON.parse(e).objects.filter((e=>{const t=this.cacheList.find((t=>t.name===e.fontFamily));return e.type.includes("text")&&!i.includes(e.fontFamily)&&t})).map((e=>e.fontFamily)):i.includes(t.fontFamily)?[]:[t.fontFamily];const r=n.map((e=>new ub(e).load(null,15e4)));return Promise.all(r)}getFontJson(){const e=this.canvas.getActiveObject();if(e){const t=e.toJSON(["id","gradientAngle","selectable","hasControls"]),n=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(t,null,"\t"))}`,i=e.toDataURL({});Um(n,"font.json"),Um(i,"font.png")}}loadFont(e){return new ub(e).load(null,15e4).then((()=>{const t=this.canvas.getActiveObjects()[0];t&&(t.set("fontFamily",e),this.canvas.renderAll())}))}createFontCSS(e){let t="";e.forEach((e=>{t+=`\n    @font-face {\n      font-family: ${e.name};\n      src: url('${e.file}');\n    }\n    `}));const n=document.createElement("style");try{n.appendChild(document.createTextNode(t))}catch(i){}document.getElementsByTagName("head")[0].appendChild(n)}destroy(){}}u(hb,"pluginName","FontPlugin"),u(hb,"apis",["getFontList","loadFont","getFontJson","downFontByJSON"]);const db=function(e,t,n,i){const r=t.target,o=r.controls[r.__corner],a=r.toLocalPoint(new vA.fabric.Point(n,i),"center","center"),s=fb(r),l=r._getTransformedDimensions(0,0);return null!=r.points&&(r.points[o.pointIndex]=new vA.fabric.Point(a.x*s.x/l.x+r.pathOffset.x,a.y*s.y/l.y+r.pathOffset.y),!0)},fb=function(e){const t=new vA.fabric.Point(e.strokeUniform?1/e.scaleX:1,e.strokeUniform?1/e.scaleY:1).multiply(e.strokeWidth);return new vA.fabric.Point(e.width+t.x,e.height+t.y)},pb=function(e,t,n){const i=n.points[this.pointIndex].x-n.pathOffset.x,r=n.points[this.pointIndex].y-n.pathOffset.y;return vA.fabric.util.transformPoint(new vA.fabric.Point(i,r),vA.fabric.util.multiplyTransformMatrices(n.canvas.viewportTransform,n.calcTransformMatrix()))};class gb{constructor(e,t){u(this,"isEdit"),u(this,"img"),u(this,"_onDeselected",oo),this.canvas=e,this.editor=t,this.isEdit=!1;const n=document.createElement("img");n.src=jy,this.img=n,this.init()}init(){}_ensureEvent(e){e.off("deselected",this._onDeselected)}toggleEdit(){this.isEdit?this.inActiveEdit():this.activeEdit()}activeEdit(){this.isEdit=!0;const e=this.canvas.getActiveObject();if(e&&"polygon"===e.type){if(this._ensureEvent(e),null==e.points)return;const t=e.points.length-1,n=this;e.controls=e.points.reduce((function(e,i,r){var o,a;return e["p"+r]=new vA.fabric.Control({positionHandler:pb,actionHandler:(o=r>0?r-1:t,a=db,function(e,t,n,i){const r=t.target;if(null==r.points)return!1;const s=vA.fabric.util.transformPoint(new vA.fabric.Point(r.points[o].x-r.pathOffset.x,r.points[o].y-r.pathOffset.y),r.calcTransformMatrix()),l=a(e,t,n,i),c=fb(r),u=(r.points[o].x-r.pathOffset.x)/c.x+.5,h=(r.points[o].y-r.pathOffset.y)/c.y+.5;return r.setPositionByOrigin(s,u,h),l}),actionName:"modifyPolygon",render:(...e)=>function(e,t,n,i,r,o){zm(e,t,n,o,25,25,vA.fabric.util.degreesToRadians(r.angle||0))}(...e,n.img)}),Object.defineProperty(e["p"+r],"pointIndex",{value:r}),e}),{}),e.set({objectCaching:!1}),e.hasBorders=!this.isEdit,this.canvas.requestRenderAll(),this._onDeselected=()=>this.inActiveEdit(e),e.on("deselected",this._onDeselected)}}inActiveEdit(e){this.isEdit=!1,(e=e||this.canvas.getActiveObject())&&"polygon"===e.type&&(e.cornerColor="blue",e.cornerStyle="rect",e.controls=vA.fabric.Object.prototype.controls,e.hasBorders=!this.isEdit,e.set({objectCaching:!0}),this._onDeselected&&(e.off("deselected",this._onDeselected),this._onDeselected=oo)),this.canvas.requestRenderAll()}}u(gb,"pluginName","PolygonModifyPlugin"),u(gb,"events",[]),u(gb,"apis",["toggleEdit","activeEdit","inActiveEdit"]);class vb{constructor(e,t){u(this,"isDrawingPolygon",!1),u(this,"points",[]),u(this,"lines",[]),u(this,"anchors",[]),u(this,"tempPoint"),u(this,"tempLine"),u(this,"lastPoint"),u(this,"onEnd"),u(this,"delta",5),u(this,"_escListener",(e=>{"Escape"!==e.key&&27!==e.keyCode||this._confirmBuildPolygon()})),u(this,"_downHandler",(e=>{if(!this.isDrawingPolygon)return;const t=e.absolutePointer,n=new vA.fabric.Point(t.x,t.y),i=this._mackAnchor(t);if(this.anchors.push(i),null==this.tempLine){const e=new vA.fabric.Point(t.x,t.y);this.tempLine=this._makeLine([e,e]),this.canvas.add(this.tempLine)}else e.e.shiftKey&&n.setXY(this.tempLine.x2,this.tempLine.y2),i.set({left:n.x,top:n.y}),this.tempLine.set({x1:n.x,y1:n.y,x2:n.x,y2:n.y});if(this.lastPoint){const e=this._makeLine([this.lastPoint,n]);if(this.lines.push(e),this.canvas.add(e),this.points[0].distanceFrom(n)/this.canvas.getZoom()<=this.delta)return void this._confirmBuildPolygon()}this.canvas.add(i),this.lastPoint=n,this.points.push(n),this._ensureAnchorsForward()})),u(this,"_moveHandler",(e=>{if(!this.isDrawingPolygon||!this.tempLine)return;const t=e.absolutePointer;if(e.e.shiftKey&&this.lastPoint){const e=function(e,t){const n=e.x,i=e.y,r=t.x-n,o=t.y-i,a=Math.sqrt(r*r+o*o);let s=Math.atan2(o,r)/Math.PI*180;return s=15*~~((s+7.5)%360/15),{x:a*Math.cos(s*Math.PI/180)+n,y:a*Math.sin(s*Math.PI/180)+i}}(this.lastPoint,t);this.tempLine.set({x2:e.x,y2:e.y})}else this.tempLine.set({x2:t.x,y2:t.y});this.canvas.renderAll()})),this.canvas=e,this.editor=t}_isUsingHistory(){return this.canvas.offHistory&&"function"==typeof this.canvas.offHistory}_bindEvent(){window.addEventListener("keydown",this._escListener),this.canvas.on("mouse:down",this._downHandler),this.canvas.on("mouse:move",this._moveHandler)}_ensureAnchorsForward(){this.anchors.forEach((e=>{e.bringForward()}))}_unbindEvent(){window.removeEventListener("keydown",this._escListener),this.canvas.off("mouse:down",this._downHandler),this.canvas.off("mouse:move",this._moveHandler)}_createPolygon(e){return new vA.fabric.Polygon(e,{fill:"#ccccccff",id:hm()})}_makeLine(e){const[t,n]=e;return new vA.fabric.Line([t.x,t.y,n.x,n.y],{fill:"#000",stroke:"#000",strokeWidth:1,selectable:!1,evented:!1})}_mackAnchor(e){return new vA.fabric.Circle({radius:5,left:e.x,top:e.y,fill:"rgb(178, 53, 84)",scaleX:1/this.canvas.getZoom(),scaleY:1/this.canvas.getZoom(),strokeWidth:1/this.canvas.getZoom(),originX:"center",originY:"center",evented:!1,selectable:!1})}_confirmBuildPolygon(){const e=this.points;if(this.discardPolygon(),this._isUsingHistory()&&(this.canvas.historyProcessing=!1),e.length>=3){const t=this._createPolygon(e);this.canvas.add(t)}}_prepare(){this.canvas.discardActiveObject(),this.canvas.getObjects().forEach((e=>{e.selectable=!1,e.hasControls=!1}))}beginDrawPolygon(e){this._prepare(),this.onEnd=e,this._isUsingHistory()&&(this.canvas.historyProcessing=!0),this.canvas.requestRenderAll(),this.isDrawingPolygon=!0,this._bindEvent()}endDrawPolygon(){this.canvas.discardActiveObject(),this.isDrawingPolygon=!1,this.lastPoint=void 0,this.tempPoint=void 0,this._unbindEvent(),this.onEnd&&this.onEnd(),this.onEnd=void 0}discardPolygon(){this.lines.forEach((e=>{this.canvas.remove(e)})),this.anchors.forEach((e=>{this.canvas.remove(e)})),this.tempLine&&this.canvas.remove(this.tempLine),this.tempLine=void 0,this.anchors=[],this.lines=[],this.points=[],this.endDrawPolygon()}}u(vb,"pluginName","DrawPolygonPlugin"),u(vb,"apis",["beginDrawPolygon","endDrawPolygon","discardPolygon"]);class Ab{constructor(e,t){u(this,"_createdHandler",(e=>{e.path.set("id",hm())})),this.canvas=e,this.editor=t}_bindEvent(){this.canvas.on("path:created",this._createdHandler)}_unbindEvent(){this.canvas.off("path:created",this._createdHandler)}startDraw(e){this.canvas.isDrawingMode=!0,this.canvas.freeDrawingBrush=new vA.fabric.PencilBrush(this.canvas),this.canvas.freeDrawingBrush.width=e.width,this._bindEvent()}endDraw(){if(this.canvas.isDrawingMode)return this.canvas.isDrawingMode=!1,void this._unbindEvent()}}u(Ab,"pluginName","FreeDrawPlugin"),u(Ab,"apis",["startDraw","endDraw"]);class mb{constructor(e,t){u(this,"options"),u(this,"_beforeHandler",(e=>{if(null==this.options)return;const t=e.path,n=vA.fabric.util.getPathSegmentsInfo;t.segmentsInfo=n(t.path),t.set({stroke:this.options.lineColor});const i=this.options.defaultText,r=this.options.defaultFontSize,o=new vA.fabric.IText(i,{shadow:"",fontFamily:"arial",fontSize:r,top:t.top,left:t.left,fill:this.options.color,path:t,id:hm(),editable:!1});this.canvas.add(o)})),u(this,"_createdHandler",(e=>{this.canvas.remove(e.path)})),this.canvas=e,this.editor=t}_bindEvent(){this.canvas.on("before:path:created",this._beforeHandler),this.canvas.on("path:created",this._createdHandler)}_unbindEvent(){this.canvas.off("before:path:created",this._beforeHandler),this.canvas.off("path:created",this._createdHandler)}startTextPathDraw(e={}){this.options=l(l({},{decimate:8,width:2,defaultText:"诸事顺遂 万事大吉",color:"#000000",lineColor:"#000000",defaultFontSize:20}),e),this.canvas.isDrawingMode=!0;const t=this.canvas.freeDrawingBrush=new vA.fabric.PencilBrush(this.canvas);t.decimate=this.options.decimate,t.width=this.options.width,t.color=this.options.color,this._bindEvent()}endTextPathDraw(){this.canvas.isDrawingMode=!1,this._unbindEvent()}}function yb(e){return h(this,null,(function*(){const t=function(){const e={version:"5.3.0",objects:[],clipPath:null};return e}(),{clipPath:n,workspase:i}=function(e){const{width:t,height:n}=e,i={type:"rect",version:"5.3.0",originX:"left",originY:"top",left:0,top:0,width:t,height:n,fill:"rgba(255,255,255,1)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,opacity:1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,rx:0,ry:0,selectable:!0,hasControls:!0},r={type:"rect",version:"5.3.0",originX:"left",originY:"top",left:0,top:0,width:t,height:n,fill:"rgba(255,255,255,1)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,rx:0,ry:0,id:"workspace",selectable:!1,hasControls:!0};return{clipPath:i,workspase:r}}(e);t.clipPath=n,t.objects.push(i);const r=function(e){const t=[];function n(e){e.forEach((e=>{e.children?n(e.children):t.push(e)}))}return n(e),t}(e.children),o=yield function(e){return h(this,null,(function*(){function t(e){return e.filter((e=>(e.text&&(e.type="text"),!e.isHidden))).map((e=>h(this,null,(function*(){const t=bb(["left","top",["width",e=>e.width+50],"height","name",["visible",()=>!0],["opacity",e=>255/e.opacity],["id",hm]])(e),n="type",i=[{sourceType:"Layer",targetType:"image",attr:[],customTransform(e){return h(this,null,(function*(){return{src:yield function(e){return h(this,null,(function*(){try{const t=yield e.composite(),n=document.createElement("canvas"),i=n.getContext("2d"),r=new ImageData(t,e.width,e.height);n.width=e.width,n.height=e.height,i.putImageData(r,0,0);return n.toDataURL("image/png")}catch(t){return""}}))}(e)}}))}},{sourceType:"text",targetType:"textbox",attr:["text"],customTransform(e){return h(this,null,(function*(){const{FontSize:t,FillColor:n,Tracking:i}=e.textProperties.EngineDict.StyleRun.RunArray[0].StyleSheet.StyleSheetData;return{charSpacing:i,fontFamily:"站酷快乐体",fill:wb(n.Values),fontSize:t||12}}))}}].find((t=>t.sourceType===e[n]));if(i){const n=Cb(i.targetType),r=bb(i.attr)(e),o=i.customTransform?yield i.customTransform(e):null;return po.assign(n,t,n,r,o)}return l({},Cb("textbox"))}))))}return yield Promise.all(t(e))}))}(r);t.objects.push(...o.reverse());return JSON.stringify(t,null,2)}))}function bb(e){return function(t){const n={desc:{}};return e.forEach((e=>{if("string"==typeof e){const i=po.get(t,e);po.set(n,e,i)}else{const[i,r]=e;if("function"==typeof r){const e=r(t);e&&po.set(n,i,e)}else{const e=po.get(t,r);po.set(n,i,e)}}})),n}}function Cb(e){return{group:{type:"group",version:"5.3.0",originX:"left",originY:"top",fill:"rgb(0,0,0)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,flipX:!1,flipY:!1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,selectable:!0,hasControls:!0},textbox:{type:"textbox",version:"5.3.0",originX:"left",originY:"top",fill:"rgb(0,0,0)",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,shadow:"",backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,fontFamily:"arial",fontWeight:"normal",fontSize:80,text:"诸事顺遂",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,textBackgroundColor:"",charSpacing:0,styles:[],direction:"ltr",path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",minWidth:20,splitByGrapheme:!0,selectable:!0,hasControls:!0},image:{type:"image",version:"5.3.0",originX:"left",originY:"top",fill:"rgb(0,0,0)",stroke:null,strokeWidth:0,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,shadow:null,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,cropX:0,cropY:0,selectable:!0,hasControls:!0,src:"",crossOrigin:"anonymous",filters:[]},rect:{type:"rect",version:"5.3.0",originX:"center",originY:"center",left:0,top:0,width:226,height:302,fill:"rgb(0,0,0)",stroke:null,strokeWidth:1,strokeDashArray:null,strokeLineCap:"butt",strokeDashOffset:0,strokeLineJoin:"miter",strokeUniform:!1,strokeMiterLimit:4,scaleX:1,scaleY:1,angle:0,flipX:!1,flipY:!1,opacity:1,shadow:null,visible:!0,backgroundColor:"",fillRule:"nonzero",paintFirst:"fill",globalCompositeOperation:"source-over",skewX:0,skewY:0,rx:0,ry:0,selectable:!0,hasControls:!0,inverted:!1,absolutePositioned:!1}}[e]}function wb(e){const[,t,n,i]=e;return`rgb(${255*t}, ${255*n}, ${255*i})`}u(mb,"pluginName","PathTextPlugin"),u(mb,"apis",["startTextPathDraw","endTextPathDraw"]);class xb{constructor(e,t){this.layerFrame=e,this.parent=t,this.type="Group",this.children=[]}get name(){var e,t;return null!==(t=null===(e=this.layerFrame)||void 0===e?void 0:e.layerProperties.name)&&void 0!==t?t:""}get opacity(){var e,t;return null!==(t=null===(e=this.layerFrame)||void 0===e?void 0:e.layerProperties.opacity)&&void 0!==t?t:0}get composedOpacity(){return this.parent.composedOpacity*(this.opacity/255)}get additionalProperties(){var e;return null===(e=this.layerFrame)||void 0===e?void 0:e.layerProperties.additionalLayerProperties}addChild(e){this.children.push(e)}hasChildren(){return 0!==this.children.length}freeze(){this.children.forEach((e=>{var t,n;return null===(n=(t=e).freeze)||void 0===n?void 0:n.call(t)})),Object.freeze(this.children)}}var _b,Eb,Sb,Ib;(Eb=_b||(_b={})).SectionDividerSetting="lsct",Eb.TypeToolObjectSetting="TySh",Eb.UnicodeLayerName="luni",Eb.VectorStrokeData="vstk",Eb.ObjectBasedEffects="lfx2",Eb.GradientFillSetting="GdFl",Eb.SolidColorSheetSetting="SoCo",Eb.PatternFillSetting="PtFl",Eb.VectorStrokeContentData="vscg",Eb.BlendOptionsCapacity="iOpa",Eb.VectorMaskSetting1="vmsk",Eb.VectorMaskSetting2="vsms",Eb.HueSaturation="hue2",Eb.NestedSectionDividerSetting="lsdk",Eb.LayerId="lyid",Eb.ArtboardData="artb",Eb.SmartObjectPlacedLayerData="SoLE",Eb.PlacedLayerData="SoLd",Eb.LinkedLayer="lnkD",Eb.LinkedLayer2="lnk2",Eb.LinkedLayer3="lnk3",function(e){e[e.Normal=0]="Normal",e[e.SceneGroup=1]="SceneGroup"}(Sb||(Sb={})),function(e){e[e.ClosedSubpathLength=0]="ClosedSubpathLength",e[e.ClosedSubpathBezierKnotLinked=1]="ClosedSubpathBezierKnotLinked",e[e.ClosedSubpathBezierKnotUnlinked=2]="ClosedSubpathBezierKnotUnlinked",e[e.OpenSubpathLength=3]="OpenSubpathLength",e[e.OpenSubpathBezierKnotLinked=4]="OpenSubpathBezierKnotLinked",e[e.OpenSubpathBezierKnotUnlinked=5]="OpenSubpathBezierKnotUnlinked",e[e.PathFillRule=6]="PathFillRule",e[e.Clipboard=7]="Clipboard",e[e.InitialFillRule=8]="InitialFillRule"}(Ib||(Ib={}));const kb=(e,t)=>{const n=Math.max(e.length,t.length);for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0};class Bb extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype),this.name=new.target.name}}class Ob extends Bb{}class Tb extends Bb{}class Db extends Bb{}class Mb extends Bb{}class Qb extends Bb{}class Lb extends Bb{}class Pb extends Bb{}class jb extends Bb{}class Rb extends Bb{}class Fb extends Bb{}class Nb extends Bb{}class Vb extends Bb{}class Ub extends Bb{}class zb extends Bb{}class Hb extends Bb{}class Yb extends Bb{}class Gb extends Bb{}class Wb extends Bb{}class Xb extends Bb{}class $b extends Bb{}class qb extends Bb{}class Kb extends Bb{}class Jb extends Bb{}class Zb extends Bb{}class eC extends Bb{}class tC extends Bb{}class nC extends Bb{}class iC extends Bb{}class rC extends Bb{}class oC extends Bb{}class aC extends Bb{}class sC extends Bb{}class lC extends Bb{}class cC extends Bb{}class uC extends Bb{}class hC extends Bb{}class dC extends Bb{}class fC extends Bb{}class pC extends Bb{}class gC extends Bb{}class vC extends Bb{}class AC extends Bb{}class mC extends Bb{}class yC extends Bb{}function bC(e,t){const n=e.getUint32(t),i=e.getUint32(t+4);if(n>=2097152)throw new tC;return 4294967296*n+i}const CC={u8:1,i8:1,u16:2,i16:2,u32:4,i32:4,f32:4,u64:8,i64:8,f64:8};class wC{static from(e){return new wC(new DataView(e.buffer,e.byteOffset,e.byteLength))}constructor(e,t=0){this.dataView=e,this.position=t}get length(){return this.dataView.byteLength}clone(e){const t=void 0!==e?e:this.position;return new wC(new DataView(this.dataView.buffer,this.dataView.byteOffset,this.dataView.byteLength),t)}pass(e){this.position+=e}unpass(e){this.position-=e}extract(e){if(this.position+e>this.dataView.byteLength)throw new $b;return new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+this.position,e)}iter(){return new Uint8Array(this.dataView.buffer,this.dataView.byteOffset+this.position)}take(e){const t=this.extract(e);return this.pass(e),t}peek(){return this.dataView.getUint8(this.position)}one(){const e=this.dataView.getUint8(this.position);return this.position+=1,e}read(e){const{dataView:t,position:n}=this;switch(this.pass(CC[e]),e){case"u8":return t.getUint8(n);case"u16":return t.getUint16(n);case"u32":return t.getUint32(n);case"u64":return bC(t,n);case"i8":return t.getInt8(n);case"i16":return t.getInt16(n);case"i32":return t.getInt32(n);case"i64":return function(e,t){const n=e.getInt32(t),i=e.getUint32(t+4);if(n>=2097152||n<-2097152||-2097152===n&&0===i)throw new tC;return 4294967296*n+i}(t,n);case"f32":return t.getFloat32(n);case"f64":return t.getFloat64(n);default:throw new TypeError(`Invalid ReadType: ${e}`)}}readString(e){const t=this.take(e);return(new TextDecoder).decode(t)}readUnicodeString(e=4){const t=2*this.read("u32"),n=this.take(t),i=new TextDecoder("utf-16be").decode(n);return this.padding(4+t,e),0===i.charCodeAt(i.length-1)?i.slice(0,-1):i}readFixedPoint32bit(){return this.read("u32")/65536}readIdString(){const e=this.read("u32");return this.readString(e||4)}padding(e,t){const n=e%t;n>0&&this.pass(t-n)}}const xC=(e,t,n)=>t<=e&&e<=n;function _C(e){return e.bottom-e.top}function EC(e){return function(e){return e.right-e.left}(e)*_C(e)}var SC,IC,kC,BC,OC,TC,DC;function MC(e){const t=Object.keys(SC);for(const n of t)if(SC[n]===e)return e;throw new Fb}function QC(e,t,n){const i=e.items.get(t);if(!i)throw new cC(`Cannot find key "${t}" in descriptor`);if(i.type!==n)throw new uC(`Unexpected descriptor value type: expected "${n}" but got "${i.type}"`);return i}!function(e){e.PassThrough="pass",e.Normal="norm",e.Dissolve="diss",e.Darken="dark",e.Multiply="mul ",e.ColorBurn="idiv",e.LinearBurn="lbrn",e.DarkerColor="dkCl",e.Lighten="lite",e.Screen="scrn",e.ColorDodge="div ",e.LinearDodge="lddg",e.LighterColor="lgCl",e.Overlay="over",e.SoftLight="sLit",e.HardLight="hLit",e.VividLight="vLit",e.LinearLight="lLit",e.PinLight="pLit",e.HardMix="hMix",e.Difference="diff",e.Exclusion="smud",e.Subtract="fsub",e.Divide="fdiv",e.Hue="hue ",e.Saturation="sat ",e.Color="colr",e.Luminosity="lum "}(SC||(SC={})),function(e){e[e.Base=0]="Base",e[e.NonBase=1]="NonBase"}(IC||(IC={})),function(e){e[e.Bitmap=0]="Bitmap",e[e.Grayscale=1]="Grayscale",e[e.Indexed=2]="Indexed",e[e.Rgb=3]="Rgb",e[e.Cmyk=4]="Cmyk",e[e.Multichannel=7]="Multichannel",e[e.Duotone=8]="Duotone",e[e.Lab=9]="Lab"}(kC||(kC={})),function(e){e[e.One=1]="One",e[e.Eight=8]="Eight",e[e.Sixteen=16]="Sixteen",e[e.ThirtyTwo=32]="ThirtyTwo"}(BC||(BC={})),function(e){e.Alias="alis",e.Boolean="bool",e.Class="type",e.Descriptor="Objc",e.Double="doub",e.Enumerated="enum",e.GlobalClass="GlbC",e.GlobalObject="GlbO",e.Integer="long",e.LargeInteger="comp",e.List="VlLs",e.RawData="tdta",e.Reference="obj ",e.String="TEXT",e.UnitFloat="UntF",e.UnitFloats="UnFl",e.ObjectArray="ObAr"}(OC||(OC={})),function(e){e.Angle="#Ang",e.Density="#Rsl",e.Distance="#Rlt",e.Millimeters="#Mlm",e.None="#Nne",e.Percent="#Prc",e.Pixels="#Pxl",e.Points="#Pnt"}(TC||(TC={})),function(e){e[e.PSD=1]="PSD",e[e.PSB=2]="PSB"}(DC||(DC={}));const LC=[56,66,80,83],PC=[0,0,0,0,0,0],jC=[1,8,16,32];function RC(e,t,n,i,r){const o=new wC(e),a=o.read("u16");if(!(a in pw))throw new Nb;const{red:s,green:l,blue:c,alpha:u}=(()=>{switch(a){case pw.RawData:return function(e,t,n){const i=(e.length-2)/n,r=e.extract(i),o=n>=2?e.extract(i):void 0,a=n>=3?e.extract(i):void 0,s=n>=4?e.extract(i):void 0;if(t===BC.Eight)return{red:r,green:o,blue:a,alpha:s};throw new Ub(`Unsupported image bit depth: ${t}`)}(o,t,i);case pw.RleCompressed:return function(e,t,n,i){let r=0,o=0,a=0,s=0;const l=i.rleScanlineLengthFieldReadType;for(let h=0;h<n;h++)r+=e.read(l);if(t>=2)for(let h=0;h<n;h++)o+=e.read(l);if(t>=3)for(let h=0;h<n;h++)a+=e.read(l);if(4===t)for(let h=0;h<n;h++)s+=e.read(l);const c=2+t*n*i.rleScanlineLengthFieldSize,u=e.clone(c);return{red:u.take(r),green:o?u.take(o):void 0,blue:a?u.take(a):void 0,alpha:s?u.take(s):void 0}}(o,i,n,r);default:throw new Vb}})();return{compression:a,red:s,green:l,blue:c,alpha:u}}const FC=[56,66,73,77];function NC(e){const t=e.take(4);if(!kb(t,FC))throw new Xb;const n=e.read("i16"),i=function(e,t=0){const n=e.read("u8"),i=e.readString(n);if(t){const i=(n+1)%t;i>0&&e.pass(t-i)}return i}(e,2),r=e.read("u32"),o=e.position+r,a=r+r%2,s=e.position;let l=null;switch(n){case mw.GridAndGuides:l=function(e){const t=e.read("u32");if(1!==t)throw new qb;const n=e.read("u32"),i=e.read("u32"),r=e.read("u32"),o=[];for(let a=0;a<r;++a){const t=e.read("i32"),n=_w(e.read("u8"));o.push({position:t,direction:n})}return{version:t,gridSizeX:n,gridSizeY:i,guides:o}}(e);break;case mw.Slices:l=function(e,t){const n=e.read("u32");if(6===n){const i=e.read("i32"),r=e.read("i32"),o=e.read("i32"),a=e.read("i32"),s=e.readUnicodeString(0),l=e.read("u32"),c=[];for(;c.length<l;){const t=e.read("u32"),n=e.read("u32"),i=Ew(e.read("u32")),r=1===i?e.read("u32"):void 0;c.push({id:t,groupId:n,origin:i,associatedLayerId:r,name:e.readUnicodeString(0),type:e.read("u32"),left:e.read("i32"),top:e.read("i32"),right:e.read("i32"),bottom:e.read("i32"),url:e.readUnicodeString(0),target:e.readUnicodeString(0),message:e.readUnicodeString(0),altTag:e.readUnicodeString(0),isCellTextHtml:!!e.read("u8"),cellText:e.readUnicodeString(0),horizontalAlignment:e.read("i32"),verticalAlignment:e.read("i32"),alpha:e.read("u8"),red:e.read("u8"),green:e.read("u8"),blue:e.read("u8")})}return{version:n,boundTop:i,boundLeft:r,boundBottom:o,boundRight:a,sliceGroupName:s,slices:c,descriptor:e.position<t?zw(e):void 0}}if(7===n||8===n)return{version:n,descriptor:zw(e)};throw new Jb(`Invalid Slices section version: ${n}`)}(e,o);break;case mw.ICCProfile:l=function(e,t){return e.take(t-e.position)}(e,o);break;case mw.ResolutionInfo:l=function(e){return{horizontal:e.readFixedPoint32bit(),horizontalUnit:e.read("u16"),widthUnit:e.read("u16"),vertical:e.readFixedPoint32bit(),verticalUnit:e.read("u16"),heightUnit:e.read("u16")}}(e);break;case mw.GlobalLightAltitude:case mw.GlobalLightAngle:l=e.read("i32")}const c=s+a-e.position;return c>0&&e.pass(c),{id:n,name:i,resource:l}}function VC(e){const t={};for(const[n,i]of e)t[n]=i;return t}const UC=(e,t,n)=>{const{top:i,left:r,bottom:o,right:a,opacity:s,clipping:l,hidden:c,transparencyLocked:u,blendMode:h,layerText:d,engineData:f,maskData:p,additionalLayerInfos:g}=t;return{name:e,top:i,left:r,bottom:o,right:a,opacity:s,clippingMask:l,hidden:c,transparencyLocked:u,blendMode:h,groupId:n,text:d,textProperties:f,maskData:p,additionalLayerProperties:VC(g.map((e=>[e.key,e])))}};class zC{static create(e,t,n){const i=UC(e.name,e,n);return new zC(t,i)}constructor(e,t){this.channels=e,this.layerProperties=t}get red(){const e=this.channels.get(gw.Red);if(void 0===e)throw new Hb;return e}get green(){return this.channels.get(gw.Green)}get blue(){return this.channels.get(gw.Blue)}get alpha(){return this.channels.get(gw.TransparencyMask)}get userMask(){return this.channels.get(gw.UserSuppliedLayerMask)}get realUserMask(){return this.channels.get(gw.RealUserSuppliedLayerMask)}get width(){const{right:e,left:t}=this.layerProperties;return e-t+1}get height(){const{bottom:e,top:t}=this.layerProperties;return e-t+1}}class HC{static create(e,t,n,i){const r=UC(e,n,i);return new HC(t,r)}constructor(e,t){this.id=e,this.layerProperties=t}}function YC(e){return{hue:e.read("i16"),saturation:e.read("i16"),lightness:e.read("i16")}}function GC(e){return Array.from(Array(6),(()=>function(e){const t=e.read("i16"),n=e.read("i16"),i=e.read("i16"),r=e.read("i16");return l({beginRamp:t,beginSustain:n,endSustain:i,endRamp:r},YC(e))}(e)))}function WC(e){const t=e.readString(4);if("liFD"!==t)throw new oC(`unknown layer type: '${t}'`);const n=e.read("i32"),i=function(e){const t=e.read("u8");return e.readString(t)}(e),r=e.readUnicodeString(0),o=e.readString(4),a=e.readString(4),s=e.read("u64");return{layerType:t,version:n,uniqueId:i,filename:r,filetype:o,creator:a,data:e.read("u8")?zw(e):void 0,contents:e.take(s),uuid:n>5?e.readUnicodeString():void 0}}function XC(e,t){const n=function(e){if(e in vw)return e;throw new Rb}(e.read("u32"));if(t<12)return{dividerType:n};const i=e.readString(4);if("8BIM"!==i)throw new iC(`Invalid Section Divider Setting signature: ${i}`);const r=MC(e.readString(4));if(t<16)return{dividerType:n,dividerSignature:i,blendMode:r};const o=e.read("u32");if(!(o in Sb))throw new iC(`Invalid Section Divider Setting subtype: ${o}`);return{dividerType:n,dividerSignature:i,blendMode:r,subType:o}}function $C(e){const[t,...n]=e.take(4);return t+(n[0]*a(2,16)+n[1]*a(2,8)+n[2])/a(2,24)}function qC(e){return{vert:$C(e),horiz:$C(e)}}function KC(e){const t=e.read("u16");switch(t){case Ib.OpenSubpathLength:case Ib.ClosedSubpathLength:return function(e,t){const n=e.read("i16"),i=e.read("i16"),r=e.read("i16");e.pass(6);const o=e.read("i16");return e.pass(10),{type:t,length:n,operation:i,subpathType:r,index:o}}(e,t);case Ib.PathFillRule:return e.pass(24),{type:t};case Ib.Clipboard:return function(e,t){const n=Array(4).map((()=>e.read("f32"))),i=e.read("f32");return e.pass(6),{type:t,bounds:n,resolution:i}}(e,t);case Ib.InitialFillRule:return function(e,t){const n=!!(1&e.read("i16"));return e.pass(22),{type:t,fill:n}}(e,t);case Ib.ClosedSubpathBezierKnotLinked:case Ib.ClosedSubpathBezierKnotUnlinked:case Ib.OpenSubpathBezierKnotLinked:case Ib.OpenSubpathBezierKnotUnlinked:return function(e,t){return{type:t,preceding:qC(e),anchor:qC(e),leaving:qC(e)}}(e,t);default:throw new Error(`Unknown PathRecordType: ${t} (bug in offsets?)`)}}function JC(e,t){const n=e.read("u32"),i=e.read("u32"),r=function(e,t){const n=Math.floor(t/26);return Array.from(Array(n),(()=>KC(e)))}(e,t);return{version:n,pathRecords:r,invert:!!(1&i),notLink:!!(2&i),disable:!!(4&i)}}function ZC(e,t,n=0){const i=e.readString(4);if("8BIM"!==i&&"8B64"!==i)throw new nC(`Invalid signature: ${i}`);const r=e.readString(4),o=e.read(function(e,t){if(t.aliLengthFieldSizeIsVariable)switch(e){case"LMsk":case"Lr16":case"Lr32":case"Layr":case"Mt16":case"Mt32":case"Mtrn":case"Alph":case"FMsk":case"Ink2":case"FEid":case"FXid":case"PxSD":case"cinf":return"u64"}return"u32"}(r,t)),a=e.position,s=function(e,t,n,i){switch(n){case _b.NestedSectionDividerSetting:case _b.SectionDividerSetting:return l({signature:t,key:n},XC(e,i));case _b.TypeToolObjectSetting:return l({signature:t,key:n},function(e){const t=e.read("u16");if(1!==t)throw new rC(`Invalid type tool object setting version: ${t}`);const n=e.read("f64"),i=e.read("f64"),r=e.read("f64"),o=e.read("f64"),a=e.read("f64"),s=e.read("f64"),l=e.read("u16");if(50!==l)throw new rC(`Invalid text version: ${l}`);const c=zw(e),u=e.read("u16");if(1!==u)throw new rC(`Invalid warp version: ${u}`);return{version:t,transformXX:n,transformXY:i,transformYX:r,transformYY:o,transformTX:a,transformTY:s,textVersion:l,textData:c,warpVersion:u,warpData:zw(e),left:e.read("f64"),top:e.read("f64"),right:e.read("f64"),bottom:e.read("f64")}}(e));case _b.UnicodeLayerName:return l({signature:t,key:n},function(e){return{name:e.readUnicodeString(0)}}(e));case _b.VectorStrokeData:return l({signature:t,key:n},function(e){return{data:zw(e)}}(e));case _b.ObjectBasedEffects:return l({signature:t,key:n},function(e){const t=e.read("u32"),n=e.read("u32");return{version:t,descriptor:Uw(e),descriptorVersion:n}}(e));case _b.GradientFillSetting:return l({signature:t,key:n},function(e){return{data:zw(e)}}(e));case _b.SolidColorSheetSetting:return l({signature:t,key:n},function(e){return{version:e.read("u32"),data:Uw(e)}}(e));case _b.PatternFillSetting:return l({signature:t,key:n},function(e){return{data:zw(e)}}(e));case _b.VectorStrokeContentData:return l({signature:t,key:n},function(e){return{version:e.read("u32"),data:zw(e)}}(e));case _b.BlendOptionsCapacity:return l({signature:t,key:n},function(e){return{fillOpacity:e.read("u8")}}(e));case _b.VectorMaskSetting1:case _b.VectorMaskSetting2:return l({signature:t,key:n},JC(e,i));case _b.HueSaturation:return l({signature:t,key:n},function(e){const t=e.read("u16"),n=e.read("u8");return e.pass(1),{version:t,colorize:n,colorization:YC(e),master:YC(e),adjustment:n?void 0:GC(e)}}(e));case _b.LayerId:return l({signature:t,key:n},function(e){return{value:e.read("u32")}}(e));case _b.ArtboardData:return l({signature:t,key:n},function(e){return{data:zw(e)}}(e));case _b.PlacedLayerData:case _b.SmartObjectPlacedLayerData:return l({signature:t,key:n},function(e){const t=e.readString(4),n=e.read("u32");return{data:zw(e),version:n,identifier:t}}(e));case _b.LinkedLayer:case _b.LinkedLayer2:case _b.LinkedLayer3:return l({signature:t,key:n},function(e,t){const n=[];let i=0;const r=e.position+t;for(;e.position<r&&(i=e.read("u64"));){const t=e.position,r=WC(e);n.push(r);const o=i-(e.position-t);e.pass(o),e.padding(e.position,4)}return{layers:n}}(e,i));default:return{signature:t,key:n,_isUnknown:!0,data:e.take(i)}}}(e,i,r,o),c=o-(e.position-a);return e.pass(c),e.padding(o,n),s}function ew(e,t,n){const i=[];for(;i.length<t;)i.push(tw(e,n));return i.map((t=>{const i=function(e,t,n,i){const r=new Map,{length:o}=t;for(let a=0;a<o;a++){const[o,s]=t[a],l=xw(e.read("u16"));switch(l){case pw.RawData:{const t=e.take(s);r.set(o,{compression:l,data:t});break}case pw.RleCompressed:{const t=e.take(s>0?iw(e,nw(n,o),i.rleScanlineLengthFieldReadType):s);r.set(o,{compression:l,data:t});break}}}return r}(e,t.channelInformation,t,n);return[t,i]})).reverse()}function tw(e,t){const[n,i,r,o]=function(e){const t=e.read("i32"),n=e.read("i32");let i=e.read("i32");0!==i&&(i-=1);let r=e.read("i32");return 0!==r&&(r-=1),[t,n,i,r]}(e),a=e.read("u16"),s=[];for(;s.length<a;){const n=e.read("i16"),i=e.read(t.layerRecordSectionChannelLengthFieldReadType)-2;s.push([n,i])}if("8BIM"!==e.readString(4))throw new jb;const l=MC(e.readString(4)),c=e.read("u8"),u=function(e){if(e===IC.Base)return IC.Base;if(e===IC.NonBase)return IC.NonBase;throw new Yb}(e.read("u8")),{hidden:h,transparencyLocked:d}=function(e){const t=e.read("u8");return{transparencyLocked:!!(1&t),hidden:!!(2&t)}}(e);e.pass(1);const f=e.read("u32"),p=e.position,g=function(e){const t=e.read("u32"),n=e.position,[i,r,o,a]=rw(e),s=e.read("u8"),l=sw(e),c=t>=36?function(e){const t=sw(e),n=e.read("u8"),[i,r,o,a]=rw(e);return{top:i,left:r,bottom:o,right:a,flags:t,backgroundColor:n}}(e):void 0,u=l.masksHaveParametersApplied?function(e){const t=e.read("u8");return{userMaskDensity:t&aw.UserMaskDensity?e.read("u8"):void 0,userMaskFeather:t&aw.UserMaskFeather?e.read("f64"):void 0,vectorMaskDensity:t&aw.VectorMaskDensity?e.read("u8"):void 0,vectorMaskFeather:t&aw.VectorMaskFeather?e.read("f64"):void 0}}(e):void 0,h=t-(e.position-n);return e.pass(h),{top:i,left:r,bottom:o,right:a,backgroundColor:s,flags:l,parameters:u,realData:c}}(e);e.pass(e.read("u32"));const v=e.read("u8");let A=e.readString(v);e.padding(v+1,4);const m=[];for(;e.position-p<f;)m.push(ZC(e,t));let y,b,C;for(const w of m)if(!w._isUnknown)switch(w.key){case _b.SectionDividerSetting:({dividerType:y}=w);break;case _b.TypeToolObjectSetting:{const e=w.textData.descriptor.items.get("Txt ");e&&e.type===OC.String&&(b=e.value);const t=w.textData.descriptor.items.get("EngineData");t&&t.type===OC.RawData&&(C=ax(t.data));break}case _b.UnicodeLayerName:({name:A}=w)}return{name:A,channelInformation:s,top:n,left:i,bottom:r,right:o,hidden:h,transparencyLocked:d,opacity:c,clipping:u,blendMode:l,additionalLayerInfos:m,dividerType:y,layerText:b,engineData:C,maskData:g}}function nw(e,t){switch(t){case gw.UserSuppliedLayerMask:return _C(e.maskData);case gw.RealUserSuppliedLayerMask:return _C(function(e){const t=e.maskData.realData;if(!t)throw new Error("missing real mask data");return t}(e));default:return _C(e)+1}}function iw(e,t,n){return Array.from(Array(t),(()=>e.read(n))).reduce(((e,t)=>e+t))}function rw(e){return Array.from(Array(4),(()=>e.read("i32")))}var ow,aw;function sw(e){const t=e.read("u8");return{positionRelativeToLayer:!!(t&ow.PositionRelativeToLayer),layerMaskDisabled:!!(t&ow.LayerMaskDisabled),invertMaskWhenBlending:!!(t&ow.InvertMaskWhenBlending),userMaskFromRenderingOtherData:!!(t&ow.UserMaskFromRenderingOtherData),masksHaveParametersApplied:!!(t&ow.MasksHaveParametersApplied)}}function lw(e,t){const n=new wC(e);n.pass(t.layerAndMaskSectionLengthFieldSize),n.pass(t.layerInfoSectionLengthFieldSize);const i=n.read("i16"),r=Math.abs(i),o=ew(n,r,t);n.padding(n.position,4),n.pass(n.read("u32"));const a=function(e,t){const n=[];for(;e.position<e.length;)n.push(ZC(e,t,4));return VC(n.map((e=>[e.key,e])))}(n,t),s=[],l=[],c=[],u=[{startIndex:0,groupId:0,parentGroupId:0}];let h=0;for(let d=0;d<r;d++){const[e,t]=o[d],n=u[u.length-1].groupId,{dividerType:i}=e;if(i===vw.CloseFolder||i===vw.OpenFolder)h+=1,u.push({startIndex:s.length,groupId:h,parentGroupId:n,layerRecord:e}),c.push("G");else if(i===vw.BoundingSection){const t=u.pop();if(void 0===t)throw new Gb;const n=t.groupId>0?t.groupId:void 0,i=t.layerRecord||e;l.push(HC.create(i.name,t.groupId,i,n)),c.push("D")}else s.push(zC.create(e,t,n)),c.push("L")}return l.sort(((e,t)=>e.id-t.id)),{layers:s,groups:l,orders:c,globalAdditionalLayerInformation:a}}!function(e){e[e.PositionRelativeToLayer=1]="PositionRelativeToLayer",e[e.LayerMaskDisabled=2]="LayerMaskDisabled",e[e.InvertMaskWhenBlending=4]="InvertMaskWhenBlending",e[e.UserMaskFromRenderingOtherData=8]="UserMaskFromRenderingOtherData",e[e.MasksHaveParametersApplied=16]="MasksHaveParametersApplied"}(ow||(ow={})),function(e){e[e.UserMaskDensity=1]="UserMaskDensity",e[e.UserMaskFeather=2]="UserMaskFeather",e[e.VectorMaskDensity=4]="VectorMaskDensity",e[e.VectorMaskFeather=8]="VectorMaskFeather"}(aw||(aw={}));function cw(e,t,n=4){const i=(4===n?e.getUint32(t):bC(e,t))+n;return{start:t,end:t+i,size:i}}function uw(e){const t=new DataView(e),n=function(e){const t=new wC(e),n=t.take(4);if(!kb(n,LC))throw new Ob;const i=t.read("u16");if(i!==DC.PSD&&i!==DC.PSB)throw new Tb;const r=fw(i),o=t.take(6);if(!kb(o,PC))throw new Db;const a=t.read("u16");if(!xC(a,1,56))throw new Lb;const s=t.read("u32"),l=t.read("u32");if(!xC(s,1,r.maxPixels)||!xC(l,1,r.maxPixels))throw new Pb;const c=t.read("u16");if(!jC.includes(c))throw new Qb;const u=t.read("u16");if(!(u in kC))throw new Mb;return{channelCount:a,version:i,width:l,height:s,depth:c,colorMode:u}}(new DataView(e,0,26)),i=fw(n.version),r=cw(t,26),o=cw(t,r.end),a=cw(t,o.end,i.layerAndMaskSectionLengthFieldSize);return{fileHeader:n,colorModeData:new DataView(e,r.size),imageResources:new DataView(e,o.start,o.size),layerAndMaskInformation:new DataView(e,a.start,a.size),imageData:new DataView(e,a.end)}}const hw={maxPixels:3e4,rleScanlineLengthFieldSize:2,rleScanlineLengthFieldReadType:"u16",layerAndMaskSectionLengthFieldSize:4,layerInfoSectionLengthFieldSize:4,layerRecordSectionChannelLengthFieldReadType:"u32",aliLengthFieldSizeIsVariable:!1},dw={maxPixels:3e5,rleScanlineLengthFieldSize:4,rleScanlineLengthFieldReadType:"u32",layerAndMaskSectionLengthFieldSize:8,layerInfoSectionLengthFieldSize:8,layerRecordSectionChannelLengthFieldReadType:"u64",aliLengthFieldSizeIsVariable:!0};function fw(e){switch(e){case DC.PSD:return hw;case DC.PSB:return dw;default:throw new Tb}}var pw,gw,vw,Aw,mw,yw,bw,Cw,ww;function xw(e){if(!(e in pw))throw new Nb;return e}function _w(e){if(!(e in Aw))throw new Kb;return e}function Ew(e){if(!(e in yw))throw new Zb(`Invalid slice origin: ${e}`);return e}function Sw(e,t=255){if(!(0<=t&&t<=255))throw new Wb;const n=e.length/4,i=function(e){switch(e){case gw.Red:return 0;case gw.Green:return 1;case gw.Blue:return 2;case gw.TransparencyMask:return 3;default:throw new zb}}(gw.TransparencyMask),r=t/255;for(let o=0;o<n;o++){const t=4*o+i;e[t]=Math.floor(r*e[t])}return e}!function(e){e[e.RawData=0]="RawData",e[e.RleCompressed=1]="RleCompressed",e[e.ZipWithoutPrediction=2]="ZipWithoutPrediction",e[e.ZipWithPrediction=3]="ZipWithPrediction"}(pw||(pw={})),function(e){e[e.Red=0]="Red",e[e.Green=1]="Green",e[e.Blue=2]="Blue",e[e.TransparencyMask=-1]="TransparencyMask",e[e.UserSuppliedLayerMask=-2]="UserSuppliedLayerMask",e[e.RealUserSuppliedLayerMask=-3]="RealUserSuppliedLayerMask"}(gw||(gw={})),function(e){e[e.Other=0]="Other",e[e.OpenFolder=1]="OpenFolder",e[e.CloseFolder=2]="CloseFolder",e[e.BoundingSection=3]="BoundingSection"}(vw||(vw={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal"}(Aw||(Aw={})),function(e){e[e.GridAndGuides=1032]="GridAndGuides",e[e.Slices=1050]="Slices",e[e.ICCProfile=1039]="ICCProfile",e[e.GlobalLightAngle=1037]="GlobalLightAngle",e[e.GlobalLightAltitude=1049]="GlobalLightAltitude",e[e.ResolutionInfo=1005]="ResolutionInfo"}(mw||(mw={})),function(e){e[e.AutoGenerated=0]="AutoGenerated",e[e.LayerGenerated=1]="LayerGenerated",e[e.UserGenerated=2]="UserGenerated"}(yw||(yw={})),function(e){e[e.PixelsPerInch=1]="PixelsPerInch",e[e.PixelsPerCM=2]="PixelsPerCM"}(bw||(bw={})),function(e){e[e.Inch=1]="Inch",e[e.CM=2]="CM",e[e.Point=3]="Point",e[e.Pica=4]="Pica",e[e.Column=5]="Column"}(Cw||(Cw={})),function(e){e.Class="Clss",e.Enumerated="Enmr",e.Identifier="Idnt",e.Index="indx",e.Name="name",e.Offset="rele",e.Property="prop"}(ww||(ww={}));let Iw,kw,Bw,Ow,Tw,Dw,Mw,Qw,Lw,Pw,jw=h(void 0,null,(function*(){let e;Bw=function(t){e=t};const t=new Array(128).fill(void 0);function n(e){return t[e]}t.push(void 0,null,!0,!1);let i=t.length;function r(e){const r=n(e);return function(e){e<132||(t[e]=i,i=e)}(e),r}let o=new(typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});o.decode();let a=null;function s(){return(null===a||0===a.byteLength)&&(a=new Uint8Array(e.memory.buffer)),a}let l=0;function c(e,t){const n=t(1*e.length,1)>>>0;return s().set(e,n/1),l=e.length,n}let u=null;function d(){return(null===u||0===u.byteLength)&&(u=new Int32Array(e.memory.buffer)),u}function f(e,t){return e>>>=0,s().subarray(e/1,e/1+t)}Lw=function(t,n,i,r,o,a,s){try{const g=e.__wbindgen_add_to_stack_pointer(-16),v=c(n,e.__wbindgen_malloc),A=l,m=c(r,e.__wbindgen_malloc),y=l,b=c(a,e.__wbindgen_malloc),C=l;e.decode_rgb(g,t,v,A,i,m,y,o,b,C,s);var u=d()[g/4+0],h=d()[g/4+1],p=f(u,h).slice();return e.__wbindgen_free(u,1*h),p}finally{e.__wbindgen_add_to_stack_pointer(16)}},Pw=function(t,n,i,r,o,a,s,u,h){try{const A=e.__wbindgen_add_to_stack_pointer(-16),m=c(n,e.__wbindgen_malloc),y=l,b=c(r,e.__wbindgen_malloc),C=l,w=c(a,e.__wbindgen_malloc),x=l,_=c(u,e.__wbindgen_malloc),E=l;e.decode_rgba(A,t,m,y,i,b,C,o,w,x,s,_,E,h);var p=d()[A/4+0],g=d()[A/4+1],v=f(p,g).slice();return e.__wbindgen_free(p,1*g),v}finally{e.__wbindgen_add_to_stack_pointer(16)}},Mw=function(t,n,i){try{const s=e.__wbindgen_add_to_stack_pointer(-16),u=c(n,e.__wbindgen_malloc),h=l;e.decode_grayscale(s,t,u,h,i);var r=d()[s/4+0],o=d()[s/4+1],a=f(r,o).slice();return e.__wbindgen_free(r,1*o),a}finally{e.__wbindgen_add_to_stack_pointer(16)}},Qw=function(t,n,i,r,o){try{const h=e.__wbindgen_add_to_stack_pointer(-16),p=c(n,e.__wbindgen_malloc),g=l,v=c(r,e.__wbindgen_malloc),A=l;e.decode_grayscale_a(h,t,p,g,i,v,A,o);var a=d()[h/4+0],s=d()[h/4+1],u=f(a,s).slice();return e.__wbindgen_free(a,1*s),u}finally{e.__wbindgen_add_to_stack_pointer(16)}};let p=new(typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder)("utf-8");const g="function"==typeof p.encodeInto?function(e,t){return p.encodeInto(e,t)}:function(e,t){const n=p.encode(e);return t.set(n),{read:e.length,written:n.length}};kw=function(){return function(e){i===t.length&&t.push(t.length+1);const n=i;return i=t[n],t[n]=e,n}(new Error)},Ow=function(t,i){const r=function(e,t,n){if(void 0===n){const n=p.encode(e),i=t(n.length,1)>>>0;return s().subarray(i,i+n.length).set(n),l=n.length,i}let i=e.length,r=t(i,1)>>>0;const o=s();let a=0;for(;a<i;a++){const t=e.charCodeAt(a);if(t>127)break;o[r+a]=t}if(a!==i){0!==a&&(e=e.slice(a)),r=n(r,i,i=a+3*e.length,1)>>>0;const t=s().subarray(r+a,r+i);a+=g(e,t).written}return l=a,r}(n(i).stack,e.__wbindgen_malloc,e.__wbindgen_realloc),o=l;d()[t/4+1]=o,d()[t/4+0]=r},Iw=function(t,n){let i,r;try{i=t,r=n}finally{e.__wbindgen_free(i,r,1)}},Tw=function(e){r(e)},Dw=function(e,t){throw new Error(function(e,t){return e>>>=0,o.decode(s().subarray(e,e+t))}(e,t))},URL=globalThis.URL;const v=yield((...e)=>h(void 0,[...e],(function*(e={},t){let n;if(t.startsWith("data:")){const i=t.replace(/^data:.*?base64,/,"");let r;if("function"==typeof Buffer&&"function"==typeof Buffer.from)r=Buffer.from(i,"base64");else{if("function"!=typeof atob)throw new Error("Cannot decode base64-encoded data URL");{const e=atob(i);r=new Uint8Array(e.length);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t)}}n=yield WebAssembly.instantiate(r,e)}else{const i=yield fetch(t),r=i.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&r.startsWith("application/wasm"))n=yield WebAssembly.instantiateStreaming(i,e);else{const t=yield i.arrayBuffer();n=yield WebAssembly.instantiate(t,e)}}return n.instance.exports})))({"./webtoon_psd_decoder_bg.js":{__wbg_new_abda76e883ba8a5f:kw,__wbg_stack_658279fe44541cf6:Ow,__wbg_error_f851667af71bcfc6:Iw,__wbindgen_object_drop_ref:Tw,__wbindgen_throw:Dw}},"data:application/wasm;base64,AGFzbQEAAAABbw9gAn9/AX9gAn9/AGADf39/AX9gAX8Bf2ABfwBgA39/fwBgAX8BfmAAAX9gBX9/f39/AGAAAGAEf39/fwF/YA5/f39/f39/f39/f39/fwBgC39/f39/f39/f39/AGAEf39/fwBgCH9/f39/f39/AAKYAgUbLi93ZWJ0b29uX3BzZF9kZWNvZGVyX2JnLmpzGl9fd2JnX25ld19hYmRhNzZlODgzYmE4YTVmAAcbLi93ZWJ0b29uX3BzZF9kZWNvZGVyX2JnLmpzHF9fd2JnX3N0YWNrXzY1ODI3OWZlNDQ1NDFjZjYAARsuL3dlYnRvb25fcHNkX2RlY29kZXJfYmcuanMcX193YmdfZXJyb3JfZjg1MTY2N2FmNzFiY2ZjNgABGy4vd2VidG9vbl9wc2RfZGVjb2Rlcl9iZy5qcxpfX3diaW5kZ2VuX29iamVjdF9kcm9wX3JlZgAEGy4vd2VidG9vbl9wc2RfZGVjb2Rlcl9iZy5qcxBfX3diaW5kZ2VuX3Rocm93AAEDVVQDBAICAQAAAAAEAQcICwUMAQEIDQ4BCAEAAAAFAQICCQAJAQoBCgMBBAUBBAMDAQAKBQMAAAAAAAEDAAMDAQMAAAMJAwMDAwECAgcAAAMDAQYGBgQEBQFwASUlBQMBABEGCQF/AUGAgMAACwfHAQsGbWVtb3J5AgAHbWFpbl9qcwAkCmRlY29kZV9yZ2IAFAtkZWNvZGVfcmdiYQASEGRlY29kZV9ncmF5c2NhbGUAGxJkZWNvZGVfZ3JheXNjYWxlX2EAGR9fX3diaW5kZ2VuX2FkZF90b19zdGFja19wb2ludGVyAEYRX193YmluZGdlbl9tYWxsb2MAJQ9fX3diaW5kZ2VuX2ZyZWUANhJfX3diaW5kZ2VuX3JlYWxsb2MAKhBfX3diaW5kZ2VuX3N0YXJ0ACQJKgEAQQELJFhUVFRYIgsdMCMNH1g5RRpYIgweMFZVLRYcJz1XRDs/OjhYVwr0lwFU/CACD38BfiMAQRBrIgskAAJAAkACQAJAAkACQCAAQfUBTwRAQQhBCBA0IQZBFEEIEDQhBUEQQQgQNCEBQQBBEEEIEDRBAnRrIgJBgIB8IAEgBSAGamprQXdxQQNrIgEgASACSxsgAE0NBiAAQQRqQQgQNCEEQdiQwAAoAgBFDQVBACAEayEDAn9BACAEQYACSQ0AGkEfIARB////B0sNABogBEEGIARBCHZnIgBrdkEBcSAAQQF0a0E+agsiBkECdEG8jcAAaigCACIBDQFBACEAQQAhBQwCC0EQIABBBGpBEEEIEDRBBWsgAEsbQQgQNCEEAkACQAJAAn8CQAJAQdSQwAAoAgAiASAEQQN2IgB2IgJBA3FFBEAgBEHckMAAKAIATQ0LIAINAUHYkMAAKAIAIgBFDQsgABBAaEECdEG8jcAAaigCACIBEEggBGshAyABEDEiAARAA0AgABBIIARrIgIgAyACIANJIgIbIQMgACABIAIbIQEgABAxIgANAAsLIAEgBBBQIQUgARAOQRBBCBA0IANLDQUgASAEEEIgBSADEDNB3JDAACgCACIARQ0EIABBeHFBzI7AAGohB0HkkMAAKAIAIQZB1JDAACgCACICQQEgAEEDdnQiAHFFDQIgBygCCAwDCwJAIAJBf3NBAXEgAGoiA0EDdCIAQdSOwABqKAIAIgVBCGooAgAiAiAAQcyOwABqIgBHBEAgAiAANgIMIAAgAjYCCAwBC0HUkMAAIAFBfiADd3E2AgALIAUgA0EDdBAvIAUQUiEDDAsLAkBBASAAQR9xIgB0EDcgAiAAdHEQQGgiAkEDdCIAQdSOwABqKAIAIgNBCGooAgAiASAAQcyOwABqIgBHBEAgASAANgIMIAAgATYCCAwBC0HUkMAAQdSQwAAoAgBBfiACd3E2AgALIAMgBBBCIAMgBBBQIgUgAkEDdCAEayICEDNB3JDAACgCACIABEAgAEF4cUHMjsAAaiEHQeSQwAAoAgAhBgJ/QdSQwAAoAgAiAUEBIABBA3Z0IgBxBEAgBygCCAwBC0HUkMAAIAAgAXI2AgAgBwshACAHIAY2AgggACAGNgIMIAYgBzYCDCAGIAA2AggLQeSQwAAgBTYCAEHckMAAIAI2AgAgAxBSIQMMCgtB1JDAACAAIAJyNgIAIAcLIQAgByAGNgIIIAAgBjYCDCAGIAc2AgwgBiAANgIIC0HkkMAAIAU2AgBB3JDAACADNgIADAELIAEgAyAEahAvCyABEFIiAw0FDAQLIAQgBhAydCEHQQAhAEEAIQUDQAJAIAEQSCICIARJDQAgAiAEayICIANPDQAgASEFIAIiAw0AQQAhAyABIQAMAwsgAUEUaigCACICIAAgAiABIAdBHXZBBHFqQRBqKAIAIgFHGyAAIAIbIQAgB0EBdCEHIAENAAsLIAAgBXJFBEBBACEFQQEgBnQQN0HYkMAAKAIAcSIARQ0DIAAQQGhBAnRBvI3AAGooAgAhAAsgAEUNAQsDQCAAIAUgABBIIgEgBE8gASAEayICIANJcSIBGyEFIAIgAyABGyEDIAAQMSIADQALCyAFRQ0AIARB3JDAACgCACIATSADIAAgBGtPcQ0AIAUgBBBQIQYgBRAOAkBBEEEIEDQgA00EQCAFIAQQQiAGIAMQMyADQYACTwRAIAYgAxAPDAILIANBeHFBzI7AAGohAgJ/QdSQwAAoAgAiAUEBIANBA3Z0IgBxBEAgAigCCAwBC0HUkMAAIAAgAXI2AgAgAgshACACIAY2AgggACAGNgIMIAYgAjYCDCAGIAA2AggMAQsgBSADIARqEC8LIAUQUiIDDQELAkACQAJAAkACQAJAAkAgBEHckMAAKAIAIgBLBEBB4JDAACgCACIAIARLDQJBCEEIEDQgBGpBFEEIEDRqQRBBCBA0akGAgAQQNCIAQRB2QAAhASALQQA2AgggC0EAIABBgIB8cSABQX9GIgAbNgIEIAtBACABQRB0IAAbNgIAIAsoAgAiCA0BQQAhAwwIC0HkkMAAKAIAIQJBEEEIEDQgACAEayIBSwRAQeSQwABBADYCAEHckMAAKAIAIQBB3JDAAEEANgIAIAIgABAvIAIQUiEDDAgLIAIgBBBQIQBB3JDAACABNgIAQeSQwAAgADYCACAAIAEQMyACIAQQQiACEFIhAwwHCyALKAIIIQxB7JDAACALKAIEIgpB7JDAACgCAGoiATYCAEHwkMAAQfCQwAAoAgAiACABIAAgAUsbNgIAAkACQAJAQeiQwAAoAgAEQEG8jsAAIQADQCAAEEMgCEYNAiAAKAIIIgANAAsMAgtB+JDAACgCACIARSAAIAhLcg0FDAcLIAAQSg0AIAAQSyAMRw0AIAAoAgAiAkHokMAAKAIAIgFNBH8gAiAAKAIEaiABSwVBAAsNAQtB+JDAAEH4kMAAKAIAIgAgCCAAIAhJGzYCACAIIApqIQFBvI7AACEAAkACQANAIAEgACgCAEcEQCAAKAIIIgANAQwCCwsgABBKDQAgABBLIAxGDQELQeiQwAAoAgAhCUG8jsAAIQACQANAIAkgACgCAE8EQCAAEEMgCUsNAgsgACgCCCIADQALQQAhAAsgCSAAEEMiBkEUQQgQNCIPa0EXayIBEFIiAEEIEDQgAGsgAWoiACAAQRBBCBA0IAlqSRsiDRBSIQ4gDSAPEFAhAEEIQQgQNCEDQRRBCBA0IQVBEEEIEDQhAkHokMAAIAggCBBSIgFBCBA0IAFrIgEQUCIHNgIAQeCQwAAgCkEIaiACIAMgBWpqIAFqayIDNgIAIAcgA0EBcjYCBEEIQQgQNCEFQRRBCBA0IQJBEEEIEDQhASAHIAMQUCABIAIgBUEIa2pqNgIEQfSQwABBgICAATYCACANIA8QQkG8jsAAKQIAIRAgDkEIakHEjsAAKQIANwIAIA4gEDcCAEHIjsAAIAw2AgBBwI7AACAKNgIAQbyOwAAgCDYCAEHEjsAAIA42AgADQCAAQQQQUCAAQQc2AgQiAEEEaiAGSQ0ACyAJIA1GDQcgCSANIAlrIgAgCSAAEFAQLiAAQYACTwRAIAkgABAPDAgLIABBeHFBzI7AAGohAgJ/QdSQwAAoAgAiAUEBIABBA3Z0IgBxBEAgAigCCAwBC0HUkMAAIAAgAXI2AgAgAgshACACIAk2AgggACAJNgIMIAkgAjYCDCAJIAA2AggMBwsgACgCACEDIAAgCDYCACAAIAAoAgQgCmo2AgQgCBBSIgVBCBA0IQIgAxBSIgFBCBA0IQAgCCACIAVraiIGIAQQUCEHIAYgBBBCIAMgACABa2oiACAEIAZqayEEQeiQwAAoAgAgAEcEQCAAQeSQwAAoAgBGDQMgACgCBEEDcUEBRw0FAkAgABBIIgVBgAJPBEAgABAODAELIABBDGooAgAiAiAAQQhqKAIAIgFHBEAgASACNgIMIAIgATYCCAwBC0HUkMAAQdSQwAAoAgBBfiAFQQN2d3E2AgALIAQgBWohBCAAIAUQUCEADAULQeiQwAAgBzYCAEHgkMAAQeCQwAAoAgAgBGoiADYCACAHIABBAXI2AgQgBhBSIQMMBwsgACAAKAIEIApqNgIEQeCQwAAoAgAgCmohAUHokMAAKAIAIgAgABBSIgBBCBA0IABrIgAQUCEDQeCQwAAgASAAayIFNgIAQeiQwAAgAzYCACADIAVBAXI2AgRBCEEIEDQhAkEUQQgQNCEBQRBBCBA0IQAgAyAFEFAgACABIAJBCGtqajYCBEH0kMAAQYCAgAE2AgAMBQtB4JDAACAAIARrIgE2AgBB6JDAAEHokMAAKAIAIgIgBBBQIgA2AgAgACABQQFyNgIEIAIgBBBCIAIQUiEDDAULQeSQwAAgBzYCAEHckMAAQdyQwAAoAgAgBGoiADYCACAHIAAQMyAGEFIhAwwEC0H4kMAAIAg2AgAMAQsgByAEIAAQLiAEQYACTwRAIAcgBBAPIAYQUiEDDAMLIARBeHFBzI7AAGohAgJ/QdSQwAAoAgAiAUEBIARBA3Z0IgBxBEAgAigCCAwBC0HUkMAAIAAgAXI2AgAgAgshACACIAc2AgggACAHNgIMIAcgAjYCDCAHIAA2AgggBhBSIQMMAgtB/JDAAEH/HzYCAEHIjsAAIAw2AgBBwI7AACAKNgIAQbyOwAAgCDYCAEHYjsAAQcyOwAA2AgBB4I7AAEHUjsAANgIAQdSOwABBzI7AADYCAEHojsAAQdyOwAA2AgBB3I7AAEHUjsAANgIAQfCOwABB5I7AADYCAEHkjsAAQdyOwAA2AgBB+I7AAEHsjsAANgIAQeyOwABB5I7AADYCAEGAj8AAQfSOwAA2AgBB9I7AAEHsjsAANgIAQYiPwABB/I7AADYCAEH8jsAAQfSOwAA2AgBBkI/AAEGEj8AANgIAQYSPwABB/I7AADYCAEGYj8AAQYyPwAA2AgBBjI/AAEGEj8AANgIAQZSPwABBjI/AADYCAEGgj8AAQZSPwAA2AgBBnI/AAEGUj8AANgIAQaiPwABBnI/AADYCAEGkj8AAQZyPwAA2AgBBsI/AAEGkj8AANgIAQayPwABBpI/AADYCAEG4j8AAQayPwAA2AgBBtI/AAEGsj8AANgIAQcCPwABBtI/AADYCAEG8j8AAQbSPwAA2AgBByI/AAEG8j8AANgIAQcSPwABBvI/AADYCAEHQj8AAQcSPwAA2AgBBzI/AAEHEj8AANgIAQdiPwABBzI/AADYCAEHgj8AAQdSPwAA2AgBB1I/AAEHMj8AANgIAQeiPwABB3I/AADYCAEHcj8AAQdSPwAA2AgBB8I/AAEHkj8AANgIAQeSPwABB3I/AADYCAEH4j8AAQeyPwAA2AgBB7I/AAEHkj8AANgIAQYCQwABB9I/AADYCAEH0j8AAQeyPwAA2AgBBiJDAAEH8j8AANgIAQfyPwABB9I/AADYCAEGQkMAAQYSQwAA2AgBBhJDAAEH8j8AANgIAQZiQwABBjJDAADYCAEGMkMAAQYSQwAA2AgBBoJDAAEGUkMAANgIAQZSQwABBjJDAADYCAEGokMAAQZyQwAA2AgBBnJDAAEGUkMAANgIAQbCQwABBpJDAADYCAEGkkMAAQZyQwAA2AgBBuJDAAEGskMAANgIAQayQwABBpJDAADYCAEHAkMAAQbSQwAA2AgBBtJDAAEGskMAANgIAQciQwABBvJDAADYCAEG8kMAAQbSQwAA2AgBB0JDAAEHEkMAANgIAQcSQwABBvJDAADYCAEHMkMAAQcSQwAA2AgBBCEEIEDQhBUEUQQgQNCECQRBBCBA0IQFB6JDAACAIIAgQUiIAQQgQNCAAayIAEFAiAzYCAEHgkMAAIApBCGogASACIAVqaiAAamsiBTYCACADIAVBAXI2AgRBCEEIEDQhAkEUQQgQNCEBQRBBCBA0IQAgAyAFEFAgACABIAJBCGtqajYCBEH0kMAAQYCAgAE2AgALQQAhA0HgkMAAKAIAIgAgBE0NAEHgkMAAIAAgBGsiATYCAEHokMAAQeiQwAAoAgAiAiAEEFAiADYCACAAIAFBAXI2AgQgAiAEEEIgAhBSIQMLIAtBEGokACADC5gHAQV/IAAQUyIAIAAQSCIBEFAhAgJAAkACQCAAEEkNACAAKAIAIQMCQCAAEEFFBEAgASADaiEBIAAgAxBRIgBB5JDAACgCAEcNASACKAIEQQNxQQNHDQJB3JDAACABNgIAIAAgASACEC4PCyABIANqQRBqIQAMAgsgA0GAAk8EQCAAEA4MAQsgAEEMaigCACIEIABBCGooAgAiBUcEQCAFIAQ2AgwgBCAFNgIIDAELQdSQwABB1JDAACgCAEF+IANBA3Z3cTYCAAsCQCACED4EQCAAIAEgAhAuDAELAkACQAJAQeiQwAAoAgAgAkcEQCACQeSQwAAoAgBHDQFB5JDAACAANgIAQdyQwABB3JDAACgCACABaiICNgIAIAAgAhAzDwtB6JDAACAANgIAQeCQwABB4JDAACgCACABaiICNgIAIAAgAkEBcjYCBCAAQeSQwAAoAgBGDQEMAgsgAhBIIgMgAWohAQJAIANBgAJPBEAgAhAODAELIAJBDGooAgAiBCACQQhqKAIAIgJHBEAgAiAENgIMIAQgAjYCCAwBC0HUkMAAQdSQwAAoAgBBfiADQQN2d3E2AgALIAAgARAzIABB5JDAACgCAEcNAkHckMAAIAE2AgAMAwtB3JDAAEEANgIAQeSQwABBADYCAAtB9JDAACgCACACTw0BQQhBCBA0IQBBFEEIEDQhAkEQQQgQNCEDQQBBEEEIEDRBAnRrIgFBgIB8IAMgACACamprQXdxQQNrIgAgACABSxtFDQFB6JDAACgCAEUNAUEIQQgQNCEAQRRBCBA0IQJBEEEIEDQhAUEAIQMCQEHgkMAAKAIAIgQgASACIABBCGtqaiIATQ0AIAQgAGtB//8DakGAgHxxIgRBgIAEayECQeiQwAAoAgAhAUG8jsAAIQACQANAIAEgACgCAE8EQCAAEEMgAUsNAgsgACgCCCIADQALQQAhAAsgABBKDQAgAEEMaigCABoMAAsQEEEAIANrRw0BQeCQwAAoAgBB9JDAACgCAE0NAUH0kMAAQX82AgAPCyABQYACSQ0BIAAgARAPQfyQwABB/JDAACgCAEEBayIANgIAIAANABAQGg8LDwsgAUF4cUHMjsAAaiECAn9B1JDAACgCACIDQQEgAUEDdnQiAXEEQCACKAIIDAELQdSQwAAgASADcjYCACACCyEDIAIgADYCCCADIAA2AgwgACACNgIMIAAgAzYCCAvIDQEMfwJAAkAgACgCCCIKIAAoAhAiA3IEQAJAIANFDQAgASACaiEIIABBFGooAgBBAWohByABIQQDQAJAIAQhAyAHQQFrIgdFDQAgAyAIRg0CAn8gAywAACIEQQBOBEAgBEH/AXEhBSADQQFqDAELIAMtAAFBP3EhCSAEQR9xIQUgBEFfTQRAIAVBBnQgCXIhBSADQQJqDAELIAMtAAJBP3EgCUEGdHIhCSAEQXBJBEAgCSAFQQx0ciEFIANBA2oMAQsgBUESdEGAgPAAcSADLQADQT9xIAlBBnRyciIFQYCAxABGDQMgA0EEagsiBCAGIANraiEGIAVBgIDEAEcNAQwCCwsgAyAIRg0AIAMsAAAiBEEATiAEQWBJciAEQXBJckUEQCAEQf8BcUESdEGAgPAAcSADLQADQT9xIAMtAAJBP3FBBnQgAy0AAUE/cUEMdHJyckGAgMQARg0BCwJAAkAgBkUNACACIAZNBEBBACEDIAIgBkYNAQwCC0EAIQMgASAGaiwAAEFASA0BCyABIQMLIAYgAiADGyECIAMgASADGyEBCyAKRQ0CIABBDGooAgAhDAJAIAJBEE8EQAJ/QQAhBUEAIQcCQAJAIAEiA0EDakF8cSIEIANrIgggAksgCEEES3INACACIAhrIglBBEkNACAJQQNxIQpBACEGAkAgAyAERg0AIAhBA3EhBQJAIAQgA0F/c2pBA0kEQCADIQQMAQsgCEF8cSELIAMhBANAIAYgBCwAAEG/f0pqIAQsAAFBv39KaiAELAACQb9/SmogBCwAA0G/f0pqIQYgBEEEaiEEIAtBBGsiCw0ACwsgBUUNAANAIAYgBCwAAEG/f0pqIQYgBEEBaiEEIAVBAWsiBQ0ACwsgAyAIaiEDAkAgCkUNACADIAlBfHFqIgQsAABBv39KIQcgCkEBRg0AIAcgBCwAAUG/f0pqIQcgCkECRg0AIAcgBCwAAkG/f0pqIQcLIAlBAnYhCCAGIAdqIQUDQCADIQYgCEUNAkHAASAIIAhBwAFPGyIHQQNxIQkgB0ECdCELAkAgB0H8AXEiCkUEQEEAIQQMAQsgBiAKQQJ0aiENQQAhBANAIANFDQEgBCADKAIAIg5Bf3NBB3YgDkEGdnJBgYKECHFqIANBBGooAgAiBEF/c0EHdiAEQQZ2ckGBgoQIcWogA0EIaigCACIEQX9zQQd2IARBBnZyQYGChAhxaiADQQxqKAIAIgRBf3NBB3YgBEEGdnJBgYKECHFqIQQgA0EQaiIDIA1HDQALCyAIIAdrIQggBiALaiEDIARBCHZB/4H8B3EgBEH/gfwHcWpBgYAEbEEQdiAFaiEFIAlFDQALAn9BACAGRQ0AGiAGIApBAnRqIgMoAgAiBEF/c0EHdiAEQQZ2ckGBgoQIcSIEIAlBAUYNABogBCADKAIEIgZBf3NBB3YgBkEGdnJBgYKECHFqIgQgCUECRg0AGiAEIAMoAggiA0F/c0EHdiADQQZ2ckGBgoQIcWoLIgNBCHZB/4EccSADQf+B/AdxakGBgARsQRB2IAVqDAILQQAgAkUNARogAkEDcSEEIAJBBE8EQCACQXxxIQYDQCAFIAMsAABBv39KaiADLAABQb9/SmogAywAAkG/f0pqIAMsAANBv39KaiEFIANBBGohAyAGQQRrIgYNAAsLIARFDQADQCAFIAMsAABBv39KaiEFIANBAWohAyAEQQFrIgQNAAsLIAULIQQMAQsgAkUEQEEAIQQMAQsgAkEDcSEFAkAgAkEESQRAQQAhBCABIQMMAQsgAkF8cSEHQQAhBCABIQMDQCAEIAMsAABBv39KaiADLAABQb9/SmogAywAAkG/f0pqIAMsAANBv39KaiEEIANBBGohAyAHQQRrIgcNAAsLIAVFDQADQCAEIAMsAABBv39KaiEEIANBAWohAyAFQQFrIgUNAAsLIAQgDEkEQCAMIARrIgQhBgJAAkACQCAALQAgIgNBACADQQNHGyIDQQFrDgIAAQILQQAhBiAEIQMMAQsgBEEBdiEDIARBAWpBAXYhBgsgA0EBaiEDIABBBGooAgAhBCAAKAIcIQUgACgCACEAAkADQCADQQFrIgNFDQEgACAFIAQoAhARAABFDQALQQEPC0EBIQMgBUGAgMQARg0CIAAgASACIAQoAgwRAgANAkEAIQMDQCADIAZGBEBBAA8LIANBAWohAyAAIAUgBCgCEBEAAEUNAAsgA0EBayAGSQ8LDAILIAAoAgAgASACIAAoAgQoAgwRAgAhAwsgAw8LIAAoAgAgASACIAAoAgQoAgwRAgAL9wQBCn8jAEEwayIDJAAgA0EDOgAoIANCgICAgIAENwMgIANBADYCGCADQQA2AhAgAyABNgIMIAMgADYCCAJ/AkACQCACKAIAIgpFBEAgAkEUaigCACIARQ0BIAIoAhAhASAAQQN0IQUgAEEBa0H/////AXFBAWohByACKAIIIQADQCAAQQRqKAIAIgQEQCADKAIIIAAoAgAgBCADKAIMKAIMEQIADQQLIAEoAgAgA0EIaiABQQRqKAIAEQAADQMgAUEIaiEBIABBCGohACAFQQhrIgUNAAsMAQsgAigCBCIARQ0AIABBBXQhCyAAQQFrQf///z9xQQFqIQcgAigCCCEAA0AgAEEEaigCACIBBEAgAygCCCAAKAIAIAEgAygCDCgCDBECAA0DCyADIAUgCmoiBEEcai0AADoAKCADIARBFGopAgA3AyAgBEEQaigCACEGIAIoAhAhCEEAIQlBACEBAkACQAJAIARBDGooAgBBAWsOAgACAQsgBkEDdCAIaiIMQQRqKAIAQR5HDQEgDCgCACgCACEGC0EBIQELIAMgBjYCFCADIAE2AhAgBEEIaigCACEBAkACQAJAIARBBGooAgBBAWsOAgACAQsgAUEDdCAIaiIGQQRqKAIAQR5HDQEgBigCACgCACEBC0EBIQkLIAMgATYCHCADIAk2AhggCCAEKAIAQQN0aiIBKAIAIANBCGogASgCBBEAAA0CIABBCGohACALIAVBIGoiBUcNAAsLIAJBDGooAgAgB0sEQCADKAIIIAIoAgggB0EDdGoiACgCACAAKAIEIAMoAgwoAgwRAgANAQtBAAwBC0EBCyADQTBqJAALywQBBH8gACABEFAhAgJAAkACQCAAEEkNACAAKAIAIQMCQCAAEEFFBEAgASADaiEBIAAgAxBRIgBB5JDAACgCAEcNASACKAIEQQNxQQNHDQJB3JDAACABNgIAIAAgASACEC4PCyABIANqQRBqIQAMAgsgA0GAAk8EQCAAEA4MAQsgAEEMaigCACIEIABBCGooAgAiBUcEQCAFIAQ2AgwgBCAFNgIIDAELQdSQwABB1JDAACgCAEF+IANBA3Z3cTYCAAsgAhA+BEAgACABIAIQLgwCCwJAQeiQwAAoAgAgAkcEQCACQeSQwAAoAgBHDQFB5JDAACAANgIAQdyQwABB3JDAACgCACABaiIBNgIAIAAgARAzDwtB6JDAACAANgIAQeCQwABB4JDAACgCACABaiIBNgIAIAAgAUEBcjYCBCAAQeSQwAAoAgBHDQFB3JDAAEEANgIAQeSQwABBADYCAA8LIAIQSCIDIAFqIQECQCADQYACTwRAIAIQDgwBCyACQQxqKAIAIgQgAkEIaigCACICRwRAIAIgBDYCDCAEIAI2AggMAQtB1JDAAEHUkMAAKAIAQX4gA0EDdndxNgIACyAAIAEQMyAAQeSQwAAoAgBHDQFB3JDAACABNgIACw8LIAFBgAJPBEAgACABEA8PCyABQXhxQcyOwABqIQICf0HUkMAAKAIAIgNBASABQQN2dCIBcQRAIAIoAggMAQtB1JDAACABIANyNgIAIAILIQEgAiAANgIIIAEgADYCDCAAIAI2AgwgACABNgIIC/cCAQV/AkACQAJAAkAgAUEJTwRAQRBBCBA0IAFLDQEMAgsgABAFIQQMAgtBEEEIEDQhAQtBCEEIEDQhA0EUQQgQNCECQRBBCBA0IQVBAEEQQQgQNEECdGsiBkGAgHwgBSACIANqamtBd3FBA2siAyADIAZLGyABayAATQ0AIAFBECAAQQRqQRBBCBA0QQVrIABLG0EIEDQiA2pBEEEIEDRqQQRrEAUiAkUNACACEFMhAAJAIAFBAWsiBCACcUUEQCAAIQEMAQsgAiAEakEAIAFrcRBTIQJBEEEIEDQhBCAAEEggAiABQQAgAiAAayAETRtqIgEgAGsiAmshBCAAEEFFBEAgASAEECwgACACECwgACACEAkMAQsgACgCACEAIAEgBDYCBCABIAAgAmo2AgALIAEQQQ0BIAEQSCICQRBBCBA0IANqTQ0BIAEgAxBQIQAgASADECwgACACIANrIgMQLCAAIAMQCQwBCyAEDwsgARBSIAEQQRoL0gIBAn8jAEEQayICJAAgACgCACEAAkAgAUH/AE0EQCAAKAIIIgMgACgCAEYEfyAAIAMQFSAAKAIIBSADCyAAKAIEaiABOgAAIAAgACgCCEEBajYCCAwBCyACQQA2AgwCfyABQYAQTwRAIAFBgIAETwRAIAIgAUE/cUGAAXI6AA8gAiABQQZ2QT9xQYABcjoADiACIAFBDHZBP3FBgAFyOgANIAIgAUESdkEHcUHwAXI6AAxBBAwCCyACIAFBP3FBgAFyOgAOIAIgAUEMdkHgAXI6AAwgAiABQQZ2QT9xQYABcjoADUEDDAELIAIgAUE/cUGAAXI6AA0gAiABQQZ2QcABcjoADEECCyEBIAEgACgCACAAKAIIIgNrSwRAIAAgAyABEBMgACgCCCEDCyAAKAIEIANqIAJBDGogARBOGiAAIAEgA2o2AggLIAJBEGokAEEAC9ACAQJ/IwBBEGsiAiQAIAAoAgAhAAJAIAFB/wBNBEAgACgCCCIDIAAoAgBGBEAgACADEBUgACgCCCEDCyAAIANBAWo2AgggACgCBCADaiABOgAADAELIAJBADYCDAJ/IAFBgBBPBEAgAUGAgARPBEAgAiABQT9xQYABcjoADyACIAFBBnZBP3FBgAFyOgAOIAIgAUEMdkE/cUGAAXI6AA0gAiABQRJ2QQdxQfABcjoADEEEDAILIAIgAUE/cUGAAXI6AA4gAiABQQx2QeABcjoADCACIAFBBnZBP3FBgAFyOgANQQMMAQsgAiABQT9xQYABcjoADSACIAFBBnZBwAFyOgAMQQILIQEgASAAKAIAIAAoAggiA2tLBEAgACADIAEQEyAAKAIIIQMLIAAoAgQgA2ogAkEMaiABEE4aIAAgASADajYCCAsgAkEQaiQAQQALywIBAn8jAEEQayICJAACQCABQf8ATQRAIAAoAggiAyAAKAIARgR/IAAgAxAVIAAoAggFIAMLIAAoAgRqIAE6AAAgACAAKAIIQQFqNgIIDAELIAJBADYCDAJ/IAFBgBBPBEAgAUGAgARPBEAgAiABQT9xQYABcjoADyACIAFBBnZBP3FBgAFyOgAOIAIgAUEMdkE/cUGAAXI6AA0gAiABQRJ2QQdxQfABcjoADEEEDAILIAIgAUE/cUGAAXI6AA4gAiABQQx2QeABcjoADCACIAFBBnZBP3FBgAFyOgANQQMMAQsgAiABQT9xQYABcjoADSACIAFBBnZBwAFyOgAMQQILIQEgASAAKAIAIAAoAggiA2tLBEAgACADIAEQEyAAKAIIIQMLIAAoAgQgA2ogAkEMaiABEE4aIAAgASADajYCCAsgAkEQaiQAQQALvAIBBX8gACgCGCEDAkACQCAAIAAoAgxGBEAgAEEUQRAgAEEUaiIBKAIAIgQbaigCACICDQFBACEBDAILIAAoAggiAiAAKAIMIgE2AgwgASACNgIIDAELIAEgAEEQaiAEGyEEA0AgBCEFIAIiAUEUaiICIAFBEGogAigCACICGyEEIAFBFEEQIAIbaigCACICDQALIAVBADYCAAsCQCADRQ0AAkAgACAAKAIcQQJ0QbyNwABqIgIoAgBHBEAgA0EQQRQgAygCECAARhtqIAE2AgAgAUUNAgwBCyACIAE2AgAgAQ0AQdiQwABB2JDAACgCAEF+IAAoAhx3cTYCAA8LIAEgAzYCGCAAKAIQIgIEQCABIAI2AhAgAiABNgIYCyAAQRRqKAIAIgBFDQAgAUEUaiAANgIAIAAgATYCGAsLoAIBBH8gAEIANwIQIAACf0EAIAFBgAJJDQAaQR8gAUH///8HSw0AGiABQQYgAUEIdmciAmt2QQFxIAJBAXRrQT5qCyIDNgIcIANBAnRBvI3AAGohAgJAAkACQAJAQdiQwAAoAgAiBEEBIAN0IgVxBEAgAigCACECIAMQMiEDIAIQSCABRw0BIAIhAwwCC0HYkMAAIAQgBXI2AgAgAiAANgIADAMLIAEgA3QhBANAIAIgBEEddkEEcWpBEGoiBSgCACIDRQ0CIARBAXQhBCADIgIQSCABRw0ACwsgAygCCCIBIAA2AgwgAyAANgIIIAAgAzYCDCAAIAE2AgggAEEANgIYDwsgBSAANgIACyAAIAI2AhggACAANgIIIAAgADYCDAtgAQx/QcSOwAAoAgAiAgRAQbyOwAAhBgNAIAIiASgCCCECIAEoAgQhAyABKAIAIQQgAUEMaigCABogASEGIAVBAWohBSACDQALC0H8kMAAQf8fIAUgBUH/H00bNgIAIAgLlgIBA38gACABaiEHAkACQAJAAkADQCAAIAdHBEAgAC0AACEFIABBAWoiASEAIAVBgAFGDQEgBcBBAE4EQEEAIQYDQCAAIAdGDQQgAiAETw0FIAIgA2ogAC0AADoAACACQQRqIQIgAEEBaiEAIAZB/wFxIAZBAWohBiAFSQ0ACwwCCyABIAdGDQVBASAFayEFIAFBAWohACABLQAAIQZBACEBA0AgAiAETw0FIAIgA2ogBjoAACACQQRqIQIgAUEBaiIBQf8BcSAFQf8BcUkNAAsMAQsLDwtBtIDAAEHBAEGIgcAAECAAC0GAgMAAQRlB+IDAABAgAAtBgIDAAEEZQdSBwAAQIAALQZiBwABBO0HkgcAAECAAC+oEAQt/IwBBEGsiESQAAkACQAJAIAQOAgEAAgtBASEPCwJAAkAgBw4CAQACC0EBIRALQQAhBAJAAkAgCg4CAQACC0EBIQQLQQEhBwJAAkACQCANDgIAAQILQQAhBwsgEUEIaiEYIAIhEiADIRMgDyENIAUhFCAGIRUgECEKIAghFiAJIRcgCyEPIAwhEAJAAkACQAJAAkAgAUECdCIORQRAQQEhAQwBCyAOQQBIDQEgDhArIgFFDQILAkAgDUUEQCATRQ0BQQAhDQNAIA0gDk8NBSABIA1qIBItAAA6AAAgDUEEaiENIBJBAWohEiATQQFrIhMNAAsMAQsgEiATQQAgASAOEBELAkAgCkUEQCAVRQ0BQQEhDQNAIA0gDk8NBSABIA1qIBQtAAA6AAAgDUEEaiENIBRBAWohFCAVQQFrIhUNAAsMAQsgFCAVQQEgASAOEBELAkAgBEUEQCAXRQ0BQQIhDQNAIA0gDk8NBSABIA1qIBYtAAA6AAAgDUEEaiENIBZBAWohFiAXQQFrIhcNAAsMAQsgFiAXQQIgASAOEBELAkAgB0UEQCAQRQ0BQQMhDQNAIA0gDk8NBSABIA1qIA8tAAA6AAAgDUEEaiENIA9BAWohDyAQQQFrIhANAAsMAQsgDyAQQQMgASAOEBELIBggDjYCBCAYIAE2AgAMAwsQJgALIA5BARBMAAtBgIDAAEEZQaSAwAAQIAALIBEoAgwhBCARKAIIIQEgDARAIAsQBgsgCQRAIAgQBgsgBgRAIAUQBgsgAwRAIAIQBgsgACABNgIAIAAgBDYCBCARQRBqJAAPCwsQRwALyQEBAn8jAEEgayIDJAACQAJAIAEgASACaiIBSw0AQQggACgCACICQQF0IgQgASABIARJGyIBIAFBCE0bIgFBf3NBH3YhBAJAIAIEQCADQQE2AhggAyACNgIUIAMgAEEEaigCADYCEAwBCyADQQA2AhgLIAMgASAEIANBEGoQGCADKAIEIQIgAygCAEUEQCAAIAE2AgAgACACNgIEDAILIANBCGooAgAiAEGBgICAeEYNASAARQ0AIAIgABBMAAsQJgALIANBIGokAAuDBAEKfyMAQRBrIg8kAAJAAkACQCAEDgIBAAILQQEhDQsCQAJAIAcOAgEAAgtBASEOC0EBIQQCQAJAAkAgCg4CAAECC0EAIQQLIA9BCGohEiACIQcgAyEKIA0hEyAFIQ0gBiEQIA4hFCAIIQ4gCSERAkACQAJAAkACQCABQQJ0IgtFBEBBASEBDAELIAtBAEgNASALQQEQPCIBRQ0CCyABQf8BIAsQTSEMAkAgE0UEQCAKRQ0BQQAhAQNAIAEgC08NBSABIAxqIActAAA6AAAgAUEEaiEBIAdBAWohByAKQQFrIgoNAAsMAQsgByAKQQAgDCALEBELAkAgFEUEQCAQRQ0BQQEhAQNAIAEgC08NBSABIAxqIA0tAAA6AAAgAUEEaiEBIA1BAWohDSAQQQFrIhANAAsMAQsgDSAQQQEgDCALEBELAkAgBEUEQCARRQ0BQQIhAQNAIAEgC08NBSABIAxqIA4tAAA6AAAgAUEEaiEBIA5BAWohDiARQQFrIhENAAsMAQsgDiARQQIgDCALEBELIBIgCzYCBCASIAw2AgAMAwsQJgALIAtBARBMAAtBgIDAAEEZQaSAwAAQIAALIA8oAgwhASAPKAIIIQQgCQRAIAgQBgsgBgRAIAUQBgsgAwRAIAIQBgsgACAENgIAIAAgATYCBCAPQRBqJAAPCwsQRwALxwEBA38jAEEgayICJAACQAJAIAFBAWoiAUUNAEEIIAAoAgAiA0EBdCIEIAEgASAESRsiASABQQhNGyIBQX9zQR92IQQCQCADBEAgAkEBNgIYIAIgAzYCFCACIABBBGooAgA2AhAMAQsgAkEANgIYCyACIAEgBCACQRBqEBggAigCBCEDIAIoAgBFBEAgACABNgIAIAAgAzYCBAwCCyACQQhqKAIAIgBBgYCAgHhGDQEgAEUNACADIAAQTAALECYACyACQSBqJAAL3AECA38BfiMAQSBrIgIkACABKAIERQRAIAEoAgwhAyACQRhqIgRBADYCACACQoCAgIAQNwMQIAIgAkEQajYCHCACQRxqQYCHwAAgAxAIGiABQQhqIAQoAgA2AgAgASACKQMQNwIACyABKQIAIQUgAUKAgICAEDcCACACQQhqIgMgAUEIaiIBKAIANgIAIAFBADYCACACIAU3AwBBDEEEEDwiAUUEQEEMQQQQTAALIAEgAikDADcCACABQQhqIAMoAgA2AgAgAEGoicAANgIEIAAgATYCACACQSBqJAAL7wEBAn8jAEEgayIFJABBuI3AAEG4jcAAKAIAIgZBAWo2AgACQAJAIAZBAEgNAEGAkcAAQYCRwAAoAgBBAWoiBjYCACAGQQJLDQAgBSAEOgAYIAUgAzYCFCAFIAI2AhAgBUHwicAANgIMIAVBmIfAADYCCEGojcAAKAIAIgJBAEgNAEGojcAAIAJBAWo2AgBBqI3AAEGwjcAAKAIABH8gBSAAIAEoAhARAQAgBSAFKQMANwMIQbCNwAAoAgAgBUEIakG0jcAAKAIAKAIUEQEAQaiNwAAoAgBBAWsFIAILNgIAIAZBAUsNACAEDQELAAsAC6sBAQF/AkAgAgRAAn8CQAJAAkAgAUEATgRAIAMoAghFDQIgAygCBCIEDQEgAQ0DIAIMBAsgAEEIakEANgIADAULIAMoAgAgBCACIAEQNQwCCyABDQAgAgwBCyABIAIQPAsiAwRAIAAgAzYCBCAAQQhqIAE2AgAgAEEANgIADwsgACABNgIEIABBCGogAjYCAAwBCyAAIAE2AgQgAEEIakEANgIACyAAQQE2AgALkQQBCX8jAEEQayIMJAACQAJAAkAgBA4CAgEACxBHAAtBASEIC0EBIQQCQAJAAkAgBw4CAAECC0EAIQQLIAxBCGohDyACIQsgAyEHIAUhDSAGIQ4gBCEQAkACQAJAAkACQCABQQJ0IglFBEBBASEKDAELIAlBAEgNASAJECsiCkUNAgsCQCAIRQRAIAdFDQFBACEIIAchASALIQQDQCAIIAlPDQUgCCAKaiAELQAAOgAAIAhBBGohCCAEQQFqIQQgAUEBayIBDQALIAchAUEBIQggCyEEA0AgCCAJTw0FIAggCmogBC0AADoAACAIQQRqIQggBEEBaiEEIAFBAWsiAQ0AC0ECIQgDQCAIIAlPDQUgCCAKaiALLQAAOgAAIAhBBGohCCALQQFqIQsgB0EBayIHDQALDAELIAsgB0EAIAogCRARIAsgB0EBIAogCRARIAsgB0ECIAogCRARCwJAIBBFBEAgDkUNAUEDIQgDQCAIIAlPDQUgCCAKaiANLQAAOgAAIAhBBGohCCANQQFqIQ0gDkEBayIODQALDAELIA0gDkEDIAogCRARCyAPIAk2AgQgDyAKNgIADAMLECYACyAJQQEQTAALQYCAwABBGUGkgMAAECAACyAMKAIMIQQgDCgCCCEBIAYEQCAFEAYLIAMEQCACEAYLIAAgATYCACAAIAQ2AgQgDEEQaiQADwsQRwALcQAjAEEwayIBJABBgI3AAC0AAARAIAFBFGpBAjYCACABQRxqQQE2AgAgAUHoh8AANgIQIAFBADYCCCABQQ82AiQgASAANgIsIAEgAUEgajYCGCABIAFBLGo2AiAgAUEIakGQiMAAECkACyABQTBqJAALpAMBB38jAEEQayIKJABBASEHAkACQAJAIAQOAgABAgtBACEHCyAKQQhqIQsgAiEEIAMhCAJAAkACQAJAAkAgAUECdCIGRQRAQQEhBQwBCyAGQQBIDQEgBkEBEDwiBUUNAgsgBUH/ASAGEE0hCQJAIAdFBEAgCEUNAUEAIQUgCCEHIAQhAQNAIAUgBk8NBSAFIAlqIAEtAAA6AAAgBUEEaiEFIAFBAWohASAHQQFrIgcNAAsgCCEHQQEhBSAEIQEDQCAFIAZPDQUgBSAJaiABLQAAOgAAIAVBBGohBSABQQFqIQEgB0EBayIHDQALQQIhBQNAIAUgBk8NBSAFIAlqIAQtAAA6AAAgBUEEaiEFIARBAWohBCAIQQFrIggNAAsMAQsgBCAIQQAgCSAGEBEgBCAIQQEgCSAGEBEgBCAIQQIgCSAGEBELIAsgBjYCBCALIAk2AgAMAwsQJgALIAZBARBMAAtBgIDAAEEZQaSAwAAQIAALIAooAgwhASAKKAIIIQQgAwRAIAIQBgsgACAENgIAIAAgATYCBCAKQRBqJAAPCxBHAAt5AQN/IwBBEGsiAiQAIAEoAgRFBEAgASgCDCEDIAJBCGoiBEEANgIAIAJCgICAgBA3AwAgAiACNgIMIAJBDGpBgIfAACADEAgaIAFBCGogBCgCADYCACABIAIpAwA3AgALIABBqInAADYCBCAAIAE2AgAgAkEQaiQAC10BAX8jAEEgayICJAAgACgCACEAIAJBGGogAUEQaikCADcDACACQRBqIAFBCGopAgA3AwAgAiABKQIANwMIIAIgADYCBCACQQRqQaCFwAAgAkEIahAIIAJBIGokAAtdAQF/IwBBIGsiAiQAIAAoAgAhACACQRhqIAFBEGopAgA3AwAgAkEQaiABQQhqKQIANwMAIAIgASkCADcDCCACIAA2AgQgAkEEakGAh8AAIAJBCGoQCCACQSBqJAALVgEBfyMAQSBrIgIkACACIAA2AgQgAkEYaiABQRBqKQIANwMAIAJBEGogAUEIaikCADcDACACIAEpAgA3AwggAkEEakGghcAAIAJBCGoQCCACQSBqJAALZQEBfyMAQTBrIgMkACADIAE2AgwgAyAANgIIIANBHGpBATYCACADQSRqQQE2AgAgA0HIisAANgIYIANBADYCECADQSA2AiwgAyADQShqNgIgIAMgA0EIajYCKCADQRBqIAIQKQALUQEBfyMAQSBrIgIkACACQQxqQQE2AgAgAkEUakEANgIAIAJByIrAADYCECACQQA2AgAgAkErNgIcIAIgADYCGCACIAJBGGo2AgggAiABECkAC0YBAX8gAiAAKAIAIgAoAgAgACgCCCIDa0sEQCAAIAMgAhATIAAoAgghAwsgACgCBCADaiABIAIQThogACACIANqNgIIQQALQQEBfyACIAAoAgAgACgCCCIDa0sEQCAAIAMgAhATIAAoAgghAwsgACgCBCADaiABIAIQThogACACIANqNgIIQQAL6QQBBn8jAEEQayIDJABBgY3AAC0AAEEDRwRAIANBAToACyADIANBC2o2AgwgA0EMaiEAIwBBIGsiASQAAkACQAJAAkACQAJAAkBBgY3AAC0AAEEBaw4DAgQBAAtBgY3AAEECOgAAIAFBgY3AADYCCCAAKAIAIgAtAAAgAEEAOgAARQ0CIwBBIGsiACQAAkACQAJAQbiNwAAoAgBB/////wdxBEAQT0UNAQtBqI3AACgCAEGojcAAQX82AgANAQJAAkBBuI3AACgCAEH/////B3FFBEBBtI3AACgCACECQbSNwABBjIPAADYCAEGwjcAAKAIAIQRBsI3AAEEBNgIADAELEE9BtI3AACgCACECQbSNwABBjIPAADYCAEGwjcAAKAIAIQRBsI3AAEEBNgIARQ0BC0G4jcAAKAIAQf////8HcUUNABBPDQBBrI3AAEEBOgAAC0GojcAAQQA2AgACQCAERQ0AIAQgAigCABEEACACQQRqKAIARQ0AIAJBCGooAgAaIAQQBgsgAEEgaiQADAILIABBFGpBATYCACAAQRxqQQA2AgAgAEHUiMAANgIQIABBmIfAADYCGCAAQQA2AgggAEEIakH4iMAAECkACwALIAFBAzoADCABQQhqIgAoAgAgAC0ABDoAAAsgAUEgaiQADAQLIAFBFGpBATYCACABQRxqQQA2AgAgAUGQhMAANgIQDAILQZiEwABBkIXAABAhAAsgAUEUakEBNgIAIAFBHGpBADYCACABQdyDwAA2AhALIAFBoIXAADYCGCABQQA2AgggAUEIakHggsAAECkACwsgA0EQaiQACzgBAX8CQCABaUEBRw0AQYCAgIB4IAFrIABJIgINACAABEAgAEEAIAEgAhsQPCIBRQ0BCyABDwsAC0kBAX8jAEEgayIAJAAgAEEUakEBNgIAIABBHGpBADYCACAAQbCKwAA2AhAgAEGAisAANgIYIABBADYCCCAAQQhqQbiKwAAQKQALRAECfyABKAIEIQIgASgCACEDQQhBBBA8IgFFBEBBCEEEEEwACyABIAI2AgQgASADNgIAIABBuInAADYCBCAAIAE2AgALOQACQAJ/IAJBgIDEAEcEQEEBIAAgAiABKAIQEQAADQEaCyADDQFBAAsPCyAAIANBACABKAIMEQIAC7kCAQJ/IwBBIGsiAiQAIAJBAToAGCACIAE2AhQgAiAANgIQIAJBjIvAADYCDCACQciKwAA2AggjAEEQayIAJAACQCACQQhqIgEoAgwiAgRAIAEoAggiA0UNASAAIAI2AgggACABNgIEIAAgAzYCACMAQRBrIgEkACAAKAIAIgJBFGooAgAhAwJAAn8CQAJAIAJBDGooAgAOAgABAwsgAw0CQQAhAkGYh8AADAELIAMNASACKAIIIgMoAgQhAiADKAIACyEDIAEgAjYCBCABIAM2AgAgAUHcicAAIAAoAgQiASgCCCAAKAIIIAEtABAQFwALIAFBADYCBCABIAI2AgwgAUHIicAAIAAoAgQiASgCCCAAKAIIIAEtABAQFwALQZiHwABBmInAABAhAAtBmIfAAEGIicAAECEACy0AAkAgA2lBAUdBgICAgHggA2sgAUlyRQRAIAAgASADIAIQNSIADQELAAsgAAslAQF/AkAgAEEBEAoiAUUNACABEFMQQQ0AIAFBACAAEE0aCyABCycAIAAgACgCBEEBcSABckECcjYCBCAAIAFqIgAgACgCBEEBcjYCBAsgAQF/AkAgAEEEaigCACIBRQ0AIAAoAgBFDQAgARAGCwsjACACIAIoAgRBfnE2AgQgACABQQFyNgIEIAAgAWogATYCAAseACAAIAFBA3I2AgQgACABaiIAIAAoAgRBAXI2AgQLFAAgACgCAARAIABBBGooAgAQBgsLGQEBfyAAKAIQIgEEfyABBSAAQRRqKAIACwsSAEEZIABBAXZrQQAgAEEfRxsLFgAgACABQQFyNgIEIAAgAWogATYCAAsQACAAIAFqQQFrQQAgAWtxC+oFAQZ/An8gACEFAkACQAJAIAJBCU8EQCADIAIQCiIHDQFBAAwEC0EIQQgQNCEAQRRBCBA0IQFBEEEIEDQhAkEAQRBBCBA0QQJ0ayIEQYCAfCACIAAgAWpqa0F3cUEDayIAIAAgBEsbIANNDQFBECADQQRqQRBBCBA0QQVrIANLG0EIEDQhAiAFEFMiACAAEEgiBBBQIQECQAJAAkACQAJAAkACQCAAEEFFBEAgAiAETQ0BIAFB6JDAACgCAEYNAiABQeSQwAAoAgBGDQMgARA+DQcgARBIIgYgBGoiCCACSQ0HIAggAmshBCAGQYACSQ0EIAEQDgwFCyAAEEghASACQYACSQ0GIAEgAmtBgYAISSACQQRqIAFNcQ0FIAEgACgCACIBakEQaiEEIAJBH2pBgIAEEDQhAgwGC0EQQQgQNCAEIAJrIgFLDQQgACACEFAhBCAAIAIQLCAEIAEQLCAEIAEQCQwEC0HgkMAAKAIAIARqIgQgAk0NBCAAIAIQUCEBIAAgAhAsIAEgBCACayICQQFyNgIEQeCQwAAgAjYCAEHokMAAIAE2AgAMAwtB3JDAACgCACAEaiIEIAJJDQMCQEEQQQgQNCAEIAJrIgFLBEAgACAEECxBACEBQQAhBAwBCyAAIAIQUCIEIAEQUCEGIAAgAhAsIAQgARAzIAYgBigCBEF+cTYCBAtB5JDAACAENgIAQdyQwAAgATYCAAwCCyABQQxqKAIAIgkgAUEIaigCACIBRwRAIAEgCTYCDCAJIAE2AggMAQtB1JDAAEHUkMAAKAIAQX4gBkEDdndxNgIAC0EQQQgQNCAETQRAIAAgAhBQIQEgACACECwgASAEECwgASAEEAkMAQsgACAIECwLIAANAwsgAxAFIgFFDQEgASAFIAAQSEF4QXwgABBBG2oiACADIAAgA0kbEE4gBRAGDAMLIAcgBSABIAMgASADSRsQThogBRAGCyAHDAELIAAQQRogABBSCwsLACABBEAgABAGCwsPACAAQQF0IgBBACAAa3ILFQAgASAAKAIAIgAoAgAgACgCBBAHCxkAIAEoAgBB+IzAAEEFIAEoAgQoAgwRAgALEwAgASgCACABKAIEIAAoAgAQCAsUACAAKAIAIAEgACgCBCgCDBEAAAsIACAAIAEQCgsTACAAQbiJwAA2AgQgACABNgIACw0AIAAtAARBAnFBAXYLEAAgASAAKAIAIAAoAgQQBwsKAEEAIABrIABxCwsAIAAtAARBA3FFCwwAIAAgAUEDcjYCBAsNACAAKAIAIAAoAgRqCw4AIAAoAgAaA0AMAAsAC9gGAgt/An4gADUCACENIwBBMGsiBCQAQSchAAJAIA1CkM4AVARAIA0hDgwBCwNAIARBCWogAGoiAkEEayANIA1CkM4AgCIOQpDOAH59pyIDQf//A3FB5ABuIgVBAXRBsIvAAGovAAA7AAAgAkECayADIAVB5ABsa0H//wNxQQF0QbCLwABqLwAAOwAAIABBBGshACANQv/B1y9WIA4hDQ0ACwsgDqciAkHjAEsEQCAAQQJrIgAgBEEJamogDqciAiACQf//A3FB5ABuIgJB5ABsa0H//wNxQQF0QbCLwABqLwAAOwAACwJAIAJBCk8EQCAAQQJrIgAgBEEJamogAkEBdEGwi8AAai8AADsAAAwBCyAAQQFrIgAgBEEJamogAkEwajoAAAsCfyAEQQlqIABqIQhBK0GAgMQAIAEoAhgiA0EBcSICGyEFIAJBJyAAayIJaiECQciKwABBACADQQRxGyEHAkACQCABKAIIRQRAQQEhACABKAIAIgMgAUEEaigCACICIAUgBxAoDQEMAgsCQAJAAkACQCACIAFBDGooAgAiBkkEQCADQQhxDQQgBiACayICIQNBASABLQAgIgAgAEEDRhsiAEEBaw4CAQIDC0EBIQAgASgCACIDIAFBBGooAgAiAiAFIAcQKA0EDAULQQAhAyACIQAMAQsgAkEBdiEAIAJBAWpBAXYhAwsgAEEBaiEAIAFBBGooAgAhAiABKAIcIQYgASgCACEBAkADQCAAQQFrIgBFDQEgASAGIAIoAhARAABFDQALQQEMBAtBASEAIAZBgIDEAEYNASABIAIgBSAHECgNASABIAggCSACKAIMEQIADQFBACEAAn8DQCADIAAgA0YNARogAEEBaiEAIAEgBiACKAIQEQAARQ0ACyAAQQFrCyADSSEADAELIAEoAhwhCyABQTA2AhwgAS0AICEMQQEhACABQQE6ACAgASgCACIDIAFBBGooAgAiCiAFIAcQKA0AIAYgAmtBAWohAAJAA0AgAEEBayIARQ0BIANBMCAKKAIQEQAARQ0AC0EBDAMLQQEhACADIAggCSAKKAIMEQIADQAgASAMOgAgIAEgCzYCHEEADAILIAAMAQsgAyAIIAkgAigCDBECAAsgBEEwaiQACwsAIAAjAGokACMACwwAQfCCwABBGRAEAAsKACAAKAIEQXhxCwoAIAAoAgRBAXELCgAgACgCDEEBcQsKACAAKAIMQQF2CxkAIAAgAUGkjcAAKAIAIgBBECAAGxEBAAALrwEBA38gASEFAkAgAkEPTQRAIAAhAQwBCyAAQQAgAGtBA3EiA2ohBCADBEAgACEBA0AgASAFOgAAIAFBAWoiASAESQ0ACwsgBCACIANrIgJBfHEiA2ohASADQQBKBEAgBUH/AXFBgYKECGwhAwNAIAQgAzYCACAEQQRqIgQgAUkNAAsLIAJBA3EhAgsgAgRAIAEgAmohAgNAIAEgBToAACABQQFqIgEgAkkNAAsLIAALswIBB38CQCACIgRBD00EQCAAIQIMAQsgAEEAIABrQQNxIgNqIQUgAwRAIAAhAiABIQYDQCACIAYtAAA6AAAgBkEBaiEGIAJBAWoiAiAFSQ0ACwsgBSAEIANrIghBfHEiB2ohAgJAIAEgA2oiA0EDcSIEBEAgB0EATA0BIANBfHEiBkEEaiEBQQAgBEEDdCIJa0EYcSEEIAYoAgAhBgNAIAUgBiAJdiABKAIAIgYgBHRyNgIAIAFBBGohASAFQQRqIgUgAkkNAAsMAQsgB0EATA0AIAMhAQNAIAUgASgCADYCACABQQRqIQEgBUEEaiIFIAJJDQALCyAIQQNxIQQgAyAHaiEBCyAEBEAgAiAEaiEDA0AgAiABLQAAOgAAIAFBAWohASACQQFqIgIgA0kNAAsLIAALCwBBgJHAACgCAEULBwAgACABagsHACAAIAFrCwcAIABBCGoLBwAgAEEIawvDBwEFfwJAIwBB0ABrIgIkACACQQA2AhggAkKAgICAEDcDECACQSBqIgQiAEEDOgAgIABCgICAgIAENwIYIABBADYCECAAQQA2AgggAEG4hcAANgIEIAAgAkEQajYCACMAQUBqIgAkAEEBIQMCQCAEKAIAIgVB7IrAAEEMIAQoAgQiBCgCDBECAA0AAkAgASgCCCIDBEAgACADNgIMIABBITYCFCAAIABBDGo2AhBBASEDIABBATYCPCAAQQI2AjQgAEH8isAANgIwIABBADYCKCAAIABBEGo2AjggBSAEIABBKGoQCEUNAQwCCyABKAIAIgMgASgCBEEMaigCABEGAELB9/nozJOy0UFSDQAgACADNgIMIABBIjYCFCAAIABBDGo2AhBBASEDIABBATYCPCAAQQI2AjQgAEH8isAANgIwIABBADYCKCAAIABBEGo2AjggBSAEIABBKGoQCA0BCyABKAIMIQEgAEEkakEPNgIAIABBHGpBDzYCACAAIAFBDGo2AiAgACABQQhqNgIYIABBIDYCFCAAIAE2AhAgAEEDNgI8IABBAzYCNCAAQdSKwAA2AjAgAEEANgIoIAAgAEEQajYCOCAFIAQgAEEoahAIIQMLIABBQGskAAJAIANFBEAgAigCECACKAIYIgBrQQlNBEAgAkEQaiAAQQoQEyACKAIYIQALIAIoAhQgAGoiAUH0hsAAKQAANwAAIAFBCGpB/IbAAC8AADsAACACIABBCmo2AhggAkEIahAAIgQQASACKAIIIQYgAigCDCIFIAIoAhAgAigCGCIAa0sEQCACQRBqIAAgBRATIAIoAhghAAsgAigCFCAAaiAGIAUQThogAiAAIAVqIgA2AhggAigCECAAa0EBTQRAIAJBEGogAEECEBMgAigCGCEACyACKAIUIABqQYoUOwAAIAIgAEECaiIDNgIYIAIoAhQhAAJAIAMgAigCECIBTwRAIAAhAQwBCyADRQRAQQEhASAAEAYMAQsgACABQQEgAxA1IgFFDQILIAEgAxACIAUEQCAGEAYLIARBhAFPBEAgBBADCyACQdAAaiQADAILIwBBQGoiACQAIABBNzYCDCAAQdCFwAA2AgggAEGIhsAANgIUIAAgAkHIAGo2AhAgAEEkakECNgIAIABBLGpBAjYCACAAQTxqQR82AgAgAEGgi8AANgIgIABBADYCGCAAQSA2AjQgACAAQTBqNgIoIAAgAEEQajYCOCAAIABBCGo2AjAgAEEYakHkhsAAECkACyADQQEQTAALCwwAQsH3+ejMk7LRQQsNAEKy+KXLheeH1Jt/CwwAQuLnycndnOOADQsDAAELC4cNAQBBgIDAAAv9DG91dHB1dCBzbGljZSBpcyB0b28gc21hbGxzcmMvbGliLnJzABkAEAAKAAAAggAAAA4AAABpbnB1dCB0ZXJtaW5hdGVkIHdoaWxlIGRlY29kaW5nIHVuY29tcHJlc3NlZCBzZWdtZW50IGluIFJMRSBzbGljZQAAABkAEAAKAAAAmQAAABYAAAAZABAACgAAAJYAAAAWAAAAaW5wdXQgdGVybWluYXRlZCB3aGlsZSBkZWNvZGluZyByZXBlYXQgc2VnbWVudCBpbiBSTEUgc2xpY2UAGQAQAAoAAACmAAAAFgAAABkAEAAKAAAAoQAAABIAAAAvVXNlcnMveWhrYW5nLy5jYXJnby9yZWdpc3RyeS9zcmMvaW5kZXguY3JhdGVzLmlvLTZmMTdkMjJiYmExNTAwMWYvY29uc29sZV9lcnJvcl9wYW5pY19ob29rLTAuMS43L3NyYy9saWIucnP0ABAAbAAAAJUAAAAOAAAAaW52YWxpZCBlbnVtIHZhbHVlIHBhc3NlZAAAAAEAAAAAAAAAAQAAAAIAAAADAAAABAAAAG9uZS10aW1lIGluaXRpYWxpemF0aW9uIG1heSBub3QgYmUgcGVyZm9ybWVkIHJlY3Vyc2l2ZWx5pAEQADgAAABPbmNlIGluc3RhbmNlIGhhcyBwcmV2aW91c2x5IGJlZW4gcG9pc29uZWQAAOQBEAAqAAAAY2FsbGVkIGBPcHRpb246OnVud3JhcCgpYCBvbiBhIGBOb25lYCB2YWx1ZS9ydXN0Yy85MGM1NDE4MDZmMjNhMTI3MDAyZGU1YjQwMzhiZTczMWJhMTQ1OGNhL2xpYnJhcnkvc3RkL3NyYy9zeW5jL29uY2UucnMAQwIQAEwAAACVAAAAMgAAAAUAAAAEAAAABAAAAAYAAAAHAAAACAAAAAkAAAAMAAAABAAAAAoAAAALAAAADAAAAGEgRGlzcGxheSBpbXBsZW1lbnRhdGlvbiByZXR1cm5lZCBhbiBlcnJvciB1bmV4cGVjdGVkbHkADQAAAAAAAAABAAAADgAAAC9ydXN0Yy85MGM1NDE4MDZmMjNhMTI3MDAyZGU1YjQwMzhiZTczMWJhMTQ1OGNhL2xpYnJhcnkvYWxsb2Mvc3JjL3N0cmluZy5ycwAYAxAASwAAAN0JAAAOAAAACgpTdGFjazoKCgAAEQAAAAQAAAAEAAAAEgAAABMAAAAUAAAAY2FsbGVkIGBPcHRpb246OnVud3JhcCgpYCBvbiBhIGBOb25lYCB2YWx1ZW1lbW9yeSBhbGxvY2F0aW9uIG9mICBieXRlcyBmYWlsZWQAAADDAxAAFQAAANgDEAANAAAAbGlicmFyeS9zdGQvc3JjL2FsbG9jLnJz+AMQABgAAABVAQAACQAAAGNhbm5vdCBtb2RpZnkgdGhlIHBhbmljIGhvb2sgZnJvbSBhIHBhbmlja2luZyB0aHJlYWQgBBAANAAAAGxpYnJhcnkvc3RkL3NyYy9wYW5pY2tpbmcucnNcBBAAHAAAAIcAAAAJAAAAXAQQABwAAABBAgAAHgAAAFwEEAAcAAAAQAIAAB8AAAAVAAAADAAAAAQAAAAWAAAAEQAAAAgAAAAEAAAAFwAAABgAAAAQAAAABAAAABkAAAAaAAAAEQAAAAgAAAAEAAAAGwAAABwAAAARAAAAAAAAAAEAAAAdAAAAbGlicmFyeS9hbGxvYy9zcmMvcmF3X3ZlYy5yc2NhcGFjaXR5IG92ZXJmbG93AAAAHAUQABEAAAAABRAAHAAAAAwCAAAFAAAASAUQAAAAAAA6AAAASAUQAAAAAABQBRAAAQAAAFAFEAABAAAAcGFuaWNrZWQgYXQgJycsIHgFEAABAAAAeQUQAAMAAAAjAAAAAAAAAAEAAAAkAAAAOiAAAEgFEAAAAAAAnAUQAAIAAAAwMDAxMDIwMzA0MDUwNjA3MDgwOTEwMTExMjEzMTQxNTE2MTcxODE5MjAyMTIyMjMyNDI1MjYyNzI4MjkzMDMxMzIzMzM0MzUzNjM3MzgzOTQwNDE0MjQzNDQ0NTQ2NDc0ODQ5NTA1MTUyNTM1NDU1NTY1NzU4NTk2MDYxNjI2MzY0NjU2NjY3Njg2OTcwNzE3MjczNzQ3NTc2Nzc3ODc5ODA4MTgyODM4NDg1ODY4Nzg4ODk5MDkxOTI5Mzk0OTU5Njk3OTg5OUVycm9yAG8JcHJvZHVjZXJzAghsYW5ndWFnZQEEUnVzdAAMcHJvY2Vzc2VkLWJ5AwVydXN0Yx0xLjcwLjAgKDkwYzU0MTgwNiAyMDIzLTA1LTMxKQZ3YWxydXMGMC4xOS4wDHdhc20tYmluZGdlbgYwLjIuODcALA90YXJnZXRfZmVhdHVyZXMCKw9tdXRhYmxlLWdsb2JhbHMrCHNpZ24tZXh0"),A=v.memory,m=v.main_js,y=v.decode_rgb,b=v.decode_rgba,C=v.decode_grayscale,w=v.decode_grayscale_a,x=v.__wbindgen_add_to_stack_pointer,_=v.__wbindgen_malloc,E=v.__wbindgen_free,S=v.__wbindgen_realloc,I=v.__wbindgen_start,k=Object.freeze(Object.defineProperty({__proto__:null,__wbindgen_add_to_stack_pointer:x,__wbindgen_free:E,__wbindgen_malloc:_,__wbindgen_realloc:S,__wbindgen_start:I,decode_grayscale:C,decode_grayscale_a:w,decode_rgb:y,decode_rgba:b,main_js:m,memory:A},Symbol.toStringTag,{value:"Module"}));Bw(k),I()}));function Rw(e,t,n,i,r,o){return h(this,null,(function*(){const a=e*t;if(!(a>0&&Number.isInteger(a)))throw new Error(`Pixel count must be a positive integer, got ${a}`);let s;if(i&&r)s=yield function(e,t,n,i,r){return h(this,null,(function*(){return yield jw,Fw(t.compression),Fw(i.compression),Fw(t.compression),r&&Fw(r.compression),r?Pw(e,t.data,t.compression,n.data,n.compression,i.data,i.compression,r.data,r.compression):Lw(e,t.data,t.compression,n.data,n.compression,i.data,i.compression)}))}(a,n,i,r,o);else{if(r||i)throw new Error(`Missing ${r?"green":"blue"} channel in RGB image`);s=yield Nw(a,n,o)}return new Uint8ClampedArray(s.buffer,s.byteOffset,s.byteLength)}))}function Fw(e){switch(e){case pw.RawData:case pw.RleCompressed:return}throw new Vb(`Unsupported compression method: ${e}`)}function Nw(e,t,n){return h(this,null,(function*(){return yield jw,Fw(t.compression),n&&Fw(n.compression),n?Qw(e,t.data,t.compression,n.data,n.compression):Mw(e,t.data,t.compression)}))}function Vw(e){const t=uw(e),{fileHeader:n}=t,i=fw(n.version),r=function(e){const t=new wC(e),n=[],i=t.read("u32");for(;t.position<i;){const e=NC(t);n.push(e)}return{resources:n}}(t.imageResources);return{fileHeader:n,colorModeData:void 0,imageResources:r,layerAndMaskInfo:lw(t.layerAndMaskInformation,i),imageData:RC(t.imageData,n.depth,n.height,n.channelCount,i)}}function Uw(e){const t=e.readUnicodeString(0),n=e.readIdString(),i=e.read("u32"),r=new Map;for(;r.size<i;){const t=e.readIdString(),n=Hw(e);if(r.has(t))throw new lC(`Duplicate descriptor key: ${t}`);r.set(t,n)}return{name:t,classId:n,items:r}}function zw(e){const t=e.read("u32");if(16!==t)throw new sC(`Invalid descriptor version: ${t}`);return{descriptorVersion:t,descriptor:Uw(e)}}function Hw(e){const t=e.readString(4);switch(t){case OC.Alias:{const n=e.read("u32");return{type:t,data:e.take(n)}}case OC.Boolean:return{type:t,value:!!e.read("u8")};case OC.Class:case OC.GlobalClass:return{type:t,name:e.readUnicodeString(0),classId:e.readIdString()};case OC.Descriptor:case OC.GlobalObject:return{type:t,descriptor:Uw(e)};case OC.Double:return{type:t,value:e.read("f64")};case OC.Enumerated:return{type:t,enumType:e.readIdString(),enumValue:e.readIdString()};case OC.Integer:return{type:t,value:e.read("i32")};case OC.LargeInteger:return{type:t,value:e.read("i64")};case OC.List:{const n=e.read("u32"),i=[];for(;i.length<n;)i.push(Hw(e));return{type:t,values:i}}case OC.RawData:{const n=e.read("u32");return{type:t,data:e.take(n)}}case OC.Reference:{const n=e.read("u32"),i=[];for(;i.length<n;)i.push(Yw(e));return{type:t,references:i}}case OC.String:return{type:t,value:e.readUnicodeString(0)};case OC.UnitFloat:return{type:t,unitType:Gw(e.readString(4)),value:e.read("f64")};case OC.ObjectArray:{e.read("u32");const n=e.readUnicodeString(0),i=e.readIdString(),r=e.read("u32");return{type:t,classObj:{name:n,classId:i},items:Array.from(Array(r),(()=>({key:e.readIdString(),value:Hw(e)})))}}case OC.UnitFloats:{const n=Gw(e.readString(4)),i=e.read("u32");return{type:t,unitType:n,values:Array.from(Array(i),(()=>e.read("f64")))}}default:throw new aC(`Unexpected descriptor type: ${t}`)}}function Yw(e){const t=e.readString(4);switch(t){case ww.Class:return{type:t,name:e.readUnicodeString(0),classId:e.readIdString()};case ww.Enumerated:return{type:t,name:e.readUnicodeString(0),classId:e.readIdString(),typeId:e.readIdString(),enumValue:e.readIdString()};case ww.Identifier:return{type:t,identifier:e.readString(4)};case ww.Index:return{type:t,index:e.read("u32")};case ww.Name:return{type:t,name:e.readUnicodeString(0)};case ww.Offset:return{type:t,name:e.readUnicodeString(0),classId:e.readIdString(),offset:e.read("u32")};case ww.Property:return{type:t,name:e.readUnicodeString(0),classId:e.readIdString(),keyId:e.readIdString()};default:throw new hC(`Invalid reference type: ${t}`)}}function Gw(e){if(!Object.values(TC).includes(e))throw new dC(`Invalid Unit Float type: ${e}`);return e}var Ww;!function(e){e[e.String=0]="String",e[e.DictBeg=1]="DictBeg",e[e.DictEnd=2]="DictEnd",e[e.ArrBeg=3]="ArrBeg",e[e.ArrEnd=4]="ArrEnd",e[e.Name=5]="Name",e[e.Number=6]="Number",e[e.Boolean=7]="Boolean"}(Ww||(Ww={}));const Xw=new Set([0,9,12,32,10,13]),$w=new Set([102,116]),qw={"(":40,")":41,"<":60,">":62,"[":91,"]":93,"/":47,"\\":92},Kw=new Set(Object.values(qw)),Jw=[];for(let uj=0;uj<256;uj+=1)Jw[uj]=Xw.has(uj)||Kw.has(uj);const Zw=new TextDecoder("utf-8");class ex{constructor(e){this.cursor=wC.from(e)}tokens(){const e=[];for(;!this.done();){const t=this.cursor.one();if(Xw.has(t))for(;!this.done()&&Xw.has(this.cursor.peek());)this.cursor.pass(1);else if(Kw.has(t)){if(t===qw["("]){e.push({type:Ww.String,value:this.text()});continue}if(t===qw["["]){e.push({type:Ww.ArrBeg});continue}if(t===qw["]"]){e.push({type:Ww.ArrEnd});continue}if(t===qw["<"]){this.cursor.pass(1),e.push({type:Ww.DictBeg});continue}if(t===qw[">"]){this.cursor.pass(1),e.push({type:Ww.DictEnd});continue}if(t===qw["/"]){e.push({type:Ww.Name,value:this.string()});continue}}else this.cursor.unpass(1),$w.has(t)?e.push({type:Ww.Boolean,value:this.boolean()}):e.push({type:Ww.Number,value:this.number()})}return e}done(){return this.cursor.position>=this.cursor.length}text(){const e=this.cursor.peek();if(e===qw[")"])return this.cursor.pass(1),"";const t=255===e||254===e;let n=new TextDecoder("utf-16be");t&&(n=this.textDecoderFromBOM());const i=[],r=this.cursor.clone();for(;r.peek()!==qw[")"];)if(r.pass(1),r.peek()===qw["\\"]){const e=r.position-this.cursor.position;i.push(n.decode(this.cursor.take(e),{stream:!0})),r.pass(2),this.cursor.pass(1),i.push(n.decode(this.cursor.take(1),{stream:!0}))}const o=r.position-this.cursor.position,a=this.cursor.take(o);return i.push(n.decode(a)),this.cursor.pass(1),i.join("")}textDecoderFromBOM(){const e=this.cursor.one(),t=this.cursor.one();if(255===e&&254===t)return new TextDecoder("utf-16le");if(254===e&&255===t)return new TextDecoder("utf-16be");throw new mC(`Unknown BOM value: [${e}, ${t}]`)}string(){return function(e){const t=e.position;let n=e.position;for(const i of e.iter()){if(Jw[i])break;n+=1}return Zw.decode(e.take(n-t))}(this.cursor)}number(){const e=this.string(),t=Number(e);if(Number.isNaN(t))throw new pC(`parsing '${e}' as Number failed`);return t}boolean(){const e=this.string();if("true"===e)return!0;if("false"===e)return!1;throw new fC(`'${e}' is neither 'true' nor 'false'`)}}const tx=Symbol(Ww[Ww.ArrBeg]),nx=Symbol(Ww[Ww.DictBeg]);class ix{constructor(e){this.tokens=e,this.stack=[]}parse(){this.runParser();const[e]=this.stack;if("object"==typeof e&&!Array.isArray(e))return e;throw new gC("EngineData top-level value is not a dict; is "+typeof e)}runParser(){for(const e of this.tokens)switch(e.type){case Ww.Name:case Ww.Number:case Ww.Boolean:case Ww.String:this.stack.push(e.value);continue;case Ww.DictBeg:this.stack.push(nx);continue;case Ww.ArrBeg:this.stack.push(tx);continue;case Ww.DictEnd:this.stack.push(this.dict());continue;case Ww.ArrEnd:this.stack.push(this.array().reverse());continue}}dict(){const e={};for(;;){const t=this.stack.pop();if(void 0===t)throw new vC("Stack empty when parsing dict");if(t===nx)return e;if(t===tx)throw new AC("Got ArrBeg while parsing a dict");const n=this.stack.pop();if("string"!=typeof n)throw new AC("Dict key is not Name; is "+typeof n);e[n]=t}}array(){const e=[];for(;;){const t=this.stack.pop();if(void 0===t)throw new vC("Stack empty when parsing array");if(t===nx)throw new AC("Got DictBeg while parsing array");if(t===tx)return e;e.push(t)}}}const rx=new Set(["DocumentResources","EngineDict","ResourceDict"]);function ox(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ax(e){const t=new ix(new ex(e).tokens()).parse();if(function(e){let t=!0;if("object"!=typeof e||!e)return!1;for(const n of rx){if(!ox(e,n))return!1;{const i=e[n];t=t&&"object"==typeof i&&!Array.isArray(i)&&!!i}}return t}(t))return t;throw new yC(`Object with keys ${JSON.stringify(Object.keys(t))} is not valid EngineData`)}class sx{composite(e=!0,t=!0){return h(this,null,(function*(){const{red:n,green:i,blue:r,alpha:o}=this.imageData,{width:a,height:s}=this,l=yield Rw(a,s,n,i,r,o);if(!0===e){if(!0===t){return Sw(l,255*this.composedOpacity)}return Sw(l,this.opacity)}return l}))}}class lx extends sx{constructor(e,t){super(),this.layerFrame=e,this.parent=t,this.type="Layer"}get name(){return this.layerFrame.layerProperties.name}get width(){return this.layerFrame.width}get height(){return this.layerFrame.height}get top(){return this.layerFrame.layerProperties.top}get left(){return this.layerFrame.layerProperties.left}get opacity(){return this.layerFrame.layerProperties.opacity}get composedOpacity(){return this.parent.composedOpacity*(this.opacity/255)}get maskData(){return this.layerFrame.layerProperties.maskData}userMask(){return h(this,null,(function*(){const e=this.layerFrame.userMask;if(e)return Nw(EC(this.maskData),e)}))}realUserMask(){return h(this,null,(function*(){const e=this.maskData.realData,t=this.layerFrame.realUserMask;if(e&&t)return Nw(EC(e),t)}))}get isHidden(){return this.layerFrame.layerProperties.hidden}get isTransparencyLocked(){return this.layerFrame.layerProperties.transparencyLocked}get additionalProperties(){return this.layerFrame.layerProperties.additionalLayerProperties}get text(){return this.layerFrame.layerProperties.text}get textProperties(){return this.layerFrame.layerProperties.textProperties}get imageData(){const{red:e,green:t,blue:n,alpha:i}=this.layerFrame;return{red:e,green:t,blue:n,alpha:i}}}function cx(e){if(!function(e){return"Psd"===e.type||"Group"===e.type}(e))throw new Bb(`Node (name = '${e.name}', type: '${e.type}') cannot be a parent node`)}class ux{constructor(e,t,n,i,r){this.origin=e,this.left=t,this.top=n,this.right=i,this.bottom=r}}function hx(e){if(e.resource.descriptor){const t=e.resource.descriptor.descriptor.items.get("slices");if(!t||t.type!==OC.List)throw new eC('Missing key "slices" in slice descriptor');return t.values.reduce(((e,t)=>{if(t.type!==OC.Descriptor)throw new eC(`Slice list contains a non-descriptor (type: ${t.type})`);return e.push(function(e){const t=function(e){const t=QC(e,"origin",OC.Enumerated);if("ESliceOrigin"!==t.enumType)throw new eC(`Unexpected enum type for slice origin: got "${t.enumType}"`);switch(t.enumValue){case"layerGenerated":return yw.LayerGenerated;case"userGenerated":return yw.UserGenerated;case"autoGenerated":return yw.AutoGenerated;default:throw new eC(`Unexpected enum value for slice origin: got "${t.enumValue}"`)}}(e),n=QC(e,"bounds",OC.Descriptor).descriptor,i=QC(n,"Top ",OC.Integer).value,r=QC(n,"Left",OC.Integer).value,o=QC(n,"Btom",OC.Integer).value,a=QC(n,"Rght",OC.Integer).value;return new ux(t,r,i,a,o)}(t.descriptor)),e}),[])}throw new eC("No slice descriptor in slice resource block")}class dx extends sx{static parse(e){const t=Vw(e);return new dx(t)}constructor(e){super(),this.parsingResult=e,this.name="ROOT",this.type="Psd",this.opacity=255,this.composedOpacity=1,this.children=[],this.layers=[],this.guides=[],this.slices=[],this.icc_profile=void 0,this.globalLightAngle=void 0,this.globalLightAltitude=void 0,this.resolutionInfo=void 0,this.additionalLayerProperties={},this.buildTreeStructure(),this.additionalLayerProperties=e.layerAndMaskInfo.globalAdditionalLayerInformation;for(const t of e.imageResources.resources)if(null!==t.resource)switch(t.id){case mw.GridAndGuides:this.guides=t.resource.guides;break;case mw.Slices:this.slices=hx(t);break;case mw.ICCProfile:this.icc_profile=t.resource;break;case mw.GlobalLightAltitude:this.globalLightAltitude=t.resource;break;case mw.GlobalLightAngle:this.globalLightAngle=t.resource;break;case mw.ResolutionInfo:this.resolutionInfo=t.resource}}get width(){return this.parsingResult.fileHeader.width}get height(){return this.parsingResult.fileHeader.height}get channelCount(){return this.parsingResult.fileHeader.channelCount}get depth(){return this.parsingResult.fileHeader.depth}get colorMode(){return this.parsingResult.fileHeader.colorMode}get imageData(){const{compression:e,red:t,green:n,blue:i,alpha:r}=this.parsingResult.imageData;return{red:{compression:e,data:t},green:n?{compression:e,data:n}:void 0,blue:i?{compression:e,data:i}:void 0,alpha:r?{compression:e,data:r}:void 0}}buildTreeStructure(){const{groups:e,layers:t,orders:n}=this.parsingResult.layerAndMaskInfo,i=[this];let r=0,o=0;n.forEach((n=>{const a=i[i.length-1];switch(n){case"G":{const t=e[r];cx(a);const n=new xb(t,a);i.push(n),a.children.push(n),r+=1;break}case"L":{const e=t[o];cx(a);const n=new lx(e,a);this.layers.push(n),a.children.push(n),o+=1;break}case"D":i.pop()}})),i.length=0,this.children.forEach((e=>{var t,n;return null===(n=(t=e).freeze)||void 0===n?void 0:n.call(t)})),Object.freeze(this.children)}}class fx{constructor(e,t){this.canvas=e,this.editor=t}insertPSD(e){return new Promise(((t,n)=>{Nm({accept:".psd"}).then((n=>{if(n&&n.length>0){const i=n[0],r=new FileReader;r.readAsText(i,"UTF-8"),r.onload=()=>h(this,null,(function*(){const n=yield i.arrayBuffer(),r=dx.parse(n),o=yield yb(r);this.loadJSON(o,e),t("")}))}})).catch(n)}))}loadJSON(e,t){this.editor.loadJSON(e,t)}}u(fx,"pluginName","PsdPlugin"),u(fx,"apis",["insertPSD"]);const px=(e,t)=>{const n=[],i=2*Math.PI/e;let r=-Math.PI/2;for(let o=0;o<e;o++){const e=o*i+r;n.push({x:Math.cos(e)*t,y:Math.sin(e)*t})}return n},gx=e=>{const{left:t=0,top:n=0}=e;return{width:e.getScaledWidth(),height:e.getScaledHeight(),left:t,top:n}},vx=(e,t)=>{Ax(e),Ax(e,"targetId",I(t,"id")),Ax(e,"targetType",I(t,"type"))},Ax=(e,t="clip",n=!0)=>{oi(e,t,n)};class mx{constructor(e,t){this.canvas=e,this.editor=t}addClipPathToImage(e){const t=this.canvas.getActiveObjects()[0];if(t&&"image"===t.type){let n=null;const[i,r]=e.split("-"),o=!!r;switch(i){case"polygon":n=((e,t)=>{const n=e.getCenterPoint(),i=px(5,200),r=new vA.fabric.Polygon(i,{fill:"rgba(0,0,0,0)",originY:"center",originX:"center",left:n.x,top:n.y});return vx(r,e),{shell:r,clipPath:new vA.fabric.Polygon([...i],{absolutePositioned:!0,originX:"center",originY:"center",left:r.left,top:r.top,inverted:t})}})(t,o);break;case"rect":n=((e,t)=>{const{width:n=0,height:i=0,left:r=0,top:o=0}=gx(e),a=Math.round(n/2),s=Math.round(i/2),l=new vA.fabric.Rect({width:a,height:s,fill:"rgba(0,0,0,0)",originX:"center",originY:"center",left:r+n/2,top:o+i/2});return vx(l,e),{clipPath:new vA.fabric.Rect({absolutePositioned:!0,width:l.width,height:l.height,originX:"center",originY:"center",left:l.left,top:l.top,inverted:t}),shell:l}})(t,o);break;case"circle":n=((e,t)=>{const n=e.getCenterPoint(),{width:i}=gx(e),r=new vA.fabric.Ellipse({fill:"rgba(0,0,0,0)",originX:"center",originY:"center",left:n.x,top:n.y,rx:i/4,ry:i/4});return vx(r,e),{shell:r,clipPath:new vA.fabric.Ellipse({absolutePositioned:!0,originX:"center",originY:"center",left:r.left,top:r.top,inverted:t,rx:r.rx,ry:r.ry})}})(t,o);break;case"triangle":n=((e,t)=>{const n=e.getCenterPoint(),{width:i=0,height:r=0}=gx(e),o=Math.round(i/2),a=Math.round(r/2),s=new vA.fabric.Triangle({fill:"rgba(0,0,0,0)",originX:"center",originY:"center",left:n.x,top:n.y,width:o,height:a});return vx(s,e),{shell:s,clipPath:new vA.fabric.Triangle({absolutePositioned:!0,originX:"center",originY:"center",left:s.left,top:s.top,width:s.width,height:s.height,inverted:t})}})(t,o)}if(null==n)return;const{shell:a,clipPath:s}=n;a.on("moving",(()=>{s.setPositionByOrigin(a.getCenterPoint(),"center","center"),t.set("dirty",!0)})),a.on("rotating",(()=>{s.set({angle:a.angle}),t.set("dirty",!0)})),a.on("scaling",(()=>{s.set({scaleX:a.scaleX,scaleY:a.scaleY}),s.setPositionByOrigin(a.getCenterPoint(),"center","center"),t.set("dirty",!0)})),a.on("deselected",(()=>{if(s instanceof vA.fabric.Ellipse&&a instanceof vA.fabric.Ellipse)s.set({rx:a.getRx(),ry:a.getRy()}),this.correctPosition(t,a,s);else if(a instanceof vA.fabric.Polygon){this.correctPosition(t,a,s);const{scaleX:e=1,scaleY:n=1}=s,{scaleX:i=1,scaleY:r=1}=a;s.set("scaleX",e*i),s.set("scaleY",n*r)}else this.correctPosition(t,a,s),s.set("width",a.getScaledWidth()),s.set("height",a.getScaledHeight());t.set("dirty",!0),this.canvas.remove(a),this.canvas.requestRenderAll()})),t.set({clipPath:s}),this.canvas.add(a),this.canvas.setActiveObject(a)}}correctPosition(e,t,n){const i=e.toLocalPoint(t.getCenterPoint(),"center","center"),{scaleX:r=1,scaleY:o=1}=e;n.set({absolutePositioned:!1,left:i.x/r,top:i.y/o,scaleX:1/r,scaleY:1/o})}removeClip(){const e=this.canvas.getActiveObjects()[0];e&&"image"===e.type&&(e.set({clipPath:void 0}),e.set("dirty",!0),this.canvas.requestRenderAll())}}u(mx,"pluginName","SimpleClipImagePlugin"),u(mx,"apis",["addClipPathToImage","removeClip"]);var yx={},bx={},Cx={};Object.defineProperty(Cx,"__esModule",{value:!0});Cx.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=t,this.text=n.text||t,this.options=n},Object.defineProperty(bx,"__esModule",{value:!0}),bx.CODE39=void 0;var wx,xx=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),_x=(wx=Cx)&&wx.__esModule?wx:{default:wx};var Ex=function(){function e(t,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t=t.toUpperCase(),n.mod43&&(t+=(i=function(e){for(var t=0,n=0;n<e.length;n++)t+=Bx(e[n]);return t%=43}(t),Sx[i])),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,_x.default),xx(e,[{key:"encode",value:function(){for(var e=kx("*"),t=0;t<this.data.length;t++)e+=kx(this.data[t])+"0";return{data:e+=kx("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),e}(),Sx=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],Ix=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function kx(e){return t=Bx(e),Ix[t].toString(2);var t}function Bx(e){return Sx.indexOf(e)}bx.CODE39=Ex;var Ox,Tx={},Dx={},Mx={},Qx={};function Lx(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(Qx,"__esModule",{value:!0});var Px=Qx.SET_A=0,jx=Qx.SET_B=1,Rx=Qx.SET_C=2;Qx.SHIFT=98;var Fx=Qx.START_A=103,Nx=Qx.START_B=104,Vx=Qx.START_C=105;Qx.MODULO=103,Qx.STOP=106,Qx.FNC1=207,Qx.SET_BY_CODE=(Lx(Ox={},Fx,Px),Lx(Ox,Nx,jx),Lx(Ox,Vx,Rx),Ox),Qx.SWAP={101:Px,100:jx,99:Rx},Qx.A_START_CHAR=String.fromCharCode(208),Qx.B_START_CHAR=String.fromCharCode(209),Qx.C_START_CHAR=String.fromCharCode(210),Qx.A_CHARS="[\0-_È-Ï]",Qx.B_CHARS="[ -È-Ï]",Qx.C_CHARS="(Ï*[0-9]{2}Ï*)",Qx.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011],Object.defineProperty(Mx,"__esModule",{value:!0});var Ux=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),zx=function(e){return e&&e.__esModule?e:{default:e}}(Cx),Hx=Qx;var Yx=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.substring(1),n));return i.bytes=t.split("").map((function(e){return e.charCodeAt(0)})),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,zx.default),Ux(e,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var t=this.bytes,n=t.shift()-105,i=Hx.SET_BY_CODE[n];if(void 0===i)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&t.unshift(Hx.FNC1);var r=e.next(t,1,i);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:e.getBar(n)+r.result+e.getBar((r.checksum+n)%Hx.MODULO)+e.getBar(Hx.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var e=this.options.ean128||!1;return"string"==typeof e&&(e="true"===e.toLowerCase()),e}}],[{key:"getBar",value:function(e){return Hx.BARS[e]?Hx.BARS[e].toString():""}},{key:"correctIndex",value:function(e,t){if(t===Hx.SET_A){var n=e.shift();return n<32?n+64:n-32}return t===Hx.SET_B?e.shift()-32:10*(e.shift()-48)+e.shift()-48}},{key:"next",value:function(t,n,i){if(!t.length)return{result:"",checksum:0};var r=void 0,o=void 0;if(t[0]>=200){o=t.shift()-105;var a=Hx.SWAP[o];void 0!==a?r=e.next(t,n+1,a):(i!==Hx.SET_A&&i!==Hx.SET_B||o!==Hx.SHIFT||(t[0]=i===Hx.SET_A?t[0]>95?t[0]-96:t[0]:t[0]<32?t[0]+96:t[0]),r=e.next(t,n+1,i))}else o=e.correctIndex(t,i),r=e.next(t,n+1,i);var s=o*n;return{result:e.getBar(o)+r.result,checksum:s+r.checksum}}}]),e}();Mx.default=Yx;var Gx={};Object.defineProperty(Gx,"__esModule",{value:!0});var Wx=Qx,Xx=function(e){return e.match(new RegExp("^"+Wx.A_CHARS+"*"))[0].length},$x=function(e){return e.match(new RegExp("^"+Wx.B_CHARS+"*"))[0].length},qx=function(e){return e.match(new RegExp("^"+Wx.C_CHARS+"*"))[0]};function Kx(e,t){var n=t?Wx.A_CHARS:Wx.B_CHARS,i=e.match(new RegExp("^("+n+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+String.fromCharCode(204)+Jx(e.substring(i[1].length));var r=e.match(new RegExp("^"+n+"+"))[0];return r.length===e.length?e:r+String.fromCharCode(t?205:206)+Kx(e.substring(r.length),!t)}function Jx(e){var t=qx(e),n=t.length;if(n===e.length)return e;e=e.substring(n);var i=Xx(e)>=$x(e);return t+String.fromCharCode(i?206:205)+Kx(e,i)}Gx.default=function(e){var t=void 0;if(qx(e).length>=2)t=Wx.C_START_CHAR+Jx(e);else{var n=Xx(e)>$x(e);t=(n?Wx.A_START_CHAR:Wx.B_START_CHAR)+Kx(e,n)}return t.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,(function(e,t){return String.fromCharCode(203)+t}))},Object.defineProperty(Dx,"__esModule",{value:!0});var Zx=t_(Mx),e_=t_(Gx);function t_(e){return e&&e.__esModule?e:{default:e}}function n_(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var i_=function(){function e(t,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),/^[\x00-\x7F\xC8-\xD3]+$/.test(t))var i=n_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,(0,e_.default)(t),n));else i=n_(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return n_(i)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,Zx.default),e}();Dx.default=i_;var r_={};Object.defineProperty(r_,"__esModule",{value:!0});var o_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a_=function(e){return e&&e.__esModule?e:{default:e}}(Mx),s_=Qx;var l_=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,s_.A_START_CHAR+t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,a_.default),o_(e,[{key:"valid",value:function(){return new RegExp("^"+s_.A_CHARS+"+$").test(this.data)}}]),e}();r_.default=l_;var c_={};Object.defineProperty(c_,"__esModule",{value:!0});var u_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),h_=function(e){return e&&e.__esModule?e:{default:e}}(Mx),d_=Qx;var f_=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,d_.B_START_CHAR+t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,h_.default),u_(e,[{key:"valid",value:function(){return new RegExp("^"+d_.B_CHARS+"+$").test(this.data)}}]),e}();c_.default=f_;var p_={};Object.defineProperty(p_,"__esModule",{value:!0});var g_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),v_=function(e){return e&&e.__esModule?e:{default:e}}(Mx),A_=Qx;var m_=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,A_.C_START_CHAR+t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,v_.default),g_(e,[{key:"valid",value:function(){return new RegExp("^"+A_.C_CHARS+"+$").test(this.data)}}]),e}();p_.default=m_,Object.defineProperty(Tx,"__esModule",{value:!0}),Tx.CODE128C=Tx.CODE128B=Tx.CODE128A=Tx.CODE128=void 0;var y_=x_(Dx),b_=x_(r_),C_=x_(c_),w_=x_(p_);function x_(e){return e&&e.__esModule?e:{default:e}}Tx.CODE128=y_.default,Tx.CODE128A=b_.default,Tx.CODE128B=C_.default,Tx.CODE128C=w_.default;var __={},E_={},S_={};Object.defineProperty(S_,"__esModule",{value:!0}),S_.SIDE_BIN="101",S_.MIDDLE_BIN="01010",S_.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},S_.EAN2_STRUCTURE=["LL","LG","GL","GG"],S_.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],S_.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"];var I_={},k_={};Object.defineProperty(k_,"__esModule",{value:!0});var B_=S_;k_.default=function(e,t,n){var i=e.split("").map((function(e,n){return B_.BINARIES[t[n]]})).map((function(t,n){return t?t[e[n]]:""}));if(n){var r=e.length-1;i=i.map((function(e,t){return t<r?e+n:e}))}return i.join("")},Object.defineProperty(I_,"__esModule",{value:!0});var O_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),T_=S_,D_=Q_(k_),M_=Q_(Cx);function Q_(e){return e&&e.__esModule?e:{default:e}}var L_=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.fontSize=!n.flat&&n.fontSize>10*n.width?10*n.width:n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,M_.default),O_(e,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(e,t){return this.text.substr(e,t)}},{key:"leftEncode",value:function(e,t){return(0,D_.default)(e,t)}},{key:"rightText",value:function(e,t){return this.text.substr(e,t)}},{key:"rightEncode",value:function(e,t){return(0,D_.default)(e,t)}},{key:"encodeGuarded",value:function(){var e={fontSize:this.fontSize},t={height:this.guardHeight};return[{data:T_.SIDE_BIN,options:t},{data:this.leftEncode(),text:this.leftText(),options:e},{data:T_.MIDDLE_BIN,options:t},{data:this.rightEncode(),text:this.rightText(),options:e},{data:T_.SIDE_BIN,options:t}]}},{key:"encodeFlat",value:function(){return{data:[T_.SIDE_BIN,this.leftEncode(),T_.MIDDLE_BIN,this.rightEncode(),T_.SIDE_BIN].join(""),text:this.text}}}]),e}();I_.default=L_,Object.defineProperty(E_,"__esModule",{value:!0});var P_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),j_=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},R_=S_,F_=function(e){return e&&e.__esModule?e:{default:e}}(I_);var N_=function(e){return(10-e.substr(0,12).split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+3*t:e+t}),0)%10)%10},V_=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{12}$/)&&(t+=N_(t));var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.lastChar=n.lastChar,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,F_.default),P_(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===N_(this.data)}},{key:"leftText",value:function(){return j_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var t=this.data.substr(1,6),n=R_.EAN13_STRUCTURE[this.data[0]];return j_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,n)}},{key:"rightText",value:function(){return j_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var t=this.data.substr(7,6);return j_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRRRR")}},{key:"encodeGuarded",value:function(){var t=j_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(t.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(t.push({data:"00"}),t.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),t}}]),e}();E_.default=V_;var U_={};Object.defineProperty(U_,"__esModule",{value:!0});var z_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),H_=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(i):void 0},Y_=function(e){return e&&e.__esModule?e:{default:e}}(I_);var G_=function(e){return(10-e.substr(0,7).split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+t:e+3*t}),0)%10)%10},W_=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{7}$/)&&(t+=G_(t)),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,Y_.default),z_(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===G_(this.data)}},{key:"leftText",value:function(){return H_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var t=this.data.substr(0,4);return H_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,t,"LLLL")}},{key:"rightText",value:function(){return H_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var t=this.data.substr(4,4);return H_(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,t,"RRRR")}}]),e}();U_.default=W_;var X_={};Object.defineProperty(X_,"__esModule",{value:!0});var $_=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),q_=S_,K_=Z_(k_),J_=Z_(Cx);function Z_(e){return e&&e.__esModule?e:{default:e}}var eE=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,J_.default),$_(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var e,t=q_.EAN5_STRUCTURE[(e=this.data,e.split("").map((function(e){return+e})).reduce((function(e,t,n){return n%2?e+9*t:e+3*t}),0)%10)];return{data:"1011"+(0,K_.default)(this.data,t,"01"),text:this.text}}}]),e}();X_.default=eE;var tE={};Object.defineProperty(tE,"__esModule",{value:!0});var nE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),iE=S_,rE=aE(k_),oE=aE(Cx);function aE(e){return e&&e.__esModule?e:{default:e}}var sE=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,oE.default),nE(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var e=iE.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,rE.default)(this.data,e,"01"),text:this.text}}}]),e}();tE.default=sE;var lE={};Object.defineProperty(lE,"__esModule",{value:!0});var cE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();lE.checksum=pE;var uE=dE(k_),hE=dE(Cx);function dE(e){return e&&e.__esModule?e:{default:e}}var fE=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{11}$/)&&(t+=pE(t));var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.displayValue=n.displayValue,n.fontSize>10*n.width?i.fontSize=10*n.width:i.fontSize=n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,hE.default),cE(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==pE(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=(0,uE.default)(this.data.substr(0,6),"LLLLLL"),e+="01010",e+=(0,uE.default)(this.data.substr(6,6),"RRRRRR"),{data:e+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101"+(0,uE.default)(this.data[0],"L"),options:{height:this.guardHeight}}),e.push({data:(0,uE.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),e.push({data:"01010",options:{height:this.guardHeight}}),e.push({data:(0,uE.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),e.push({data:(0,uE.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),e}}]),e}();function pE(e){var t,n=0;for(t=1;t<11;t+=2)n+=parseInt(e[t]);for(t=0;t<11;t+=2)n+=3*parseInt(e[t]);return(10-n%10)%10}lE.default=fE;var gE={};Object.defineProperty(gE,"__esModule",{value:!0});var vE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),AE=bE(k_),mE=bE(Cx),yE=lE;function bE(e){return e&&e.__esModule?e:{default:e}}function CE(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var wE=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],xE=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],_E=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=CE(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));if(i.isValid=!1,-1!==t.search(/^[0-9]{6}$/))i.middleDigits=t,i.upcA=EE(t,"0"),i.text=n.text||""+i.upcA[0]+t+i.upcA[i.upcA.length-1],i.isValid=!0;else{if(-1===t.search(/^[01][0-9]{7}$/))return CE(i);if(i.middleDigits=t.substring(1,t.length-1),i.upcA=EE(i.middleDigits,t[0]),i.upcA[i.upcA.length-1]!==t[t.length-1])return CE(i);i.isValid=!0}return i.displayValue=n.displayValue,n.fontSize>10*n.width?i.fontSize=10*n.width:i.fontSize=n.fontSize,i.guardHeight=n.height+i.fontSize/2+n.textMargin,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,mE.default),vE(e,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var e="";return e+="101",e+=this.encodeMiddleDigits(),{data:e+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var e=[];return this.displayValue&&e.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),e.push({data:"101",options:{height:this.guardHeight}}),e.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),e.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&e.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),e}},{key:"encodeMiddleDigits",value:function(){var e=this.upcA[0],t=this.upcA[this.upcA.length-1],n=xE[parseInt(t)][parseInt(e)];return(0,AE.default)(this.middleDigits,n)}}]),e}();function EE(e,t){for(var n=parseInt(e[e.length-1]),i=wE[n],r="",o=0,a=0;a<i.length;a++){var s=i[a];r+="X"===s?e[o++]:s}return""+(r=""+t+r)+(0,yE.checksum)(r)}gE.default=_E,Object.defineProperty(__,"__esModule",{value:!0}),__.UPCE=__.UPC=__.EAN2=__.EAN5=__.EAN8=__.EAN13=void 0;var SE=DE(E_),IE=DE(U_),kE=DE(X_),BE=DE(tE),OE=DE(lE),TE=DE(gE);function DE(e){return e&&e.__esModule?e:{default:e}}__.EAN13=SE.default,__.EAN8=IE.default,__.EAN5=kE.default,__.EAN2=BE.default,__.UPC=OE.default,__.UPCE=TE.default;var ME={},QE={},LE={};Object.defineProperty(LE,"__esModule",{value:!0}),LE.START_BIN="1010",LE.END_BIN="11101",LE.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"],Object.defineProperty(QE,"__esModule",{value:!0});var PE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),jE=LE,RE=function(e){return e&&e.__esModule?e:{default:e}}(Cx);var FE=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,RE.default),PE(e,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var e=this,t=this.data.match(/.{2}/g).map((function(t){return e.encodePair(t)})).join("");return{data:jE.START_BIN+t+jE.END_BIN,text:this.text}}},{key:"encodePair",value:function(e){var t=jE.BINARIES[e[1]];return jE.BINARIES[e[0]].split("").map((function(e,n){return("1"===e?"111":"1")+("1"===t[n]?"000":"0")})).join("")}}]),e}();QE.default=FE;var NE={};Object.defineProperty(NE,"__esModule",{value:!0});var VE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),UE=function(e){return e&&e.__esModule?e:{default:e}}(QE);var zE=function(e){var t=e.substr(0,13).split("").map((function(e){return parseInt(e,10)})).reduce((function(e,t,n){return e+t*(3-n%2*2)}),0);return 10*Math.ceil(t/10)-t},HE=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==t.search(/^[0-9]{13}$/)&&(t+=zE(t)),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,UE.default),VE(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===zE(this.data)}}]),e}();NE.default=HE,Object.defineProperty(ME,"__esModule",{value:!0}),ME.ITF14=ME.ITF=void 0;var YE=WE(QE),GE=WE(NE);function WE(e){return e&&e.__esModule?e:{default:e}}ME.ITF=YE.default,ME.ITF14=GE.default;var XE={},$E={};Object.defineProperty($E,"__esModule",{value:!0});var qE=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),KE=function(e){return e&&e.__esModule?e:{default:e}}(Cx);var JE=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,KE.default),qE(e,[{key:"encode",value:function(){for(var e="110",t=0;t<this.data.length;t++){var n=parseInt(this.data[t]).toString(2);n=ZE(n,4-n.length);for(var i=0;i<n.length;i++)e+="0"==n[i]?"100":"110"}return{data:e+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),e}();function ZE(e,t){for(var n=0;n<t;n++)e="0"+e;return e}$E.default=JE;var eS={},tS={};Object.defineProperty(tS,"__esModule",{value:!0}),tS.mod10=function(e){for(var t=0,n=0;n<e.length;n++){var i=parseInt(e[n]);(n+e.length)%2==0?t+=i:t+=2*i%10+Math.floor(2*i/10)}return(10-t%10)%10},tS.mod11=function(e){for(var t=0,n=[2,3,4,5,6,7],i=0;i<e.length;i++){var r=parseInt(e[e.length-1-i]);t+=n[i%n.length]*r}return(11-t%11)%11},Object.defineProperty(eS,"__esModule",{value:!0});var nS=function(e){return e&&e.__esModule?e:{default:e}}($E),iS=tS;var rS=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,iS.mod10)(t),n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,nS.default),e}();eS.default=rS;var oS={};Object.defineProperty(oS,"__esModule",{value:!0});var aS=function(e){return e&&e.__esModule?e:{default:e}}($E),sS=tS;var lS=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t+(0,sS.mod11)(t),n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,aS.default),e}();oS.default=lS;var cS={};Object.defineProperty(cS,"__esModule",{value:!0});var uS=function(e){return e&&e.__esModule?e:{default:e}}($E),hS=tS;var dS=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t+=(0,hS.mod10)(t),t+=(0,hS.mod10)(t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,uS.default),e}();cS.default=dS;var fS={};Object.defineProperty(fS,"__esModule",{value:!0});var pS=function(e){return e&&e.__esModule?e:{default:e}}($E),gS=tS;var vS=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t+=(0,gS.mod11)(t),t+=(0,gS.mod10)(t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,pS.default),e}();fS.default=vS,Object.defineProperty(XE,"__esModule",{value:!0}),XE.MSI1110=XE.MSI1010=XE.MSI11=XE.MSI10=XE.MSI=void 0;var AS=wS($E),mS=wS(eS),yS=wS(oS),bS=wS(cS),CS=wS(fS);function wS(e){return e&&e.__esModule?e:{default:e}}XE.MSI=AS.default,XE.MSI10=mS.default,XE.MSI11=yS.default,XE.MSI1010=bS.default,XE.MSI1110=CS.default;var xS={};Object.defineProperty(xS,"__esModule",{value:!0}),xS.pharmacode=void 0;var _S=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),ES=function(e){return e&&e.__esModule?e:{default:e}}(Cx);var SS=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.number=parseInt(t,10),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,ES.default),_S(e,[{key:"encode",value:function(){for(var e=this.number,t="";!isNaN(e)&&0!=e;)e%2==0?(t="11100"+t,e=(e-2)/2):(t="100"+t,e=(e-1)/2);return{data:t=t.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),e}();xS.pharmacode=SS;var IS={};Object.defineProperty(IS,"__esModule",{value:!0}),IS.codabar=void 0;var kS=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),BS=function(e){return e&&e.__esModule?e:{default:e}}(Cx);var OS=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),0===t.search(/^[0-9\-\$\:\.\+\/]+$/)&&(t="A"+t+"A");var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t.toUpperCase(),n));return i.text=i.options.text||i.text.replace(/[A-D]/g,""),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,BS.default),kS(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var e=[],t=this.getEncodings(),n=0;n<this.data.length;n++)e.push(t[this.data.charAt(n)]),n!==this.data.length-1&&e.push("0");return{text:this.text,data:e.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),e}();IS.codabar=OS;var TS={};Object.defineProperty(TS,"__esModule",{value:!0}),TS.GenericBarcode=void 0;var DS=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),MS=function(e){return e&&e.__esModule?e:{default:e}}(Cx);var QS=function(){function e(t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(e,MS.default),DS(e,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),e}();TS.GenericBarcode=QS,Object.defineProperty(yx,"__esModule",{value:!0});var LS=bx,PS=Tx,jS=__,RS=ME,FS=XE,NS=xS,VS=IS,US=TS;yx.default={CODE39:LS.CODE39,CODE128:PS.CODE128,CODE128A:PS.CODE128A,CODE128B:PS.CODE128B,CODE128C:PS.CODE128C,EAN13:jS.EAN13,EAN8:jS.EAN8,EAN5:jS.EAN5,EAN2:jS.EAN2,UPC:jS.UPC,UPCE:jS.UPCE,ITF14:RS.ITF14,ITF:RS.ITF,MSI:FS.MSI,MSI10:FS.MSI10,MSI11:FS.MSI11,MSI1010:FS.MSI1010,MSI1110:FS.MSI1110,pharmacode:NS.pharmacode,codabar:VS.codabar,GenericBarcode:US.GenericBarcode};var zS={};Object.defineProperty(zS,"__esModule",{value:!0});var HS=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};zS.default=function(e,t){return HS({},e,t)};var YS={};Object.defineProperty(YS,"__esModule",{value:!0}),YS.default=function(e){var t=[];return function e(n){if(Array.isArray(n))for(var i=0;i<n.length;i++)e(n[i]);else n.text=n.text||"",n.data=n.data||"",t.push(n)}(e),t};var GS={};Object.defineProperty(GS,"__esModule",{value:!0}),GS.default=function(e){return e.marginTop=e.marginTop||e.margin,e.marginBottom=e.marginBottom||e.margin,e.marginRight=e.marginRight||e.margin,e.marginLeft=e.marginLeft||e.margin,e};var WS={},XS={},$S={};Object.defineProperty($S,"__esModule",{value:!0}),$S.default=function(e){var t=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var n in t)t.hasOwnProperty(n)&&"string"==typeof e[n=t[n]]&&(e[n]=parseInt(e[n],10));"string"==typeof e.displayValue&&(e.displayValue="false"!=e.displayValue);return e};var qS={};Object.defineProperty(qS,"__esModule",{value:!0});qS.default={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}},Object.defineProperty(XS,"__esModule",{value:!0});var KS=ZS($S),JS=ZS(qS);function ZS(e){return e&&e.__esModule?e:{default:e}}XS.default=function(e){var t={};for(var n in JS.default)JS.default.hasOwnProperty(n)&&(e.hasAttribute("jsbarcode-"+n.toLowerCase())&&(t[n]=e.getAttribute("jsbarcode-"+n.toLowerCase())),e.hasAttribute("data-"+n.toLowerCase())&&(t[n]=e.getAttribute("data-"+n.toLowerCase())));return t.value=e.getAttribute("jsbarcode-value")||e.getAttribute("data-value"),t=(0,KS.default)(t)};var eI={},tI={},nI={};Object.defineProperty(nI,"__esModule",{value:!0}),nI.getTotalWidthOfEncodings=nI.calculateEncodingAttributes=nI.getBarcodePadding=nI.getEncodingHeight=nI.getMaximumHeightOfEncodings=void 0;var iI=function(e){return e&&e.__esModule?e:{default:e}}(zS);function rI(e,t){return t.height+(t.displayValue&&e.text.length>0?t.fontSize+t.textMargin:0)+t.marginTop+t.marginBottom}function oI(e,t,n){if(n.displayValue&&t<e){if("center"==n.textAlign)return Math.floor((e-t)/2);if("left"==n.textAlign)return 0;if("right"==n.textAlign)return Math.floor(e-t)}return 0}function aI(e,t,n){var i;if(n)i=n;else{if("undefined"==typeof document)return 0;i=document.createElement("canvas").getContext("2d")}i.font=t.fontOptions+" "+t.fontSize+"px "+t.font;var r=i.measureText(e);return r?r.width:0}nI.getMaximumHeightOfEncodings=function(e){for(var t=0,n=0;n<e.length;n++)e[n].height>t&&(t=e[n].height);return t},nI.getEncodingHeight=rI,nI.getBarcodePadding=oI,nI.calculateEncodingAttributes=function(e,t,n){for(var i=0;i<e.length;i++){var r,o=e[i],a=(0,iI.default)(t,o.options);r=a.displayValue?aI(o.text,a,n):0;var s=o.data.length*a.width;o.width=Math.ceil(Math.max(r,s)),o.height=rI(o,a),o.barcodePadding=oI(r,s,a)}},nI.getTotalWidthOfEncodings=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n].width;return t},Object.defineProperty(tI,"__esModule",{value:!0});var sI=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),lI=function(e){return e&&e.__esModule?e:{default:e}}(zS),cI=nI;var uI=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.encodings=n,this.options=i}return sI(e,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var e=0;e<this.encodings.length;e++){var t=(0,lI.default)(this.options,this.encodings[e].options);this.drawCanvasBarcode(t,this.encodings[e]),this.drawCanvasText(t,this.encodings[e]),this.moveCanvasDrawing(this.encodings[e])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var e=this.canvas.getContext("2d");e.save(),(0,cI.calculateEncodingAttributes)(this.encodings,this.options,e);var t=(0,cI.getTotalWidthOfEncodings)(this.encodings),n=(0,cI.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=t+this.options.marginLeft+this.options.marginRight,this.canvas.height=n,e.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(e.fillStyle=this.options.background,e.fillRect(0,0,this.canvas.width,this.canvas.height)),e.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(e,t){var n,i=this.canvas.getContext("2d"),r=t.data;n="top"==e.textPosition?e.marginTop+e.fontSize+e.textMargin:e.marginTop,i.fillStyle=e.lineColor;for(var o=0;o<r.length;o++){var a=o*e.width+t.barcodePadding;"1"===r[o]?i.fillRect(a,n,e.width,e.height):r[o]&&i.fillRect(a,n,e.width,e.height*r[o])}}},{key:"drawCanvasText",value:function(e,t){var n,i,r=this.canvas.getContext("2d"),o=e.fontOptions+" "+e.fontSize+"px "+e.font;e.displayValue&&(i="top"==e.textPosition?e.marginTop+e.fontSize-e.textMargin:e.height+e.textMargin+e.marginTop+e.fontSize,r.font=o,"left"==e.textAlign||t.barcodePadding>0?(n=0,r.textAlign="left"):"right"==e.textAlign?(n=t.width-1,r.textAlign="right"):(n=t.width/2,r.textAlign="center"),r.fillText(t.text,n,i))}},{key:"moveCanvasDrawing",value:function(e){this.canvas.getContext("2d").translate(e.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),e}();tI.default=uI;var hI={};Object.defineProperty(hI,"__esModule",{value:!0});var dI=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),fI=function(e){return e&&e.__esModule?e:{default:e}}(zS),pI=nI;var gI="http://www.w3.org/2000/svg",vI=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.svg=t,this.encodings=n,this.options=i,this.document=i.xmlDocument||document}return dI(e,[{key:"render",value:function(){var e=this.options.marginLeft;this.prepareSVG();for(var t=0;t<this.encodings.length;t++){var n=this.encodings[t],i=(0,fI.default)(this.options,n.options),r=this.createGroup(e,i.marginTop,this.svg);this.setGroupOptions(r,i),this.drawSvgBarcode(r,i,n),this.drawSVGText(r,i,n),e+=n.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,pI.calculateEncodingAttributes)(this.encodings,this.options);var e=(0,pI.getTotalWidthOfEncodings)(this.encodings),t=(0,pI.getMaximumHeightOfEncodings)(this.encodings),n=e+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(n,t),this.options.background&&this.drawRect(0,0,n,t,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(e,t,n){var i,r=n.data;i="top"==t.textPosition?t.fontSize+t.textMargin:0;for(var o=0,a=0,s=0;s<r.length;s++)a=s*t.width+n.barcodePadding,"1"===r[s]?o++:o>0&&(this.drawRect(a-t.width*o,i,t.width*o,t.height,e),o=0);o>0&&this.drawRect(a-t.width*(o-1),i,t.width*o,t.height,e)}},{key:"drawSVGText",value:function(e,t,n){var i,r,o=this.document.createElementNS(gI,"text");t.displayValue&&(o.setAttribute("style","font:"+t.fontOptions+" "+t.fontSize+"px "+t.font),r="top"==t.textPosition?t.fontSize-t.textMargin:t.height+t.textMargin+t.fontSize,"left"==t.textAlign||n.barcodePadding>0?(i=0,o.setAttribute("text-anchor","start")):"right"==t.textAlign?(i=n.width-1,o.setAttribute("text-anchor","end")):(i=n.width/2,o.setAttribute("text-anchor","middle")),o.setAttribute("x",i),o.setAttribute("y",r),o.appendChild(this.document.createTextNode(n.text)),e.appendChild(o))}},{key:"setSvgAttributes",value:function(e,t){var n=this.svg;n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("x","0px"),n.setAttribute("y","0px"),n.setAttribute("viewBox","0 0 "+e+" "+t),n.setAttribute("xmlns",gI),n.setAttribute("version","1.1"),n.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(e,t,n){var i=this.document.createElementNS(gI,"g");return i.setAttribute("transform","translate("+e+", "+t+")"),n.appendChild(i),i}},{key:"setGroupOptions",value:function(e,t){e.setAttribute("style","fill:"+t.lineColor+";")}},{key:"drawRect",value:function(e,t,n,i,r){var o=this.document.createElementNS(gI,"rect");return o.setAttribute("x",e),o.setAttribute("y",t),o.setAttribute("width",n),o.setAttribute("height",i),r.appendChild(o),o}}]),e}();hI.default=vI;var AI={};Object.defineProperty(AI,"__esModule",{value:!0});var mI=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var yI=function(){function e(t,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.object=t,this.encodings=n,this.options=i}return mI(e,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),e}();AI.default=yI,Object.defineProperty(eI,"__esModule",{value:!0});var bI=xI(tI),CI=xI(hI),wI=xI(AI);function xI(e){return e&&e.__esModule?e:{default:e}}eI.default={CanvasRenderer:bI.default,SVGRenderer:CI.default,ObjectRenderer:wI.default};var _I={};function EI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function SI(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function II(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(_I,"__esModule",{value:!0});var kI=function(){function e(t,n){EI(this,e);var i=SI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.name="InvalidInputException",i.symbology=t,i.input=n,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return II(e,Error),e}(),BI=function(){function e(){EI(this,e);var t=SI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="InvalidElementException",t.message="Not supported type to render on",t}return II(e,Error),e}(),OI=function(){function e(){EI(this,e);var t=SI(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.name="NoElementException",t.message="No element to render on.",t}return II(e,Error),e}();_I.InvalidInputException=kI,_I.InvalidElementException=BI,_I.NoElementException=OI,Object.defineProperty(WS,"__esModule",{value:!0});var TI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DI=LI(XS),MI=LI(eI),QI=_I;function LI(e){return e&&e.__esModule?e:{default:e}}function PI(e){if("string"==typeof e)return function(e){var t=document.querySelectorAll(e);if(0===t.length)return;for(var n=[],i=0;i<t.length;i++)n.push(PI(t[i]));return n}(e);if(Array.isArray(e)){for(var t=[],n=0;n<e.length;n++)t.push(PI(e[n]));return t}if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLImageElement)return i=e,{element:r=document.createElement("canvas"),options:(0,DI.default)(i),renderer:MI.default.CanvasRenderer,afterRender:function(){i.setAttribute("src",r.toDataURL())}};if(e&&e.nodeName&&"svg"===e.nodeName.toLowerCase()||"undefined"!=typeof SVGElement&&e instanceof SVGElement)return{element:e,options:(0,DI.default)(e),renderer:MI.default.SVGRenderer};if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement)return{element:e,options:(0,DI.default)(e),renderer:MI.default.CanvasRenderer};if(e&&e.getContext)return{element:e,renderer:MI.default.CanvasRenderer};if(e&&"object"===(void 0===e?"undefined":TI(e))&&!e.nodeName)return{element:e,renderer:MI.default.ObjectRenderer};throw new QI.InvalidElementException;var i,r}WS.default=PI;var jI={};Object.defineProperty(jI,"__esModule",{value:!0});var RI=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}();var FI=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t}return RI(e,[{key:"handleCatch",value:function(e){if("InvalidInputException"!==e.name)throw e;if(this.api._options.valid===this.api._defaults.valid)throw e.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(e){try{var t=e.apply(void 0,arguments);return this.api._options.valid(!0),t}catch(n){return this.handleCatch(n),this.api}}}]),e}();jI.default=FI;var NI=$I(yx),VI=$I(zS),UI=$I(YS),zI=$I(GS),HI=$I(WS),YI=$I($S),GI=$I(jI),WI=_I,XI=$I(qS);function $I(e){return e&&e.__esModule?e:{default:e}}var qI=function(){},KI=function(e,t,n){var i=new qI;if(void 0===e)throw Error("No element to render on was provided.");return i._renderProperties=(0,HI.default)(e),i._encodings=[],i._options=XI.default,i._errorHandler=new GI.default(i),void 0!==t&&((n=n||{}).format||(n.format=tk()),i.options(n)[n.format](t,n).render()),i};for(var JI in KI.getModule=function(e){return NI.default[e]},NI.default)NI.default.hasOwnProperty(JI)&&ZI(NI.default,JI);function ZI(e,t){qI.prototype[t]=qI.prototype[t.toUpperCase()]=qI.prototype[t.toLowerCase()]=function(n,i){var r=this;return r._errorHandler.wrapBarcodeCall((function(){i.text=void 0===i.text?void 0:""+i.text;var o=(0,VI.default)(r._options,i);o=(0,YI.default)(o);var a=e[t],s=ek(n,a,o);return r._encodings.push(s),r}))}}function ek(e,t,n){var i=new t(e=""+e,n);if(!i.valid())throw new WI.InvalidInputException(i.constructor.name,e);var r=i.encode();r=(0,UI.default)(r);for(var o=0;o<r.length;o++)r[o].options=(0,VI.default)(n,r[o].options);return r}function tk(){return NI.default.CODE128?"CODE128":Object.keys(NI.default)[0]}function nk(e,t,n){t=(0,UI.default)(t);for(var i=0;i<t.length;i++)t[i].options=(0,VI.default)(n,t[i].options),(0,zI.default)(t[i].options);(0,zI.default)(n),new(0,e.renderer)(e.element,t,n).render(),e.afterRender&&e.afterRender()}qI.prototype.options=function(e){return this._options=(0,VI.default)(this._options,e),this},qI.prototype.blank=function(e){var t=new Array(e+1).join("0");return this._encodings.push({data:t}),this},qI.prototype.init=function(){var e;if(this._renderProperties)for(var t in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){e=this._renderProperties[t];var n=(0,VI.default)(this._options,e.options);"auto"==n.format&&(n.format=tk()),this._errorHandler.wrapBarcodeCall((function(){var t=ek(n.value,NI.default[n.format.toUpperCase()],n);nk(e,t,n)}))}},qI.prototype.render=function(){if(!this._renderProperties)throw new WI.NoElementException;if(Array.isArray(this._renderProperties))for(var e=0;e<this._renderProperties.length;e++)nk(this._renderProperties[e],this._encodings,this._options);else nk(this._renderProperties,this._encodings,this._options);return this},qI.prototype._defaults=XI.default,"undefined"!=typeof window&&(window.JsBarcode=KI),"undefined"!=typeof jQuery&&(jQuery.fn.JsBarcode=function(e,t){var n=[];return jQuery(this).each((function(){n.push(this)})),KI(n,e,t)});const ik=xi(KI);var rk=(e=>(e.CODE128="CODE128",e.EAN8="EAN8",e.EAN13="EAN13",e.ITF14="ITF14",e.codabar="codabar",e.pharmacode="pharmacode",e))(rk||{});class ok{constructor(e,t){this.canvas=e,this.editor=t}hookTransform(e){return h(this,null,(function*(){if("barcode"===e.extensionType){const t=yield this._getBase64Str(e.extension);e.src=t}}))}_getBase64Str(e){const t=document.createElement("canvas");ik(t,e.value,l({},e));return t.toDataURL("image/png",1)}_defaultBarcodeOption(){return{value:"123456",format:"CODE128",text:"hi kuaitu",textAlign:"left",textPosition:"bottom",fontSize:12,background:"#fff",lineColor:"#000",displayValue:!1}}addBarcode(){const e=this._defaultBarcodeOption(),t=this._getBase64Str(JSON.parse(JSON.stringify(e)));vA.fabric.Image.fromURL(t,(t=>{t.set({extensionType:"barcode",extension:e}),t.scaleToWidth(this.editor.getWorkspase().getScaledWidth()/2),this.canvas.add(t),this.canvas.setActiveObject(t),this.editor.position("center")}),{crossOrigin:"anonymous"})}setBarcode(e){try{const t=this._getBase64Str(e),n=this.canvas.getActiveObjects()[0];vA.fabric.Image.fromURL(t,(t=>{t.set({left:n.left,top:n.top,extensionType:"barcode",extension:l({},e)}),t.scaleToWidth(n.getScaledWidth()),this.editor.del(),this.canvas.add(t),this.canvas.setActiveObject(t)}),{crossOrigin:"anonymous"})}catch(t){}}getBarcodeTypes(){return Object.values(rk)}destroy(){}}u(ok,"pluginName","BarCodePlugin"),u(ok,"apis",["addBarcode","setBarcode","getBarcodeTypes"]);var ak={exports:{}};self,ak.exports=(()=>{var e={192:(e,t)=>{var n,i,r=function(){var e=function(e,t){var n=e,i=a[t],r=null,o=0,l=null,v=[],A={},y=function(e,t){r=function(e){for(var t=new Array(e),n=0;n<e;n+=1){t[n]=new Array(e);for(var i=0;i<e;i+=1)t[n][i]=null}return t}(o=4*n+17),b(0,0),b(o-7,0),b(0,o-7),w(),C(),_(e,t),n>=7&&x(e),null==l&&(l=S(n,i,v)),E(l,t)},b=function(e,t){for(var n=-1;n<=7;n+=1)if(!(e+n<=-1||o<=e+n))for(var i=-1;i<=7;i+=1)t+i<=-1||o<=t+i||(r[e+n][t+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},C=function(){for(var e=8;e<o-8;e+=1)null==r[e][6]&&(r[e][6]=e%2==0);for(var t=8;t<o-8;t+=1)null==r[6][t]&&(r[6][t]=t%2==0)},w=function(){for(var e=s.getPatternPosition(n),t=0;t<e.length;t+=1)for(var i=0;i<e.length;i+=1){var o=e[t],a=e[i];if(null==r[o][a])for(var l=-2;l<=2;l+=1)for(var c=-2;c<=2;c+=1)r[o+l][a+c]=-2==l||2==l||-2==c||2==c||0==l&&0==c}},x=function(e){for(var t=s.getBCHTypeNumber(n),i=0;i<18;i+=1){var a=!e&&1==(t>>i&1);r[Math.floor(i/3)][i%3+o-8-3]=a}for(i=0;i<18;i+=1)a=!e&&1==(t>>i&1),r[i%3+o-8-3][Math.floor(i/3)]=a},_=function(e,t){for(var n=i<<3|t,a=s.getBCHTypeInfo(n),l=0;l<15;l+=1){var c=!e&&1==(a>>l&1);l<6?r[l][8]=c:l<8?r[l+1][8]=c:r[o-15+l][8]=c}for(l=0;l<15;l+=1)c=!e&&1==(a>>l&1),l<8?r[8][o-l-1]=c:l<9?r[8][15-l-1+1]=c:r[8][15-l-1]=c;r[o-8][8]=!e},E=function(e,t){for(var n=-1,i=o-1,a=7,l=0,c=s.getMaskFunction(t),u=o-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var h=0;h<2;h+=1)if(null==r[i][u-h]){var d=!1;l<e.length&&(d=1==(e[l]>>>a&1)),c(i,u-h)&&(d=!d),r[i][u-h]=d,-1==(a-=1)&&(l+=1,a=7)}if((i+=n)<0||o<=i){i-=n,n=-n;break}}},S=function(e,t,n){for(var i=u.getRSBlocks(e,t),r=h(),o=0;o<n.length;o+=1){var a=n[o];r.put(a.getMode(),4),r.put(a.getLength(),s.getLengthInBits(a.getMode(),e)),a.write(r)}var l=0;for(o=0;o<i.length;o+=1)l+=i[o].dataCount;if(r.getLengthInBits()>8*l)throw"code length overflow. ("+r.getLengthInBits()+">"+8*l+")";for(r.getLengthInBits()+4<=8*l&&r.put(0,4);r.getLengthInBits()%8!=0;)r.putBit(!1);for(;!(r.getLengthInBits()>=8*l||(r.put(236,8),r.getLengthInBits()>=8*l));)r.put(17,8);return function(e,t){for(var n=0,i=0,r=0,o=new Array(t.length),a=new Array(t.length),l=0;l<t.length;l+=1){var u=t[l].dataCount,h=t[l].totalCount-u;i=Math.max(i,u),r=Math.max(r,h),o[l]=new Array(u);for(var d=0;d<o[l].length;d+=1)o[l][d]=255&e.getBuffer()[d+n];n+=u;var f=s.getErrorCorrectPolynomial(h),p=c(o[l],f.getLength()-1).mod(f);for(a[l]=new Array(f.getLength()-1),d=0;d<a[l].length;d+=1){var g=d+p.getLength()-a[l].length;a[l][d]=g>=0?p.getAt(g):0}}var v=0;for(d=0;d<t.length;d+=1)v+=t[d].totalCount;var A=new Array(v),m=0;for(d=0;d<i;d+=1)for(l=0;l<t.length;l+=1)d<o[l].length&&(A[m]=o[l][d],m+=1);for(d=0;d<r;d+=1)for(l=0;l<t.length;l+=1)d<a[l].length&&(A[m]=a[l][d],m+=1);return A}(r,i)};A.addData=function(e,t){var n=null;switch(t=t||"Byte"){case"Numeric":n=d(e);break;case"Alphanumeric":n=f(e);break;case"Byte":n=p(e);break;case"Kanji":n=g(e);break;default:throw"mode:"+t}v.push(n),l=null},A.isDark=function(e,t){if(e<0||o<=e||t<0||o<=t)throw e+","+t;return r[e][t]},A.getModuleCount=function(){return o},A.make=function(){if(n<1){for(var e=1;e<40;e++){for(var t=u.getRSBlocks(e,i),r=h(),o=0;o<v.length;o++){var a=v[o];r.put(a.getMode(),4),r.put(a.getLength(),s.getLengthInBits(a.getMode(),e)),a.write(r)}var l=0;for(o=0;o<t.length;o++)l+=t[o].dataCount;if(r.getLengthInBits()<=8*l)break}n=e}y(!1,function(){for(var e=0,t=0,n=0;n<8;n+=1){y(!0,n);var i=s.getLostPoint(A);(0==n||e>i)&&(e=i,t=n)}return t}())},A.createTableTag=function(e,t){e=e||2;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+(t=void 0===t?4*e:t)+"px;",n+='">',n+="<tbody>";for(var i=0;i<A.getModuleCount();i+=1){n+="<tr>";for(var r=0;r<A.getModuleCount();r+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+e+"px;",n+=" height: "+e+"px;",n+=" background-color: ",n+=A.isDark(i,r)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return(n+="</tbody>")+"</table>"},A.createSvgTag=function(e,t,n,i){var r={};"object"==typeof arguments[0]&&(e=(r=arguments[0]).cellSize,t=r.margin,n=r.alt,i=r.title),e=e||2,t=void 0===t?4*e:t,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-description":null,(i="string"==typeof i?{text:i}:i||{}).text=i.text||null,i.id=i.text?i.id||"qrcode-title":null;var o,a,s,l,c=A.getModuleCount()*e+2*t,u="";for(l="l"+e+",0 0,"+e+" -"+e+",0 0,-"+e+"z ",u+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',u+=r.scalable?"":' width="'+c+'px" height="'+c+'px"',u+=' viewBox="0 0 '+c+" "+c+'" ',u+=' preserveAspectRatio="xMinYMin meet"',u+=i.text||n.text?' role="img" aria-labelledby="'+I([i.id,n.id].join(" ").trim())+'"':"",u+=">",u+=i.text?'<title id="'+I(i.id)+'">'+I(i.text)+"</title>":"",u+=n.text?'<description id="'+I(n.id)+'">'+I(n.text)+"</description>":"",u+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',u+='<path d="',a=0;a<A.getModuleCount();a+=1)for(s=a*e+t,o=0;o<A.getModuleCount();o+=1)A.isDark(a,o)&&(u+="M"+(o*e+t)+","+s+l);return(u+='" stroke="transparent" fill="black"/>')+"</svg>"},A.createDataURL=function(e,t){e=e||2,t=void 0===t?4*e:t;var n=A.getModuleCount()*e+2*t,i=t,r=n-t;return m(n,n,(function(t,n){if(i<=t&&t<r&&i<=n&&n<r){var o=Math.floor((t-i)/e),a=Math.floor((n-i)/e);return A.isDark(a,o)?0:1}return 1}))},A.createImgTag=function(e,t,n){e=e||2,t=void 0===t?4*e:t;var i=A.getModuleCount()*e+2*t,r="";return r+="<img",r+=' src="',r+=A.createDataURL(e,t),r+='"',r+=' width="',r+=i,r+='"',r+=' height="',r+=i,r+='"',n&&(r+=' alt="',r+=I(n),r+='"'),r+"/>"};var I=function(e){for(var t="",n=0;n<e.length;n+=1){var i=e.charAt(n);switch(i){case"<":t+="&lt;";break;case">":t+="&gt;";break;case"&":t+="&amp;";break;case'"':t+="&quot;";break;default:t+=i}}return t};return A.createASCII=function(e,t){if((e=e||1)<2)return function(e){e=void 0===e?2:e;var t,n,i,r,o,a=1*A.getModuleCount()+2*e,s=e,l=a-e,c={"██":"█","█ ":"▀"," █":"▄","  ":" "},u={"██":"▀","█ ":"▀"," █":" ","  ":" "},h="";for(t=0;t<a;t+=2){for(i=Math.floor((t-s)/1),r=Math.floor((t+1-s)/1),n=0;n<a;n+=1)o="█",s<=n&&n<l&&s<=t&&t<l&&A.isDark(i,Math.floor((n-s)/1))&&(o=" "),s<=n&&n<l&&s<=t+1&&t+1<l&&A.isDark(r,Math.floor((n-s)/1))?o+=" ":o+="█",h+=e<1&&t+1>=l?u[o]:c[o];h+="\n"}return a%2&&e>0?h.substring(0,h.length-a-1)+Array(a+1).join("▀"):h.substring(0,h.length-1)}(t);e-=1,t=void 0===t?2*e:t;var n,i,r,o,a=A.getModuleCount()*e+2*t,s=t,l=a-t,c=Array(e+1).join("██"),u=Array(e+1).join("  "),h="",d="";for(n=0;n<a;n+=1){for(r=Math.floor((n-s)/e),d="",i=0;i<a;i+=1)o=1,s<=i&&i<l&&s<=n&&n<l&&A.isDark(r,Math.floor((i-s)/e))&&(o=0),d+=o?c:u;for(r=0;r<e;r+=1)h+=d+"\n"}return h.substring(0,h.length-1)},A.renderTo2dContext=function(e,t){t=t||2;for(var n=A.getModuleCount(),i=0;i<n;i++)for(var r=0;r<n;r++)e.fillStyle=A.isDark(i,r)?"black":"white",e.fillRect(i*t,r*t,t,t)},A};e.stringToBytes=(e.stringToBytesFuncs={default:function(e){for(var t=[],n=0;n<e.length;n+=1){var i=e.charCodeAt(n);t.push(255&i)}return t}}).default,e.createStringToBytes=function(e,t){var n=function(){for(var n=A(e),i=function(){var e=n.read();if(-1==e)throw"eof";return e},r=0,o={};;){var a=n.read();if(-1==a)break;var s=i(),l=i()<<8|i();o[String.fromCharCode(a<<8|s)]=l,r+=1}if(r!=t)throw r+" != "+t;return o}(),i="?".charCodeAt(0);return function(e){for(var t=[],r=0;r<e.length;r+=1){var o=e.charCodeAt(r);if(o<128)t.push(o);else{var a=n[e.charAt(r)];"number"==typeof a?(255&a)==a?t.push(a):(t.push(a>>>8),t.push(255&a)):t.push(i)}}return t}};var t,n,i,r,o,a={L:1,M:0,Q:3,H:2},s=(t=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,i=7973,o=function(e){for(var t=0;0!=e;)t+=1,e>>>=1;return t},(r={}).getBCHTypeInfo=function(e){for(var t=e<<10;o(t)-o(n)>=0;)t^=n<<o(t)-o(n);return 21522^(e<<10|t)},r.getBCHTypeNumber=function(e){for(var t=e<<12;o(t)-o(i)>=0;)t^=i<<o(t)-o(i);return e<<12|t},r.getPatternPosition=function(e){return t[e-1]},r.getMaskFunction=function(e){switch(e){case 0:return function(e,t){return(e+t)%2==0};case 1:return function(e,t){return e%2==0};case 2:return function(e,t){return t%3==0};case 3:return function(e,t){return(e+t)%3==0};case 4:return function(e,t){return(Math.floor(e/2)+Math.floor(t/3))%2==0};case 5:return function(e,t){return e*t%2+e*t%3==0};case 6:return function(e,t){return(e*t%2+e*t%3)%2==0};case 7:return function(e,t){return(e*t%3+(e+t)%2)%2==0};default:throw"bad maskPattern:"+e}},r.getErrorCorrectPolynomial=function(e){for(var t=c([1],0),n=0;n<e;n+=1)t=t.multiply(c([1,l.gexp(n)],0));return t},r.getLengthInBits=function(e,t){if(1<=t&&t<10)switch(e){case 1:return 10;case 2:return 9;case 4:case 8:return 8;default:throw"mode:"+e}else if(t<27)switch(e){case 1:return 12;case 2:return 11;case 4:return 16;case 8:return 10;default:throw"mode:"+e}else{if(!(t<41))throw"type:"+t;switch(e){case 1:return 14;case 2:return 13;case 4:return 16;case 8:return 12;default:throw"mode:"+e}}},r.getLostPoint=function(e){for(var t=e.getModuleCount(),n=0,i=0;i<t;i+=1)for(var r=0;r<t;r+=1){for(var o=0,a=e.isDark(i,r),s=-1;s<=1;s+=1)if(!(i+s<0||t<=i+s))for(var l=-1;l<=1;l+=1)r+l<0||t<=r+l||0==s&&0==l||a==e.isDark(i+s,r+l)&&(o+=1);o>5&&(n+=3+o-5)}for(i=0;i<t-1;i+=1)for(r=0;r<t-1;r+=1){var c=0;e.isDark(i,r)&&(c+=1),e.isDark(i+1,r)&&(c+=1),e.isDark(i,r+1)&&(c+=1),e.isDark(i+1,r+1)&&(c+=1),0!=c&&4!=c||(n+=3)}for(i=0;i<t;i+=1)for(r=0;r<t-6;r+=1)e.isDark(i,r)&&!e.isDark(i,r+1)&&e.isDark(i,r+2)&&e.isDark(i,r+3)&&e.isDark(i,r+4)&&!e.isDark(i,r+5)&&e.isDark(i,r+6)&&(n+=40);for(r=0;r<t;r+=1)for(i=0;i<t-6;i+=1)e.isDark(i,r)&&!e.isDark(i+1,r)&&e.isDark(i+2,r)&&e.isDark(i+3,r)&&e.isDark(i+4,r)&&!e.isDark(i+5,r)&&e.isDark(i+6,r)&&(n+=40);var u=0;for(r=0;r<t;r+=1)for(i=0;i<t;i+=1)e.isDark(i,r)&&(u+=1);return n+Math.abs(100*u/t/t-50)/5*10},r),l=function(){for(var e=new Array(256),t=new Array(256),n=0;n<8;n+=1)e[n]=1<<n;for(n=8;n<256;n+=1)e[n]=e[n-4]^e[n-5]^e[n-6]^e[n-8];for(n=0;n<255;n+=1)t[e[n]]=n;return{glog:function(e){if(e<1)throw"glog("+e+")";return t[e]},gexp:function(t){for(;t<0;)t+=255;for(;t>=256;)t-=255;return e[t]}}}();function c(e,t){if(void 0===e.length)throw e.length+"/"+t;var n=function(){for(var n=0;n<e.length&&0==e[n];)n+=1;for(var i=new Array(e.length-n+t),r=0;r<e.length-n;r+=1)i[r]=e[r+n];return i}(),i={getAt:function(e){return n[e]},getLength:function(){return n.length},multiply:function(e){for(var t=new Array(i.getLength()+e.getLength()-1),n=0;n<i.getLength();n+=1)for(var r=0;r<e.getLength();r+=1)t[n+r]^=l.gexp(l.glog(i.getAt(n))+l.glog(e.getAt(r)));return c(t,0)},mod:function(e){if(i.getLength()-e.getLength()<0)return i;for(var t=l.glog(i.getAt(0))-l.glog(e.getAt(0)),n=new Array(i.getLength()),r=0;r<i.getLength();r+=1)n[r]=i.getAt(r);for(r=0;r<e.getLength();r+=1)n[r]^=l.gexp(l.glog(e.getAt(r))+t);return c(n,0).mod(e)}};return i}var u=function(){var e=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],t=function(e,t){var n={};return n.totalCount=e,n.dataCount=t,n};return{getRSBlocks:function(n,i){var r=function(t,n){switch(n){case a.L:return e[4*(t-1)+0];case a.M:return e[4*(t-1)+1];case a.Q:return e[4*(t-1)+2];case a.H:return e[4*(t-1)+3];default:return}}(n,i);if(void 0===r)throw"bad rs block @ typeNumber:"+n+"/errorCorrectionLevel:"+i;for(var o=r.length/3,s=[],l=0;l<o;l+=1)for(var c=r[3*l+0],u=r[3*l+1],h=r[3*l+2],d=0;d<c;d+=1)s.push(t(u,h));return s}}}(),h=function(){var e=[],t=0,n={getBuffer:function(){return e},getAt:function(t){var n=Math.floor(t/8);return 1==(e[n]>>>7-t%8&1)},put:function(e,t){for(var i=0;i<t;i+=1)n.putBit(1==(e>>>t-i-1&1))},getLengthInBits:function(){return t},putBit:function(n){var i=Math.floor(t/8);e.length<=i&&e.push(0),n&&(e[i]|=128>>>t%8),t+=1}};return n},d=function(e){var t=e,n={getMode:function(){return 1},getLength:function(e){return t.length},write:function(e){for(var n=t,r=0;r+2<n.length;)e.put(i(n.substring(r,r+3)),10),r+=3;r<n.length&&(n.length-r==1?e.put(i(n.substring(r,r+1)),4):n.length-r==2&&e.put(i(n.substring(r,r+2)),7))}},i=function(e){for(var t=0,n=0;n<e.length;n+=1)t=10*t+r(e.charAt(n));return t},r=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+e};return n},f=function(e){var t=e,n={getMode:function(){return 2},getLength:function(e){return t.length},write:function(e){for(var n=t,r=0;r+1<n.length;)e.put(45*i(n.charAt(r))+i(n.charAt(r+1)),11),r+=2;r<n.length&&e.put(i(n.charAt(r)),6)}},i=function(e){if("0"<=e&&e<="9")return e.charCodeAt(0)-"0".charCodeAt(0);if("A"<=e&&e<="Z")return e.charCodeAt(0)-"A".charCodeAt(0)+10;switch(e){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+e}};return n},p=function(t){var n=e.stringToBytes(t);return{getMode:function(){return 4},getLength:function(e){return n.length},write:function(e){for(var t=0;t<n.length;t+=1)e.put(n[t],8)}}},g=function(t){var n=e.stringToBytesFuncs.SJIS;if(!n)throw"sjis not supported.";!function(){var e=n("友");if(2!=e.length||38726!=(e[0]<<8|e[1]))throw"sjis not supported."}();var i=n(t);return{getMode:function(){return 8},getLength:function(e){return~~(i.length/2)},write:function(e){for(var t=i,n=0;n+1<t.length;){var r=(255&t[n])<<8|255&t[n+1];if(33088<=r&&r<=40956)r-=33088;else{if(!(57408<=r&&r<=60351))throw"illegal char at "+(n+1)+"/"+r;r-=49472}r=192*(r>>>8&255)+(255&r),e.put(r,13),n+=2}if(n<t.length)throw"illegal char at "+(n+1)}}},v=function(){var e=[],t={writeByte:function(t){e.push(255&t)},writeShort:function(e){t.writeByte(e),t.writeByte(e>>>8)},writeBytes:function(e,n,i){n=n||0,i=i||e.length;for(var r=0;r<i;r+=1)t.writeByte(e[r+n])},writeString:function(e){for(var n=0;n<e.length;n+=1)t.writeByte(e.charCodeAt(n))},toByteArray:function(){return e},toString:function(){var t="";t+="[";for(var n=0;n<e.length;n+=1)n>0&&(t+=","),t+=e[n];return t+"]"}};return t},A=function(e){var t=e,n=0,i=0,r=0,o={read:function(){for(;r<8;){if(n>=t.length){if(0==r)return-1;throw"unexpected end of file./"+r}var e=t.charAt(n);if(n+=1,"="==e)return r=0,-1;e.match(/^\s$/)||(i=i<<6|a(e.charCodeAt(0)),r+=6)}var o=i>>>r-8&255;return r-=8,o}},a=function(e){if(65<=e&&e<=90)return e-65;if(97<=e&&e<=122)return e-97+26;if(48<=e&&e<=57)return e-48+52;if(43==e)return 62;if(47==e)return 63;throw"c:"+e};return o},m=function(e,t,n){for(var i=function(e,t){var n=e,i=t,r=new Array(e*t),o={setPixel:function(e,t,i){r[t*n+e]=i},write:function(e){e.writeString("GIF87a"),e.writeShort(n),e.writeShort(i),e.writeByte(128),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(0),e.writeByte(255),e.writeByte(255),e.writeByte(255),e.writeString(","),e.writeShort(0),e.writeShort(0),e.writeShort(n),e.writeShort(i),e.writeByte(0);var t=a(2);e.writeByte(2);for(var r=0;t.length-r>255;)e.writeByte(255),e.writeBytes(t,r,255),r+=255;e.writeByte(t.length-r),e.writeBytes(t,r,t.length-r),e.writeByte(0),e.writeString(";")}},a=function(e){for(var t=1<<e,n=1+(1<<e),i=e+1,o=s(),a=0;a<t;a+=1)o.add(String.fromCharCode(a));o.add(String.fromCharCode(t)),o.add(String.fromCharCode(n));var l,c,u,h=v(),d=(l=h,c=0,u=0,{write:function(e,t){if(e>>>t!=0)throw"length over";for(;c+t>=8;)l.writeByte(255&(e<<c|u)),t-=8-c,e>>>=8-c,u=0,c=0;u|=e<<c,c+=t},flush:function(){c>0&&l.writeByte(u)}});d.write(t,i);var f=0,p=String.fromCharCode(r[f]);for(f+=1;f<r.length;){var g=String.fromCharCode(r[f]);f+=1,o.contains(p+g)?p+=g:(d.write(o.indexOf(p),i),o.size()<4095&&(o.size()==1<<i&&(i+=1),o.add(p+g)),p=g)}return d.write(o.indexOf(p),i),d.write(n,i),d.flush(),h.toByteArray()},s=function(){var e={},t=0,n={add:function(i){if(n.contains(i))throw"dup key:"+i;e[i]=t,t+=1},size:function(){return t},indexOf:function(t){return e[t]},contains:function(t){return void 0!==e[t]}};return n};return o}(e,t),r=0;r<t;r+=1)for(var o=0;o<e;o+=1)i.setPixel(o,r,n(o,r));var a=v();i.write(a);for(var s=function(){var e=0,t=0,n=0,i="",r={},o=function(e){i+=String.fromCharCode(a(63&e))},a=function(e){if(e<0);else{if(e<26)return 65+e;if(e<52)return e-26+97;if(e<62)return e-52+48;if(62==e)return 43;if(63==e)return 47}throw"n:"+e};return r.writeByte=function(i){for(e=e<<8|255&i,t+=8,n+=1;t>=6;)o(e>>>t-6),t-=6},r.flush=function(){if(t>0&&(o(e<<6-t),e=0,t=0),n%3!=0)for(var r=3-n%3,a=0;a<r;a+=1)i+="="},r.toString=function(){return i},r}(),l=a.toByteArray(),c=0;c<l.length;c+=1)s.writeByte(l[c]);return s.flush(),"data:image/gif;base64,"+s};return e}();r.stringToBytesFuncs["UTF-8"]=function(e){return function(e){for(var t=[],n=0;n<e.length;n++){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(n++,i=65536+((1023&i)<<10|1023&e.charCodeAt(n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t}(e)},void 0===(i="function"==typeof(n=function(){return r})?n.apply(t,[]):n)||(e.exports=i)},676:(e,t,n)=>{n.d(t,{default:()=>M});var i=function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,r++)i[r]=o[a];return i},o=function(e){return!!e&&"object"==typeof e&&!Array.isArray(e)};function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!t.length)return e;var s=t.shift();return void 0!==s&&o(e)&&o(s)?(e=i({},e),Object.keys(s).forEach((function(t){var n=e[t],i=s[t];Array.isArray(n)&&Array.isArray(i)?e[t]=i:o(n)&&o(i)?e[t]=a(Object.assign({},n),i):e[t]=i})),a.apply(void 0,r([e],t))):e}function s(e,t){var n=document.createElement("a");n.download=t,n.href=e,document.body.appendChild(n),n.click(),document.body.removeChild(n)}function l(e){return t=this,n=void 0,r=function(){return function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(t){return[2,new Promise((function(t){var n=new XMLHttpRequest;n.onload=function(){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n.response)},n.open("GET",e),n.responseType="blob",n.send()}))]}))},new((i=void 0)||(i=Promise))((function(e,o){function a(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r.throw(e))}catch(t){o(t)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,s)}l((r=r.apply(t,n||[])).next())}));var t,n,i,r}const c={L:.07,M:.15,Q:.25,H:.3};var u=function(){return(u=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};const h=function(){function e(e){var t=e.svg,n=e.type;this._svg=t,this._type=n}return e.prototype.draw=function(e,t,n,i){var r;switch(this._type){case"dots":r=this._drawDot;break;case"classy":r=this._drawClassy;break;case"classy-rounded":r=this._drawClassyRounded;break;case"rounded":r=this._drawRounded;break;case"extra-rounded":r=this._drawExtraRounded;break;default:r=this._drawSquare}r.call(this,{x:e,y:t,size:n,getNeighbor:i})},e.prototype._rotateFigure=function(e){var t,n=e.x,i=e.y,r=e.size,o=e.rotation,a=void 0===o?0:o,s=n+r/2,l=i+r/2;(0,e.draw)(),null===(t=this._element)||void 0===t||t.setAttribute("transform","rotate("+180*a/Math.PI+","+s+","+l+")")},e.prototype._basicDot=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(u(u({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),t._element.setAttribute("cx",String(i+n/2)),t._element.setAttribute("cy",String(r+n/2)),t._element.setAttribute("r",String(n/2))}}))},e.prototype._basicSquare=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(u(u({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),t._element.setAttribute("x",String(i)),t._element.setAttribute("y",String(r)),t._element.setAttribute("width",String(n)),t._element.setAttribute("height",String(n))}}))},e.prototype._basicSideRounded=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(u(u({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+i+" "+r+"v "+n+"h "+n/2+"a "+n/2+" "+n/2+", 0, 0, 0, 0 "+-n)}}))},e.prototype._basicCornerRounded=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(u(u({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+i+" "+r+"v "+n+"h "+n+"v "+-n/2+"a "+n/2+" "+n/2+", 0, 0, 0, "+-n/2+" "+-n/2)}}))},e.prototype._basicCornerExtraRounded=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(u(u({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+i+" "+r+"v "+n+"h "+n+"a "+n+" "+n+", 0, 0, 0, "+-n+" "+-n)}}))},e.prototype._basicCornersRounded=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(u(u({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("d","M "+i+" "+r+"v "+n/2+"a "+n/2+" "+n/2+", 0, 0, 0, "+n/2+" "+n/2+"h "+n/2+"v "+-n/2+"a "+n/2+" "+n/2+", 0, 0, 0, "+-n/2+" "+-n/2)}}))},e.prototype._drawDot=function(e){var t=e.x,n=e.y,i=e.size;this._basicDot({x:t,y:n,size:i,rotation:0})},e.prototype._drawSquare=function(e){var t=e.x,n=e.y,i=e.size;this._basicSquare({x:t,y:n,size:i,rotation:0})},e.prototype._drawRounded=function(e){var t=e.x,n=e.y,i=e.size,r=e.getNeighbor,o=r?+r(-1,0):0,a=r?+r(1,0):0,s=r?+r(0,-1):0,l=r?+r(0,1):0,c=o+a+s+l;if(0!==c)if(c>2||o&&a||s&&l)this._basicSquare({x:t,y:n,size:i,rotation:0});else{if(2===c){var u=0;return o&&s?u=Math.PI/2:s&&a?u=Math.PI:a&&l&&(u=-Math.PI/2),void this._basicCornerRounded({x:t,y:n,size:i,rotation:u})}if(1===c)return u=0,s?u=Math.PI/2:a?u=Math.PI:l&&(u=-Math.PI/2),void this._basicSideRounded({x:t,y:n,size:i,rotation:u})}else this._basicDot({x:t,y:n,size:i,rotation:0})},e.prototype._drawExtraRounded=function(e){var t=e.x,n=e.y,i=e.size,r=e.getNeighbor,o=r?+r(-1,0):0,a=r?+r(1,0):0,s=r?+r(0,-1):0,l=r?+r(0,1):0,c=o+a+s+l;if(0!==c)if(c>2||o&&a||s&&l)this._basicSquare({x:t,y:n,size:i,rotation:0});else{if(2===c){var u=0;return o&&s?u=Math.PI/2:s&&a?u=Math.PI:a&&l&&(u=-Math.PI/2),void this._basicCornerExtraRounded({x:t,y:n,size:i,rotation:u})}if(1===c)return u=0,s?u=Math.PI/2:a?u=Math.PI:l&&(u=-Math.PI/2),void this._basicSideRounded({x:t,y:n,size:i,rotation:u})}else this._basicDot({x:t,y:n,size:i,rotation:0})},e.prototype._drawClassy=function(e){var t=e.x,n=e.y,i=e.size,r=e.getNeighbor,o=r?+r(-1,0):0,a=r?+r(1,0):0,s=r?+r(0,-1):0,l=r?+r(0,1):0;0!==o+a+s+l?o||s?a||l?this._basicSquare({x:t,y:n,size:i,rotation:0}):this._basicCornerRounded({x:t,y:n,size:i,rotation:Math.PI/2}):this._basicCornerRounded({x:t,y:n,size:i,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:n,size:i,rotation:Math.PI/2})},e.prototype._drawClassyRounded=function(e){var t=e.x,n=e.y,i=e.size,r=e.getNeighbor,o=r?+r(-1,0):0,a=r?+r(1,0):0,s=r?+r(0,-1):0,l=r?+r(0,1):0;0!==o+a+s+l?o||s?a||l?this._basicSquare({x:t,y:n,size:i,rotation:0}):this._basicCornerExtraRounded({x:t,y:n,size:i,rotation:Math.PI/2}):this._basicCornerExtraRounded({x:t,y:n,size:i,rotation:-Math.PI/2}):this._basicCornersRounded({x:t,y:n,size:i,rotation:Math.PI/2})},e}();var d=function(){return(d=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};const f=function(){function e(e){var t=e.svg,n=e.type;this._svg=t,this._type=n}return e.prototype.draw=function(e,t,n,i){var r;switch(this._type){case"square":r=this._drawSquare;break;case"extra-rounded":r=this._drawExtraRounded;break;default:r=this._drawDot}r.call(this,{x:e,y:t,size:n,rotation:i})},e.prototype._rotateFigure=function(e){var t,n=e.x,i=e.y,r=e.size,o=e.rotation,a=void 0===o?0:o,s=n+r/2,l=i+r/2;(0,e.draw)(),null===(t=this._element)||void 0===t||t.setAttribute("transform","rotate("+180*a/Math.PI+","+s+","+l+")")},e.prototype._basicDot=function(e){var t=this,n=e.size,i=e.x,r=e.y,o=n/7;this._rotateFigure(d(d({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("clip-rule","evenodd"),t._element.setAttribute("d","M "+(i+n/2)+" "+r+"a "+n/2+" "+n/2+" 0 1 0 0.1 0zm 0 "+o+"a "+(n/2-o)+" "+(n/2-o)+" 0 1 1 -0.1 0Z")}}))},e.prototype._basicSquare=function(e){var t=this,n=e.size,i=e.x,r=e.y,o=n/7;this._rotateFigure(d(d({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("clip-rule","evenodd"),t._element.setAttribute("d","M "+i+" "+r+"v "+n+"h "+n+"v "+-n+"zM "+(i+o)+" "+(r+o)+"h "+(n-2*o)+"v "+(n-2*o)+"h "+(2*o-n)+"z")}}))},e.prototype._basicExtraRounded=function(e){var t=this,n=e.size,i=e.x,r=e.y,o=n/7;this._rotateFigure(d(d({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","path"),t._element.setAttribute("clip-rule","evenodd"),t._element.setAttribute("d","M "+i+" "+(r+2.5*o)+"v "+2*o+"a "+2.5*o+" "+2.5*o+", 0, 0, 0, "+2.5*o+" "+2.5*o+"h "+2*o+"a "+2.5*o+" "+2.5*o+", 0, 0, 0, "+2.5*o+" "+2.5*-o+"v "+-2*o+"a "+2.5*o+" "+2.5*o+", 0, 0, 0, "+2.5*-o+" "+2.5*-o+"h "+-2*o+"a "+2.5*o+" "+2.5*o+", 0, 0, 0, "+2.5*-o+" "+2.5*o+"M "+(i+2.5*o)+" "+(r+o)+"h "+2*o+"a "+1.5*o+" "+1.5*o+", 0, 0, 1, "+1.5*o+" "+1.5*o+"v "+2*o+"a "+1.5*o+" "+1.5*o+", 0, 0, 1, "+1.5*-o+" "+1.5*o+"h "+-2*o+"a "+1.5*o+" "+1.5*o+", 0, 0, 1, "+1.5*-o+" "+1.5*-o+"v "+-2*o+"a "+1.5*o+" "+1.5*o+", 0, 0, 1, "+1.5*o+" "+1.5*-o)}}))},e.prototype._drawDot=function(e){var t=e.x,n=e.y,i=e.size,r=e.rotation;this._basicDot({x:t,y:n,size:i,rotation:r})},e.prototype._drawSquare=function(e){var t=e.x,n=e.y,i=e.size,r=e.rotation;this._basicSquare({x:t,y:n,size:i,rotation:r})},e.prototype._drawExtraRounded=function(e){var t=e.x,n=e.y,i=e.size,r=e.rotation;this._basicExtraRounded({x:t,y:n,size:i,rotation:r})},e}();var p=function(){return(p=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};const g=function(){function e(e){var t=e.svg,n=e.type;this._svg=t,this._type=n}return e.prototype.draw=function(e,t,n,i){("square"===this._type?this._drawSquare:this._drawDot).call(this,{x:e,y:t,size:n,rotation:i})},e.prototype._rotateFigure=function(e){var t,n=e.x,i=e.y,r=e.size,o=e.rotation,a=void 0===o?0:o,s=n+r/2,l=i+r/2;(0,e.draw)(),null===(t=this._element)||void 0===t||t.setAttribute("transform","rotate("+180*a/Math.PI+","+s+","+l+")")},e.prototype._basicDot=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(p(p({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","circle"),t._element.setAttribute("cx",String(i+n/2)),t._element.setAttribute("cy",String(r+n/2)),t._element.setAttribute("r",String(n/2))}}))},e.prototype._basicSquare=function(e){var t=this,n=e.size,i=e.x,r=e.y;this._rotateFigure(p(p({},e),{draw:function(){t._element=document.createElementNS("http://www.w3.org/2000/svg","rect"),t._element.setAttribute("x",String(i)),t._element.setAttribute("y",String(r)),t._element.setAttribute("width",String(n)),t._element.setAttribute("height",String(n))}}))},e.prototype._drawDot=function(e){var t=e.x,n=e.y,i=e.size,r=e.rotation;this._basicDot({x:t,y:n,size:i,rotation:r})},e.prototype._drawSquare=function(e){var t=e.x,n=e.y,i=e.size,r=e.rotation;this._basicSquare({x:t,y:n,size:i,rotation:r})},e}(),v="circle";var A=function(e,t,n,i){return new(n||(n=Promise))((function(t,r){function o(e){try{s(i.next(e))}catch(t){r(t)}}function a(e){try{s(i.throw(e))}catch(t){r(t)}}function s(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}s((i=i.apply(e,[])).next())}))},m=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},y=[[1,1,1,1,1,1,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,0,0,0,0,0,1],[1,1,1,1,1,1,1]],b=[[0,0,0,0,0,0,0],[0,0,0,0,0,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,1,1,1,0,0],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]];const C=function(){function e(e){this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("width",String(e.width)),this._element.setAttribute("height",String(e.height)),this._defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this._element.appendChild(this._defs),this._options=e}return Object.defineProperty(e.prototype,"width",{get:function(){return this._options.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._options.height},enumerable:!1,configurable:!0}),e.prototype.getElement=function(){return this._element},e.prototype.drawQR=function(e){return A(this,void 0,void 0,(function(){var t,n,i,r,o,a,s,l,u,h,d=this;return m(this,(function(f){switch(f.label){case 0:return t=e.getModuleCount(),n=Math.min(this._options.width,this._options.height)-2*this._options.margin,i=this._options.shape===v?n/Math.sqrt(2):n,r=Math.floor(i/t),o={hideXDots:0,hideYDots:0,width:0,height:0},this._qr=e,this._options.image?[4,this.loadImage()]:[3,2];case 1:if(f.sent(),!this._image)return[2];a=this._options,s=a.imageOptions,l=a.qrOptions,u=s.imageSize*c[l.errorCorrectionLevel],h=Math.floor(u*t*t),o=function(e){var t=e.originalHeight,n=e.originalWidth,i=e.maxHiddenDots,r=e.maxHiddenAxisDots,o=e.dotSize,a={x:0,y:0},s={x:0,y:0};if(t<=0||n<=0||i<=0||o<=0)return{height:0,width:0,hideYDots:0,hideXDots:0};var l=t/n;return a.x=Math.floor(Math.sqrt(i/l)),a.x<=0&&(a.x=1),r&&r<a.x&&(a.x=r),a.x%2==0&&a.x--,s.x=a.x*o,a.y=1+2*Math.ceil((a.x*l-1)/2),s.y=Math.round(s.x*l),(a.y*a.x>i||r&&r<a.y)&&(r&&r<a.y?(a.y=r,a.y%2==0&&a.x--):a.y-=2,s.y=a.y*o,a.x=1+2*Math.ceil((a.y/l-1)/2),s.x=Math.round(s.y/l)),{height:s.y,width:s.x,hideYDots:a.y,hideXDots:a.x}}({originalWidth:this._image.width,originalHeight:this._image.height,maxHiddenDots:h,maxHiddenAxisDots:t-14,dotSize:r}),f.label=2;case 2:return this.drawBackground(),this.drawDots((function(e,n){var i,r,a,s,l,c;return!(d._options.imageOptions.hideBackgroundDots&&e>=(t-o.hideXDots)/2&&e<(t+o.hideXDots)/2&&n>=(t-o.hideYDots)/2&&n<(t+o.hideYDots)/2||(null===(i=y[e])||void 0===i?void 0:i[n])||(null===(r=y[e-t+7])||void 0===r?void 0:r[n])||(null===(a=y[e])||void 0===a?void 0:a[n-t+7])||(null===(s=b[e])||void 0===s?void 0:s[n])||(null===(l=b[e-t+7])||void 0===l?void 0:l[n])||(null===(c=b[e])||void 0===c?void 0:c[n-t+7]))})),this.drawCorners(),this._options.image?[4,this.drawImage({width:o.width,height:o.height,count:t,dotSize:r})]:[3,4];case 3:f.sent(),f.label=4;case 4:return[2]}}))}))},e.prototype.drawBackground=function(){var e,t,n,i=this._element,r=this._options;if(i){var o=null===(e=r.backgroundOptions)||void 0===e?void 0:e.gradient,a=null===(t=r.backgroundOptions)||void 0===t?void 0:t.color;if((o||a)&&this._createColor({options:o,color:a,additionalRotation:0,x:0,y:0,height:r.height,width:r.width,name:"background-color"}),null===(n=r.backgroundOptions)||void 0===n?void 0:n.round){var s=Math.min(r.width,r.height),l=document.createElementNS("http://www.w3.org/2000/svg","rect");this._backgroundClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._backgroundClipPath.setAttribute("id","clip-path-background-color"),this._defs.appendChild(this._backgroundClipPath),l.setAttribute("x",String((r.width-s)/2)),l.setAttribute("y",String((r.height-s)/2)),l.setAttribute("width",String(s)),l.setAttribute("height",String(s)),l.setAttribute("rx",String(s/2*r.backgroundOptions.round)),this._backgroundClipPath.appendChild(l)}}},e.prototype.drawDots=function(e){var t,n,i=this;if(!this._qr)throw"QR code is not defined";var r=this._options,o=this._qr.getModuleCount();if(o>r.width||o>r.height)throw"The canvas is too small.";var a=Math.min(r.width,r.height)-2*r.margin,s=r.shape===v?a/Math.sqrt(2):a,l=Math.floor(s/o),c=Math.floor((r.width-o*l)/2),u=Math.floor((r.height-o*l)/2),d=new h({svg:this._element,type:r.dotsOptions.type});this._dotsClipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this._dotsClipPath.setAttribute("id","clip-path-dot-color"),this._defs.appendChild(this._dotsClipPath),this._createColor({options:null===(t=r.dotsOptions)||void 0===t?void 0:t.gradient,color:r.dotsOptions.color,additionalRotation:0,x:0,y:0,height:r.height,width:r.width,name:"dot-color"});for(var f=function(t){for(var r=function(r){return e&&!e(t,r)?"continue":(null===(n=p._qr)||void 0===n?void 0:n.isDark(t,r))?(d.draw(c+t*l,u+r*l,l,(function(n,a){return!(t+n<0||r+a<0||t+n>=o||r+a>=o)&&!(e&&!e(t+n,r+a))&&!!i._qr&&i._qr.isDark(t+n,r+a)})),void(d._element&&p._dotsClipPath&&p._dotsClipPath.appendChild(d._element))):"continue"},a=0;a<o;a++)r(a)},p=this,g=0;g<o;g++)f(g);if(r.shape===v){var A=Math.floor((a/l-o)/2),m=o+2*A,y=c-A*l,b=u-A*l,C=[],w=Math.floor(m/2);for(g=0;g<m;g++){C[g]=[];for(var x=0;x<m;x++)g>=A-1&&g<=m-A&&x>=A-1&&x<=m-A||Math.sqrt((g-w)*(g-w)+(x-w)*(x-w))>w?C[g][x]=0:C[g][x]=this._qr.isDark(x-2*A<0?x:x>=o?x-2*A:x-A,g-2*A<0?g:g>=o?g-2*A:g-A)?1:0}var _=function(e){for(var t=function(t){if(!C[e][t])return"continue";d.draw(y+e*l,b+t*l,l,(function(n,i){var r;return!!(null===(r=C[e+n])||void 0===r?void 0:r[t+i])})),d._element&&E._dotsClipPath&&E._dotsClipPath.appendChild(d._element)},n=0;n<m;n++)t(n)},E=this;for(g=0;g<m;g++)_(g)}},e.prototype.drawCorners=function(){var e=this;if(!this._qr)throw"QR code is not defined";var t=this._element,n=this._options;if(!t)throw"Element code is not defined";var i=this._qr.getModuleCount(),r=Math.min(n.width,n.height)-2*n.margin,o=n.shape===v?r/Math.sqrt(2):r,a=Math.floor(o/i),s=7*a,l=3*a,c=Math.floor((n.width-i*a)/2),u=Math.floor((n.height-i*a)/2);[[0,0,0],[1,0,Math.PI/2],[0,1,-Math.PI/2]].forEach((function(t){var r,o,d,p,v,A,m,C,w,x,_,E,S=t[0],I=t[1],k=t[2],B=c+S*a*(i-7),O=u+I*a*(i-7),T=e._dotsClipPath,D=e._dotsClipPath;if(((null===(r=n.cornersSquareOptions)||void 0===r?void 0:r.gradient)||(null===(o=n.cornersSquareOptions)||void 0===o?void 0:o.color))&&((T=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","clip-path-corners-square-color-"+S+"-"+I),e._defs.appendChild(T),e._cornersSquareClipPath=e._cornersDotClipPath=D=T,e._createColor({options:null===(d=n.cornersSquareOptions)||void 0===d?void 0:d.gradient,color:null===(p=n.cornersSquareOptions)||void 0===p?void 0:p.color,additionalRotation:k,x:B,y:O,height:s,width:s,name:"corners-square-color-"+S+"-"+I})),null===(v=n.cornersSquareOptions)||void 0===v?void 0:v.type){var M=new f({svg:e._element,type:n.cornersSquareOptions.type});M.draw(B,O,s,k),M._element&&T&&T.appendChild(M._element)}else for(var Q=new h({svg:e._element,type:n.dotsOptions.type}),L=function(e){for(var t=function(t){if(!(null===(A=y[e])||void 0===A?void 0:A[t]))return"continue";Q.draw(B+e*a,O+t*a,a,(function(n,i){var r;return!!(null===(r=y[e+n])||void 0===r?void 0:r[t+i])})),Q._element&&T&&T.appendChild(Q._element)},n=0;n<y[e].length;n++)t(n)},P=0;P<y.length;P++)L(P);if(((null===(m=n.cornersDotOptions)||void 0===m?void 0:m.gradient)||(null===(C=n.cornersDotOptions)||void 0===C?void 0:C.color))&&((D=document.createElementNS("http://www.w3.org/2000/svg","clipPath")).setAttribute("id","clip-path-corners-dot-color-"+S+"-"+I),e._defs.appendChild(D),e._cornersDotClipPath=D,e._createColor({options:null===(w=n.cornersDotOptions)||void 0===w?void 0:w.gradient,color:null===(x=n.cornersDotOptions)||void 0===x?void 0:x.color,additionalRotation:k,x:B+2*a,y:O+2*a,height:l,width:l,name:"corners-dot-color-"+S+"-"+I})),null===(_=n.cornersDotOptions)||void 0===_?void 0:_.type){var j=new g({svg:e._element,type:n.cornersDotOptions.type});j.draw(B+2*a,O+2*a,l,k),j._element&&D&&D.appendChild(j._element)}else{Q=new h({svg:e._element,type:n.dotsOptions.type});var R=function(e){for(var t=function(t){if(!(null===(E=b[e])||void 0===E?void 0:E[t]))return"continue";Q.draw(B+e*a,O+t*a,a,(function(n,i){var r;return!!(null===(r=b[e+n])||void 0===r?void 0:r[t+i])})),Q._element&&D&&D.appendChild(Q._element)},n=0;n<b[e].length;n++)t(n)};for(P=0;P<b.length;P++)R(P)}}))},e.prototype.loadImage=function(){var e=this;return new Promise((function(t,n){var i=e._options,r=new Image;if(!i.image)return n("Image is not defined");"string"==typeof i.imageOptions.crossOrigin&&(r.crossOrigin=i.imageOptions.crossOrigin),e._image=r,r.onload=function(){t()},r.src=i.image}))},e.prototype.drawImage=function(e){var t=e.width,n=e.height,i=e.count,r=e.dotSize;return A(this,void 0,void 0,(function(){var e,o,a,s,c,u,h,d,f;return m(this,(function(p){switch(p.label){case 0:return e=this._options,o=Math.floor((e.width-i*r)/2),a=Math.floor((e.height-i*r)/2),s=o+e.imageOptions.margin+(i*r-t)/2,c=a+e.imageOptions.margin+(i*r-n)/2,u=t-2*e.imageOptions.margin,h=n-2*e.imageOptions.margin,(d=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("x",String(s)),d.setAttribute("y",String(c)),d.setAttribute("width",u+"px"),d.setAttribute("height",h+"px"),[4,l(e.image||"")];case 1:return f=p.sent(),d.setAttribute("href",f||""),this._element.appendChild(d),[2]}}))}))},e.prototype._createColor=function(e){var t=e.options,n=e.color,i=e.additionalRotation,r=e.x,o=e.y,a=e.height,s=e.width,l=e.name,c=s>a?s:a,u=document.createElementNS("http://www.w3.org/2000/svg","rect");if(u.setAttribute("x",String(r)),u.setAttribute("y",String(o)),u.setAttribute("height",String(a)),u.setAttribute("width",String(s)),u.setAttribute("clip-path","url('#clip-path-"+l+"')"),t){var h;if("radial"===t.type)(h=document.createElementNS("http://www.w3.org/2000/svg","radialGradient")).setAttribute("id",l),h.setAttribute("gradientUnits","userSpaceOnUse"),h.setAttribute("fx",String(r+s/2)),h.setAttribute("fy",String(o+a/2)),h.setAttribute("cx",String(r+s/2)),h.setAttribute("cy",String(o+a/2)),h.setAttribute("r",String(c/2));else{var d=((t.rotation||0)+i)%(2*Math.PI),f=(d+2*Math.PI)%(2*Math.PI),p=r+s/2,g=o+a/2,v=r+s/2,A=o+a/2;f>=0&&f<=.25*Math.PI||f>1.75*Math.PI&&f<=2*Math.PI?(p-=s/2,g-=a/2*Math.tan(d),v+=s/2,A+=a/2*Math.tan(d)):f>.25*Math.PI&&f<=.75*Math.PI?(g-=a/2,p-=s/2/Math.tan(d),A+=a/2,v+=s/2/Math.tan(d)):f>.75*Math.PI&&f<=1.25*Math.PI?(p+=s/2,g+=a/2*Math.tan(d),v-=s/2,A-=a/2*Math.tan(d)):f>1.25*Math.PI&&f<=1.75*Math.PI&&(g+=a/2,p+=s/2/Math.tan(d),A-=a/2,v-=s/2/Math.tan(d)),(h=document.createElementNS("http://www.w3.org/2000/svg","linearGradient")).setAttribute("id",l),h.setAttribute("gradientUnits","userSpaceOnUse"),h.setAttribute("x1",String(Math.round(p))),h.setAttribute("y1",String(Math.round(g))),h.setAttribute("x2",String(Math.round(v))),h.setAttribute("y2",String(Math.round(A)))}t.colorStops.forEach((function(e){var t=e.offset,n=e.color,i=document.createElementNS("http://www.w3.org/2000/svg","stop");i.setAttribute("offset",100*t+"%"),i.setAttribute("stop-color",n),h.appendChild(i)})),u.setAttribute("fill","url('#"+l+"')"),this._defs.appendChild(h)}else n&&u.setAttribute("fill",n);this._element.appendChild(u)},e}(),w="canvas";for(var x={},_=0;_<=40;_++)x[_]=_;const E={type:w,shape:"square",width:300,height:300,data:"",margin:0,qrOptions:{typeNumber:x[0],mode:void 0,errorCorrectionLevel:"Q"},imageOptions:{hideBackgroundDots:!0,imageSize:.4,crossOrigin:void 0,margin:0},dotsOptions:{type:"square",color:"#000"},backgroundOptions:{round:0,color:"#fff"}};var S=function(){return(S=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function I(e){var t=S({},e);if(!t.colorStops||!t.colorStops.length)throw"Field 'colorStops' is required in gradient";return t.rotation?t.rotation=Number(t.rotation):t.rotation=0,t.colorStops=t.colorStops.map((function(e){return S(S({},e),{offset:Number(e.offset)})})),t}function k(e){var t=S({},e);return t.width=Number(t.width),t.height=Number(t.height),t.margin=Number(t.margin),t.imageOptions=S(S({},t.imageOptions),{hideBackgroundDots:Boolean(t.imageOptions.hideBackgroundDots),imageSize:Number(t.imageOptions.imageSize),margin:Number(t.imageOptions.margin)}),t.margin>Math.min(t.width,t.height)&&(t.margin=Math.min(t.width,t.height)),t.dotsOptions=S({},t.dotsOptions),t.dotsOptions.gradient&&(t.dotsOptions.gradient=I(t.dotsOptions.gradient)),t.cornersSquareOptions&&(t.cornersSquareOptions=S({},t.cornersSquareOptions),t.cornersSquareOptions.gradient&&(t.cornersSquareOptions.gradient=I(t.cornersSquareOptions.gradient))),t.cornersDotOptions&&(t.cornersDotOptions=S({},t.cornersDotOptions),t.cornersDotOptions.gradient&&(t.cornersDotOptions.gradient=I(t.cornersDotOptions.gradient))),t.backgroundOptions&&(t.backgroundOptions=S({},t.backgroundOptions),t.backgroundOptions.gradient&&(t.backgroundOptions.gradient=I(t.backgroundOptions.gradient))),t}var B=n(192),O=n.n(B),T=function(e,t,n,i){return new(n||(n=Promise))((function(t,r){function o(e){try{s(i.next(e))}catch(t){r(t)}}function a(e){try{s(i.throw(e))}catch(t){r(t)}}function s(e){var i;e.done?t(e.value):(i=e.value,i instanceof n?i:new n((function(e){e(i)}))).then(o,a)}s((i=i.apply(e,[])).next())}))},D=function(e,t){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};const M=function(){function e(e){this._options=e?k(a(E,e)):E,this.update()}return e._clearContainer=function(e){e&&(e.innerHTML="")},e.prototype._setupSvg=function(){var e=this;if(this._qr){var t=new C(this._options);this._svg=t.getElement(),this._svgDrawingPromise=t.drawQR(this._qr).then((function(){var n;e._svg&&(null===(n=e._extension)||void 0===n||n.call(e,t.getElement(),e._options))}))}},e.prototype._setupCanvas=function(){var e,t=this;this._qr&&(this._canvas=document.createElement("canvas"),this._canvas.width=this._options.width,this._canvas.height=this._options.height,this._setupSvg(),this._canvasDrawingPromise=null===(e=this._svgDrawingPromise)||void 0===e?void 0:e.then((function(){if(t._svg){var e=t._svg,n=(new XMLSerializer).serializeToString(e),i="data:image/svg+xml;base64,"+btoa(n),r=new Image;return new Promise((function(e){r.onload=function(){var n,i;null===(i=null===(n=t._canvas)||void 0===n?void 0:n.getContext("2d"))||void 0===i||i.drawImage(r,0,0),e()},r.src=i}))}})))},e.prototype._getElement=function(e){return void 0===e&&(e="png"),T(this,void 0,void 0,(function(){return D(this,(function(t){switch(t.label){case 0:if(!this._qr)throw"QR code is empty";return"svg"!==e.toLowerCase()?[3,2]:(this._svg&&this._svgDrawingPromise||this._setupSvg(),[4,this._svgDrawingPromise]);case 1:return t.sent(),[2,this._svg];case 2:return this._canvas&&this._canvasDrawingPromise||this._setupCanvas(),[4,this._canvasDrawingPromise];case 3:return t.sent(),[2,this._canvas]}}))}))},e.prototype.update=function(t){e._clearContainer(this._container),this._options=t?k(a(this._options,t)):this._options,this._options.data&&(this._qr=O()(this._options.qrOptions.typeNumber,this._options.qrOptions.errorCorrectionLevel),this._qr.addData(this._options.data,this._options.qrOptions.mode||function(e){switch(!0){case/^[0-9]*$/.test(e):return"Numeric";case/^[0-9A-Z $%*+\-./:]*$/.test(e):return"Alphanumeric";default:return"Byte"}}(this._options.data)),this._qr.make(),this._options.type===w?this._setupCanvas():this._setupSvg(),this.append(this._container))},e.prototype.append=function(e){if(e){if("function"!=typeof e.appendChild)throw"Container should be a single DOM node";this._options.type===w?this._canvas&&e.appendChild(this._canvas):this._svg&&e.appendChild(this._svg),this._container=e}},e.prototype.applyExtension=function(e){if(!e)throw"Extension function should be defined.";this._extension=e,this.update()},e.prototype.deleteExtension=function(){this._extension=void 0,this.update()},e.prototype.getRawData=function(e){return void 0===e&&(e="png"),T(this,void 0,void 0,(function(){var t,n,i;return D(this,(function(r){switch(r.label){case 0:if(!this._qr)throw"QR code is empty";return[4,this._getElement(e)];case 1:return(t=r.sent())?"svg"===e.toLowerCase()?(n=new XMLSerializer,i=n.serializeToString(t),[2,new Blob(['<?xml version="1.0" standalone="no"?>\r\n'+i],{type:"image/svg+xml"})]):[2,new Promise((function(n){return t.toBlob(n,"image/"+e,1)}))]:[2,null]}}))}))},e.prototype.download=function(e){return T(this,void 0,void 0,(function(){var t,n,i,r,o;return D(this,(function(a){switch(a.label){case 0:if(!this._qr)throw"QR code is empty";return t="png",n="qr","string"==typeof e?t=e:"object"==typeof e&&null!==e&&(e.name&&(n=e.name),e.extension&&(t=e.extension)),[4,this._getElement(t)];case 1:return(i=a.sent())?("svg"===t.toLowerCase()?(r=new XMLSerializer,o='<?xml version="1.0" standalone="no"?>\r\n'+(o=r.serializeToString(i)),s("data:image/svg+xml;charset=utf-8,"+encodeURIComponent(o),n+".svg")):s(i.toDataURL("image/"+t),n+"."+t),[2]):[2]}}))}))},e}()}},t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={exports:{}};return e[i](r,r.exports,n),r.exports}return n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n(676)})().default;const sk=xi(ak.exports);var lk=(e=>(e.rounded="rounded",e.dots="dots",e.classy="classy",e.classy_rounded="classy-rounded",e.square="square",e.extra_rounded="extra-rounded",e))(lk||{}),ck=(e=>(e.dot="dot",e.square="square",e.extra_rounded="extra-rounded",e))(ck||{}),uk=(e=>(e.dot="dot",e.square="square",e))(uk||{}),hk=(e=>(e.L="L",e.M="M",e.Q="Q",e.H="H",e))(hk||{});class dk{constructor(e,t){this.canvas=e,this.editor=t}hookTransform(e){return h(this,null,(function*(){if("qrcode"===e.extensionType){const t=this._paramsToOption(e.extension),n=yield this._getBase64Str(t);e.src=n}}))}_getBase64Str(e){return h(this,null,(function*(){const t=new sk(e),n=yield t.getRawData("png");if(!n)return"";return(yield Gm(n))||""}))}_defaultBarcodeOption(){return{data:"https://kuaitu.cc",width:300,margin:10,errorCorrectionLevel:"M",dotsColor:"#000000",dotsType:"rounded",cornersSquareColor:"#000000",cornersSquareType:"square",cornersDotColor:"#000000",cornersDotType:"square",background:"#ffffff"}}_paramsToOption(e){return{width:e.width,height:e.width,type:"canvas",data:e.data,margin:e.margin,qrOptions:{errorCorrectionLevel:e.errorCorrectionLevel},dotsOptions:{color:e.dotsColor,type:e.dotsType},cornersSquareOptions:{color:e.cornersSquareColor,type:e.cornersSquareType},cornersDotOptions:{color:e.cornersDotColor,type:e.cornersDotType},backgroundOptions:{color:e.background}}}addQrCode(){return h(this,null,(function*(){const e=this._defaultBarcodeOption(),t=this._paramsToOption(e),n=yield this._getBase64Str(t);vA.fabric.Image.fromURL(n,(t=>{t.set({extensionType:"qrcode",extension:e}),t.scaleToWidth(this.editor.getWorkspase().getScaledWidth()/2),this.canvas.add(t),this.canvas.setActiveObject(t),this.editor.position("center")}),{crossOrigin:"anonymous"})}))}setQrCode(e){return h(this,null,(function*(){try{const t=this._paramsToOption(e),n=yield this._getBase64Str(t),i=this.canvas.getActiveObjects()[0];vA.fabric.Image.fromURL(n,(t=>{t.set({left:i.left,top:i.top,extensionType:"qrcode",extension:l({},e)}),t.scaleToWidth(i.getScaledWidth()),this.editor.del(),this.canvas.add(t),this.canvas.setActiveObject(t)}),{crossOrigin:"anonymous"})}catch(t){}}))}getQrCodeTypes(){return{DotsType:Object.values(lk),CornersType:Object.values(ck),cornersDotType:Object.values(uk),errorCorrectionLevelType:Object.values(hk)}}destroy(){}}u(dk,"pluginName","QrCodePlugin"),u(dk,"apis",["addQrCode","setQrCode","getQrCodeTypes"]);class fk{constructor(e,t){this.canvas=e,this.editor=t}addImage(e){return new Promise(((t,n)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>t(i),i.onerror=()=>n(),i.src=e}))}imageStrokeDraw(e,t,n="source-over"){return h(this,null,(function*(){const i=this.canvas.getActiveObject();if(!i)return;const r=i.originWidth||0,o=i.originHeight||0,a=(null==i?void 0:i.originSrc)||i.getSrc();let s=document.createElement("canvas");const l=s.getContext("2d");if(!l)return;if(0===t)return void i.setSrc(a,(()=>{var e;null==(e=i.canvas)||e.renderAll()}));l.save(),l.clearRect(0,0,s.width,s.height),l.restore(),s.width=r+2*t,s.height=o+2*t;const c=[-1,-1,0,-1,1,-1,-1,0,1,0,-1,1,0,1,1,1],u=yield this.addImage(a);if(!u)return;for(let e=0;e<c.length;e+=2)l.drawImage(u,t+c[e]*t,t+c[e+1]*t,r,o);l.globalCompositeOperation="source-in",l.fillStyle=e,l.fillRect(0,0,r+2*t,o+2*t),l.globalCompositeOperation=n,l.drawImage(u,t,t,r,o);const h=null==s?void 0:s.toDataURL();s=null,h&&i.setSrc(h,(()=>{var e;null==(e=i.canvas)||e.renderAll()}))}))}destroy(){}}u(fk,"pluginName","ImageStroke"),u(fk,"apis",["imageStrokeDraw"]);class pk{constructor(e,t){u(this,"workspaceEl"),u(this,"minSize",{width:1,height:1}),u(this,"barOpts",{bWidth:30,bHeight:6,bPadding:10}),u(this,"hasCreatedBar",!1),u(this,"isDragging",!1),u(this,"dragEl",null),u(this,"startPoints",{x:0,y:0}),u(this,"barOffset",{x:0,y:0}),u(this,"wsOffset",{left:0,top:0,width:0,height:0}),u(this,"eventHandler",{render:ce(this.renderBars.bind(this),50),onDragging:ce(this.onDragging.bind(this),30)}),this.canvas=e,this.editor=t,this._init(),this._initResizeObserve(),this._addListeners()}_init(){const e=document.querySelector("#workspace");if(!e)throw new Error("element #workspace is missing, plz check!");this.workspaceEl=e}_initResizeObserve(){new ResizeObserver(ce((()=>{this.renderBars()}),50)).observe(this.workspaceEl)}renderBars(){const e=this.canvas.viewportTransform,[t,,,n,i,r]=e||[],o=this.getWorkspase(),a=o.width*t,s=o.height*n,l=o.left*t,c=o.top*n,{bWidth:u,bHeight:h,bPadding:d}=this.barOpts;if(!e)return;const f=this._getBarFromType("left");f.style.left=i+l-h-d+"px",f.style.top=r+c+s/2-u/2+"px";const p=this._getBarFromType("right");p.style.left=`${i+l+a+d}px`,p.style.top=r+c+s/2-u/2+"px";const g=this._getBarFromType("top");g.style.left=i+l+a/2-u/2+"px",g.style.top=r+c-h-d+"px";const v=this._getBarFromType("bottom");v.style.left=i+l+a/2-u/2+"px",v.style.top=`${r+c+s+d}px`,this.hasCreatedBar||(this.hasCreatedBar=!0,this._watchDrag())}_getBarFromType(e){let t=document.querySelector(`#resize-${e}-bar`);return t||(t=document.createElement("div"),t.id=`resize-${e}-bar`,t.className="resize-bar",["left","right"].includes(e)?t.classList.add("horizontal"):t.classList.add("vertical"),this.workspaceEl.appendChild(t),t)}_watchDrag(){Array.from(document.getElementsByClassName("resize-bar")).forEach((e=>{e.addEventListener("mousedown",(t=>{this.isDragging=!0,this.dragEl=e,this.dragEl.classList.add("active"),this.startPoints={x:t.clientX,y:t.clientY},this.barOffset={x:e.offsetLeft,y:e.offsetTop};const n=this.getWorkspase(),{width:i,height:r,left:o,top:a}=n;this.wsOffset={width:i,height:r,left:o,top:a}}))})),document.addEventListener("mousemove",this.eventHandler.onDragging),document.addEventListener("mouseup",(()=>{this.isDragging&&this.dragEl&&(this.isDragging=!1,this.dragEl.classList.remove("active"),this.dragEl=null,this.canvas.defaultCursor="default")}))}onDragging(e){if(this.isDragging&&this.dragEl){const t=this.getWorkspase(),n=this.canvas.viewportTransform,[i,,,r]=n||[],o=e.clientX-this.startPoints.x,a=e.clientY-this.startPoints.y,s=o/i,l=a/r,c=this.dragEl.id.split("-")[1];let u=0;switch(c){case"left":u=Math.round(this.wsOffset.width-2*s),u>=this.minSize.width?(this.dragEl.style.left=`${this.barOffset.x+o}px`,t.set("left",this.wsOffset.left+2*s),t.set("width",u)):(t.set("left",this.wsOffset.left+this.wsOffset.width-this.minSize.width),t.set("width",this.minSize.width));break;case"right":u=Math.round(this.wsOffset.width+2*s),u>=this.minSize.width?(this.dragEl.style.left=`${this.barOffset.x+o}px`,t.set("width",u)):t.set("width",this.minSize.width);break;case"top":u=Math.round(this.wsOffset.height-2*l),u>=this.minSize.height?(this.dragEl.style.top=`${this.barOffset.y+a}px`,t.set("top",this.wsOffset.top+2*l),t.set("height",u)):(t.set("top",this.wsOffset.top+this.wsOffset.height-this.minSize.height),t.set("height",this.minSize.height));break;case"bottom":u=Math.round(this.wsOffset.height+2*l),u>=this.minSize.height?(this.dragEl.style.top=`${this.barOffset.y+a}px`,t.set("height",u)):t.set("height",this.minSize.height)}this.editor.setCenterFromObject(t),t.clone((e=>{this.canvas.clipPath=e,this.canvas.requestRenderAll()})),["left","right"].includes(c)?this.canvas.defaultCursor="ew-resize":this.canvas.defaultCursor="ns-resize",this.editor.emit("sizeChange",t.width,t.height)}}_addListeners(){this.canvas.on("after:render",this.eventHandler.render)}getWorkspase(){return this.canvas.getObjects().find((e=>"workspace"===e.id))}destroy(){}}u(pk,"pluginName","ResizePlugin"),u(pk,"events",[]),u(pk,"apis",[]);var gk=(e=>(e.lockMovementX="lockMovementX",e.lockMovementY="lockMovementY",e.lockRotation="lockRotation",e.lockScalingX="lockScalingX",e.lockScalingY="lockScalingY",e))(gk||{});class vk{constructor(e,t){this.canvas=e,this.editor=t}hookImportAfter(){return this.canvas.forEachObject((e=>{!1===e.hasControls&&!1===e.selectable&&(this.canvas.setActiveObject(e),this.lock())})),Promise.resolve()}lock(){const e=this.canvas.getActiveObject();e&&(e.hasControls=!1,e.selectable=!1,e.evented=!1,Object.values(gk).forEach((t=>{e[t]=!0})),this.canvas.discardActiveObject().renderAll())}unLock(){const e=this.canvas.getActiveObject();e&&(e.hasControls=!0,e.selectable=!0,e.evented=!0,Object.values(gk).forEach((t=>{e[t]=!1})),this.canvas.discardActiveObject().renderAll())}contextMenu(){const e=this.editor.getSelectMode(),t=this.canvas.getActiveObject();if(e===dm.ONE&&t)return t.selectable?[{text:"锁定",hotkey:"",onclick:()=>this.lock()}]:[{text:"解锁",hotkey:"",onclick:()=>this.unLock()}]}destroy(){}}u(vk,"pluginName","LockPlugin"),u(vk,"apis",["lock","unLock"]);class Ak{constructor(e,t){this.canvas=e,this.editor=t,this.editor=t,this.canvas=e}addBaseType(e,t){const{event:n=!1,scale:i=!1,center:r=!0}=t||{};e.set({id:hm()}),i&&this._toScale(e),n&&this._toEvent(e,n),this.canvas.add(e),!n&&r&&this._toCenter(e),this.canvas.refreshHistory(),this.canvas.setActiveObject(e),this.canvas.renderAll()}_toEvent(e,t){const{left:n,top:i}=this.canvas.getSelectionElement().getBoundingClientRect();if(t.x<n||t.y<i||void 0===e.width)return;const r={x:t.x-n,y:t.y-i},o=this.canvas.restorePointerVpt(r);e.set({left:o.x,top:o.y})}_toCenter(e){this.canvas.setActiveObject(e),this.editor.position("center")}_toScale(e){const{width:t}=this.editor.getWorkspase();void 0!==t&&e.scaleToWidth(t/2)}createImgByElement(e){return new Promise((t=>{"svg"===this.getImageExtension(e.src)?vA.fabric.loadSVGFromURL(e.src,(e=>{const n=vA.fabric.util.groupSVGElements(e,{shadow:"",fontFamily:"arial",name:"svg元素"});t(n)})):vA.fabric.Image.fromURL(e.src,(e=>{t(e)}),{crossOrigin:"anonymous"})}))}getImageExtension(e){const t=e.split("/"),n=t[t.length-1].split(".");return n[n.length-1]}destroy(){}}u(Ak,"pluginName","AddBaseTypePlugin"),u(Ak,"apis",["addBaseType","createImgByElement"]),vA.fabric.Rect=vA.fabric.util.createClass(vA.fabric.Rect,{type:"rect",initialize:function(e){e||(e={}),this.callSuper("initialize",e)},_render(e){const t=this.roundValue||0;this.rx=1/this.scaleX*t,this.ry=1/this.scaleY*t,this.callSuper("_render",e)}}),vA.fabric.Rect.fromObject=function(e,t){return vA.fabric.Object._fromObject("Rect",e,t)},vA.fabric.Rect,vA.fabric.Textbox=vA.fabric.util.createClass(vA.fabric.Textbox,{type:"textbox",_renderChars:function(e,t,n,i,r,o){var a,s,l,c,u,h=this.getHeightOfLine(o),d=-1!==this.textAlign.indexOf("justify"),f="",p=0,g=this.path,v=!d&&0===this.charSpacing&&this.isEmptyStyles(o)&&!g,A="ltr"===this.direction,m="ltr"===this.direction?1:-1,y=t.canvas.getAttribute("dir");if(t.save(),y!==this.direction&&(t.canvas.setAttribute("dir",A?"ltr":"rtl"),t.direction=A?"ltr":"rtl",t.textAlign=A?"left":"right"),r-=h*this._fontSizeFraction/this.lineHeight,v)return this._renderChar(e,t,o,0,n.join(""),i,r,h),void t.restore();for(var b=0,C=n.length-1;b<=C;b++)c=b===C||this.charSpacing||g,f+=n[b],l=this.__charBounds[o][b],0===p?(i+=m*(l.kernedWidth-l.width),p+=l.width):p+=l.kernedWidth,d&&!c&&this._reSpaceAndTab.test(n[b])&&(c=!0),c||(a=a||this.getCompleteStyleDeclaration(o,b),s=this.getCompleteStyleDeclaration(o,b+1),c=vA.fabric.util.hasStyleChanged(a,s,!1)),g?(t.save(),t.translate(l.renderLeft,l.renderTop),t.rotate(l.angle),this._renderChar(e,t,o,b,f,-p/2,0,h),t.restore()):(u=i,this._renderChar(e,t,o,b,f,u,r,h)),f="",a=s,i+=m*p,p=0;t.restore()},enlargeSpaces:function(){for(var e,t,n,i,r,o,a,s=0,l=this._textLines.length;s<l;s++)if(("justify"===this.textAlign||s!==l-1&&!this.isEndOfWrapping(s))&&(i=0,r=this._textLines[s],(t=this.getLineWidth(s))<this.width&&(a=this.textLines[s].split(""))&&a.length>1)){n=a.length,e=(this.width-t)/(n-1);for(var c=0,u=r.length;c<=u;c++)(o=this.__charBounds[s][c]).left+=i,c<u-1&&(o.width+=e,o.kernedWidth+=e,i+=e)}}}),vA.fabric.Textbox.fromObject=function(e,t){const{text:n}=e;return t(new vA.fabric.Textbox(n,e))},vA.fabric.Rect;const mk=ty();function yk(){const{t:e}=Xt(),t=wr(),n=xr(),i=()=>h(this,null,(function*(){const e=mk.editor.getJson(),t=yield r();return{json:e,img:null==t?void 0:t.id,desc:""}})),r=()=>h(this,null,(function*(){const e=yield canvasEditor.preview();return yield(e=>{const t=((e,t)=>{for(var n=e.split(","),i=n[0].match(/:(.*?);/)[1],r=atob(n[1]),o=r.length,a=new Uint8Array(o);o--;)a[o]=r.charCodeAt(o);return new File([a],t,{type:i})})(e,"123.png"),n=new FormData,i=new Date;return n.append("files",t,`${i.getTime()}`),kr(n).then((e=>{const[t]=e.data;return t})).catch((e=>{}))})(e)})),o=e=>{t.replace("/?id="+e)};return{createTmpl:(e,t,n="")=>h(this,null,(function*(){mk.editor.clear(),mk.editor.setSize(e,t);const r=wf().format("YYYY[年]MM[月]DD[日]HH[小时]mm[分钟]ss[秒]")+"创建的作品",a=yield i(),s=yield _r({data:c(l({},a),{type:"file",parentId:String(n),name:r})});return o(s.data.data.id),s})),createTmplByCommon:()=>h(this,null,(function*(){var e;const t=wf().format("YYYY[年]MM[月]DD[日]HH[小时]mm[分钟]ss[秒]")+"创建的作品",r=yield i();return yield _r({data:c(l({},r),{type:"file",parentId:"",externalId:(null==(e=n.query)?void 0:e.projectid)||null,name:t})})})),getTemplInfo:e=>h(this,null,(function*(){return(yield Er(e)).data})),updataTemplInfo:(e,t)=>h(this,null,(function*(){const n=yield i();t&&(n.name=t),yield Sr(e,{data:n})})),removeTemplInfo:t=>new Promise(((n,i)=>{$t.confirm(`${e("my_spase.remove_templTip")}`,"Warning",{title:e("my_spase.remove_templ")}).then((()=>{Ir(t).then(n).catch(i)}))})),routerToId:o,createdFileType:(e,t="")=>h(this,null,(function*(){yield _r({data:{name:e,type:"fileType",parentId:String(t)}})})),reNameFileType:(e,t)=>h(this,null,(function*(){yield Sr(t,{data:{name:e}})})),removeFileType:t=>new Promise(((n,i)=>{$t.confirm(`${e("my_spase.remove_file_type_Tip")}`,"Warning",{title:e("my_spase.remove_file_type")}).then((()=>{Ir(t).then(n).catch(i)}))}))}}const bk={class:"f-center pr-10px"},Ck={__name:"Save",setup(e){const t=ey(),n=xr(),{createTmplByCommon:i,updataTemplInfo:r,routerToId:o}=yk(),{t:a}=Xt(),s={clipboard(){return h(this,null,(function*(){try{yield t.editor.clipboard(),Gt.success("复制成功")}catch(e){Gt.error("复制失败")}}))},saveJson(){t.editor.saveJson()},saveSvg(){t.editor.saveSvg()},saveImg(){t.editor.saveImg()},clipboardBase64(){return h(this,null,(function*(){try{yield t.editor.clipboardBase64(),Gt.success("复制成功")}catch(e){Gt.error("复制失败")}}))},saveMyClould(){return h(this,null,(function*(){var e,t;const a=qt.service();try{if(null==(e=null==n?void 0:n.query)?void 0:e.id)yield r(null==(t=null==n?void 0:n.query)?void 0:t.id);else{const e=yield i();o(e.data.data.id)}}catch(s){Gt.warning("请登录")}a.close()}))}},l=le((function(e){s[e]&&"function"==typeof s[e]&&s[e]()}),300),c=()=>{var e,n;null==(e=t.editor)||e.clear(),t.canvas.clearHistory(),null==(n=t.editor)||n.historyUpdate()},u=()=>{$t.confirm(`${a("clearTip")}`,"Warning",{title:a("tip"),type:"warning",confirmButtonText:"ok",cancelButtonText:a("cancel")}).then(c)};return(e,t)=>{const n=et,i=Se,r=Kt,o=Jt,a=Zt;return ui(),hi("div",bk,[Hi(n,{class:"ml-10px",link:"",type:"primary",onClick:u},{default:mi((()=>[Ri(bi(e.$t("editor.save.empty")),1)])),_:1}),Hi(a,{class:"ml-10px",onCommand:pi(l)},{dropdown:mi((()=>[Hi(o,null,{default:mi((()=>[Hi(r,{command:"saveMyClould"},{default:mi((()=>[Ri(bi(e.$t("editor.save.save_my_spase")),1)])),_:1}),Hi(r,{command:"saveImg",divided:""},{default:mi((()=>[Ri(bi(e.$t("editor.save.save_as_picture")),1)])),_:1}),Hi(r,{command:"saveSvg"},{default:mi((()=>[Ri(bi(e.$t("editor.save.save_as_svg")),1)])),_:1}),Hi(r,{command:"clipboard",divided:""},{default:mi((()=>[Ri(bi(e.$t("editor.save.copy_to_clipboard")),1)])),_:1}),Hi(r,{command:"clipboardBase64"},{default:mi((()=>[Ri(bi(e.$t("editor.save.copy_to_clipboardstr")),1)])),_:1}),Hi(r,{command:"saveJson",divided:""},{default:mi((()=>[Ri(bi(e.$t("editor.save.save_as_json")),1)])),_:1})])),_:1})])),default:mi((()=>[Hi(n,{type:"primary"},{default:mi((()=>[Ri(bi(e.$t("editor.save.download"))+" ",1),Hi(i,{class:"el-icon--right"},{default:mi((()=>[Hi(pi(tt))])),_:1})])),_:1})])),_:1},8,["onCommand"])])}}},wk=ai({__name:"PreviewCurrent",setup(e){const t=ey(),n=si(!1),i=si([]),r=()=>{n.value=!1,i.value=[]},o=()=>{t.editor.preview().then((e=>{i.value=[e],n.value=!0}))};return(e,t)=>{const a=et,s=Eg;return ui(),hi(ji,null,[Hi(a,{link:"",type:"primary",onClick:o},{default:mi((()=>[Ri(bi(e.$t("editor.preview")),1)])),_:1}),pi(n)?(ui(),Ai(s,{key:0,"url-list":pi(i),onClose:r},null,8,["url-list"])):Fi("",!0)],64)}}}),xk={class:"inline-block"},_k=ai({__name:"History",setup(e){const t=ey(),n=si(0),i=si(0),r=()=>{t.editor.undo()},o=()=>{t.editor.redo()};return ci((()=>{ki((()=>{var e;null==(e=t.editor)||e.on("historyUpdate",((e,t)=>{n.value=e,i.value=t}))}))})),(e,t)=>{const a=en,s=et,l=nt;return ui(),hi("div",xk,[Hi(l,{content:e.$t("editor.history.undo")+`(${pi(n)})`},{default:mi((()=>[Hi(s,{onClick:r,link:"",size:"small",disabled:!pi(n)},{default:mi((()=>[Hi(a,{extClass:"text-20px",color:pi(n)?"#333":"#ccc",icon:"ios-undo"},null,8,["color"])])),_:1},8,["disabled"])])),_:1},8,["content"]),Hi(l,{content:e.$t("editor.history.redo")+`(${pi(i)})`},{default:mi((()=>[Hi(s,{onClick:o,link:"",size:"small",disabled:!pi(i)},{default:mi((()=>[Hi(a,{extClass:"text-20px",color:pi(i)?"#333":"#ccc",icon:"ios-redo"},null,8,["color"])])),_:1},8,["disabled"])])),_:1},8,["content"])])}}}),Ek={key:0,class:"inline-block"},Sk={__name:"MyTemplName",setup(e){const t=ey(),n=wr(),{getTemplInfo:i,updataTemplInfo:r}=yk(),o=si(""),a=xr(),s=si(!1);Ii((()=>a.query),(e=>{(null==e?void 0:e.id)?i(null==e?void 0:e.id).then((e=>{var t,n;o.value=null==(n=null==(t=null==e?void 0:e.data)?void 0:t.attributes)?void 0:n.name})):o.value=!1})),ci((()=>{ki((()=>h(this,null,(function*(){var e,r,s,c;if(null==(e=null==a?void 0:a.query)?void 0:e.id)i(null==(r=null==a?void 0:a.query)?void 0:r.id).then((e=>{var n,i,r,a;o.value=null==(i=null==(n=null==e?void 0:e.data)?void 0:n.attributes)?void 0:i.name,t.editor.loadJSON(JSON.stringify(null==(a=null==(r=null==e?void 0:e.data)?void 0:r.attributes)?void 0:a.json))})).catch((()=>{window.location.href="/"}));else if(null==(s=null==a?void 0:a.query)?void 0:s.projectid){const e=yield l(null==(c=null==a?void 0:a.query)?void 0:c.projectid);e&&i(e).then((i=>{var r,s,l,c;n.replace(a.fullPath+"&id="+e),o.value=null==(s=null==(r=null==i?void 0:i.data)?void 0:r.attributes)?void 0:s.name,t.editor.loadJSON(JSON.stringify(null==(c=null==(l=null==i?void 0:i.data)?void 0:l.attributes)?void 0:c.json))}))}}))))}));const l=e=>{const t={populate:{img:"*"},filters:{externalId:{$eq:String(e)}},pagination:{page:1,pageSize:50}};return Br(Wt.stringify(t)).then((e=>{if(e.data.data.length)return e.data.data[0].id})).catch((e=>e))},c=()=>{if(""===o.value)return Gt.warning("文件名称不能为空"),void(o.value="默认文件名称");s.value=!0,r(a.query.id,o.value).then().finally((()=>{s.value=!1}))},u=le((()=>{a.query.id&&c()}),3e3);return ci((()=>{var e;null==(e=t.canvas)||e.on("object:modified",u)})),(e,t)=>{var n,i;const r=Ze,l=et,h=tn;return(null==(i=null==(n=pi(a))?void 0:n.query)?void 0:i.id)?(ui(),hi("div",Ek,[Hi(r,{modelValue:pi(o),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(o)?o.value=e:null),placeholder:"请输入文件名称",style:{width:"190px"},size:"small",onChange:pi(u),loading:pi(s)},null,8,["modelValue","onChange","loading"]),Hi(l,{link:"",onClick:c,loading:pi(s)},null,8,["loading"]),Hi(h,{type:"vertical"})])):Fi("",!0)}}},Ik={class:"f-center"},kk={class:"dialog-footer"},Bk={__name:"ImportFile",setup(e){const t=ey(),{getImgStr:n,selectFiles:i}=Wm,r=zi({showModal:!1,svgStr:""}),o={insertImg:function(){i({accept:"image/*",multiple:!0}).then((e=>{Array.from(e).forEach((e=>{n(e).then((e=>{!function(e){if(!e)throw new Error("file is undefined");const n=document.createElement("img");n.src=e,document.body.appendChild(n),n.onload=()=>h(this,null,(function*(){const e=yield t.editor.createImgByElement(n);t.editor.addBaseType(e,{scale:!0}),n.remove()}))}(e)}))}))}))},insertSvg:function(){i({accept:".svg",multiple:!0}).then((e=>{Array.from(e).forEach((e=>{n(e).then((e=>{!function(e){if(!e)throw new Error("file is undefined");vA.fabric.loadSVGFromURL(e,((e,n)=>{const i=vA.fabric.util.groupSVGElements(e,c(l({},n),{name:"defaultSVG",id:hm()}));t.editor.addBaseType(i,{scale:!0})}))}(e)}))}))}))},insertSvgStrModal:function(){r.svgStr="",r.showModal=!0},insertSvgStr:function(){vA.fabric.loadSVGFromString(r.svgStr,((e,n)=>{const i=vA.fabric.util.groupSVGElements(e,c(l({},n),{name:"defaultSVG"}));t.editor.addBaseType(i,{scale:!0}),r.showModal=!1}))}},a=e=>{const t=o[e];t&&"function"==typeof t&&t()};return(e,t)=>{const n=Se,i=et,o=Kt,s=Jt,l=Zt,c=Ze,u=nn;return ui(),hi("div",Ik,[Hi(l,{"transfer-class-name":"fix",onCommand:a},{dropdown:mi((()=>[Hi(s,null,{default:mi((()=>[Hi(o,{command:"insertImg"},{default:mi((()=>[Ri(bi(e.$t("editor.insertFile.insert_picture")),1)])),_:1}),Hi(o,{command:"insertSvg"},{default:mi((()=>[Ri(bi(e.$t("editor.insertFile.insert_SVG")),1)])),_:1}),Hi(o,{command:"insertSvgStrModal"},{default:mi((()=>[Ri(bi(e.$t("editor.insertFile.insert_SVGStr")),1)])),_:1})])),_:1})])),default:mi((()=>[Hi(i,{link:"",type:"primary"},{default:mi((()=>[Ri(bi(e.$t("editor.insertFile.insert"))+" ",1),Hi(n,{class:"el-icon--right"},{default:mi((()=>[Hi(pi(tt))])),_:1})])),_:1})])),_:1}),Hi(u,{modelValue:pi(r).showModal,"onUpdate:modelValue":t[3]||(t[3]=e=>pi(r).showModal=e),title:e.$t("editor.insertFile.modal_tittle")},{footer:mi((()=>[vi("div",kk,[Hi(i,{onClick:t[1]||(t[1]=e=>pi(r).showModal=!1)},{default:mi((()=>[Ri("取消")])),_:1}),Hi(i,{type:"primary",onClick:t[2]||(t[2]=e=>a("insertSvgStr"))},{default:mi((()=>[Ri(" 确认 ")])),_:1})])])),default:mi((()=>[Hi(c,{modelValue:pi(r).svgStr,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(r).svgStr=e),"show-word-limit":"",type:"textarea",placeholder:e.$t("editor.insertFile.insert_SVGStr_placeholder")},null,8,["modelValue","placeholder"])])),_:1},8,["modelValue","title"])])}}},Ok=e=>(Tr("data-v-330f5ebb"),e=e(),Dr(),e),Tk={class:"size-wrap"},Dk={class:"size-wrap-item"},Mk=Ok((()=>vi("span",null,"宽度",-1))),Qk={class:"size-wrap-item"},Lk=Ok((()=>vi("span",null,"高度",-1))),Pk={"label-width":0},jk={class:"cell-wrap box-border"},Rk=["onClick"],Fk={class:"cell-name"},Nk={class:"cell-label"},Vk=Or({__name:"ModalSize",props:{title:{type:String,default:""}},emits:["set"],setup(e,{expose:t,emit:n}){const i=ey(),r=n,o=e,a=si(!1),s=si(null),l=si(null),c=si([]),u=()=>h(this,null,(function*(){s.value&&l.value?(r("set",s.value,l.value),a.value=!1):Gt.warning("请检查尺寸")}));return t({showSetSize:(e,t)=>{s.value=e||null,l.value=t||null,i.editor.getSizeList().then((e=>{c.value=e})),a.value=!0}}),(e,t)=>{const n=jg,i=et,r=tn,h=Se,d=nn;return ui(),Ai(d,{modelValue:pi(a),"onUpdate:modelValue":t[2]||(t[2]=e=>Qi(a)?a.value=e:null),title:o.title,"footer-hide":""},{default:mi((()=>[vi("h3",null,bi(e.$t("editor.importFiles.createDesign.customSize")),1),vi("section",Tk,[vi("div",Dk,[Mk,Hi(n,{style:{width:"70%"},modelValue:pi(s),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(s)?s.value=e:null),min:1,placeholder:"请输入","controls-position":"right"},null,8,["modelValue"])]),vi("div",Qk,[Lk,Hi(n,{style:{width:"70%"},modelValue:pi(l),"onUpdate:modelValue":t[1]||(t[1]=e=>Qi(l)?l.value=e:null),min:1,placeholder:"请输入","controls-position":"right"},null,8,["modelValue"])]),vi("div",Pk,[Hi(i,{type:"primary",onClick:u},{default:mi((()=>[Ri(bi(e.$t("editor.importFiles.createDesign.create")),1)])),_:1})])]),Hi(r,{direction:"horizontal"}),vi("h3",null,bi(e.$t("editor.importFiles.createDesign.systemSize")),1),vi("section",jk,[(ui(!0),hi(ji,null,Zi(pi(c),(e=>(ui(),hi("div",{key:e.name,class:"cell-main",onClick:t=>(e=>{const[t,n]=e.split("x");s.value=Number(t),l.value=Number(n)})(`${e.width}x${e.height}x${e.unit}`)},[vi("div",null,[vi("div",Fk,bi(e.name),1),vi("div",Nk,bi(`${e.width}x${e.height}${e.unit}`),1)]),Hi(h,null,{default:mi((()=>[Hi(pi(bt))])),_:1})],8,Rk)))),128))])])),_:1},8,["modelValue","title"])}}},[["__scopeId","data-v-330f5ebb"]]),Uk={class:"f-center"},zk={__name:"ImportJson",setup(e){var t;const n=ey(),{createTmpl:i,routerToId:r}=yk(),o=si(null),a={importFiles:null==(t=n.editor)?void 0:t.insert(),createDesign:()=>{var e;return null==(e=o.value)?void 0:e.showSetSize()},psd:()=>h(this,null,(function*(){yield n.editor.insertPSD()}))},s=e=>{var t;null==(t=a[e])||t.call(a)},l=(e,t)=>h(this,null,(function*(){const n=yield i(e,t);r(n.data.data.id),Gt.success("创建成功")}));return(e,t)=>{const n=Se,i=et,r=Kt,a=Jt,c=Zt;return ui(),hi("div",Uk,[Hi(c,{onCommand:s},{dropdown:mi((()=>[Hi(a,null,{default:mi((()=>[Hi(r,{command:"createDesign"},{default:mi((()=>[Ri(bi(e.$t("editor.importFiles.createDesign.title")),1)])),_:1}),Hi(r,{command:"importFiles"},{default:mi((()=>[Ri(bi(e.$t("editor.importFiles.importFiles")),1)])),_:1}),Hi(r,{command:"psd"},{default:mi((()=>[Ri("PSD")])),_:1})])),_:1})])),default:mi((()=>[Hi(i,{link:"",type:"primary"},{default:mi((()=>[Ri(bi(e.$t("editor.importFiles.file"))+" ",1),Hi(n,{class:"el-icon--right"},{default:mi((()=>[Hi(pi(tt))])),_:1})])),_:1})])),_:1}),Hi(Vk,{title:e.$t("editor.importFiles.createDesign.title"),ref_key:"modalSizeRef",ref:o,onSet:l},null,8,["title"])])}}},Hk={class:"w-full flex justify-between items-center"},Yk={class:"flex justify-start items-center"},Gk={class:"flex justify-end items-center"},Wk=vi("a",{class:"mr-10px",href:"https://github.com/ikuaitu/element-fabric-editor",target:"_blank"},[vi("img",{src:"https://img.shields.io/badge/GitHub-ElementFbricEditor-blue",alt:"element-fbric-editor"})],-1),Xk=ai({__name:"index",setup(e){const t=ey(),n=Si((()=>t.rulerEnable)),i=e=>{e?t.editor.rulerEnable():t.editor.rulerDisable(),t.updateRulerEnable(e),document.activeElement.blur()};return(e,t)=>{const r=rn,o=tn,a=zk,s=Bk,l=et,c=sr("router-link"),u=Sk,h=Vv,d=_k,f=wk,p=Ck,g=on;return ui(),hi("div",Hk,[vi("div",Yk,[Hi(r),Hi(o,{direction:"vertical"}),Hi(a),Hi(o,{direction:"vertical"}),Hi(s),Hi(o,{direction:"vertical"}),Hi(c,{custom:"",to:"/editor/template"},{default:mi((({navigate:e})=>[Hi(l,{text:"",onClick:e},{default:mi((()=>[Ri("全部模板")])),_:2},1032,["onClick"])])),_:1}),Hi(o,{direction:"vertical"}),Hi(u),Hi(h,{modelValue:pi(n),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(n)?n.value=e:null),size:"large",class:"ml-10px","inline-prompt":"","active-text":"标尺","inactive-text":"标尺",onChange:i},null,8,["modelValue"]),Hi(o,{direction:"vertical"}),Hi(d)]),vi("div",Gk,[Wk,Hi(f),Hi(o,{direction:"vertical"}),Hi(p),Hi(o,{direction:"vertical"}),Hi(g)])])}}}),$k=[{name:"添加",icon:"add",type:Xm.create},{name:"模板",icon:"template",type:Xm.template},{name:"元素",icon:"element",type:Xm.element},{name:"文字",icon:"text",type:Xm.text},{name:"素材",icon:"img",type:Xm.material},{name:"AI",icon:"ai",type:Xm.ai},{name:"我的",icon:"mine",type:Xm.mine}],qk=[{name:"标题",icon:"text-h1",type:qm.h1},{name:"副标题",icon:"text-h2",type:qm.h2},{name:"正文",icon:"text-normal",type:qm.normal}],Kk=[{name:"矩形",icon:'<svg role="img" aria-label="shape-rectangle" focusable="false" data-icon="shape-rectangle" aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="gd_design_icon gd_design_icon-shape-rectangle"><path fill-rule="evenodd" clip-rule="evenodd" d="M19.5 19V5C19.5 4.72386 19.2761 4.5 19 4.5L5 4.5C4.72386 4.5 4.5 4.72386 4.5 5L4.5 19C4.5 19.2761 4.72386 19.5 5 19.5H19C19.2761 19.5 19.5 19.2761 19.5 19ZM21 5C21 3.89543 20.1046 3 19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5Z" fill="currentColor"></path></svg>',type:Km.react},{name:"三角形",icon:'<svg role="img" aria-label="shape-polygon" focusable="false" data-icon="shape-polygon" aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="gd_design_icon gd_design_icon-shape-polygon"><path fill-rule="evenodd" clip-rule="evenodd" d="M20.7949 19.1828L12.1881 3.46617C12.1068 3.31769 11.8936 3.31768 11.8122 3.46617L3.20553 19.1828C3.12732 19.3256 3.23066 19.5 3.39347 19.5H20.6069C20.7697 19.5 20.8731 19.3256 20.7949 19.1828ZM13.5038 2.74569C12.8533 1.55784 11.1471 1.55784 10.4966 2.74569L1.88988 18.4623C1.26427 19.6047 2.09097 21 3.39347 21H20.6069C21.9094 21 22.7361 19.6047 22.1105 18.4623L13.5038 2.74569Z" fill="currentColor"></path></svg>',type:Km.triangle},{name:"圆形",icon:'<svg role="img" aria-label="shape-circle" focusable="false" data-icon="shape-circle" aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="gd_design_icon gd_design_icon-shape-circle"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 20.5C16.6944 20.5 20.5 16.6944 20.5 12C20.5 7.30558 16.6944 3.5 12 3.5C7.30558 3.5 3.5 7.30558 3.5 12C3.5 16.6944 7.30558 20.5 12 20.5ZM12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" fill="currentColor"></path></svg>',type:Km.around},{name:"多边形",icon:'<svg data-v-1eb84746="" t="1650874633978" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2032" width="26" height="26"><path data-v-1eb84746="" d="M161.152 398.016l134.016 412.416h433.664l134.016-412.416L512 143.104 161.152 398.08zM512 64l426.048 309.568-162.752 500.864H248.704L85.952 373.568 512 64z" p-id="2033"></path></svg>',type:Km.polygon},{name:"直线",icon:'<svg role="img" aria-label="shape-line" focusable="false" data-icon="shape-line" aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="gd_design_icon gd_design_icon-shape-line"><path fill-rule="evenodd" clip-rule="evenodd" d="M3.46967 20.5303C3.17678 20.2374 3.17678 19.7626 3.46967 19.4697L19.4697 3.46967C19.7626 3.17678 20.2374 3.17678 20.5303 3.46967C20.8232 3.76256 20.8232 4.23744 20.5303 4.53033L4.53033 20.5303C4.23744 20.8232 3.76256 20.8232 3.46967 20.5303Z" fill="currentColor"></path></svg>',type:Km.line}],Jk=[{name:"二维码",icon:'<svg\n          t="1717679888665"\n          class="icon"\n          viewBox="0 0 1024 1024"\n          version="1.1"\n          p-id="4558"\n          xmlns="http://www.w3.org/2000/svg"\n          width="20"\n          height="20"\n        >\n          <path\n            d="M386.612245 470.204082H177.632653c-45.97551 0-83.591837-37.616327-83.591837-83.591837V177.632653c0-45.97551 37.616327-83.591837 83.591837-83.591837h208.979592c45.97551 0 83.591837 37.616327 83.591837 83.591837v208.979592c0 45.97551-37.616327 83.591837-83.591837 83.591837zM177.632653 135.836735c-22.987755 0-41.795918 18.808163-41.795918 41.795918v208.979592c0 22.987755 18.808163 41.795918 41.795918 41.795918h208.979592c22.987755 0 41.795918-18.808163 41.795918-41.795918V177.632653c0-22.987755-18.808163-41.795918-41.795918-41.795918H177.632653zM846.367347 470.204082h-208.979592c-45.97551 0-83.591837-37.616327-83.591837-83.591837V177.632653c0-45.97551 37.616327-83.591837 83.591837-83.591837h208.979592c45.97551 0 83.591837 37.616327 83.591837 83.591837v208.979592c0 45.97551-37.616327 83.591837-83.591837 83.591837z m-208.979592-334.367347c-22.987755 0-41.795918 18.808163-41.795918 41.795918v208.979592c0 22.987755 18.808163 41.795918 41.795918 41.795918h208.979592c22.987755 0 41.795918-18.808163 41.795918-41.795918V177.632653c0-22.987755-18.808163-41.795918-41.795918-41.795918h-208.979592z"\n            fill="#333333"\n            p-id="4559"\n          ></path>\n          <path\n            d="M773.22449 344.816327h-62.693878c-17.240816 0-31.346939-14.106122-31.346939-31.346939V250.77551c0-17.240816 14.106122-31.346939 31.346939-31.346939h62.693878c17.240816 0 31.346939 14.106122 31.346939 31.346939v62.693878c0 17.240816-14.106122 31.346939-31.346939 31.346939zM313.469388 344.816327H250.77551c-17.240816 0-31.346939-14.106122-31.346939-31.346939V250.77551c0-17.240816 14.106122-31.346939 31.346939-31.346939h62.693878c17.240816 0 31.346939 14.106122 31.346939 31.346939v62.693878c0 17.240816-14.106122 31.346939-31.346939 31.346939zM313.469388 804.571429H250.77551c-17.240816 0-31.346939-14.106122-31.346939-31.346939v-62.693878c0-17.240816 14.106122-31.346939 31.346939-31.346939h62.693878c17.240816 0 31.346939 14.106122 31.346939 31.346939v62.693878c0 17.240816-14.106122 31.346939-31.346939 31.346939zM574.693878 929.959184c-11.493878 0-20.897959-9.404082-20.89796-20.89796v-271.673469c0-45.97551 37.616327-83.591837 83.591837-83.591837h41.795918c45.97551 0 83.591837 37.616327 83.591837 83.591837v62.693878c0 22.987755 18.808163 41.795918 41.795919 41.795918h41.795918c22.987755 0 41.795918-18.808163 41.795918-41.795918v-125.387755c0-11.493878 9.404082-20.897959 20.897959-20.89796s20.897959 9.404082 20.89796 20.89796v125.387755c0 45.97551-37.616327 83.591837-83.591837 83.591836h-41.795918c-45.97551 0-83.591837-37.616327-83.591837-83.591836v-62.693878c0-22.987755-18.808163-41.795918-41.795919-41.795918h-41.795918c-22.987755 0-41.795918 18.808163-41.795918 41.795918v271.673469c0 11.493878-9.404082 20.897959-20.897959 20.89796zM909.061224 929.959184h-167.183673c-11.493878 0-20.897959-9.404082-20.897959-20.89796s9.404082-20.897959 20.897959-20.897959h167.183673c11.493878 0 20.897959 9.404082 20.89796 20.897959s-9.404082 20.897959-20.89796 20.89796z"\n            fill="#333333"\n            p-id="4560"\n          ></path>\n          <path\n            d="M386.612245 929.959184H177.632653c-45.97551 0-83.591837-37.616327-83.591837-83.591837v-208.979592c0-45.97551 37.616327-83.591837 83.591837-83.591837h208.979592c45.97551 0 83.591837 37.616327 83.591837 83.591837v208.979592c0 45.97551-37.616327 83.591837-83.591837 83.591837z m-208.979592-334.367347c-22.987755 0-41.795918 18.808163-41.795918 41.795918v208.979592c0 22.987755 18.808163 41.795918 41.795918 41.795918h208.979592c22.987755 0 41.795918-18.808163 41.795918-41.795918v-208.979592c0-22.987755-18.808163-41.795918-41.795918-41.795918H177.632653z"\n            fill="#333333"\n            p-id="4561"\n          ></path>\n        </svg>',type:Jm.qrcode},{name:"条码",icon:'<svg\n          t="1717679973041"\n          class="icon"\n          viewBox="0 0 1024 1024"\n          version="1.1"\n          xmlns="http://www.w3.org/2000/svg"\n          p-id="5747"\n          width="20"\n          height="20"\n        >\n          <path\n            d="M876.893 63.84h20.44c34.501 0 62.49 30.402 62.49 64.919V229.7h-0.13c0 16.569-11.355 22.409-22.855 22.409s-22.854-7.734-22.854-19.234c0-0.211-3.92-0.373-3.92-0.583v-82.72c0-23-10.56-35.975-33.56-35.975h-61.47c-0.21 0-1.36-2.786-1.555-2.786-11.5 0-21.817-12.213-21.817-23.713s18.885-20.813 18.885-20.813V63.84h66.345zM213.45 66.286V63.84h-86.914c-34.5 0-62.36 30.402-62.36 64.919V229.7c0 16.569 9.33 22.409 20.83 22.409s24.927-8.528 24.927-20.028c0-0.211 4.001 0.421 4.001 0.21v-82.72c0-23 10.432-35.974 33.432-35.974h63.008c0.194 0 0.372-2.786 0.583-2.786 11.5 0 22.06-10.772 22.06-22.263 0-11.5-2.98-22.263-19.567-22.263z m16.587 500.74V246.27h-33.173v530.764h33.173V567.026zM109.933 795.141c0-11.5-11.37-21.576-22.87-21.576s-22.888 3.468-22.888 20.053v105.638c0 34.5 27.86 60.224 62.36 60.224h83.837c0.194 0 0.372 0.679 0.583 0.679 11.5 0 22.06-9.038 22.06-20.538s-2.98-20.538-19.566-20.538v7.224h-66.344v-6.737c-33.173-2.624-33.173-19.923-33.173-41.14v-82.704c0.001-0.213-3.999-0.39-3.999-0.585z m186.448-228.115V246.27h-16.586V694.1h16.586V567.026z m16.585 160.249h-33.172v49.758h33.172v-49.758z m66.344-160.249V246.27h-16.585V694.1h16.585V567.026z m16.586 160.249h-33.171v49.758h33.171v-49.758z m82.931-160.249V246.27h-66.344V694.1h66.344V567.026z m0 210.007v-49.758h-33.173v49.758h33.173z m132.688-210.007V246.27h-49.758V694.1h49.758V567.026z m-82.93 210.007h33.172v-49.758h-33.172v49.758zM661.273 566.41V246.27H644.69V694.1h16.584V566.41z m-33.171 210.623h33.171v-49.758h-33.171v49.758zM744.205 566.41V246.27h-16.587V694.1h16.587V566.41z m-33.173 210.623h33.173v-49.758h-33.173v49.758z m116.103-210.007V246.27h-33.172v530.764h33.172V567.026z m70.198 392.454c34.5 0 62.489-25.723 62.489-60.224V793.618h-0.13c0-16.585-9.33-20.053-20.83-20.053s-24.88 9.688-24.88 21.188c0 0.226-3.918 0.76-3.918 0.97v82.705c0 20.7 0 37.738-33.172 40.978v6.899h-66.345v-7.224s-18.885 9.33-18.885 20.83 10.317 20.246 21.817 20.246c0.193 0 1.344-0.68 1.555-0.68h82.299z"\n            p-id="5748"\n          ></path>\n        </svg>',type:Jm.barCode}],Zk=[{name:"新建模板",icon:"template",type:Zm.design},{name:"插入图片",icon:"img",type:Zm.img},{name:"插入SVG",icon:"svg-file",type:Zm.svg},{name:"插入PSD",icon:"psd-file",type:Zm.psd},{name:"插入JSON",icon:"json-file",type:Zm.json}],eB={class:"my-material"},tB={key:0,class:"img-group flex justify-start flex-wrap"},nB={class:"relative tmpl-img-box"},iB={key:1,class:"tip"},rB={__name:"uploadMaterial",setup(e){const{selectFiles:t}=Wm,n=ey(),i=si([]),r=si(!1),o=()=>{Mr().then((e=>{var t;i.value=null==(t=e.data.data)?void 0:t.map((e=>{var t,n,i,r;return{id:e.id,name:null==(t=null==e?void 0:e.attributes)?void 0:t.name,imgUrl:Qr+(null==(r=null==(i=null==(n=e.attributes.img)?void 0:n.data)?void 0:i.attributes)?void 0:r.url)}})),r.value=!0})).catch((e=>{r.value=!1}))};o();const a=()=>{t({accept:"image/*"}).then((e=>{const t=new FormData,n=new Date,[i]=e;t.append("files",i,`${n.getTime()}`),kr(t).then((e=>{const[t]=e.data;s(t.id,i.name)})).catch((e=>{}))}))},s=(e,t)=>{Lr({data:{img:e,name:t}}).finally(o)},l=e=>h(this,null,(function*(){const t=yield n.editor.createImgByElement(e.target);n.editor.addBaseType(t,{scale:!0})}));return(e,t)=>{const n=et,r=Se,s=Tg,c=nt;return ui(),hi("div",eB,[Hi(n,{class:"w-full",icon:pi(an),onClick:a,long:"",type:"primary"},{default:mi((()=>[Ri(bi(e.$t("myMaterial.uploadBtn")),1)])),_:1},8,["icon"]),pi(i).length?(ui(),hi("div",tB,[(ui(!0),hi(ji,null,Zi(pi(i),((e,t)=>(ui(),Ai(c,{content:e.name,key:`${t}-bai1-button`,placement:"top"},{default:mi((()=>[vi("div",nB,[Hi(r,{class:"del-btn",color:"red",onClick:t=>{return n=e.id,void Pr(n).finally(o);var n}},{default:mi((()=>[Hi(pi(sn))])),_:2},1032,["onClick"]),Hi(s,{lazy:"",src:e.imgUrl,fit:"contain",height:"100%",alt:e.name,onClick:l},null,8,["src","alt"])])])),_:2},1032,["content"])))),128))])):(ui(),hi("div",iB,"暂无素材"))])}}},oB=Or(rB,[["__scopeId","data-v-50728920"]]),aB={class:"file-type-box"},sB=["src"],lB={class:"more"},cB=Or({__name:"fileType",props:{name:{type:String,default:""},itemId:{type:[Number,String],default:""}},emits:["change","select"],setup(e,{emit:t}){const{reNameFileType:n,removeFileType:i}=yk(),r=e,o=t,a=e=>{({reName:u,delete:d})[e]()},s=si(""),u=()=>{s.value=r.name,$t.confirm("重命名文件夹",{confirmButtonText:"确认",cancelButtonText:"取消",message:()=>hr(Ze,c(l(l({},Ze.$el),Ze.$attrs),{size:"large",modelValue:s.value,autofocus:!0,style:{margin:"10px 0",width:"400px"},placeholder:"请输入文件夹名称","onUpdate:modelValue":e=>{s.value=e}}))}).then((()=>h(this,null,(function*(){""!==s.value?(yield n(s.value,r.itemId),o("change")):Gt.warning("文件夹名称不能为空")}))))},d=()=>h(this,null,(function*(){var e,t;const n=yield i(r.itemId);(null==(e=null==n?void 0:n.data)?void 0:e.msg)?Gt.error({content:null==(t=n.data)?void 0:t.msg,duration:3}):o("change")}));return(e,t)=>{const n=Se,i=et,s=Kt,l=Jt,c=Zt;return ui(),hi("div",aB,[vi("img",{src:pi("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAADICAYAAACDHY8MAAAAAXNSR0IArs4c6QAAB/ZJREFUeF7tnL9uXEUchWdWGGQSF4miBITkAhqchgpREOHdVElNBQ9BS4MU+2Xo8wLsNTUVjV/CCqKgSbGDdm3wrr12Iu+9M79z9rNEg+KZc76TT/f6D+S05qNMH43TaDZOuRymksfr/gz/7h0EculSySdpNury5KyDFwTmBPJVDOXk4VFK6RV4eiVwnA/fzLnyseUEVoQrvz+Y8kQb8G/EbDThaTcgX4Gj/xcO2eqslQ/fXHurqHMzt0QgsBgf2SpOkUuXv/trUvFGrgpEIF98g2QaKNM2ROFrum1YeU3HzNOtzfK8Wrbh3vpWhGu3AE+5duyb3ZzLycPS7PbtvhjhtnB/hGs1Ot88aUW+6b0I1xA/X8c1hN/oaoRrBP7iWl4r2/KvfjvCVUe+ciHCteVf/XaEq4589UJeKxsPUPl6hKsM/Np1/H5l6wWq3o9wVXGvvYzXyvYbVEuAcNVQ33gRwrXfoFoChKuG+uaL+DouwAiVIiBcJdC3XsPXcRFWqJIB4apgfscle9+cpM9+4n/DEGGLHjLkJy9v/K/7Ea4HwBsf8fHTlPZ/2fgYDohEoByvEw/homz05a9RkpCjVwKr4iFcr3A3OOzR9ynN/+HDkMCldAgXZV6Ei7LEMDlmZZI/fdkh3DB473Yqr5V346bwWTl1+fGLCcJFGgvhIq0xQJbRM4QbAOudj+S18s7oND4xv0a4SEshXKQ1BsiCcANA3fBIXis3BBj60894wkXbZ/4D8PkPwvlwJIBw4VbltTLcJD0GQrgeYfZzFL/m1Q/HmKcgXMhd+Dou5Cw9hEK4HiD2fwSvlf0zjXEiwsXY4UoKhAs5Sw+hEK4HiMMcwWvlMFzbnopwbfnfcjvChZ1mg2AItwG8YT+V18ph+bY5HeHacH+PWxHuPSDJ/ZFbhPvwfkr3nsg1sgrMb5zozfnB/nnm3W/XZV8j3L1PEE1vZhJHJLD77Kp4V4R78EVKO/cjRicTBDQJ7OyntPfDf9mXhEM2zUFJHZ/ApXQXwvEaGX80EmoTOH+9vBDu8VfaZUgPAQUCez/+ncsfTwvfjVRYi4zyBHY+f5vLn18XvlEiPyUFFAgshDudFIWsZISAPIHR7gzh5FekgAwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAA4RxWpIMMAYSTmYqgDgQQzmFFOsgQQDiZqQjqQADhHFakgwwBhJOZiqAOBBDOYUU6yBBAOJmpCOpAAOEcVqSDDAGEk5mKoA4EEM5hRTrIEEA4makI6kAgf/Q2l9NJcehCBwiEJ5B3/kG48CsR0IjAGcIZrUmV8AQQLvxEBHQisBBumlIaO7WiCwRCEsjpNcKFXIZQlgRK+jmX0/E4pTx/yvEBAQgMSCAfTHOen89r5YCUORoCCwL5OB/8drQQDun4OwGBYQnMn24L7Zav4Uk3LHRO30oCXUrlOB903TXhzp90z49SKq+2Eg2lIdAvgS4fTCfLR6484S5fL+ffSBmNUyqH/Mig3wU4zZ7A4km2/FRbbvwv/sNzeMKZkPkAAAAASUVORK5CYII=")},null,8,sB),vi("span",null,bi(r.name),1),vi("div",{class:"click-bg",onClick:t[0]||(t[0]=e=>o("select"))}),vi("div",lB,[Hi(c,{trigger:"click",onCommand:a},{dropdown:mi((()=>[Hi(l,null,{default:mi((()=>[Hi(s,{command:"reName"},{default:mi((()=>[Ri("重命名")])),_:1}),Hi(s,{command:"delete"},{default:mi((()=>[Ri("删除")])),_:1})])),_:1})])),default:mi((()=>[Hi(i,{size:"small",shape:"circle",text:""},{default:mi((()=>[Hi(n,{size:"18px"},{default:mi((()=>[Hi(pi(bt))])),_:1})])),_:1})])),_:1})])])}}},[["__scopeId","data-v-ed117189"]]),uB={class:"file-type-box"},hB={class:"more"},dB={class:"dialog-footer"},fB=Or({__name:"file",props:{name:{type:String,default:""},src:{type:String,default:""},previewSrc:{type:String,default:""},itemId:{type:[Number,String],default:""},json:{type:Object,default:()=>({})}},emits:["change"],setup(e,{emit:t}){const n=ey(),{t:i}=Xt(),{reNameFileType:r,removeTemplInfo:o,routerToId:a,getTemplInfo:s}=yk(),u=e,d=t,f=e=>{({reName:g,delete:v,transfer:w})[e]()},p=si(""),g=()=>{p.value=u.name,$t.confirm({title:"重命名",message:hr(Ze,c(l(l({},Ze.$el),Ze.$attrs),{size:"large",modelValue:p.value,autofocus:!0,placeholder:"请输入文件名称","onUpdate:modelValue":e=>{p.value=e}}))}).then((()=>h(this,null,(function*(){""!==p.value?(yield r(p.value,u.itemId),d("change")):Gt.warning("文件名称不能为空")}))))},v=()=>h(this,null,(function*(){yield o(u.itemId),d("change")})),A=()=>{$t.confirm(i("replaceTip"),i("tip"),{confirmButtonText:i("ok"),cancelButtonText:i("cancel"),type:"warning"}).then((()=>{m()}))},m=()=>h(this,null,(function*(){const e=qt.service({text:i("alert.loading_data")}),t=yield s(u.itemId);a(u.itemId),n.editor.loadJSON(JSON.stringify(t.data.attributes.json),e.close)})),y=si(!1),b=si(""),C=si([]),w=()=>h(this,null,(function*(){C.value=[],b.value="";const e=yield jr();C.value=[e.data.data],y.value=!0})),x=()=>h(this,null,(function*(){const e="root"===b.value?"":b.value;yield Sr(u.itemId,{data:{parentId:String(e)}}),d("change")}));return(e,t)=>{const n=Tg,i=Se,r=et,o=Kt,a=Jt,s=Zt,l=nt,c=gA,h=nn;return ui(),hi(ji,null,[Hi(l,{content:u.name,placement:"top"},{default:mi((()=>[vi("div",uB,[Hi(n,{lazy:"",onClick:A,src:u.src,fit:"contain",height:"100%",width:"100%",alt:u.name},null,8,["src","alt"]),vi("div",hB,[Hi(s,{trigger:"click",onCommand:f},{list:mi((()=>[Hi(a,null,{default:mi((()=>[Hi(o,{command:"reName"},{default:mi((()=>[Ri("重命名")])),_:1}),Hi(o,{command:"delete"},{default:mi((()=>[Ri("删除")])),_:1}),Hi(o,{command:"transfer"},{default:mi((()=>[Ri("迁移目录")])),_:1})])),_:1})])),default:mi((()=>[Hi(r,{size:"small",shape:"circle",text:""},{default:mi((()=>[Hi(i,{size:"24px"},{default:mi((()=>[Hi(pi(bt))])),_:1})])),_:1})])),_:1})])])])),_:1},8,["content"]),Hi(h,{modelValue:pi(y),"onUpdate:modelValue":t[2]||(t[2]=e=>Qi(y)?y.value=e:null),title:"请选择迁移目录"},{footer:mi((()=>[vi("div",dB,[Hi(r,{onClick:t[1]||(t[1]=e=>y.value=!1)},{default:mi((()=>[Ri("取消")])),_:1}),Hi(r,{type:"primary",onClick:x},{default:mi((()=>[Ri(" 确认 ")])),_:1})])])),default:mi((()=>[Hi(c,{modelValue:pi(b),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(b)?b.value=e:null),data:pi(C),width:"200px"},null,8,["modelValue","data"])])),_:1},8,["modelValue"])],64)}}},[["__scopeId","data-v-5c695af6"]]),pB={class:"search-box"},gB={style:{height:"calc(100vh - 160px)"},id:"myFileTemplBox"},vB={__name:"myTempl",setup(e){const t=xr(),{createdFileType:n,createTmpl:i}=yk(),r=zi({name:{$contains:""},parentId:{$eq:"",filterEmpty:!1}}),{pageData:o,showScroll:a,scrollHeight:s,isDownBottom:u,pageLoading:d,startPage:f,startGetList:p,nextPage:g}=ln({el:"#myFileTemplBox",apiClient:Br,filters:r,sort:["type:desc"],fields:["name","parentId","type","externalId"],formatData:e=>e.map((e=>({id:e.id,name:e.attributes.name,type:e.attributes.type||"file",desc:e.attributes.desc,json:e.attributes.json,src:cn(e.attributes.img),previewSrc:un(e.attributes.img)})))});ci((()=>h(this,null,(function*(){yield C(),f()}))));const v=si(""),A=si(null),m=e=>{"fileType"===e?(v.value="",$t.confirm("新建文件夹",{confirmButtonText:"确认",cancelButtonText:"取消",message:()=>hr(Ze,c(l(l({},Ze.$el),Ze.$attrs),{size:"large",modelValue:v.value,autofocus:!0,style:{margin:"10px 0",width:"400px"},placeholder:"请输入文件夹名称","onUpdate:modelValue":e=>{v.value=e}}))}).then((()=>h(this,null,(function*(){""!==v.value?(yield n(v.value,r.parentId.$eq),p()):Gt.warning("文件夹名称不能为空")}))))):A.value.showSetSize()},y=(e,t)=>h(this,null,(function*(){yield i(e,t,r.parentId.$eq),p()})),b=si([{name:"全部",parentId:""}]),C=()=>h(this,null,(function*(){var e;if(null==(e=null==t?void 0:t.query)?void 0:e.id){const e=yield Rr({id:t.query.id});b.value=e.data.data;const n=e.data.data[e.data.data.length-1];r.parentId.$eq=n.parentId}}));return(e,t)=>{const n=et,i=Kt,l=Jt,c=Zt,h=Ze,f=bf,v=yf,C=tn,w=Dt;return ui(),hi("div",null,[vi("div",pB,[Hi(c,{onCommand:m,placement:"bottom-start",style:{"margin-right":"10px"},transfer:""},{dropdown:mi((()=>[Hi(l,null,{default:mi((()=>[Hi(i,{command:"file"},{default:mi((()=>[Ri("新建设计")])),_:1}),Hi(i,{command:"fileType"},{default:mi((()=>[Ri("新建文件夹")])),_:1})])),_:1})])),default:mi((()=>[Hi(n,{type:"primary",icon:pi(bt)},null,8,["icon"])])),_:1}),Hi(h,{class:"input",placeholder:"请输入关键词",modelValue:pi(r).name.$contains,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(r).name.$contains=e),search:"",disabled:pi(d),onKeyup:Xi(pi(p),["enter"])},null,8,["modelValue","disabled","onKeyup"])]),Hi(v,null,{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(b),((e,t)=>(ui(),Ai(f,{onClick:n=>((e,t)=>{t===b.value.length-1||(r.parentId.$eq=e,b.value=b.value.slice(0,t+1),p())})(e.parentId,t),key:e.id},{default:mi((()=>[Ri(bi(e.name),1)])),_:2},1032,["onClick"])))),128))])),_:1}),vi("div",gB,[pi(a)?(ui(),Ai(w,{key:"myFileTemplBox","on-reach-bottom":pi(g),height:pi(s)},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(o),(e=>(ui(),hi("div",{key:e.name,class:"item"},["fileType"===e.type?(ui(),Ai(cB,{key:0,itemId:e.id,name:e.name,onSelect:()=>((e,t)=>{r.parentId.$eq=String(e),b.value.push({name:t,parentId:e}),p()})(e.id,e.name),onChange:pi(p)},null,8,["itemId","name","onSelect","onChange"])):(ui(),Ai(fB,{key:1,src:e.src,json:e.json,previewSrc:e.previewSrc,itemId:e.id,name:e.name,onChange:pi(p)},null,8,["src","json","previewSrc","itemId","name","onChange"]))])))),128)),pi(u)?(ui(),Ai(C,{key:0,plain:""},{default:mi((()=>[Ri("已经到底了")])),_:1})):Fi("",!0)])),_:1},8,["on-reach-bottom","height"])):Fi("",!0)]),Hi(Vk,{title:e.$t("editor.importFiles.createDesign.title"),ref_key:"modalSizeRef",ref:A,onSet:y},null,8,["title"])])}}},AB=Or(vB,[["__scopeId","data-v-7a6e101c"]]),mB={key:0,class:"box-border p-10px my-material"},yB={key:1,class:"tip"},bB=Or({__name:"index",setup(e){const t=si("templ"),n=si(!1);return Mr().then((()=>{n.value=!0})).catch((()=>{n.value=!1})),(e,i)=>{const r=hn,o=dn;return pi(n)?(ui(),hi("div",mB,[Hi(o,{modelValue:pi(t),"onUpdate:modelValue":i[0]||(i[0]=e=>Qi(t)?t.value=e:null)},{default:mi((()=>[Hi(r,{label:"模板",name:"templ"},{default:mi((()=>["templ"===pi(t)?(ui(),Ai(AB,{key:0})):Fi("",!0)])),_:1}),Hi(r,{label:"图片",name:"img"},{default:mi((()=>["img"===pi(t)?(ui(),Ai(oB,{key:0})):Fi("",!0)])),_:1})])),_:1},8,["modelValue"])])):(ui(),hi("div",yB,"请先登录"))}}},[["__scopeId","data-v-8263c1cb"]]),{SelectMode:CB,SelectEvent:wB}=pm,xB=ty();function _B(e){const{t:t}=Xt(),n=zi({mSelectMode:CB.EMPTY,mSelectOneType:"",mSelectId:"",mSelectIds:[],mSelectActive:[]}),i=e=>{n.mSelectMode=CB.ONE;const[t]=e;t&&(n.mSelectActive=[t],n.mSelectId=t.id,n.mSelectOneType=t.type,n.mSelectIds=[t.id]),a()},r=e=>{n.mSelectMode=CB.MULTI,n.mSelectId="",n.mSelectIds=e.map((e=>e.id)),a()},o=()=>{n.mSelectId="",n.mSelectIds=[],n.mSelectMode=CB.EMPTY,n.mSelectOneType="",a()};let a=()=>{};let s;ci((()=>{ki((()=>{var e,t,n;null==(e=xB.editor)||e.on(wB.ONE,i),null==(t=xB.editor)||t.on(wB.MULTI,r),null==(n=xB.editor)||n.on(wB.CANCEL,o)}))})),Fr((()=>{var e,t,n;null==(e=xB.editor)||e.off(wB.ONE,i),null==(t=xB.editor)||t.off(wB.MULTI,r),null==(n=xB.editor)||n.off(wB.CANCEL,o)})),e&&(s=Si((()=>e.includes(n.mSelectOneType))));const l=Si((()=>"one"===n.mSelectMode)),c=Si((()=>"multiple"===n.mSelectMode)),u=Si((()=>"one"===n.mSelectMode&&"group"===n.mSelectOneType)),h=Si((()=>n.mSelectMode)),d=Si((()=>n.mSelectOneType));return{canvasEditor:xB.editor,mixinState:n,t:t,selectType:d,isSelect:h,isGroup:u,isOne:l,isMultiple:c,isMatchType:s,matchTypeHander:e=>Si((()=>e.includes(n.mSelectOneType))),getObjectAttr:e=>{a=e}}}const EB={class:"w-full"},SB={class:"layer-box"},IB=["onClick"],kB={class:"btn-box"},BB={key:1,class:"empty-text"},OB=ai({__name:"index",setup(e){const t=ey(),{isOne:n,mixinState:i}=_B(),r=si([]),o=e=>e.id===i.mSelectId||i.mSelectIds.includes(e.id),a={group:"layer-group",textbox:"layer-textbox","i-text":"layer-iText",image:"layer-image",rect:"layer-rect",circle:"layer-circle",triangle:"layer-triangle",polygon:"layer-polygon"},s=(e,t)=>{if(e.includes("text"))return t.name||t.text;return{group:"组合",image:"图片",rect:"矩形",circle:"圆形",triangle:"三角形",polygon:"多边形",path:"路径"}[e]||"默认元素"},l=e=>{var n,i,r,o;const a=null==(n=t.canvas)?void 0:n.getObjects().find((t=>t.id===e));null==(i=t.canvas)||i.discardActiveObject(),null==(r=t.canvas)||r.setActiveObject(a),null==(o=t.canvas)||o.requestRenderAll()},c=()=>{t.editor.up()},u=()=>{t.editor.toFront()},h=()=>{t.editor.down()},d=()=>{t.editor.toBack()},f=()=>{var e;r.value=[...(null==(e=t.canvas)?void 0:e.getObjects().filter((e=>!(e instanceof vA.fabric.GuideLine||"workspace"===e.id))))||[]].reverse().map((e=>{const{type:t,id:n,name:i,text:r,selectable:o}=e;return{type:t,id:n,name:i,text:r,isLock:!o}})),r.value=xd(pi(r),"id")};return ci((()=>{var e;f(),null==(e=t.canvas)||e.on("after:render",f)})),or((()=>{var e;null==(e=t.canvas)||e.off("after:render",f)})),(e,i)=>{const f=en,p=nt,g=Ep,v=et,A=wp,m=gn;return ui(),hi("div",EB,[pi(r).length?(ui(),hi(ji,{key:0},[vi("div",SB,[(ui(!0),hi(ji,null,Zi(pi(r),(e=>(ui(),hi("div",{onClick:t=>l(e.id),key:e.id,class:fi(o(e)&&"active")},[Hi(A,{class:"ellipsis"},{default:mi((()=>[Hi(g,{span:22},{default:mi((()=>[Hi(p,{content:e.name||e.text||e.type,placement:"left"},{default:mi((()=>{return[vi("div",null,[Hi(f,{extClass:"text-20px",class:fi(o(e)&&"active"),color:"#fff",icon:(t=e.type,a[t]||"layer-default")},null,8,["class","icon"]),Ri(" | "+bi(s(e.type,e)),1)])];var t})),_:2},1032,["content"])])),_:2},1024),Hi(g,{span:2},{default:mi((()=>[Hi(v,{icon:e.isLock?pi(fn):pi(pn),link:"",onClick:n=>(e=>{var n;l(e.id),e.isLock?t.editor.unLock():t.editor.lock(),null==(n=t.canvas)||n.discardActiveObject()})(e)},null,8,["icon","onClick"])])),_:2},1024)])),_:2},1024)],10,IB)))),128))]),vi("div",kB,[Mi(Hi(m,null,{default:mi((()=>[Hi(v,{onClick:c},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"layer-up"})])),_:1}),Hi(v,{onClick:h},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"layer-down"})])),_:1}),Hi(v,{onClick:u},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"layer-upTop"})])),_:1}),Hi(v,{onClick:d},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"layer-downTop"})])),_:1})])),_:1},512),[[$i,pi(n)]])])],64)):(ui(),hi("p",BB,"暂无图层"))])}}}),TB=Or(OB,[["__scopeId","data-v-3d5052e9"]]),DB={class:"w-full h-full box-border px-10px"},MB=["onClick"],QB=["src"],LB=ai({__name:"index",props:{direction:{type:String,default:"vertical"}},setup(e){const t=e,n=ey(),i=iy(),{curTempIdx:r,templateList:o,curTemplate:a}=Nr(i),s=Si((()=>{const e=pi(a);return("vertical"===t.direction?176:64)*((e.height||0)/e.width)})),l=le((function(e){i.setTemplateIndex(e)}),250);function c(){var e;const t=pi(o)[pi(r)];t&&t.image&&t.image.startsWith("blob:")&&(URL.revokeObjectURL(t.image),null==(e=n.canvas)||e.toCanvasElement(10).toBlob((e=>{e&&(t.image=URL.createObjectURL(e))})))}return ci((()=>{var e;null==(e=n.canvas)||e.on("object:modified",c)})),or((()=>{var e;null==(e=n.canvas)||e.off("object:modified",c)})),(e,n)=>(ui(),hi("div",DB,[(ui(!0),hi(ji,null,Zi(pi(o),((e,n)=>(ui(),hi("div",{class:fi(["relative w-full box-border rounded-8px cursor-pointer",[pi(r)===n?"border-10px border-solid border-[var(--el-color-primary)]":""]]),style:Ni({height:pi(s)+"px"}),key:n,onClick:e=>pi(l)(n)},[vi("div",{class:"relative w-full border-1px border-solid border-[var(--bg-gray)] rounded-8px",style:Ni({width:"vertical"===t.direction?"184px":"64px"})},[vi("img",{class:"w-full inline-block",src:e.image},null,8,QB),vi("div",{class:fi(["inline-block flex items-center justify-center text-center absolute text-#fff bg-[rgba(0_0_0/0.6)]","horizontal"===t.direction?"left-4px bottom-8px text-10px w-14px h-14px rounded-2px leading-12px":"left-8px bottom-12px text-12px w-20px h-20px rounded-4px leading-18px"])},bi(n+1),3)],4)],14,MB)))),128))]))}}),PB=ty();function jB(){const e=PB.editor.getScale(),{width:t,height:n}=PB.editor.getWorkspaceSize()||{width:0,height:0};return{createTemplate:()=>{var i;return{id:hm(),version:vA.fabric.version,width:t,height:n,zoom:e,objects:(null==(i=PB.canvas)?void 0:i.getObjects())||[]}}}}const RB={class:"w-full relative"},FB={class:"w-full h-48px box-border px-16px border-b-1px border-b-solid border-b-[rgba(0_0_0/0.08)] mb-12px"},NB={class:"w-full h-full flex justify-between items-center"},VB={class:"h-full flex justify-start items-center text-14px"},UB={class:"flex"},zB={class:"w-full h-full flex justify-start items-center"},HB=Or(ai({__name:"index",setup(e){const t=ey(),n=iy(),{panelType:i}=Nr(t),r={canvas:LB,layer:TB},o=si(!1),a=si("canvas"),s=Si((()=>{let e="";switch(pi(a)){case"canvas":e="搜索画板";break;case"layer":e="搜索图层"}return e})),l=le((function(e){a.value=e}),250),c=le((function(){o.value=!0}),250),u=le((function(){const{createTemplate:e}=jB();n.addTemplate(e())}),250);return Ii((()=>i.value),(e=>{if(e===$m.canvas)a.value="canvas";else{if(e!==$m.layer)return"";a.value="layer"}}),{immediate:!0}),(e,t)=>{const n=Se,i=et,h=Ze;return ui(),hi("div",RB,[vi("div",FB,[Mi(vi("div",NB,[vi("ul",VB,[vi("li",{class:fi(["h-full f-center cursor-pointer select-none mr-10px",["canvas"===pi(a)?"text-#333 font-500 tab-active":""]]),onClick:t[0]||(t[0]=e=>pi(l)("canvas"))}," 画板 ",2),vi("li",{class:fi(["h-full f-center cursor-pointer select-none",["layer"===pi(a)?"text-#333 font-500 tab-active":""]]),onClick:t[1]||(t[1]=e=>pi(l)("layer"))}," 图层 ",2)]),vi("div",UB,["canvas"===pi(a)?(ui(),Ai(i,{key:0,text:"",onClick:pi(u),style:{padding:"0",width:"32px","border-radius":"6px"}},{default:mi((()=>[Hi(n,{style:{"font-size":"20px"}},{default:mi((()=>[Hi(pi(bt))])),_:1})])),_:1},8,["onClick"])):Fi("",!0),Hi(i,{text:"",onClick:pi(c),style:{padding:"0",width:"32px","border-radius":"6px",margin:"0"}},{default:mi((()=>[Hi(n,{style:{"font-size":"20px"}},{default:mi((()=>[Hi(pi(vn))])),_:1})])),_:1},8,["onClick"])])],512),[[$i,!pi(o)]]),Mi(vi("div",zB,[Hi(n,{class:"mr-8px"},{default:mi((()=>[Hi(pi(vn))])),_:1}),Hi(h,{placeholder:pi(s),onBlur:t[2]||(t[2]=e=>o.value=!1)},null,8,["placeholder"])],512),[[$i,pi(o)]])]),vi("div",null,[(ui(),Ai(Vr,null,[(ui(),Ai(yi(r[pi(a)])))],1024))])])}}}),[["__scopeId","data-v-c8b3b6bc"]]),YB={class:"box-border p-10px"};const GB=Or({},[["render",function(e,t){return ui(),hi("div",YB,"计划中")}]]),WB={class:"w-full h-fullr"},XB=vi("div",{class:"h-36px leading-36px font-bold ml-10px"},"图片",-1),$B={class:"flex justify-start items-center flex-wrap min-h-40px"},qB=["onClick"],KB={class:"text-12px mt-10px"},JB={class:"-mt-10px"},ZB=vi("div",{class:"h-36px leading-36px font-bold ml-10px"},"文字",-1),eO={class:"flex justify-start items-center flex-wrap min-h-40px"},tO=["onClick"],nO={class:"text-12px mt-10px"},iO={class:"-mt-10px"},rO=vi("div",{class:"h-36px leading-36px font-bold ml-10px"},"形状",-1),oO={class:"flex justify-start items-center flex-wrap min-h-40px"},aO=["onClick"],sO=["innerHTML"],lO={class:"-mt-10px"},cO=vi("div",{class:"h-36px leading-36px font-bold ml-10px"},"条码图片",-1),uO={class:"flex justify-start items-center flex-wrap min-h-40px"},hO=["onClick"],dO=["innerHTML"],fO=ai({__name:"index",setup(e){const{getImgStr:t,selectFiles:n}=Wm,i=ey(),r=si(!1),o=(e,t)=>h(this,null,(function*(){i.editor.clear(),i.editor.setSize(e,t),Gt.success("创建成功")})),a={shadow:"",fontFamily:"arial"};le((function(){n({accept:"image/*",multiple:!0}).then((e=>{Array.from(e).forEach((e=>{t(e).then((e=>{p(e)}))}))}))}),250);const s=le((function(e){return h(this,null,(function*(){const o=qt.service({lock:!0,body:!0});try{switch(e){case Zm.design:r.value=!0;break;case Zm.img:n({accept:"image/*",multiple:!0}).then((e=>{Array.from(e).forEach((e=>{t(e).then((e=>{p(e)}))}))}));break;case Zm.svg:n({accept:".svg",multiple:!0}).then((e=>{Array.from(e).forEach((e=>{t(e).then((e=>{!function(e){if(!e)throw new Error("file is undefined");vA.fabric.loadSVGFromURL(e,((e,t)=>{const n=vA.fabric.util.groupSVGElements(e,c(l({},t),{name:"defaultSVG",id:hm()}));i.editor.addBaseType(n,{scale:!0})}))}(e)}))}))}));break;case Zm.json:i.editor.insert();break;case Zm.psd:yield i.editor.insertPSD()}o.close()}catch(a){o.close()}}))}),250),u=le((function(e){let t;switch(e){case qm.h1:t=new vA.fabric.Textbox("双击编辑标题",c(l({},a),{fontWeight:"bold",fontSize:80,fill:"#000000"}));break;case qm.h2:t=new vA.fabric.Textbox("双击编辑标题",c(l({},a),{fontWeight:"bold",fontSize:60,fill:"#000000"}));break;case qm.normal:t=new vA.fabric.Textbox("双击编辑标题",c(l({},a),{fontSize:48,fill:"#000000"}))}t&&i.editor.addBaseType(t,{center:!0})}),250),d=le((function(e){switch(e){case Km.react:const e=new vA.fabric.Rect(c(l({},a),{fill:"#F57274FF",width:400,height:400,name:"矩形"}));i.editor.addBaseType(e,{center:!0});break;case Km.triangle:const t=new vA.fabric.Triangle(c(l({},a),{width:400,height:400,fill:"#92706BFF",name:"三角形"}));i.editor.addBaseType(t,{center:!0});break;case Km.around:const n=new vA.fabric.Circle(c(l({},a),{radius:150,fill:"#57606BFF",name:"圆形"}));i.editor.addBaseType(n,{center:!0});break;case Km.polygon:const r=new vA.fabric.Polygon(px(5,200),c(l({},a),{fill:"#CCCCCCFF",name:"多边形"}));r.set({width:400,height:400,pathOffset:{x:0,y:0}}),i.editor.addBaseType(r,{center:!0});break;case Km.line:const o=new vA.fabric.Line([100,100,10,10],c(l({},a),{stroke:"#333",fill:"#333",name:"直线"}));i.editor.addBaseType(o,{center:!0})}}),250),f=le((function(e){switch(e){case Jm.qrcode:i.editor.addQrCode();break;case Jm.barCode:i.editor.addBarcode()}}),250);function p(e){if(!e)throw new Error("file is undefined");const t=document.createElement("img");t.src=e,document.body.appendChild(t),t.onload=()=>h(this,null,(function*(){const e=yield i.editor.createImgByElement(t);i.editor.addBaseType(e,{scale:!0}),t.remove()}))}return(e,t)=>{const n=en;return ui(),hi("div",WB,[vi("section",null,[XB,vi("ul",$B,[(ui(!0),hi(ji,null,Zi(pi(Zk),(e=>(ui(),hi("li",{class:"f-center flex-col p-10px select-none cursor-pointer w-88px h-88px ml-10px mb-10px bg-#f1f2f4 rounded-12px editor-item",key:e.type,onClick:t=>pi(s)(e.type)},[Hi(n,{extClass:"text-24px",icon:e.icon,color:"#333"},null,8,["icon"]),vi("span",KB,bi(e.name),1)],8,qB)))),128))])]),vi("section",JB,[ZB,vi("ul",eO,[(ui(!0),hi(ji,null,Zi(pi(qk),(e=>(ui(),hi("li",{class:"f-center flex-col p-10px select-none cursor-pointer w-88px h-88px ml-10px mb-10px bg-#f1f2f4 rounded-12px editor-item",key:e.type,onClick:t=>pi(u)(e.type)},[Hi(n,{extClass:"text-24px",icon:e.icon,color:"#333"},null,8,["icon"]),vi("span",nO,bi(e.name),1)],8,tO)))),128))])]),vi("section",iO,[rO,vi("ul",oO,[(ui(!0),hi(ji,null,Zi(pi(Kk),(e=>(ui(),hi("li",{class:"f-center flex-col p-10px select-none cursor-pointer w-88px h-full ml-10px mb-10px bg-#f1f2f4 rounded-12px editor-item",key:e.type,onClick:t=>pi(d)(e.type)},[vi("div",{class:"w-24px h-24px",innerHTML:e.icon},null,8,sO)],8,aO)))),128))])]),vi("section",lO,[cO,vi("ul",uO,[(ui(!0),hi(ji,null,Zi(pi(Jk),(e=>(ui(),hi("li",{class:"f-center flex-col p-10px select-none cursor-pointer w-88px h-full ml-10px mb-10px bg-#f1f2f4 rounded-12px editor-item",key:e.type,onClick:t=>pi(f)(e.type)},[vi("div",{class:"w-24px h-24px",innerHTML:e.icon},null,8,dO)],8,hO)))),128))])]),Hi(Vk,{title:"新建设计",show:pi(r),"onUpdate:show":t[0]||(t[0]=e=>Qi(r)?r.value=e:null),onSet:o},null,8,["show"])])}}}),pO={class:"box-border p-10px"},gO={class:"tool-box"},vO={class:"tool-box"},AO={class:"tool-box"},mO={__name:"index",setup(e){const t=ey(),n={polygon:"polygon",freeDraw:"freeDraw",pathText:"pathText"},i={shadow:"",fontFamily:"arial"},{t:r}=Xt(),o=zi({isDrawingLineMode:!1,lineType:!1}),a=e=>{b();const n=new vA.fabric.IText(r("everything_is_fine"),c(l({},i),{fontSize:80,fill:"#000000FF"}));t.editor.addBaseType(n,{center:!0,event:e})},s=e=>{b();const n=new vA.fabric.Textbox(r("everything_goes_well"),c(l({},i),{splitByGrapheme:!0,width:400,fontSize:80,fill:"#000000FF"}));t.editor.addBaseType(n,{center:!0,event:e})},u=e=>{b();const n=new vA.fabric.Triangle(c(l({},i),{width:400,height:400,fill:"#92706BFF",name:"三角形"}));t.editor.addBaseType(n,{center:!0,event:e})},h=e=>{b();const n=new vA.fabric.Polygon(px(5,200),c(l({},i),{fill:"#CCCCCCFF",name:"多边形"}));n.set({width:400,height:400,pathOffset:{x:0,y:0}}),t.editor.addBaseType(n,{center:!0,event:e})},d=e=>{b();const n=new vA.fabric.Circle(c(l({},i),{radius:150,fill:"#57606BFF",name:"圆形"}));t.editor.addBaseType(n,{center:!0,event:e})},f=e=>{b();const n=new vA.fabric.Rect(c(l({},i),{fill:"#F57274FF",width:400,height:400,name:"矩形"}));t.editor.addBaseType(n,{center:!0,event:e})},p=()=>{const e=()=>{o.lineType=!1,o.isDrawingLineMode=!1,y(!o.isDrawingLineMode,!o.isDrawingLineMode)};o.lineType!==n.polygon?(v(),A(),o.lineType=n.polygon,o.isDrawingLineMode=!0,t.editor.beginDrawPolygon(e),t.editor.endDraw(),y(!o.isDrawingLineMode,!o.isDrawingLineMode)):t.editor.discardPolygon()},g=()=>{o.lineType===n.freeDraw?(t.editor.endDraw(),o.lineType=!1,o.isDrawingLineMode=!1):(v(),A(),o.lineType=n.freeDraw,o.isDrawingLineMode=!0,t.editor.startDraw({width:20}))},v=()=>{t.editor.discardPolygon(),t.editor.endDraw(),t.editor.endTextPathDraw()},A=()=>{o.isDrawingLineMode=!1,o.lineType="",t.editor.setMode(o.isDrawingLineMode),t.editor.setLineType(o.lineType)},m=e=>{[n.polygon,n.freeDraw,n.pathText].includes(o.lineType)&&v(),o.lineType===e?(o.isDrawingLineMode=!1,o.lineType=""):(o.isDrawingLineMode=!0,o.lineType=e),t.editor.setMode(o.isDrawingLineMode),t.editor.setLineType(e),y(!o.isDrawingLineMode,!o.isDrawingLineMode)},y=(e,n)=>{t.editor.canvas.forEachObject((t=>{"workspace"!==t.id&&(t.selectable=n,t.evented=e)}))},b=()=>{o.isDrawingLineMode&&(o.isDrawingLineMode=!1,o.lineType="",t.editor.setMode(!1),v(),y(!0,!0))};return Ur((()=>{b()})),(e,n)=>{const i=tn,r=en;return ui(),hi("div",pO,[Hi(i,{"content-position":"left"},{default:mi((()=>[Ri(bi(e.$t("editor.common_elements")),1)])),_:1}),vi("div",gO,[vi("span",{onClick:n[0]||(n[0]=()=>a()),draggable:!0,onDragend:a},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-text"})],32),vi("span",{onClick:n[1]||(n[1]=()=>s()),draggable:!0,onDragend:s},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-textBox"})],32),vi("span",{onClick:n[2]||(n[2]=()=>f()),draggable:!0,onDragend:f},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-rect"})],32),vi("span",{onClick:n[3]||(n[3]=()=>d()),draggable:!0,onDragend:d},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-circle"})],32),vi("span",{onClick:n[4]||(n[4]=()=>u()),draggable:!0,onDragend:u},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-triangle"})],32),vi("span",{onClick:n[5]||(n[5]=()=>h()),draggable:!0,onDragend:h},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-polygon"})],32)]),Hi(i,{"content-position":"left"},{default:mi((()=>[Ri(bi(e.$t("editor.draw_elements")),1)])),_:1}),vi("div",vO,[vi("span",{onClick:n[6]||(n[6]=e=>m("line")),class:fi(pi(o).isDrawingLineMode&&"line"===pi(o).lineType&&"bg")},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-draw1"})],2),vi("span",{onClick:n[7]||(n[7]=e=>m("arrow")),class:fi(pi(o).isDrawingLineMode&&"arrow"===pi(o).lineType&&"bg")},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-draw2"})],2),vi("span",{onClick:n[8]||(n[8]=e=>m("thinTailArrow")),class:fi(pi(o).isDrawingLineMode&&"thinTailArrow"===pi(o).lineType&&"bg")},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-draw3"})],2),vi("span",{onClick:p,class:fi(pi(o).isDrawingLineMode&&"polygon"===pi(o).lineType&&"bg")},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-draw4"})],2),vi("span",{onClick:g,class:fi(pi(o).isDrawingLineMode&&"freeDraw"===pi(o).lineType&&"bg")},[Hi(r,{extClass:"text-20px",icon:"editor-brush"})],2)]),Hi(i,{"content-position":"left"},{default:mi((()=>[Ri(bi(e.$t("editor.code_img")),1)])),_:1}),vi("div",AO,[vi("span",{onClick:n[9]||(n[9]=(...e)=>pi(t).editor.addQrCode&&pi(t).editor.addQrCode(...e))},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-qrCode"})]),vi("span",{onClick:n[10]||(n[10]=(...e)=>pi(t).editor.addBarcode&&pi(t).editor.addBarcode(...e))},[Hi(r,{extClass:"text-20px",color:"#333",icon:"tool-barCode"})])])])}}},yO=Or(mO,[["__scopeId","data-v-4e6231aa"]]),bO=Qr,CO=e=>Cr.get(`${bO}/api/templs/${e}`);function wO(e,t,n,i,r,o,a){var s;return s={populate:{img:"*"},filters:{},fields:a,pagination:{page:e,pageSize:o}},[{key:i,value:t,type:"$eq"},{key:r,value:n,type:"$contains"}].forEach((e=>{const{key:t,value:n,type:i}=e;n&&(s.filters[t]={[i]:n})})),Wt.stringify(s)}function xO(e){var t,n;const i=(null==(n=null==(t=null==e?void 0:e.data)?void 0:t.attributes)?void 0:n.url)||"";return bO+i}function _O(e){var t,n,i,r,o,a;const s=(null==(r=null==(i=null==(n=null==(t=null==e?void 0:e.data)?void 0:t.attributes)?void 0:n.formats)?void 0:i.small)?void 0:r.url)||(null==(a=null==(o=null==e?void 0:e.data)?void 0:o.attributes)?void 0:a.url)||"";return bO+s}function EO({typeUrl:e,listUrl:t,searchTypeKey:n,searchWordKey:i,scrollElement:r,pageSize:o,fields:a=[]}){const s=si(!1),l=si(""),c=si(""),u=si([]),d=Si((()=>{const e=u.value.find((e=>e.value===c.value));return(null==e?void 0:e.lable)||"全部"})),f=si([]),p=si(1),g=zi({page:0,pageCount:0,pageSize:10,total:0}),v=Si((()=>g.page===p.value&&g.page>=g.pageCount)),A=()=>h(this,null,(function*(){s.value=!0;try{const n=(yield(t=e,Cr.get(`${bO}/api/${t}?pagination[pageSize]=200`))).data.data.map((e=>({value:e.id,label:e.attributes.name})));u.value=[{label:"全部",value:""},...n]}catch(n){u.value=[]}var t;s.value=!1})),m=()=>h(this,null,(function*(){s.value=!0;try{const s=wO(p.value,c.value,l.value,n,i,o,a),u=yield(e=t,r=s,Cr.get(`${bO}/api/${e}?${r}`)),h=u.data.data.map((e=>{var t;return{id:e.id,name:e.attributes.name,desc:e.attributes.desc,json:null==(t=e.attributes)?void 0:t.json,src:xO(e.attributes.img),previewSrc:_O(e.attributes.img)}}));Object.keys(u.data.meta.pagination).forEach((e=>{g[e]=u.data.meta.pagination[e]})),f.value=[...f.value,...h]}catch(u){}var e,r;s.value=!1})),y=si(!1),b=si(0);return{startPage:()=>h(this,null,(function*(){const e=document.querySelector(r);b.value=e.offsetHeight,y.value=!0,yield A(),yield m()})),searchKeyWord:l,typeValue:c,typeText:d,typeList:u,pageLoading:s,pageData:f,isDownBottm:v,startGetList:()=>{f.value=[],p.value=1,m()},nextPage:()=>{p.value>=g.pageCount||(p.value++,setTimeout((()=>{m()}),1e3))},scrollHeight:b,showScroll:y,getInfo:CO}}const SO={class:"box-border p-10px"},IO={class:"search-box"},kO={style:{height:"calc(100vh - 108px)"},id:"myTemplBox"},BO={gap:10,cols:2},OO={class:"tmpl-img-box"},TO=Or({__name:"index",setup(e){const t=ey(),n=wr(),i=xr(),{t:r}=Xt(),{startPage:o,typeValue:a,typeText:s,typeList:l,pageLoading:c,pageData:u,searchKeyWord:d,isDownBottm:f,startGetList:p,nextPage:g,showScroll:v,scrollHeight:A,getInfo:m}=EO({typeUrl:"templ-types",listUrl:"templs",searchTypeKey:"templ_type",searchWordKey:"name",pageSize:10,scrollElement:"#myTemplBox",fields:["name"]});a.value=4;const y=e=>h(this,null,(function*(){const o=qt.service({text:r("alert.loading_data")}),a=yield m(e.id);i.query.admin?n.replace("/?tempId="+e.id+"&admin=true"):n.replace("/?tempId="+e.id),t.editor.loadJSON(JSON.stringify(a.data.data.attributes.json),null==o?void 0:o.close())})),b=le(p,200),C=()=>h(this,null,(function*(){if(i.query.tempId)try{const e=qt.service({text:r("alert.loading_data")}),n=yield m(i.query.tempId);t.editor.loadJSON(JSON.stringify(n.data.data.attributes.json),null==e?void 0:e.close())}catch(e){}})),w=si(),x=si(0),_=ce((function(e){if(pi(c))return;const t=w.value.wrapRef;w.value.moveY=100*t.scrollTop/t.clientHeight,w.value.moveX=100*t.scrollLeft/t.clientWidth;let n=t.scrollHeight-t.clientHeight;e.scrollTop+2>=n&&(x.value=e.scrollTop,g())}),300);return ci((()=>{o(),C()})),(e,t)=>{const n=tv,i=ev,o=Ze,h=Tg,g=nt,m=tn,C=Dt,x=An;return ui(),hi("div",SO,[vi("div",IO,[Hi(i,{class:"select",modelValue:pi(a),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(a)?a.value=e:null),onChange:pi(b),disabled:pi(c),placeholder:"请选择"},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(l),(e=>(ui(),Ai(n,{value:e.value,label:e.label,key:e.value},null,8,["value","label"])))),128))])),_:1},8,["modelValue","onChange","disabled"]),Hi(o,{class:"input",placeholder:`在${pi(s)}中搜索`,modelValue:pi(d),"onUpdate:modelValue":t[1]||(t[1]=e=>Qi(d)?d.value=e:null),search:"",disabled:pi(c),onKeyup:Xi(pi(p),["enter"])},null,8,["placeholder","modelValue","disabled","onKeyup"])]),Mi((ui(),hi("div",kO,[pi(v)?(ui(),Ai(C,{ref_key:"scrollbarRef",ref:w,key:"mysscroll",onScroll:pi(_),height:pi(A)},{default:mi((()=>[vi("wc-waterfall",BO,[(ui(!0),hi(ji,null,Zi(pi(u),(e=>(ui(),Ai(g,{content:e.name,key:e.src,placement:"top"},{default:mi((()=>[vi("div",OO,[Hi(h,{src:e.previewSrc,fit:"contain",height:"100%",alt:e.name,onClick:t=>(e=>{$t({title:r("common.tip"),message:`${r("editor.tip.replaceTip")}`,showCancelButton:!0,confirmButtonText:r("common.ok"),cancelButtonText:r("common.cancel")}).then((()=>y(e)))})(e)},null,8,["src","alt","onClick"])])])),_:2},1032,["content"])))),128))]),pi(f)?(ui(),Ai(m,{key:0},{default:mi((()=>[Ri("已经到底了")])),_:1})):Fi("",!0)])),_:1},8,["onScroll","height"])):Fi("",!0)])),[[x,pi(c)]])])}}},[["__scopeId","data-v-519d01b3"]]),DO={class:"search-box"},MO=Or({__name:"SearchType",props:{typeListApi:{type:Function,Object:()=>({})}},emits:["change"],setup(e,{expose:t,emit:n}){const i=e,r=n,o=si(!1),a=si(""),s=si(""),l=si([]),c=Si((()=>{const e=l.value.find((e=>e.value===a.value));return(null==e?void 0:e.label)||"全部"}));ci((()=>h(this,null,(function*(){o.value=!0;try{const e=(yield i.typeListApi()).data.data.map((e=>({value:e.id,label:e.attributes.name})));l.value=[{label:"全部",value:""},...e]}catch(e){}o.value=!1}))));const u=()=>{r("change",{searchKeyWord:s.value,typeValue:a.value})},d=()=>{a.value="",s.value="",u()},f=le(u,300);return t({setType:e=>{a.value=e}}),(e,t)=>{const n=et,i=tv,r=ev,h=Ze;return ui(),hi("div",DO,[pi(a)||pi(s)?(ui(),Ai(n,{key:0,text:"",class:"back-btn",onClick:d,icon:pi(mn)},null,8,["icon"])):Fi("",!0),Hi(r,{class:"select",modelValue:pi(a),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(a)?a.value=e:null),disabled:pi(o),placeholder:"请选择",onChange:u},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(l),(e=>(ui(),Ai(i,{value:e.value,label:e.label,key:e.value},null,8,["value","label"])))),128))])),_:1},8,["modelValue","disabled"]),Hi(h,{class:"input",placeholder:`在${pi(c)}中搜索`,modelValue:pi(s),"onUpdate:modelValue":t[1]||(t[1]=e=>Qi(s)?s.value=e:null),disabled:pi(o),clearable:"",onChange:pi(f),onSearch:u,search:""},null,8,["placeholder","modelValue","disabled","onChange"])])}}},[["__scopeId","data-v-6dc45053"]]),QO={class:"material-type"},LO={class:"top"},PO={class:"img-box"},jO=["onClick","onDragend"],RO={__name:"TypeList",props:{typeApi:{type:Function},typeListApi:{type:Function},typeKey:{type:String},formatData:{type:Function}},emits:["click","dragend"],setup(e,{emit:t}){const n=t,i=e,r=si([]),o=()=>h(this,null,(function*(){const e=yield i.typeApi();r.value=e.data.data.map((e=>({name:e.attributes.name,id:e.id,list:[]})))})),a=()=>h(this,null,(function*(){let e=0;for(const t of r.value){const n=yield i.typeListApi({populate:{img:"*"},filters:{[i.typeKey]:{$eq:t.id}},pagination:{page:1,pageSize:8}});r.value[e].list=i.formatData(n.data.data),e++}}));return ci((()=>h(this,null,(function*(){yield o(),yield a()})))),(e,t)=>{const i=et,o=Tg;return ui(),hi("div",QO,[(ui(!0),hi(ji,null,Zi(pi(r),(e=>(ui(),hi("div",{class:"item",key:e.id},[vi("div",LO,[vi("h3",null,bi(e.name),1),Hi(i,{link:"",size:"small",onClick:t=>n("selectType",e.id)},{default:mi((()=>[Ri("查看更多")])),_:2},1032,["onClick"])]),vi("div",PO,[(ui(!0),hi(ji,null,Zi(e.list,(e=>(ui(),hi("div",{class:"img-item",key:e.id,onClick:t=>n("click",{info:e,e:t}),onDragend:t=>n("dragend",{info:e,e:t})},[Hi(o,{lazy:"",src:e.src,fit:"contain",width:"100%",height:"100%",alt:e.name},null,8,["src","alt"])],40,jO)))),128))])])))),128))])}}},FO=Or(RO,[["__scopeId","data-v-bfc18003"]]),NO=["id"],VO={key:0,class:"img-box"},UO=Or({__name:"PageList",props:{pageListApi:{type:Function},filters:{type:Object},DOMId:{type:String,default:""},formatData:{type:Function}},emits:["back","click","dragend"],setup(e,{expose:t,emit:n}){const i=n,r=e,{pageData:o,showScroll:a,scrollHeight:s,isDownBottom:l,pageLoading:c,startPage:u,startGetList:d,nextPage:f}=ln({el:"#"+r.DOMId,apiClient:r.pageListApi,filters:r.filters,sort:[],fields:[],formatData:r.formatData}),p=si(),g=si(0),v=ce((function(e){if(pi(c))return;const t=p.value.wrapRef;p.value.moveY=100*t.scrollTop/t.clientHeight,p.value.moveX=100*t.scrollLeft/t.clientWidth;let n=t.scrollHeight-t.clientHeight;e.scrollTop+2>=n&&(g.value=e.scrollTop,f())}),300);return ci((()=>h(this,null,(function*(){u()})))),t({startGetList:d,startPage:u}),(e,t)=>{const n=Tg,u=nt,h=tn,d=Dt,f=An;return Mi((ui(),hi("div",{class:"page-list-box",style:{height:"calc(100vh - 100px)"},id:r.DOMId,"element-loading-text":"Loading...","element-loading-svg-view-box":"-10, -10, 50, 50","element-loading-background":"rgba(122, 122, 122, 0.8)"},[pi(a)?(ui(),Ai(d,{ref_key:"scrollbarRef",ref:p,key:r.DOMId,height:pi(s),onScroll:pi(v)},{default:mi((()=>[pi(o).length?(ui(),hi("div",VO,[(ui(!0),hi(ji,null,Zi(pi(o),(e=>(ui(),hi("div",{class:"img-item",key:e.id},[Hi(u,{content:e.name,placement:"top"},{default:mi((()=>[Hi(n,{lazy:"",src:e.src,fit:"contain",style:{width:"90px",height:"90px"},alt:e.name,onClick:t=>i("click",{info:e,e:t}),onDragend:t=>i("dragend",{info:e,e:t})},null,8,["src","alt","onClick","onDragend"])])),_:2},1032,["content"])])))),128))])):Fi("",!0),pi(l)?(ui(),Ai(h,{key:1},{default:mi((()=>[Ri(bi(pi(o).length?"已经到底了":"暂无内容"),1)])),_:1})):Fi("",!0)])),_:1},8,["height","onScroll"])):Fi("",!0)],8,NO)),[[f,pi(c)]])}}},[["__scopeId","data-v-3e213793"]]),zO=ty();function HO(){const e=()=>{var e;return null==(e=zO.canvas)?void 0:e.getSelectionElement().getBoundingClientRect()};return{getCanvasBound:e,isOutsideCanvas:(t,n)=>{const{left:i,right:r,top:o,bottom:a}=e();return t<i||t>r||n<o||n>a}}}const YO={class:"box-border p-10px"},GO={__name:"index",setup(e){const t=ey(),{isOutsideCanvas:n}=HO(),i=si(),r=zi({material_type:{$contains:""},name:{$contains:""}}),o=e=>e.map((e=>({id:e.id,name:e.attributes.name,desc:e.attributes.desc,src:cn(e.attributes.img),previewSrc:un(e.attributes.img)}))),a=e=>h(this,[e],(function*({searchKeyWord:e,typeValue:t}){r.name.$contains="",r.material_type.$contains="",yield ki(),r.name.$contains=e,r.material_type.$contains=t})),s=e=>h(this,null,(function*(){r.material_type.$contains=e,i.value.setType(e),yield ki()})),l=e=>h(this,[e],(function*({e:e}){if(n(e.clientX,e.clientY))return;const i=yield t.editor.createImgByElement(e.target);t.editor.addBaseType(i,{scale:!0,event:e})})),c=e=>h(this,[e],(function*({e:e}){const n=yield t.editor.createImgByElement(e.target);t.editor.addBaseType(n,{scale:!0})}));return ci((()=>h(this,null,(function*(){var e;const t=xr();if(null==(e=null==t?void 0:t.query)?void 0:e.loadFile){const e=t.query.loadFile,n=yield Wm.insertImgFile(e);c({target:n})}})))),(e,t)=>(ui(),hi("div",YO,[Hi(MO,{ref_key:"selectTypeRef",ref:i,typeListApi:pi(yn),onChange:a},null,8,["typeListApi"]),Mi(Hi(FO,{typeApi:pi(yn),typeListApi:pi(bn),typeKey:"material_type",formatData:o,onSelectType:s,onClick:c,onDragend:l},null,8,["typeApi","typeListApi"]),[[$i,!pi(r).material_type.$contains&&!pi(r).name.$contains]]),pi(r).material_type.$contains||pi(r).name.$contains?(ui(),Ai(UO,{key:0,DOMId:"materialList",pageListApi:pi(Cn),filters:pi(r),onClick:c,formatData:o,onDragend:l},null,8,["pageListApi","filters"])):Fi("",!0)]))}},WO={class:"box-border p-10px"},XO={__name:"index",setup(e){const t=ey(),{t:n}=Xt(),{isOutsideCanvas:i}=HO(),r=e=>h(this,[e],(function*({e:e,info:r}){if(i(e.clientX,e.clientY))return;const o=qt.service({text:n("alert.loading_data")});yield t.editor.downFontByJSON(JSON.stringify(r.json));const s=JSON.parse(JSON.stringify(r.json)),l=a(s.type);new vA.fabric[l].fromObject(s,(n=>{t.editor.addBaseType(n,{event:e}),o.close()}))})),o=e=>h(this,[e],(function*({info:e}){const i=qt.service({text:n("alert.loading_data")});yield t.editor.downFontByJSON(JSON.stringify(e.json));const r=JSON.parse(JSON.stringify(e.json));r.id=hm();const o=a(r.type);new vA.fabric[o].fromObject(r,(e=>{t.editor.addBaseType(e),i.close()}))}));function a(e){return e.charAt(0).toUpperCase()+e.slice(1)}const s=si(),l=zi({font_style_type:{$contains:""},name:{$contains:""}}),c=e=>e.map((e=>({id:e.id,name:e.attributes.name,desc:e.attributes.desc,json:e.attributes.json,src:cn(e.attributes.img),previewSrc:un(e.attributes.img)}))),u=e=>h(this,[e],(function*({searchKeyWord:e,typeValue:t}){l.name.$contains="",l.font_style_type.$contains="",yield ki(),l.name.$contains=e,l.font_style_type.$contains=t})),d=e=>h(this,null,(function*(){l.font_style_type.$contains=e,s.value.setType(e),yield ki()}));return(e,t)=>{var n,i,a,h;return ui(),hi("div",WO,[Hi(MO,{ref_key:"selectTypeRef",ref:s,typeListApi:pi(wn),onChange:u},null,8,["typeListApi"]),Mi(Hi(FO,{typeApi:pi(wn),typeListApi:pi(xn),typeKey:"font_style_type",formatData:c,onSelectType:d,onClick:o,onDragend:r},null,8,["typeApi","typeListApi"]),[[$i,!(null==(n=pi(l))?void 0:n.font_style_type.$contains)&&!(null==(i=pi(l))?void 0:i.name.$contains)]]),(null==(a=pi(l))?void 0:a.font_style_type.$contains)||(null==(h=pi(l))?void 0:h.name.$contains)?(ui(),Ai(UO,{key:0,DOMId:"fontMaterialList",pageListApi:pi(_n),filters:pi(l),formatData:c,onClick:o,onDragend:r},null,8,["pageListApi","filters"])):Fi("",!0)])}}},$O={class:"flex justify-start max-w-384px basis-72px"},qO={class:"relative bg-#fff z-1 w-72px flex flex-col items-center pt-10px box-border border-r-#eef2f8 border-r-solid border-r-1px"},KO=["onClick"],JO=[(e=>(Tr("data-v-3fd73b33"),e=e(),Dr(),e))((()=>vi("img",{src:"data:image/svg+xml,%3csvg%20width='15'%20height='92'%20viewBox='0%200%2015%2092'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2%2092L2%200H3C3%203.77087%204.42026%207.40332%206.97794%2010.1742L10.4917%2013.9807C13.3904%2017.121%2015%2021.2378%2015%2025.5115V66.626C15%2071.0146%2013.3028%2075.2332%2010.2636%2078.399L7.1792%2081.6119C4.4975%2084.4054%203%2088.1277%203%2092H2Z'%20fill='white'/%3e%3cpath%20d='M2%2092H3C3%2088.1277%204.4975%2084.4054%207.17919%2081.612L10.2636%2078.3991C13.3028%2075.2332%2015%2071.0147%2015%2066.6261V25.5115C15%2021.2379%2013.3904%2017.121%2010.4917%2013.9807L6.97795%2010.1742C4.42026%207.40337%203%203.77085%203%200H2C2%201.91731%202.34422%203.80108%203%205.56777C3.71995%207.50734%204.81541%209.30577%206.24314%2010.8525L9.75686%2014.659C12.4851%2017.6146%2014%2021.4892%2014%2025.5115V66.6261C14%2070.7565%2012.4027%2074.7269%209.5422%2077.7066L6.4578%2080.9195C4.92573%2082.5154%203.75601%2084.3955%203%2086.4322C2.34449%2088.1982%202%2090.0818%202%2092Z'%20fill='black'%20fill-opacity='0.08'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M8.44061%2041.6074L9.05932%2042.2261L5.28535%2046.0001L9.05932%2049.7741L8.44061%2050.3928L4.04791%2046.0001L8.44061%2041.6074Z'%20fill='%234C535C'/%3e%3c/svg%3e"},null,-1)))],ZO=Or(ai({__name:"index",setup(e){const t=ey(),{panelType:n,showPanel:i,tabType:r,panelPositoin:o}=Nr(t),a={[Xm.create]:fO,[Xm.template]:TO,[Xm.element]:yO,[Xm.ai]:GB,[Xm.text]:XO,[Xm.material]:GO,[Xm.mine]:bB,[Xm.none]:""},s=le((function(){t.setShowPanel(!1),l.value=Xm.none}),250),l=si(Xm.template),c=le((function(e,r){l.value=e,!pi(i)&&t.setShowPanel(!0),"bottom"===pi(o)&&t.setPanelPositoin("left"),pi(n)!==$m.menu&&(n.value=r),t.setTabType(e)}),250);return Ii((()=>r.value),(e=>{pi(l)!==e&&(l.value=e)})),(e,t)=>{const r=en;return ui(),hi("section",$O,[vi("ul",qO,[(ui(!0),hi(ji,null,Zi(pi($k),(e=>(ui(),hi("li",{class:"flex flex-col items-center mb-20px cursor-pointer",key:e.type,onClick:t=>pi(c)(e.type,pi($m).menu)},[vi("div",{class:fi(["px-10px f-center py-4px rounded-10px tab-item editor-item",[pi(l)===e.type?"tab-item_active":""]])},[Hi(r,{extClass:"text-20px",icon:e.icon,color:pi(l)===e.type?"#000":"#333"},null,8,["icon","color"])],2),vi("span",{class:fi(["text-12px",[pi(l)===e.type?"font-bold":""]])},bi(e.name),3)],8,KO)))),128))]),"left"===pi(o)?(ui(),hi("div",{key:0,class:fi(["relative h-full transition-all transition-ease left-style-panel",[pi(i)?"":"-ml-312px",pi(n)===pi($m).menu?"w-312px":"w-224px"]])},[pi(i)&&pi(n)===pi($m).menu?(ui(),hi(ji,{key:0},[(ui(),Ai(Vr,null,[(ui(),Ai(yi(a[pi(l)])))],1024)),vi("div",{class:"inline-block absolute -right-13px top-50% -translate-y-50% z-1 cursor-pointer",onClick:t[0]||(t[0]=(...e)=>pi(s)&&pi(s)(...e))},JO)],64)):(ui(),Ai(pi(HB),{key:1}))],2)):Fi("",!0)])}}}),[["__scopeId","data-v-3fd73b33"]]),eT={class:"absolute right-10px bottom-10px"},tT=ai({__name:"Zoom",setup(e){const t=ey(),n=si(!1),i=e=>{e?t.editor.startDring():t.editor.endDring()},r=()=>{t.editor.one()},o=()=>{t.editor.big()},a=()=>{t.editor.auto()};return ci((()=>{ki((()=>{var e,i;null==(e=t.editor)||e.on("startDring",(()=>n.value=!0)),null==(i=t.editor)||i.on("endDring",(()=>n.value=!1))}))})),or((()=>{var e,n;null==(e=t.editor)||e.off("startDring"),null==(n=t.editor)||n.off("endDring")})),(e,t)=>{const s=Vv,l=en,c=et,u=gn;return ui(),hi("div",eT,[Hi(s,{modelValue:pi(n),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(n)?n.value=e:null),size:"large",class:"mr-10px","inline-prompt":"","active-text":"拖曳","inactive-text":"拖曳",onChange:i},null,8,["modelValue"]),Hi(u,null,{default:mi((()=>[Hi(c,{onClick:o},{default:mi((()=>[Hi(l,{extClass:"text-20px",color:"var(--color)",icon:"zoom-big"})])),_:1}),Hi(c,{onClick:r,icon:pi(rt)},null,8,["icon"]),Hi(c,{onClick:a},{default:mi((()=>[Hi(l,{extClass:"text-20px",color:"var(--color)",icon:"zoom-small"})])),_:1})])),_:1})])}}}),nT={class:"box"},iT={__name:"DragMode",setup(e){const t=ey(),n=si(!1),i=e=>{var n,i;e?null==(n=t.editor)||n.startDring():null==(i=t.editor)||i.endDring()};return ci((()=>{ki((()=>{var e,i;null==(e=t.editor)||e.on("startDring",(()=>n.value=!0)),null==(i=t.editor)||i.on("endDring",(()=>n.value=!1))}))})),or((()=>{var e,n;null==(e=t.editor)||e.off("startDring"),null==(n=t.editor)||n.off("endDring")})),(e,t)=>{const r=Vv;return ui(),hi("div",nT,[Hi(r,{size:"large",modelValue:pi(n),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(n)?n.value=e:null),onChange:i,width:"60","inline-prompt":"","active-text":"Drag","inactive-text":"Drag"},null,8,["modelValue"])])}}},rT=e=>(Tr("data-v-53e577b4"),e=e(),Dr(),e),oT={class:"w-full absolute left-0 right-0 bottom-0"},aT={class:"main-bottom relative bottom-0"},sT={class:"flex justify-between items-start"},lT={class:"flex justify-start items-center"},cT=rT((()=>vi("div",{class:"text-14px h-24px leading-24px"},[vi("span",{class:"mr-4px"},"画板"),vi("span",null,"1/1")],-1))),uT={class:"flex justify-end items-center"},hT={key:0,class:"main-panel mt-8px bg-#fff box-border rounded-12px"},dT=[rT((()=>vi("div",{class:"pb-1px mx-6px"}," 1 ",-1)))],fT=Or(ai({__name:"index",setup(e){const t=ey(),{panelPositoin:n,showPanel:i,panelType:r}=Nr(t),o=le((function(e){pi(r)===e?(t.setShowPanel(!pi(i)),"bottom"===pi(n)&&t.setPanelPositoin("left")):(t.setPanelType(e),t.setShowPanel(!0))}),250),a=le((function(){t.setShowPanel(!pi(i))}),250),s=le((function(){t.setPanelPositoin("left"===pi(n)?"bottom":"left"),!pi(i)&&t.setShowPanel(!0)}),250);return(e,t)=>{const r=en,l=tn,c=iT,u=tT;return ui(),hi("div",oT,[vi("div",aT,[vi("div",sT,[vi("div",lT,[vi("div",{class:"f-center p-5px rounded-6px cursor-pointer bg-#fff",onClick:t[0]||(t[0]=Li((e=>pi(o)(pi($m).layer)),["stop"]))},[Hi(r,{icon:"editor-layer",extClass:"text-20px"})]),vi("div",{class:"ml-4px f-center p-4px rounded-6px cursor-pointer bg-#fff panel-canvas",onClick:t[3]||(t[3]=e=>pi(o)(pi($m).canvas))},[cT,vi("div",{class:fi(["ml-4px",["bottom"===pi(n)?"rotate-270":""]]),onClick:t[1]||(t[1]=Li(((...e)=>pi(a)&&pi(a)(...e)),["stop"]))},[Hi(r,{icon:"unfold",extClass:"text-16px"})],2),vi("div",{class:"hidden panel-position items-center",onClick:t[2]||(t[2]=Li(((...e)=>pi(s)&&pi(s)(...e)),["stop"]))},[Hi(l,{direction:"vertical"}),Hi(r,{class:fi(["bottom"===pi(n)?"rotate-270":""]),icon:"panel-position",extClass:"text-16px"},null,8,["class"])])])]),vi("div",uT,[Hi(c),Hi(u)])]),"bottom"===pi(n)&&pi(i)?(ui(),hi("div",hT,dT)):Fi("",!0)])])}}}),[["__scopeId","data-v-53e577b4"]]),pT={class:"flex-1 w-full relative overflow-hidden",id:"workspace"},gT={class:"relative"},vT=(e=>(Tr("data-v-06a4c87a"),e=e(),Dr(),e))((()=>vi("div",{class:"absolute w-full z-2 inside-shadow"},null,-1))),AT=Or(ai({__name:"index",setup(e){const t=ey(),n=Si((()=>t.rulerEnable));return(e,t)=>(ui(),hi("section",pT,[vi("div",gT,[vT,vi("canvas",{class:fi(["w-300px h-300px mx-auto",pi(n)?"design-stage-grid":""]),id:"canvas"},null,2),Hi(fT)])]))}}),[["__scopeId","data-v-06a4c87a"]]),mT={key:0,class:"mb-10px attr-item-box"},yT=vi("h4",null,"数据",-1),bT=ai({__name:"AttributeId",setup(e){const t=ey(),{isOne:n}=_B(),i=Ci(),r=zi({id:0,linkData:["",""]}),o=e=>{var n;const i=null==(n=t.canvas)?void 0:n.getActiveObject();e&&e.target&&e.target!==i||i&&(r.id=i.get("id"),r.linkData=i.get("linkData")||["",""])},a=(e,n)=>{var i,r;const o=null==(i=t.canvas)?void 0:i.getActiveObjects()[0];o&&(o&&o.set(e,n),null==(r=t.canvas)||r.renderAll())},s=()=>{var e;null==(e=null==i?void 0:i.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,n,i;o(),null==(e=t.editor)||e.on("selectCancel",s),null==(n=t.editor)||n.on("selectOne",o),null==(i=t.canvas)||i.on("object:modified",o)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",s),null==(n=t.editor)||n.off("selectOne",o),null==(i=t.canvas)||i.off("object:modified",o)})),(e,t)=>{const i=tn,o=Ze,s=En,l=Sn,c=tv,u=ev,h=Ep,d=wp;return pi(n)?(ui(),hi("div",mT,[Hi(i,{"content-position":"left"},{default:mi((()=>[yT])),_:1}),Hi(l,{"label-width":40,class:"form-wrap"},{default:mi((()=>[Hi(s,{label:e.$t("editor.attributes.id")},{default:mi((()=>[Hi(o,{modelValue:pi(r).id,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(r).id=e),onChange:t[1]||(t[1]=e=>a("id",pi(r).id)),size:"small"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),Hi(d,{gutter:10},{default:mi((()=>[Hi(h,{span:12},{default:mi((()=>[Hi(u,{modelValue:pi(r).linkData[0],"onUpdate:modelValue":t[2]||(t[2]=e=>pi(r).linkData[0]=e),filterable:"","allow-create":"",onChange:t[3]||(t[3]=e=>a("linkData",pi(r).linkData))},{default:mi((()=>[Hi(c,{value:"src"}),Hi(c,{value:"text"})])),_:1},8,["modelValue"])])),_:1}),Hi(h,{span:12},{default:mi((()=>[Hi(o,{modelValue:pi(r).linkData[1],"onUpdate:modelValue":t[4]||(t[4]=e=>pi(r).linkData[1]=e),placeholder:"请输入"},null,8,["modelValue"])])),_:1})])),_:1})])):Fi("",!0)}}});function CT(e,t){return void 0===t&&(t=15),+parseFloat(Number(e).toPrecision(t))}function wT(e){var t=e.toString().split(/[eE]/),n=(t[0].split(".")[1]||"").length-+(t[1]||0);return n>0?n:0}function xT(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));var t=wT(e);return t>0?CT(Number(e)*Math.pow(10,t)):Number(e)}function _T(e){OT&&(e>Number.MAX_SAFE_INTEGER||Number.MIN_SAFE_INTEGER)}function ET(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t[0];return t.slice(1).reduce((function(t,n){return e(t,n)}),i)}}var ST=ET((function(e,t){var n=xT(e),i=xT(t),r=wT(e)+wT(t),o=n*i;return _T(o),o/Math.pow(10,r)})),IT=ET((function(e,t){var n=Math.pow(10,Math.max(wT(e),wT(t)));return(ST(e,n)+ST(t,n))/n})),kT=ET((function(e,t){var n=Math.pow(10,Math.max(wT(e),wT(t)));return(ST(e,n)-ST(t,n))/n})),BT=ET((function(e,t){var n=xT(e),i=xT(t);return _T(n),_T(i),ST(n/i,CT(Math.pow(10,wT(t)-wT(e))))}));var OT=!0;var TT={strip:CT,plus:IT,minus:kT,times:ST,divide:BT,round:function(e,t){var n=Math.pow(10,t),i=BT(Math.round(Math.abs(ST(e,n))),n);return e<0&&0!==i&&(i=ST(i,-1)),i},digitLength:wT,float2Fixed:xT,enableBoundaryChecking:function(e){void 0===e&&(e=!0),OT=e}};const DT=["aria-valuemax","aria-valuemin","aria-valuenow","value","disabled","autofocus","readonly","placeholder"],MT="asa-input-number",QT=Or(ai({__name:"InputNumber",props:{autofocus:{type:Boolean},parser:{},formatter:{},min:{default:-1/0},max:{default:1/0},precision:{default:2},step:{default:1},modelValue:{},defaultValue:{},modelEvent:{default:"change"},controlsOutside:{type:Boolean},hideButton:{type:Boolean},downDisabled:{type:Boolean},upDisabled:{type:Boolean},size:{default:"default"},disabled:{type:Boolean},readonly:{type:Boolean},placeholder:{},append:{},prepend:{}},emits:["update:modelValue","on-change","on-focus","on-blur","on-input"],setup(e,{expose:t,emit:n}){var i;TT.enableBoundaryChecking(!1);const r=e,o=n,a=si(`${MT}-input-wrap`),s=si(`${MT}-input`),l=si(`${MT}-handler-wrap`),c=si([`${MT}-handler`,`${MT}-handler-up`,{[`${MT}-handler-up-disabled`]:r.upDisabled}]),u=si([`${MT}-handler`,`${MT}-handler-down`,{[`${MT}-handler-down-disabled`]:r.downDisabled}]),h=si(!1),d=Si((()=>[`${MT}`,{[`${MT}-${r.size}`]:!!r.size,[`${MT}-disabled`]:r.disabled,[`${MT}-focused`]:h.value,[`${MT}-controls-outside`]:r.controlsOutside}])),f=si(),p=Si((()=>{if(Hc(r.precision)){const e=`${r.step}`.split(".")[1],t=e&&e.length||0;return Math.max(t,r.precision)}})),g=e=>{var t,n;if(!Hc(e))return"";const i=p.value?e.toFixed(p.value).replace(/\.?0+$/,""):String(e);return null!=(n=null==(t=r.formatter)?void 0:t.call(r,i))?n:i},v=si(g(null!=(i=r.modelValue)?i:r.defaultValue)),A=e=>{h.value=!0,o("on-focus",e)},m=e=>{h.value=!1,o("on-blur",e)},y=e=>{S(e,"minus",!0)},b=e=>{S(e,"plus",!0)},C=e=>{"ArrowUp"===e.key?(e.preventDefault(),!r.readonly&&w("plus",e)):"ArrowDown"===e.key&&(e.preventDefault(),!r.readonly&&w("minus",e))},w=(e,t)=>{if("plus"===e&&(B.value||r.upDisabled)||"minus"===e&&(k.value||r.downDisabled))return;let n;n=Hc(I.value)?D(TT[e](I.value,r.step)):r.min===-1/0?0:r.min,v.value=g(n),O(n),o("update:modelValue",n),o("on-change",n,t)};let x=0;const _=()=>{x&&(window.clearTimeout(x),x=0)},E={onMouseup:_,onMouseleave:_},S=(e,t,n=!1)=>{var i;e.preventDefault(),null==(i=f.value)||i.focus(),w(t,e),n&&(x=window.setTimeout((()=>e.target.dispatchEvent(e)),150))},I=Si((()=>{var e,t;if(!v.value)return;const n=Number(null!=(t=null==(e=r.parser)?void 0:e.call(r,v.value))?t:v.value);return Number.isNaN(n)?void 0:n})),k=si(Hc(I.value)&&I.value<=r.min),B=si(Hc(I.value)&&I.value>=r.max),O=e=>{let t=!1,n=!1;Hc(e)&&(e<=r.min&&(t=!0),e>=r.max&&(n=!0)),B.value!==n&&(B.value=n),k.value!==t&&(k.value=t)},T=e=>{var t,n,i,a;let{value:s}=e.target;s=s.trim().replace(/。/g,"."),s=null!=(n=null==(t=r.parser)?void 0:t.call(r,s))?n:s,(Hc(Number(s))||/^(\.|-)$/.test(s))&&(v.value=null!=(a=null==(i=r.formatter)?void 0:i.call(r,s))?a:s,O(I.value),"input"===r.modelEvent&&o("update:modelValue",I.value),o("on-input",I.value,v.value,e))},D=e=>{if(!ve(e))return Hc(r.min)&&e<r.min&&(e=r.min),Hc(r.max)&&e>r.max&&(e=r.max),Hc(p.value)?TT.round(e,p.value):e},M=e=>{const t=D(I.value),n=g(t);t===I.value&&v.value===n||(v.value=n,O(t)),ki((()=>{Hc(r.modelValue)&&r.modelValue!==t&&(v.value=g(r.modelValue),O(r.modelValue))})),o("update:modelValue",t),o("on-change",t,e)},Q=()=>{const e=D(I.value),t=g(e);e===I.value&&v.value===t||(v.value=t),o("update:modelValue",e)},L=si(),P=si(),j=e=>{const t=si(),{posStart:n,posEnd:i}=Rm(e,{threshold:0,onSwipeStart:()=>{t.value=I.value},onSwipe:e=>{if(!Hc(t.value))return;const o=t.value+TT.round(i.x-n.x,0)*r.step;v.value=g(o),"input"===r.modelEvent?T(e):M(e)}})};return ci((()=>{L.value&&j(L),P.value&&j(P)})),Ii((()=>r.modelValue),(e=>{e!==I.value&&(v.value=g(e),O(e))})),Ii((()=>r.min),(e=>{const t=Hc(I.value)&&I.value<=e;k.value!==t&&(k.value=t);Hc(I.value)&&I.value<e&&Q()})),Ii((()=>r.max),(e=>{const t=Hc(I.value)&&I.value>=e;B.value!==t&&(B.value=t);Hc(I.value)&&I.value>e&&Q()})),t({minus:y,plus:b,input:f.value,focus:()=>{var e;null==(e=f.value)||e.focus()},blur:()=>{var e;null==(e=f.value)||e.blur()}}),(e,t)=>{const n=Se;return ui(),hi("div",{class:fi(pi(d))},[e.controlsOutside?(ui(),hi(ji,{key:0},[vi("div",Gi({class:["el-input-number--default is-controls-right el-input-number--default is-controls-right",{"el-input-number--default is-controls-right":e.downDisabled}],onMousedown:y},E),null,16),vi("div",Gi({class:["el-input-number--default is-controls-right el-input-number--default is-controls-right",{"el-input-number--default is-controls-right":e.upDisabled}],onMousedown:b},E)," 2 ",16)],64)):e.hideButton?Fi("",!0):(ui(),hi("div",{key:1,class:fi(pi(l))},[vi("a",Gi({class:pi(c),onMousedown:b},E),[vi("span",null,[Hi(n,{size:"12px",color:"#999"},{default:mi((()=>[Hi(pi(yt))])),_:1})])],16),vi("a",Gi({class:pi(u),onMousedown:y},E),[vi("span",null,[Hi(n,{size:"12px",color:"#999"},{default:mi((()=>[Hi(pi(tt))])),_:1})])],16)],2)),vi("div",{class:fi(pi(a))},[e.$slots.prefix?di(e.$slots,"prefix",{key:0},void 0,!0):e.append?(ui(),hi("label",{key:1,ref_key:"appendLabelRef",ref:L,class:fi(`${pi(a)}__label`)},bi(e.append),3)):Fi("",!0),vi("input",{ref_key:"inputRef",ref:f,type:"text",autocomplete:"off",spellcheck:"false",role:"spinbutton","aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":pi(v),value:pi(v),class:fi(pi(s)),disabled:e.disabled,autofocus:e.autofocus,readonly:e.readonly,placeholder:e.placeholder,onFocus:A,onBlur:m,onInput:T,onChange:M,onKeydown:C},null,42,DT),e.$slots.suffix?di(e.$slots,"suffix",{key:2},void 0,!0):e.prepend?(ui(),hi("label",{key:3,ref_key:"prependLabelRef",ref:P,class:fi(`${pi(a)}__label`)},bi(e.prepend),3)):Fi("",!0)],2)],2)}}}),[["__scopeId","data-v-d655ccac"]]),LT={key:0,class:"box attr-item-box"},PT=vi("h4",null,"圆角",-1),jT=ai({__name:"AttributeRounded",setup(e){const t=ey(),n=Ci(),{isOne:i,isMatchType:r}=_B(["rect"]),o=zi({rx:0,ry:0}),a=e=>{var n;const i=null==(n=t.canvas)?void 0:n.getActiveObject();e&&e.target&&e.target!==i||i&&(o.rx=i.get("rx"),o.ry=i.get("ry"))},s=e=>{const n=t.canvas.getActiveObjects()[0];n&&(n.set("ry",e),n.set("rx",e),t.canvas.renderAll())},l=()=>{var e;null==(e=null==n?void 0:n.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,n,i;a(),null==(e=t.editor)||e.on("selectCancel",l),null==(n=t.editor)||n.on("selectOne",a),null==(i=t.canvas)||i.on("object:modified",a)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",l),null==(n=t.editor)||n.off("selectOne",a),null==(i=t.canvas)||i.off("object:modified",a)})),(e,t)=>{const n=tn,a=Tv,l=En,c=Sn,u=Ep,h=wp;return pi(i)&&pi(r)?(ui(),hi("div",LT,[Hi(n,{"content-position":"left"},{default:mi((()=>[PT])),_:1}),vi("div",null,[Hi(h,{gutter:10},{default:mi((()=>[Hi(u,{span:18,flex:"1"},{default:mi((()=>[Hi(c,{"label-width":40,class:"form-wrap"},{default:mi((()=>[Hi(l,{label:e.$t("editor.attributes.radius")},{default:mi((()=>[Hi(a,{modelValue:pi(o).rx,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(o).rx=e),max:300,onInput:t[1]||(t[1]=e=>s(e))},null,8,["modelValue"])])),_:1},8,["label"])])),_:1})])),_:1}),Hi(u,{span:6,flex:"1"},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(o).rx,"onUpdate:modelValue":t[2]||(t[2]=e=>pi(o).rx=e),min:0,max:300,onOnChange:t[3]||(t[3]=e=>s(e))},null,8,["modelValue"])])),_:1})])),_:1})])])):Fi("",!0)}}}),RT={key:0,class:"attr-item-box"},FT=(e=>(Tr("data-v-e91b8a0a"),e=e(),Dr(),e))((()=>vi("h4",null,"边框",-1))),NT={class:"number-warp"},VT={class:"label",style:{"margin-right":"10px"}},UT={style:{flex:"1"}},zT={class:"number-warp"},HT={style:{flex:"0 0 48px","font-size":"var(--el-form-label-font-size)",color:"var(--el-text-color-regular)"}},YT={class:"content"},GT=Or(ai({__name:"AttributeBorder",setup(e){const{isOne:t,isGroup:n}=_B(),i=ey(),r=Ci(),o=["group"],a=zi({stroke:"#fff",strokeWidth:0,strokeDashArray:[]}),s=[{value:{strokeUniform:!0,strokeDashArray:[],strokeLineCap:"butt"},label:"Stroke"},{value:{strokeUniform:!0,strokeDashArray:[1,10],strokeLineCap:"butt"},label:"Dash-1"},{value:{strokeUniform:!0,strokeDashArray:[1,10],strokeLineCap:"round"},label:"Dash-2"},{value:{strokeUniform:!0,strokeDashArray:[15,15],strokeLineCap:"square"},label:"Dash-3"},{value:{strokeUniform:!0,strokeDashArray:[15,15],strokeLineCap:"round"},label:"Dash-4"},{value:{strokeUniform:!0,strokeDashArray:[25,25],strokeLineCap:"square"},label:"Dash-5"},{value:{strokeUniform:!0,strokeDashArray:[25,25],strokeLineCap:"round"},label:"Dash-6"},{value:{strokeUniform:!0,strokeDashArray:[1,8,16,8,1,20],strokeLineCap:"square"},label:"Dash-7"},{value:{strokeUniform:!0,strokeDashArray:[1,8,16,8,1,20],strokeLineCap:"round"},label:"Dash-8"}],l=e=>{var t;const n=null==(t=i.canvas)?void 0:t.getActiveObject();if((!e||!e.target||e.target===n)&&n&&!o.includes(n.type)){a.stroke=n.get("stroke"),a.strokeWidth=n.get("strokeWidth");const e=JSON.stringify(n.get("strokeDashArray")||[]),t=s.find((t=>JSON.stringify(t.value.strokeDashArray)===e&&n.get("strokeLineCap")===t.value.strokeLineCap));t&&(a.strokeDashArray=t.label)}},c=(e,t)=>{var n,r;const o=null==(n=i.canvas)?void 0:n.getActiveObjects()[0];o&&(o.set(e,t),o.set("strokeUniform",!0),null==(r=i.canvas)||r.renderAll())},u=e=>{var t,n;const r=null==(t=i.canvas)?void 0:t.getActiveObjects()[0];if(r){const t=s.find((t=>t.label===e));r.set(t.value),null==(n=i.canvas)||n.renderAll()}},h=()=>{var e;null==(e=null==r?void 0:r.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,t,n;l(),null==(e=i.editor)||e.on("selectCancel",h),null==(t=i.editor)||t.on("selectOne",l),null==(n=i.canvas)||n.on("object:modified",l)}))})),or((()=>{var e,t,n;null==(e=i.editor)||e.off("selectCancel",h),null==(t=i.editor)||t.off("selectOne",l),null==(n=i.canvas)||n.off("object:modified",l)})),(e,i)=>{const r=tn,o=yg,l=Ep,h=wp,d=tv,f=ev;return pi(t)&&!pi(n)?(ui(),hi("div",RT,[Hi(r,{"content-position":"left"},{default:mi((()=>[FT])),_:1}),vi("div",null,[Hi(h,{gutter:12,style:{"margin-right":"10px"}},{default:mi((()=>[Hi(l,{span:12},{default:mi((()=>[vi("div",NT,[vi("span",VT,bi(e.$t("editor.color")),1),vi("div",UT,[Hi(o,{modelValue:pi(a).stroke,"onUpdate:modelValue":i[0]||(i[0]=e=>pi(a).stroke=e),onChange:i[1]||(i[1]=e=>c("stroke",e)),"show-alpha":""},null,8,["modelValue"])])])])),_:1}),Hi(l,{span:12},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(a).strokeWidth,"onUpdate:modelValue":i[2]||(i[2]=e=>pi(a).strokeWidth=e),onOnChange:i[3]||(i[3]=e=>c("strokeWidth",e)),append:e.$t("editor.width"),min:0},null,8,["modelValue","append"])])),_:1})])),_:1}),vi("div",zT,[vi("span",HT,bi(e.$t("editor.attributes.stroke")),1),vi("div",YT,[Hi(f,{modelValue:pi(a).strokeDashArray,"onUpdate:modelValue":i[4]||(i[4]=e=>pi(a).strokeDashArray=e),onChange:u},{default:mi((()=>[(ui(),hi(ji,null,Zi(s,(e=>Hi(d,{value:e.label,label:e.label,key:`stroke-${e.label}`},{default:mi((()=>[Ri(bi(e.label),1)])),_:2},1032,["value","label"]))),64))])),_:1},8,["modelValue"])])])])])):Fi("",!0)}}}),[["__scopeId","data-v-e91b8a0a"]]),WT={key:0,class:"box attr-item-box"},XT=(e=>(Tr("data-v-b1040482"),e=e(),Dr(),e))((()=>vi("h4",null,"阴影",-1))),$T={class:"f-center rounded-4px",style:{background:"#f8f8f9"}},qT={class:"label"},KT={class:"content"},JT=Or(ai({__name:"AttributeShadow",setup(e){const t=ey(),{isOne:n}=_B(),i=Ci(),r=zi({shadow:{}}),o=e=>{var n;const i=null==(n=t.canvas)?void 0:n.getActiveObject();e&&e.target&&e.target!==i||i&&(r.shadow=i.get("shadow")||{})},a=()=>{var e,n;const i=null==(e=t.canvas)?void 0:e.getActiveObjects()[0];i&&(i.set("shadow",new vA.fabric.Shadow(r.shadow)),null==(n=t.canvas)||n.renderAll())},s=()=>{var e;null==(e=null==i?void 0:i.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,n,i;o(),null==(e=t.editor)||e.on("selectCancel",s),null==(n=t.editor)||n.on("selectOne",o),null==(i=t.canvas)||i.on("object:modified",o)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",s),null==(n=t.editor)||n.off("selectOne",o),null==(i=t.canvas)||i.off("object:modified",o)})),(e,t)=>{const i=tn,o=yg,s=Ep,l=wp;return pi(n)?(ui(),hi("div",WT,[Hi(i,{"content-position":"left"},{default:mi((()=>[XT])),_:1}),Hi(l,{gutter:12,style:{"margin-bottom":"10px"}},{default:mi((()=>[Hi(s,{span:12},{default:mi((()=>[vi("div",$T,[vi("span",qT,bi(e.$t("editor.color")),1),vi("div",KT,[Hi(o,{modelValue:pi(r).shadow.color,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(r).shadow.color=e),onChange:a,alpha:""},null,8,["modelValue"])])])])),_:1}),Hi(s,{span:12},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(r).shadow.blur,"onUpdate:modelValue":t[1]||(t[1]=e=>pi(r).shadow.blur=e),defaultValue:0,onOnChange:a,append:e.$t("editor.attributes.blur"),min:0},null,8,["modelValue","append"])])),_:1})])),_:1}),Hi(l,{gutter:12},{default:mi((()=>[Hi(s,{span:12},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(r).shadow.offsetX,"onUpdate:modelValue":t[2]||(t[2]=e=>pi(r).shadow.offsetX=e),defaultValue:0,onOnChange:a,append:e.$t("editor.attributes.offset_x")},null,8,["modelValue","append"])])),_:1}),Hi(s,{span:12},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(r).shadow.offsetY,"onUpdate:modelValue":t[3]||(t[3]=e=>pi(r).shadow.offsetY=e),defaultValue:0,onOnChange:a,append:e.$t("editor.attributes.offset_y")},null,8,["modelValue","append"])])),_:1})])),_:1})])):Fi("",!0)}}}),[["__scopeId","data-v-b1040482"]]),ZT={key:0,class:"box attr-item-box"},eD=(e=>(Tr("data-v-f983e3e0"),e=e(),Dr(),e))((()=>vi("h4",null,"位置信息",-1))),tD={class:"number-warp"},nD={class:"number-warp"},iD=Or(ai({__name:"AttributePostion",setup(e){const t=ey(),n=Ci(),{isMatchType:i,isOne:r}=_B(["text","i-text","textbox","rect","circle","triangle","polygon","image","group","line","arrow","thinTailArrow"]),o=zi({opacity:0,angle:0,left:0,top:0,rx:0,ry:0}),a=e=>{var n,r;const a=null==(n=t.canvas)?void 0:n.getActiveObject();e&&e.target&&e.target!==a||a&&i&&(o.opacity=100*(null!=(r=a.get("opacity"))?r:0),o.left=a.get("left"),o.top=a.get("top"),o.angle=a.get("angle")||0)},s=(e,n)=>{var i,r,o,a;const s=null==(i=t.canvas)?void 0:i.getActiveObjects()[0];if(s){if("opacity"===e)return s&&s.set(e,n/100),void(null==(r=t.canvas)||r.renderAll());if("angle"===e)return s.rotate(n),void(null==(o=t.canvas)||o.renderAll());s&&s.set(e,n),null==(a=t.canvas)||a.renderAll()}},l=()=>{var e;null==(e=null==n?void 0:n.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,n,i;a(),null==(e=t.editor)||e.on("selectCancel",l),null==(n=t.editor)||n.on("selectOne",a),null==(i=t.canvas)||i.on("object:modified",a)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",l),null==(n=t.editor)||n.off("selectOne",a),null==(i=t.canvas)||i.off("object:modified",a)})),(e,t)=>{const n=tn,a=Ep,l=wp,c=Tv;return pi(r)?(ui(),hi("div",ZT,[Hi(n,{"content-position":"left"},{default:mi((()=>[eD])),_:1}),Mi(vi("div",null,[Hi(l,{gutter:10,style:{"margin-bottom":"10px"}},{default:mi((()=>[Hi(a,{span:12},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(o).left,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(o).left=e),append:e.$t("editor.attributes.left"),onOnChange:t[1]||(t[1]=e=>s("left",e))},null,8,["modelValue","append"])])),_:1}),Hi(a,{span:12},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(o).left,"onUpdate:modelValue":t[2]||(t[2]=e=>pi(o).left=e),append:e.$t("editor.attributes.top"),onOnChange:t[3]||(t[3]=e=>s("top",e))},null,8,["modelValue","append"])])),_:1})])),_:1}),vi("div",tD,[vi("span",null,bi(e.$t("editor.attributes.angle")),1),Hi(c,{modelValue:pi(o).angle,"onUpdate:modelValue":t[4]||(t[4]=e=>pi(o).angle=e),max:360,onInput:t[5]||(t[5]=e=>s("angle",e))},null,8,["modelValue"])]),vi("div",nD,[vi("span",null,bi(e.$t("editor.attributes.opacity")),1),Hi(c,{modelValue:pi(o).opacity,"onUpdate:modelValue":t[6]||(t[6]=e=>pi(o).opacity=e),onInput:t[7]||(t[7]=e=>s("opacity",e))},null,8,["modelValue"])])],512),[[$i,pi(i)]])])):Fi("",!0)}}}),[["__scopeId","data-v-f983e3e0"]]),rD={key:0,class:"box attr-item-box"},oD=vi("h4",null,"文本内容",-1),aD=vi("h4",null,"文本路径",-1),sD={class:"ivu-col__box"},lD={class:"label"},cD={class:"content"},uD=ai({__name:"AttributeTextContent",setup(e){const{isOne:t,isMatchType:n}=_B(["i-text"]),i=ey(),r=Ci(),o=zi({text:"",strokeWidth:1,stroke:"",showPathAttr:!1}),a=e=>{var t;const n=null==(t=i.canvas)?void 0:t.getActiveObject();if((!e||!e.target||e.target===n)&&n){o.text=n.get("text");const e=n.get("path");e?(o.strokeWidth=e.strokeWidth,o.stroke=e.stroke,o.showPathAttr=!0):o.showPathAttr=!1}},s=(e,t)=>{var n,r;const a=null==(n=i.canvas)?void 0:n.getActiveObjects()[0];if(a){if(o[e]=t,"text"===e)a.set(e,t);else{a.get("path").set(e,t)}null==(r=i.canvas)||r.renderAll()}},l=()=>{var e;null==(e=null==r?void 0:r.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,t,n;null==(e=i.editor)||e.on("selectCancel",l),null==(t=i.editor)||t.on("selectOne",a),null==(n=i.canvas)||n.on("object:modified",a)}))})),or((()=>{var e,t,n;null==(e=i.editor)||e.off("selectCancel",l),null==(t=i.editor)||t.off("selectOne",a),null==(n=i.canvas)||n.off("object:modified",a)})),(e,i)=>{const r=tn,a=Ze,l=En,c=Sn,u=yg,h=Ep,d=wp;return pi(t)&&pi(n)?(ui(),hi("div",rD,[Hi(r,{"content-position":"left"},{default:mi((()=>[oD])),_:1}),Hi(c,{"label-width":40,class:"form-wrap"},{default:mi((()=>[Hi(l,{label:e.$t("editor.attributes.id")},{default:mi((()=>[Hi(a,{modelValue:pi(o).text,"onUpdate:modelValue":i[0]||(i[0]=e=>pi(o).text=e),onChange:i[1]||(i[1]=e=>s("text",pi(o).text)),size:"small"},null,8,["modelValue"])])),_:1},8,["label"])])),_:1}),pi(o).showPathAttr?(ui(),hi(ji,{key:0},[Hi(r,{"content-position":"left"},{default:mi((()=>[aD])),_:1}),vi("div",null,[Hi(d,{gutter:12},{default:mi((()=>[Hi(h,{flex:"1"},{default:mi((()=>[vi("div",sD,[vi("span",lD,bi(e.$t("editor.color")),1),vi("div",cD,[Hi(u,{modelValue:pi(o).stroke,"onUpdate:modelValue":i[2]||(i[2]=e=>pi(o).stroke=e),onChange:i[3]||(i[3]=e=>s("stroke",e)),"show-alpha":""},null,8,["modelValue"])])])])),_:1}),Hi(h,{flex:"1"},{default:mi((()=>[Hi(pi(QT),{modelValue:pi(o).strokeWidth,"onUpdate:modelValue":i[4]||(i[4]=e=>pi(o).strokeWidth=e),onOnChange:i[5]||(i[5]=e=>s("strokeWidth",e)),append:e.$t("editor.width"),min:0},null,8,["modelValue","append"])])),_:1})])),_:1})])],64)):Fi("",!0)])):Fi("",!0)}}}),hD={key:0,class:"attr-item-box"},dD={class:"flex-view"},fD={class:"flex-item"},pD={class:"label"},gD={class:"flex-1"},vD=Or(ai({__name:"AttributeTextFloat",setup(e){const t=ey(),n=zi({verticalAlign:"null"}),{isMatchType:i,isOne:r}=_B(["i-text","textbox","text"]),o=e=>{var r,o;const a=null==(r=t.canvas)?void 0:r.getActiveObject();e&&e.target&&e.target!==a||a&&i&&(null==(o=null==a?void 0:a.text)?void 0:o.includes("."))&&(n.verticalAlign=a.get("verticalAlign"))},a=Ci(),s=()=>{var e;null==(e=null==a?void 0:a.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,n,i;o(),null==(e=t.editor)||e.on("selectCancel",s),null==(n=t.editor)||n.on("selectOne",o),null==(i=t.canvas)||i.on("object:modified",o)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",s),null==(n=t.editor)||n.off("selectOne",o),null==(i=t.canvas)||i.off("object:modified",o)})),(e,o)=>{const a=tv,s=ev;return pi(r)&&pi(i)?(ui(),hi("div",hD,[vi("div",dD,[vi("div",fD,[vi("span",pD,bi(e.$t("editor.textFloat")),1),vi("div",gD,[Hi(s,{modelValue:pi(n).verticalAlign,"onUpdate:modelValue":o[0]||(o[0]=e=>pi(n).verticalAlign=e),onChange:o[1]||(o[1]=e=>((e,n)=>{var i,r;const o=null==(i=t.canvas)?void 0:i.getActiveObjects()[0];if(o&&o.text.includes(".")){const[i]=o.text.split("."),a=i.length+1,s=o.text.length;o.styles=[],"top"===n?o.setSuperscript(a,s):"bottom"===n&&o.setSelectionStyles({fontSize:o.superscript.size*o.fontSize},a,s),o.set(e,n),null==(r=t.canvas)||r.renderAll()}})("verticalAlign",e))},{default:mi((()=>[Hi(a,{label:"无",value:"null"}),Hi(a,{label:"下标",value:"bottom"}),Hi(a,{label:"上标",value:"top"})])),_:1},8,["modelValue"])])])])])):Fi("",!0)}}}),[["__scopeId","data-v-d5730b98"]]),AD={key:0,class:"box attr-item-box"},mD=(e=>(Tr("data-v-ec90b901"),e=e(),Dr(),e))((()=>vi("h4",null,"字体属性",-1))),yD={class:"flex-view"},bD={class:"flex-item"},CD={class:"left font-selector"},wD={style:{display:"none"}},xD={class:"right"},_D={class:"flex-view",style:{"margin-bottom":"0"}},ED={class:"flex-item"},SD={class:"flex-view"},ID={class:"flex-item"},kD={viewBox:"0 0 1024 1024",width:"14",height:"14"},BD={class:"flex-view"},OD={class:"right"},TD={class:"right"},DD={class:"flex-view"},MD={class:"flex-item"},QD={class:"label"},LD={class:"content"},PD=ai({__name:"AttributeFont",setup(e){var t;const n=ey(),{isMatchType:i,isOne:r}=_B(["i-text","textbox","text"]),o=Ci(),a=zi({fontSize:0,fontFamily:"",lineHeight:0,charSpacing:0,fontWeight:"",textBackgroundColor:"#fff",textAlign:"",fontStyle:"",underline:!1,linethrough:!1,overline:!1}),s=si([]);null==(t=n.editor)||t.getFontList().then((e=>{s.value=e}));const l=["left","center","right","justify"],c=["text-align-left","text-align-center","text-align-right","text-align-justitfy"],u=e=>{var t;const r=null==(t=n.canvas)?void 0:t.getActiveObject();e&&e.target&&e.target!==r||r&&i&&(a.fontSize=r.get("fontSize"),a.fontFamily=r.get("fontFamily"),a.lineHeight=r.get("lineHeight"),a.textAlign=r.get("textAlign"),a.underline=r.get("underline"),a.linethrough=r.get("linethrough"),a.charSpacing=r.get("charSpacing"),a.overline=r.get("overline"),a.fontStyle=r.get("fontStyle"),a.textBackgroundColor=r.get("textBackgroundColor"),a.fontWeight=r.get("fontWeight"))},d=(e,t)=>{var i,r;const o=null==(i=n.canvas)?void 0:i.getActiveObjects()[0];o&&(o&&o.set(e,t),null==(r=n.canvas)||r.renderAll())},f=()=>{var e;null==(e=null==o?void 0:o.proxy)||e.$forceUpdate()},p=e=>h(this,null,(function*(){if(!e)return;const t=qt.service();n.editor.loadFont(e).finally((()=>t.close()))}));return ci((()=>{ki((()=>{var e,t,i;u(),null==(e=n.editor)||e.on("selectCancel",f),null==(t=n.editor)||t.on("selectOne",u),null==(i=n.canvas)||i.on("object:modified",u)}))})),or((()=>{var e,t,i;null==(e=n.editor)||e.off("selectCancel",f),null==(t=n.editor)||t.off("selectOne",u),null==(i=n.canvas)||i.off("object:modified",u)})),(e,t)=>{const o=tn,u=tv,h=ev,f=en,g=pp,v=fp,A=et,m=gn,y=yg;return pi(r)&&pi(i)?(ui(),hi("div",AD,[Hi(o,{"content-position":"left"},{default:mi((()=>[mD])),_:1}),vi("div",null,[vi("div",yD,[vi("div",bD,[vi("div",CD,[Hi(h,{modelValue:pi(a).fontFamily,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(a).fontFamily=e),onChange:p},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(s),(e=>(ui(),Ai(u,{value:e.name,label:e.name,key:`font-${e.name}`},{default:mi((()=>[vi("div",{class:"font-item",style:Ni(`background-image:url('${e.img}');height: 100%;background-size: 100% 100%;`)},[Ri(bi(e.img?"":e)+" ",1),vi("span",wD,bi(e.name),1)],4)])),_:2},1032,["value","label"])))),128))])),_:1},8,["modelValue"])]),vi("div",xD,[Hi(pi(QT),{modelValue:pi(a).fontSize,"onUpdate:modelValue":t[1]||(t[1]=e=>pi(a).fontSize=e),onOnChange:t[2]||(t[2]=e=>d("fontSize",e)),append:"字号",min:1},null,8,["modelValue"])])])]),vi("div",_D,[vi("div",ED,[Hi(v,{class:"button-group",modelValue:pi(a).textAlign,"onUpdate:modelValue":t[3]||(t[3]=e=>pi(a).textAlign=e),onChange:t[4]||(t[4]=e=>d("textAlign",e)),type:"button"},{default:mi((()=>[(ui(),hi(ji,null,Zi(l,((e,t)=>Hi(g,{label:e,value:e,key:e},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:c[t]},null,8,["icon"])])),_:2},1032,["label","value"]))),64))])),_:1},8,["modelValue"])])]),vi("div",SD,[vi("div",ID,[Hi(m,{class:"button-group"},{default:mi((()=>[Hi(A,{style:{width:"25%"},onClick:t[5]||(t[5]=e=>((e,t)=>{var i,r;const o="normal"===t?"bold":"normal";a.fontWeight=o;const s=null==(i=n.canvas)?void 0:i.getActiveObjects()[0];s&&s.set(e,o),null==(r=n.canvas)||r.renderAll()})("fontWeight",pi(a).fontWeight))},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"atb-fontWeight"})])),_:1}),Hi(A,{style:{width:"25%"},onClick:t[6]||(t[6]=e=>((e,t)=>{var i,r;const o="normal"===t?"italic":"normal";a.fontStyle=o;const s=null==(i=n.canvas)?void 0:i.getActiveObjects()[0];s&&s.set(e,o),null==(r=n.canvas)||r.renderAll()})("fontStyle",pi(a).fontStyle))},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"atb-fontStyle"})])),_:1}),Hi(A,{style:{width:"25%"},onClick:t[7]||(t[7]=e=>((e,t)=>{var i,r;const o=!1===t;a.linethrough=o;const s=null==(i=n.canvas)?void 0:i.getActiveObjects()[0];s&&s.set(e,o),null==(r=n.canvas)||r.renderAll()})("linethrough",pi(a).linethrough))},{default:mi((()=>[Hi(f,{extClass:"text-20px",color:"#fff",icon:"atb-linethrough"})])),_:1}),Hi(A,{style:{width:"25%"},onClick:t[8]||(t[8]=e=>((e,t)=>{var i,r;const o=!1===t;a.underline=o;const s=null==(i=n.canvas)?void 0:i.getActiveObjects()[0];s&&s.set(e,o),null==(r=n.canvas)||r.renderAll()})("underline",pi(a).underline))},{default:mi((()=>[(ui(),hi("svg",kD,[Hi(f,{extClass:"text-20px",color:"#fff",icon:"atb-underline"})]))])),_:1})])),_:1})])]),vi("div",BD,[vi("div",OD,[Hi(pi(QT),{modelValue:pi(a).lineHeight,"onUpdate:modelValue":t[9]||(t[9]=e=>pi(a).lineHeight=e),onOnChange:t[10]||(t[10]=e=>d("lineHeight",e)),step:.1,append:e.$t("editor.attributes.line_height")},null,8,["modelValue","append"])]),vi("div",TD,[Hi(pi(QT),{modelValue:pi(a).charSpacing,"onUpdate:modelValue":t[11]||(t[11]=e=>pi(a).charSpacing=e),onOnChange:t[12]||(t[12]=e=>d("charSpacing",e)),append:e.$t("editor.attributes.char_spacing")},null,8,["modelValue","append"])])]),vi("div",DD,[vi("div",MD,[vi("span",QD,bi(e.$t("editor.background")),1),vi("div",LD,[Hi(y,{modelValue:pi(a).textBackgroundColor,"onUpdate:modelValue":t[13]||(t[13]=e=>pi(a).textBackgroundColor=e),onChange:t[14]||(t[14]=e=>d("textBackgroundColor",e)),"show-alpha":""},null,8,["modelValue"])])])])])])):Fi("",!0)}}}),jD=Or(PD,[["__scopeId","data-v-ec90b901"]]),RD=(e,{decimal:t=0}={})=>t>0?Number(e.toFixed(t)):Math.round(e),FD=(e,{onmousedown:t,onmousemove:n,onmouseup:i}={})=>{let r=e.getBoundingClientRect();const o={x:0,y:0},a=e=>{let t=e.pageX-r.x,n=e.pageY-r.y;t<0&&(t=0),t>r.width&&(t=r.width),n<0&&(n=0),n>r.height&&(n=r.height),o.x=RD(t/r.width,{decimal:2}),o.y=RD(n/r.height,{decimal:2})},s=e=>{a(e),n&&n(o,e)},l=e=>{document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l),i&&i(o,e)},c=n=>{r=e.getBoundingClientRect(),a(n),document.addEventListener("mousemove",s),document.addEventListener("mouseup",l),t&&t(o,n)};return e.addEventListener("mousedown",c),{destroy(){e.removeEventListener("mousedown",c)}}},ND=(e,t,n)=>{let i=Math.round(e).toString(16),r=Math.round(t).toString(16),o=Math.round(n).toString(16);return 1===i.length&&(i="0"+i),1===r.length&&(r="0"+r),1===o.length&&(o="0"+o),"#"+i+r+o},VD=(e,t,n,i=1)=>{const r=ND(e,t,n);let o=Math.round(255*i).toString(16);return 1===o.length&&(o="0"+o),r+o},UD=(e,t,n)=>{e/=255,t/=255,n/=255;const i=Math.min(e,t,n),r=Math.max(e,t,n),o=r-i;let a=0,s=0;if(0===o)a=s=0;else{s=o/r;const i=((r-e)/6+o/2)/o,l=((r-t)/6+o/2)/o,c=((r-n)/6+o/2)/o;e===r?a=c-l:t===r?a=1/3+i-c:n===r&&(a=2/3+l-i),a<0?a+=1:a>1&&(a-=1)}return[360*a,100*s,100*r]};const zD=(e,t,n)=>{const[i,r,o]=function(e,t,n){e=e/360*6,t/=100,n/=100;const i=Math.floor(e),r=e-i,o=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),l=i%6,c=[n,a,o,o,s,n][l],u=[s,n,n,a,o,o][l],h=[o,o,s,n,n,a][l];return[Math.round(255*c),Math.round(255*u),Math.round(255*h)]}(e,t,n);return ND(i,r,o)},HD=e=>{let t=0,n=0,i=0;return 4==(e=e.slice(0,7)).length?(t=Number("0x"+e[1]+e[1]),n=Number("0x"+e[2]+e[2]),i=Number("0x"+e[3]+e[3])):7==e.length&&(t=Number("0x"+e[1]+e[2]),n=Number("0x"+e[3]+e[4]),i=Number("0x"+e[5]+e[6])),[t,n,i]},YD=e=>{const t=HD(e),n=Number("0x"+e[7]+e[8]);return[...t,Number((n/255).toFixed(2))]},GD=e=>{const[t,n,i,r]=YD(e);return((e,t,n,i=1)=>[...UD(e,t,n),i])(t,n,i,r)},WD=e=>e.startsWith("#")?"纯色":e.startsWith("linear-gradient")?"渐变":"图案",XD=(e,t)=>{const n=[];return t.forEach((e=>{n.push(`${e.color} ${100*e.offset}%`)})),`linear-gradient(${e}deg, ${n.join(",")})`};function $D(e){const t=function(e,t=!0){const n=document.createElement("div");return n.id="color-pipette-tooltip-container",n.innerHTML=e,n.style=`\n    position: fixed;\n    left: 50%;\n    top: 9%;\n    z-index: 10002;\n    display: ${t?"flex":"none"};\n    align-items: center;\n    background-color: rgba(0,0,0,0.4);\n    padding: 6px 12px;\n    border-radius: 4px;\n    color: #fff;\n    font-size: 18px;\n    pointer-events: none;\n  `,n}(e);document.body.appendChild(t),setTimeout((()=>{var e;return null==(e=null==t?void 0:t.parentNode)?void 0:e.removeChild(t)}),2e3)}const qD={class:"my-tabs"},KD={class:"my-tabs__header p-0.5 mb-3 rounded bg-gray-100 cursor-pointers"},JD={class:"my-tabs__header-shell relative flex justify-between"},ZD=["onClick"],eM={class:"my-tabs__content"},tM={name:"Tabs"},nM=Or(Object.assign(tM,{props:{value:{type:String,required:!0}},emits:["update:value","change"],setup(e,{expose:t,emit:n}){const i=e,r=n;Ii((()=>i.value),(()=>{c()}));const o=si([]),a=zi({width:0,left:0});let s=0;ci((()=>{s=100/o.value.length,a.width=`${s}%`,c()}));let l=null;function c(e=-1){return h(this,null,(function*(){var t,n,r,c;e<0&&(e=o.value.findIndex((e=>e.props.label===i.value))),a.left=s*e+"%";try{yield ki(),null==(n=null==(t=null==l?void 0:l.exposed)?void 0:t.changeActive)||n.call(t,!1),l=o.value[e],null==(c=null==(r=l.exposed)?void 0:r.changeActive)||c.call(r,!0)}catch(u){}}))}return t({tabs:o}),(t,n)=>(ui(),hi("div",qD,[vi("div",KD,[vi("div",JD,[(ui(!0),hi(ji,null,Zi(o.value,((t,n)=>(ui(),hi("div",{key:t.props.label,class:fi(["my-tab__title relative flex-auto py-1 text-center",{"my-active":t.props.label===e.value}]),onClick:e=>function(e,t){r("update:value",e.props.label),c(t)}(t,n)},bi(t.props.label),11,ZD)))),128)),vi("div",{class:"my-tab__slider",style:Ni(a)},null,4)])]),vi("div",eM,[di(t.$slots,"default",{},void 0,!0)])]))}}),[["__scopeId","data-v-fd81b187"]]),iM={},rM={t:"1685345224620",class:"sd-xggj",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8489",width:"20",height:"20"},oM=[vi("path",{d:"M716.288 140.501333a42.666667 42.666667 0 0 1 60.373333 0l90.496 90.496a42.666667 42.666667 0 0 1 0 60.330667l-120.661333 120.704L595.626667 261.12l120.661333-120.661333zM520.192 185.770667l301.696 301.653333-60.330667 60.373333-301.653333-301.696 60.288-60.330666z","p-id":"8490"},null,-1),vi("path",{d:"M580.565333 366.762667l-60.373333-60.330667-362.026667 362.026667V853.333333l181.034667-3.84 362.026667-362.026666-60.330667-60.373334-331.861333 331.904-60.373334-60.373333 331.904-331.861333z","p-id":"8491"},null,-1)];const aM=Or(iM,[["render",function(e,t){return ui(),hi("svg",rM,oM)}]]),sM={name:"TabPanel"},lM=Object.assign(sM,{props:{label:{type:String,required:!0}},setup(e,{expose:t}){const n=Ci();n.parent.exposed.tabs.value.push(n);const i=si(!1),r=Si((()=>({display:i.value?"block":"none"})));return t({changeActive:function(e){i.value=e}}),(e,t)=>(ui(),hi("div",{class:"tab-panel",style:Ni(r.value)},[di(e.$slots,"default")],4))}}),cM=ai({props:["modelValue"],emits:["change","update:modelValue"],setup(e,{emit:t}){const n=si(90),i=si(null),r=Si((()=>n.value-90));let o=!1;const a=si(!1);Ii((()=>n.value),(i=>{e.modelValue!==n.value&&t("update:modelValue",i),t("change")})),Ii((()=>e.modelValue),(e=>{n.value=e}));return{inputChange:e=>{t("change",e)},num:n,turn:e=>{if(!o)return;const t=27,i=27,r=e.offsetX-t,a=e.offsetY-i,s=180*Math.atan2(a,r)/Math.PI;n.value=Math.round(s+90)},touch:(e,t)=>{e.preventDefault(),o=t},angleInDegrees:r,numInput:i,visiable:a}}}),uM={class:"angle-input-box"};const hM=Or(cM,[["render",function(e,t,n,i,r,o){return ui(),hi("div",uM,[Mi(vi("input",{ref:"numInput","onUpdate:modelValue":t[0]||(t[0]=t=>e.num=t),class:"angle-input",onFocus:t[1]||(t[1]=t=>e.visiable=!0),onBlur:t[2]||(t[2]=t=>e.visiable=!1),onInput:t[3]||(t[3]=(...t)=>e.inputChange&&e.inputChange(...t))},null,544),[[cr,e.num]]),Mi(vi("div",{class:"AngleHandle",onMousedown:t[6]||(t[6]=t=>e.touch(t,!0)),onMouseup:t[7]||(t[7]=t=>e.touch(t,!1))},[vi("div",{class:"angle",onMouseup:t[4]||(t[4]=(...t)=>e.turn&&e.turn(...t)),onMousemove:t[5]||(t[5]=(...t)=>e.turn&&e.turn(...t))},[vi("div",{style:Ni(`transform: rotate(${e.angleInDegrees}deg)`),class:"line"},null,4)],32)],544),[[$i,e.visiable]])])}]]),dM=e=>(Tr("data-v-64d70aa8"),e=e(),Dr(),e),fM={class:"color-picker"},pM={key:1,class:"title"},gM={key:2,class:"cp__gradient flex-center"},vM={class:"cp__gradient-bar"},AM=["data-sort","onMousedown"],mM=dM((()=>vi("div",{class:"cpp__color-saturation"},null,-1))),yM=dM((()=>vi("div",{class:"cpp__color-value"},null,-1))),bM={class:"cps__track"},CM={class:"cps__track"},wM={class:"cp__box"},xM=["value"],_M=["value"],EM=["onClick"],SM={name:"ColorPicker",inheritAttrs:!1},IM=Object.assign(SM,{props:{value:{type:String,default:"#ffffffff"},modes:{type:Array,default:()=>["纯色","渐变"]},defaultColor:{type:String,default:"#ffffffff"},defaultGradient:{type:String,default:"linear-gradient(90deg, #fffae0ff 0%, #ffd1f1ff 100%)"},defaultImage:{type:String,default:"https://st0.dancf.com/csc/157/material-2d-textures/0/20190714-174653-ed3c.jpg"}},emits:["update:value","change","native-pick","blur"],setup(e,{expose:t,emit:n}){const i=e,r=n,o=si(WD(i.value)),a=si(90),s=si([]),c=zi({h:0,s:0,l:0,a:0}),u=si("#f00"),d=si("#000"),f=si(0);let p=si({});const g="EyeDropper"in window,v=si(),A=si(),m=si(),y=si(),b=si(),C=si(),w=si();let x=null,_=null,E=null,S=null,I=null,k=!0,B=null;const O=si([]),T={color:i.defaultColor,gradient:i.defaultGradient,image:i.defaultImage},D=Si((()=>i.modes.includes("渐变"))),M=Si((()=>{const e=HD(d.value).join(",");return{background:`linear-gradient(to right, rgba(${e}, 0) 0%, rgb(${e}) 100%)`}}));Ii(p,(e=>{V(e.color)})),Ii(d,(e=>{!function(e){if(/^#(?:[0-9a-f]{3}){1,2}$/i.test(e)){const n=HD(e),[i,r,o]=UD(...n);c.h=i,c.s=r,c.l=o;try{m.value.style.left=`${c.s}%`,m.value.style.top=100-c.l+"%",y.value.style.left=c.h/360*100+"%",d.value=e}catch(t){}}}(e)})),Ii((()=>i.value),(e=>{const t=WD(e);t!==o.value&&(o.value=t),F(t),P(e),Q(e)}));const Q=le((e=>h(this,null,(function*(){const t=O.value,n=t.indexOf(e);-1!==n&&O.value.splice(n,1),t.length>=4&&O.value.splice(t.length-1,1);const i=[e];O.value=i.concat(t)}))),300),L=Ii(c,(function(e){const t=((e,t,n,i=1)=>`${zD(e,t,n)}${0===i?"00":Math.round(255*i).toString(16)}`)(...Object.values(e));let n;"纯色"===o.value?n=t:"渐变"===o.value&&(p.value.color=t,n=XD(a.value,s.value));N(t),j(n)}),{deep:!0});function P(e){"纯色"===o.value?T.color=e:"渐变"===o.value?T.gradient=e:"图案"===o.value&&(T.image=e)}function j(e){P(e),r("update:value",e),r("change",{mode:o.value,color:e,angle:Number(a.value),stops:s.value})}function R(e){return h(this,null,(function*(){if(e===o.value)return;let t;o.value=e,"纯色"===e?t=T.color:"渐变"===e?t=T.gradient:"图案"===e&&(t=T.image),j(t)}))}function F(e){"纯色"===e?V(i.value):"渐变"===e&&(0===s.value.length?i.value.match(/[^,]+/g).forEach(((e,t)=>{if(0===t)return void(a.value=Number(e.match(/\d+/)[0]));let[n,i]=e.trim().split(" ");n.startsWith("#")||(n=VD(n)),i=i.match(/\d+/)[0]/100,s.value.push({color:n,offset:i}),p.value=s.value[0]})):V(p.value.color))}function N(e){var t;u.value=`hsl(${c.h}, 100%, 50%)`,d.value=e.slice(0,7),d.value,f.value=Math.round(100*(null!=(t=c.a)?t:1))}function V(e){if(k){const n=GD(e);c.h=n[0],c.s=n[1],c.l=n[2],c.a=n[3],N(e);try{let e=c.s;const t=Math.round(100-c.l);m.value.style.left=`${e}%`,m.value.style.top=`${t}%`,e=c.h/360,y.value.style.left=100*e+"%",C.value.style.left=100*c.a+"%"}catch(t){}}}function U(e){if(e.stopPropagation(),e.preventDefault(),!["Backspace","Delete"].includes(e.key))return;if(2===s.value.length)return;const t=s.value.indexOf(p.value);s.value.splice(t,1),p.value=s.value[0]}function z(){k=!1,B&&clearTimeout(B),B=setTimeout((()=>{k=!0}),16)}function H(e){return h(this,null,(function*(){let t="";if(e&&e.target.value){const n=e.target.value;t=n+(7===n.length?"ff":"")}else{const e=new window.EyeDropper;$D("按Esc可退出");try{const n=yield e.open();t=n.sRGBHex+"ff"}catch(n){}}"渐变"===o.value?(p.value.color=t,p.value=l({},p.value)):r("update:value",t),r("native-pick",t)}))}ci((function(){return h(this,null,(function*(){function e(e){z();try{const t=100*e.x,n=100*e.y;c.s=Math.round(t),c.l=Math.round(100-n),m.value.style.left=`${t}%`,m.value.style.top=`${n}%`}catch(t){}}function t(e){z(),c.h=360*e.x,y.value.style.left=100*e.x+"%"}function n(e){z(),c.a=e.x,C.value.style.left=100*e.x+"%"}m.value.style.left=`${c.s}%`,m.value.style.top=100-c.l+"%",y.value.style.left=c.h/360*100+"%",C.value.style.left=100*c.a+"%",D.value&&(x=FD(v.value,{onmousedown:function(e){if(I)return;const t=s.value.findIndex((t=>t.offset>=e.x)),n=s.value[t-1],i=YD(n.color),r=s.value[t],o=YD(r.color),a=[];for(let s=0;s<3;s+=1)a.push(i[s]+(o[s]-i[s])*e.x);const l=r.offset-e.x-(e.x-n.offset)>0?i[3]:o[3],c=VD(...a,l);p.value={color:c,offset:e.x},s.value.splice(t,0,p.value)},onmousemove:function(e){if(!I)return;p.value.offset=e.x,s.value.sort(((e,t)=>e.offset-t.offset));j(XD(a.value,s.value))},onmouseup:function(){I=!1}})),_=FD(A.value,{onmousemove:e,onmouseup:e}),E=FD(b.value,{onmousemove:t,onmouseup:t}),S=FD(w.value,{onmousemove:n,onmouseup:n}),F(o.value),P(i.value)}))})),or((()=>{null==_||_.destroy(),null==E||E.destroy(),null==S||S.destroy(),L(),x&&x.destroy()}));const Y=e=>{const t=function(e){let t=e.replace(/\s/g,"");e.startsWith("#")||(t="#"+t);t.length<9&&(t=t.padEnd(9,"f"));return t}(e.target.value);r("blur",t),r("update:value",t)};function G(){j(XD(a.value,s.value))}return t({updateValue:j}),(t,n)=>(ui(),hi("div",fM,[e.modes.length>1?(ui(),Ai(nM,{key:0,type:"border-card",value:pi(o),"onUpdate:value":R},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(e.modes,(e=>(ui(),Ai(lM,{key:e,label:e},null,8,["label"])))),128))])),_:1},8,["value"])):(ui(),hi("div",pM,bi(pi(o)),1)),pi(D)?Mi((ui(),hi("div",gM,[vi("div",vM,[vi("div",{ref_key:"elGradientTrack",ref:v,class:"cpgb__track",style:Ni([{width:"100%"},{background:e.value}])},[(ui(!0),hi(ji,null,Zi(pi(s),((e,t)=>(ui(),hi("div",{key:t,class:fi(["cpgb__pointer",{"cpgb__pointer--active":e===pi(p)}]),"data-sort":t,style:Ni({left:100*e.offset+"%",background:e.color}),tabindex:"-1",onMousedown:t=>{return n=e,I=!0,void(p.value=n);var n},onKeydown:Li(U,["stop"])},null,46,AM)))),128))],4)]),Hi(hM,{modelValue:pi(a),"onUpdate:modelValue":n[0]||(n[0]=e=>Qi(a)?a.value=e:null),onChange:G},null,8,["modelValue"])],512)),[[$i,"渐变"===pi(o)]]):Fi("",!0),vi("div",{ref_key:"elPalette",ref:A,class:"cp__palette",style:Ni({background:pi(u)})},[mM,yM,vi("div",{ref_key:"elPalettePointer",ref:m,class:"cpp__pointer"},null,512)],4),vi("div",{ref_key:"elSliderHux",ref:b,class:"cp__slider cp__slider-hux"},[vi("div",bM,[vi("div",{ref_key:"elSliderHuxPointer",ref:y,class:"cpst__pointer"},null,512)])],512),vi("div",{ref_key:"elSliderAlpha",ref:w,class:"cp__slider cp__slider-alpha"},[vi("div",{class:"cpsa__background",style:Ni(pi(M))},null,4),vi("div",CM,[vi("div",{ref_key:"elSliderAlphaPointer",ref:C,class:"cpst__pointer"},null,512)])],512),vi("div",wM,[vi("div",{class:"item",onClick:H},[g?(ui(),Ai(aM,{key:0})):(ui(),hi("input",{key:1,class:"native",type:"color",onInput:H},null,32))]),"渐变"===pi(o)?(ui(),hi("input",{key:0,class:"input",value:pi(p).color},null,8,xM)):(ui(),hi("input",{key:1,value:e.value,class:"input",onBlur:Y},null,40,_M)),"纯色"===pi(o)?(ui(!0),hi(ji,{key:2},Zi(pi(O),(e=>(ui(),hi("div",{key:e,class:"item item-color",style:Ni({background:e}),onClick:t=>H({target:{value:e}})},null,12,EM)))),128)):Fi("",!0)])]))}}),kM=Or(IM,[["__scopeId","data-v-64d70aa8"]]),BM={key:0,class:"box attr-item-box"},OM=(e=>(Tr("data-v-ae38b2ac"),e=e(),Dr(),e))((()=>vi("h4",null,"颜色",-1))),TM={class:"bg-item"},DM={style:{width:"100%","box-sizing":"border-box",padding:"10px"}},MM="gradientAngle",QM=Or(ai({__name:"AttributeColor",setup(e){const{selectType:t,isOne:n}=_B(),i=ey(),r=Ci(),o=zi({fill:""}),a=e=>{var t;const r=null==(t=i.canvas)?void 0:t.getActiveObject();if((!e||!e.target||e.target===r)&&r&&n){const e=r.get("fill");o.fill="string"==typeof e?e:c(e,r)}},s=e=>{var t,n;const r=null==(t=i.canvas)?void 0:t.getActiveObjects()[0];if(r){const t=String(e.color).replace("NaN","");if("纯色"===e.mode)r.set("fill",t);else if("渐变"===e.mode){const t=u(Ti(e.stops),r.width,r.height,e.angle);r.set("fill",t,e.angle),r.set(MM,e.angle)}null==(n=i.canvas)||n.renderAll()}},l=e=>{s(e)},c=(e,t)=>{if(!e)return;return`linear-gradient(${t.get(MM,e.degree)}deg, ${e.colorStops.map((e=>e.color+" "+100*e.offset+"%"))})`},u=(e,t,n,i)=>{const r=(e=>{const t=-parseInt(e,10)*(Math.PI/180);return{x1:Math.round(50+50*Math.sin(t))/100,y1:Math.round(50+50*Math.cos(t))/100,x2:Math.round(50+50*Math.sin(t+Math.PI))/100,y2:Math.round(50+50*Math.cos(t+Math.PI))/100}})(i);return new vA.fabric.Gradient({type:"linear",gradientUnits:"pencentage",coords:{x1:r.x1*t,y1:r.y1*n,x2:r.x2*t,y2:r.y2*n},colorStops:[...e]})},h=()=>{var e;null==(e=null==r?void 0:r.proxy)||e.$forceUpdate()};return ci((()=>{ki((()=>{var e,t,n;a(),null==(e=i.editor)||e.on("selectCancel",h),null==(t=i.editor)||t.on("selectOne",a),null==(n=i.canvas)||n.on("object:modified",a)}))})),or((()=>{var e,t,n;null==(e=i.editor)||e.off("selectCancel",h),null==(t=i.editor)||t.off("selectOne",a),null==(n=i.canvas)||n.off("object:modified",a)})),(e,i)=>{const r=tn,a=sv;return pi(n)&&"image"!==pi(t)&&"group"!==pi(t)?(ui(),hi("div",BM,[Hi(r,{"content-position":"left"},{default:mi((()=>[OM])),_:1}),vi("div",TM,[Hi(a,{width:"280px",placement:"top-start",effect:"light",trigger:"hover"},{reference:mi((()=>[vi("div",{class:"color-bar",style:Ni({background:pi(o).fill})},null,4)])),default:mi((()=>[vi("div",DM,[Hi(kM,{value:pi(o).fill,"onUpdate:value":i[0]||(i[0]=e=>pi(o).fill=e),modes:["渐变","纯色"],onChange:s,onNativePick:l},null,8,["value"])])])),_:1})])])):Fi("",!0)}}}),[["__scopeId","data-v-ae38b2ac"]]),LM=e=>(Tr("data-v-21b64001"),e=e(),Dr(),e),PM={key:0,class:"box mb-20px"},jM=LM((()=>vi("h4",null,"图像描边",-1))),RM={class:"hd-wrap"},FM={class:"hd flex-1"},NM=LM((()=>vi("span",null,"启用图像描边",-1))),VM={class:"hd-wrap"},UM=LM((()=>vi("div",{class:"hd"},[vi("span",null,"是否只显示描边")],-1))),zM={class:"operation"},HM=LM((()=>vi("div",{class:"hd",style:{"flex-basis":"98px"}},[vi("span",null,"描边大小")],-1))),YM={style:{width:"100%"}},GM={class:"operation",style:{"justify-content":"space-between"}},WM=LM((()=>vi("div",{class:"hd"},[vi("span",null,"描边颜色")],-1))),XM=Or(ai({__name:"ImgStroke",setup(e){const t=ey(),{isOne:n}=_B(),i=si(!1),r=si(!1),o=si(5),a=si("#000"),s=si(!1),l=()=>{var e;const n=null==(e=t.canvas)?void 0:e.getActiveObject();if(n&&Wm.isImage(n))return n},c=()=>{const e=pi(s)?"destination-out":"source-over";t.editor.imageStrokeDraw(pi(a),pi(o),e)},u=e=>h(this,null,(function*(){e?(0===pi(o)&&(o.value=5),(()=>{const e=l();e&&(e.set("originWidth",null==e?void 0:e.get("width")),e.set("originHeight",null==e?void 0:e.get("height")),e.set("originSrc",null==e?void 0:e.getSrc()))})(),c()):(o.value=0,c())})),d=e=>{e&&(o.value=e,c())},f=e=>{e&&(a.value=e,c())},p=()=>{i.value=!!l()};return ci((()=>{ki((()=>{var e;null==(e=t.editor)||e.on("selectOne",p)}))})),or((()=>{t.editor.off("selectOne",p)})),(e,t)=>{const l=tn,h=Se,p=sv,g=Vv,v=Tv,A=yg;return pi(n)&&pi(i)?(ui(),hi("div",PM,[Hi(l,{"content-position":"left"},{default:mi((()=>[jM])),_:1}),vi("div",RM,[vi("div",FM,[NM,Hi(p,{trigger:"hover",content:"只支持png透明图像"},{reference:mi((()=>[Hi(h,{color:"#f34250"},{default:mi((()=>[Hi(pi(In))])),_:1})])),_:1})]),Hi(g,{modelValue:pi(r),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(r)?r.value=e:null),size:"large","inline-prompt":"",class:"switch","active-text":"开启","inactive-text":"关闭",onChange:u},null,8,["modelValue"])]),pi(r)?(ui(),hi(ji,{key:0},[vi("div",VM,[UM,Hi(g,{"inline-prompt":"",modelValue:pi(s),"onUpdate:modelValue":t[1]||(t[1]=e=>Qi(s)?s.value=e:null),size:"large",class:"switch","active-text":"是","inactive-text":"否",onChange:c},null,8,["modelValue"])]),vi("div",zM,[HM,vi("div",YM,[Hi(v,{modelValue:pi(o),"onUpdate:modelValue":t[2]||(t[2]=e=>Qi(o)?o.value=e:null),max:50,onChange:d},null,8,["modelValue"])])]),vi("div",GM,[WM,vi("div",null,[Hi(A,{modelValue:pi(a),"onUpdate:modelValue":t[3]||(t[3]=e=>Qi(a)?a.value=e:null),onChange:f,placement:"left"},null,8,["modelValue"])])])],64)):Fi("",!0)])):Fi("",!0)}}}),[["__scopeId","data-v-21b64001"]]),$M=""+new URL("../assets/BlackWhite-D0k4iDLO.png",import.meta.url).href,qM=""+new URL("../assets/Brownie-5RUMvKA4.png",import.meta.url).href,KM=""+new URL("../assets/Invert-Hm5CLPU-.png",import.meta.url).href,JM=""+new URL("../assets/Kodachrome-Csq7xRvv.png",import.meta.url).href,ZM=""+new URL("../assets/Polaroid-_9eYyYhg.png",import.meta.url).href,eQ=""+new URL("../assets/Sepia-CCBV97ZV.png",import.meta.url).href,tQ=""+new URL("../assets/Vintage-Cedqhw4o.png",import.meta.url).href,nQ=""+new URL("../assets/technicolor-P5g_tRH3.png",import.meta.url).href,iQ={SELECT:"select",COLOR:"color",NUMBER:"number"},rQ=[{type:"Brightness",status:!1,params:[{key:"brightness",value:0,uiType:iQ.NUMBER,min:-1,max:1,step:.01}]},{type:"Contrast",status:!1,params:[{key:"contrast",value:0,uiType:iQ.NUMBER,min:-1,max:1,step:.01}]},{type:"Saturation",status:!1,params:[{key:"saturation",value:0,uiType:iQ.NUMBER,min:-1,max:1,step:.01}]},{type:"Vibrance",status:!1,params:[{key:"vibrance",value:0,uiType:iQ.NUMBER,min:-1,max:1,step:.01}]},{type:"HueRotation",status:!1,params:[{key:"rotation",value:0,uiType:iQ.NUMBER,min:-1,max:1,step:.01}]},{type:"Noise",status:!1,params:[{key:"noise",value:0,uiType:iQ.NUMBER,min:-1,max:1e3,step:.1}]},{type:"Pixelate",status:!1,params:[{key:"blocksize",value:.01,uiType:iQ.NUMBER,min:.01,max:100,step:.01}]},{type:"Blur",status:!1,params:[{key:"blur",value:0,uiType:iQ.NUMBER,min:0,max:1,step:.01}]},{type:"Grayscale",status:!1,params:[{key:"mode",value:"average",uiType:iQ.SELECT,list:["average","lightness","luminosity"]}]},{type:"RemoveColor",status:!1,params:[{key:"color",value:"",uiType:iQ.COLOR},{key:"distance",value:0,uiType:iQ.NUMBER,min:0,max:1,step:.01}]}],oQ=[{type:"Gamma",status:!1,params:[{key:"red",value:0,uiType:iQ.NUMBER,min:.01,max:2.2,step:.01},{key:"green",value:0,uiType:iQ.NUMBER,min:.01,max:2.2,step:.01},{key:"blue",value:0,uiType:iQ.NUMBER,min:.01,max:2.2,step:.01}],handler:(e,t,n)=>({gamma:[e,t,n]})}],aQ={key:0,class:"mb-12px"},sQ=(e=>(Tr("data-v-ca4f321d"),e=e(),Dr(),e))((()=>vi("h4",null,"图片滤镜",-1))),lQ={class:"filter-box overflow-hidden"},cQ=["src","onClick"],uQ={key:0,class:"content"},hQ={key:0},dQ={key:1},fQ={key:2},pQ=ai({__name:"Filters",setup(e){const{isOne:t}=_B(),n=ey(),i=Ci(),r={BlackWhite:!1,Brownie:!1,Vintage:!1,Kodachrome:!1,technicolor:!1,Polaroid:!1,Invert:!1,Sepia:!1},o=zi({uiType:iQ,noParamsFilters:r,paramsFilters:[...rQ],combinationFilters:[...oQ],type:""}),a=(e,t)=>{var i;const r=null==(i=n.canvas)?void 0:i.getActiveObjects()[0];if(o.noParamsFilters[e]=t,t){h(r,e)||u(r,e)}else d(r,e)},s=e=>{var t;const i=null==(t=n.canvas)?void 0:t.getActiveObjects()[0],r=[...o.paramsFilters,...o.combinationFilters].find((t=>t.type===e));r.status?r.handler?function(e){var t;const i=null==(t=n.canvas)?void 0:t.getActiveObjects()[0];d(i,e.type);const r=e.params.map((e=>e.value));u(i,e.type,e.handler(...r))}(r):r.params.forEach((t=>{!function(e,t,i){var r,o;const a=null==(r=n.canvas)?void 0:r.getActiveObjects()[0],s=h(a,e);if(s)s[t]=i;else{u(a,e)[t]=i}a.applyFilters(),null==(o=n.canvas)||o.renderAll()}(e,t.key,t.value)})):d(i,e)},l=()=>{var e,t;const a=null==(e=n.canvas)?void 0:e.getActiveObjects()[0];a&&(o.type=a.type,"image"===o.type&&(Object.keys(r).forEach((e=>{var t;o.noParamsFilters[e]=!!h(a,e),null==(t=null==i?void 0:i.proxy)||t.$forceUpdate()})),rQ.forEach((e=>{const t=o.paramsFilters.find((t=>t.type===e.type)),n=h(a,e.type);t.status=!!n,t.params.forEach((e=>{e.value=n?n[e.key]:e.value}))})),oQ.forEach((e=>{const t=o.combinationFilters.find((t=>t.type===e.type)),n=h(a,e.type);t.status=!!n}))),null==(t=null==i?void 0:i.proxy)||t.$forceUpdate())};function c(e){return new URL(Object.assign({"../assets/filters/BlackWhite.png":$M,"../assets/filters/Brownie.png":qM,"../assets/filters/Invert.png":KM,"../assets/filters/Kodachrome.png":JM,"../assets/filters/Polaroid.png":ZM,"../assets/filters/Sepia.png":eQ,"../assets/filters/Vintage.png":tQ,"../assets/filters/technicolor.png":nQ})[`../assets/filters/${e}.png`],import.meta.url).href}function u(e,t,i=null){var r;let o;const a=f(t),s=vA.fabric.Image.filters[a];return s&&(o=new s(i),o.options=i,e.filters.push(o)),e.applyFilters(),null==(r=n.canvas)||r.renderAll(),o}function h(e,t){let n=null;if(e){const i=f(t),{length:r}=e.filters;let o,a;for(a=0;a<r;a+=1)if(o=e.filters[a],o.type===i){n=o;break}}return n}function d(e,t){var i;const r=f(t);e.filters=e.filters.filter((e=>e.type!==r)),e.applyFilters(),null==(i=n.canvas)||i.renderAll()}function f(e){return e.charAt(0).toUpperCase()+e.slice(1)}return ci((()=>{ki((()=>{var e;null==(e=n.editor)||e.on("selectOne",l)}))})),or((()=>{ki((()=>{var e;null==(e=n.editor)||e.off("selectOne",l)}))})),(e,n)=>{const i=tn,l=Wf,u=zp,h=dp,d=fp,f=Tv,p=yg,g=Up;return pi(t)&&"image"===pi(o).type?(ui(),hi("div",aQ,[Hi(i,{"content-position":"left"},{default:mi((()=>[sQ])),_:1}),Hi(g,null,{default:mi((()=>[Hi(u,{name:"1"},{title:mi((()=>[Ri(bi(e.$t("editor.filters.simple")),1)])),default:mi((()=>[vi("div",lQ,[(ui(!0),hi(ji,null,Zi(pi(o).noParamsFilters,((t,n)=>(ui(),hi("div",{class:"filter-item",key:n},[Ri(bi(n)+" ",1),vi("img",{src:c(n),onClick:e=>a(n,!r[n])},null,8,cQ),Hi(l,{modelValue:pi(o).noParamsFilters[n],"onUpdate:modelValue":e=>pi(o).noParamsFilters[n]=e,onChange:e=>a(n,e)},{default:mi((()=>[Ri(bi(e.$t("editor.filters."+n)),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])))),128))])])),_:1}),Hi(u,{name:"2",title:e.$t("editor.filters.complex")},{default:mi((()=>[vi("div",null,[(ui(!0),hi(ji,null,Zi([...pi(o).paramsFilters,...pi(o).combinationFilters],(t=>(ui(),hi("div",{class:"filter-item has-params",key:t.type},[Hi(l,{modelValue:t.status,"onUpdate:modelValue":e=>t.status=e,onChange:e=>s(t.type)},{default:mi((()=>[Ri(bi(e.$t("editor.filters."+t.type)),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"]),t.status?(ui(),hi("div",uQ,[(ui(!0),hi(ji,null,Zi(t.params,(n=>(ui(),hi("div",{class:"content slider-box",key:n},[n.uiType===pi(iQ).SELECT?(ui(),hi("div",hQ,[Hi(d,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,onChange:e=>s(t.type)},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(n.list,(n=>(ui(),Ai(h,{value:n,key:n},{default:mi((()=>[Ri(bi(e.$t("editor.filters."+t.type+"List."+n)),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])):Fi("",!0),n.uiType===pi(iQ).NUMBER?(ui(),hi("div",dQ,[Hi(f,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,max:n.max,min:n.min,step:n.step,onOnInput:e=>s(t.type)},null,8,["modelValue","onUpdate:modelValue","max","min","step","onOnInput"])])):Fi("",!0),n.uiType===pi(iQ).COLOR?(ui(),hi("div",fQ,[Hi(p,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,"show-alpha":"",size:"small",onChange:e=>s(t.type)},null,8,["modelValue","onUpdate:modelValue","onChange"])])):Fi("",!0)])))),128))])):Fi("",!0)])))),128))])])),_:1},8,["title"])])),_:1})])):Fi("",!0)}}}),gQ=Or(pQ,[["__scopeId","data-v-ca4f321d"]]),vQ=e=>(Tr("data-v-c371f3a1"),e=e(),Dr(),e),AQ={key:0,class:"box attr-item-box"},mQ=vQ((()=>vi("h4",null,"二位码属性",-1))),yQ={class:"flex-view"},bQ={class:"flex-item"},CQ=vQ((()=>vi("span",{class:"label"},"内容",-1))),wQ={class:"flex-1"},xQ={class:"flex-view"},_Q={class:"flex-item"},EQ={class:"content number-content"},SQ={class:"flex-item",style:{"margin-left":"20px"}},IQ={class:"content number-content"},kQ={class:"flex-view"},BQ={class:"flex-item"},OQ=vQ((()=>vi("span",{class:"label"},"散点",-1))),TQ={class:"content"},DQ={class:"flex-item"},MQ=vQ((()=>vi("span",{class:"label",style:{"margin-left":"10px"}},"类型",-1))),QQ={class:"content"},LQ={class:"flex-view"},PQ={class:"flex-item"},jQ=vQ((()=>vi("span",{class:"label"},"外角",-1))),RQ={class:"content"},FQ={class:"flex-item"},NQ=vQ((()=>vi("span",{class:"label",style:{"margin-left":"10px"}},"类型",-1))),VQ={class:"content"},UQ={class:"flex-view"},zQ={class:"flex-item"},HQ=vQ((()=>vi("span",{class:"label"},"内角",-1))),YQ={class:"content"},GQ={class:"flex-item"},WQ=vQ((()=>vi("span",{class:"label",style:{"margin-left":"10px"}},"类型",-1))),XQ={class:"content"},$Q={class:"flex-view"},qQ={class:"flex-item"},KQ=vQ((()=>vi("span",{class:"label"},"背景",-1))),JQ={class:"content"},ZQ={class:"flex-item"},eL=vQ((()=>vi("span",{class:"label",style:{"margin-left":"10px"}},"容错",-1))),tL={class:"content"},nL=Or(ai({__name:"AttributeQrCode",setup(e){const t=ey(),{isOne:n,isMatchType:i}=_B(["image"]),r=Ci(),o=si(""),a=Si((()=>"qrcode"===o.value)),s=zi({data:"",width:300,margin:10,errorCorrectionLevel:"M",dotsColor:"#000000",dotsType:"rounded",cornersSquareColor:"#000000",cornersSquareType:"dot",cornersDotColor:"#000000",cornersDotType:"square",background:"#ffffff"}),l=e=>{var n;const r=null==(n=t.canvas)?void 0:n.getActiveObject();if((!e||!e.target||e.target===r)&&(o.value=(null==r?void 0:r.extensionType)||"",r&&i&&"qrcode"===(null==r?void 0:r.extensionType))){const e=r.get("extension");Object.keys(e).forEach((t=>{s[t]=e[t]}))}},c=()=>{var e;t.editor.setQrCode(Ti(s)),null==(e=t.canvas)||e.renderAll()},u=()=>{var e;o.value="",null==(e=null==r?void 0:r.proxy)||e.$forceUpdate()},h=zi({CornersType:[],DotsType:[],cornersDotType:[],errorCorrectionLevelType:[]});return ci((()=>{ki((()=>{var e,n,i,r;const o=null==(e=t.editor)?void 0:e.getQrCodeTypes();o&&Object.assign(h,o),null==(n=t.editor)||n.on("selectCancel",u),null==(i=t.editor)||i.on("selectOne",l),null==(r=t.canvas)||r.on("object:modified",l)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",u),null==(n=t.editor)||n.off("selectOne",l),null==(i=t.canvas)||i.off("object:modified",l)})),(e,t)=>{const r=tn,o=Ze,l=yg,u=tv,d=ev;return pi(n)&&pi(i)&&pi(a)?(ui(),hi("div",AQ,[Hi(r,{"content-position":"left"},{default:mi((()=>[mQ])),_:1}),vi("div",null,[vi("div",yQ,[vi("div",bQ,[CQ,vi("div",wQ,[Hi(o,{modelValue:pi(s).data,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(s).data=e),onChange:c},null,8,["modelValue"])])])]),vi("div",xQ,[vi("div",_Q,[vi("div",EQ,[Hi(pi(QT),{modelValue:pi(s).width,"onUpdate:modelValue":t[1]||(t[1]=e=>pi(s).width=e),onOnChange:c,append:"宽度",min:1},null,8,["modelValue"])])]),vi("div",SQ,[vi("div",IQ,[Hi(pi(QT),{modelValue:pi(s).margin,"onUpdate:modelValue":t[2]||(t[2]=e=>pi(s).margin=e),onOnChange:c,append:"边距",min:1},null,8,["modelValue"])])])]),vi("div",kQ,[vi("div",BQ,[OQ,vi("div",TQ,[Hi(l,{id:"dotsColor",modelValue:pi(s).dotsColor,"onUpdate:modelValue":t[3]||(t[3]=e=>pi(s).dotsColor=e),onChange:c,"show-alpha":""},null,8,["modelValue"])])]),vi("div",DQ,[MQ,vi("div",QQ,[Hi(d,{modelValue:pi(s).dotsType,"onUpdate:modelValue":t[4]||(t[4]=e=>pi(s).dotsType=e),onChange:c,style:{width:"90px"}},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(h).DotsType,(e=>(ui(),Ai(u,{value:e,key:e},{default:mi((()=>[Ri(bi(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])])]),vi("div",LQ,[vi("div",PQ,[jQ,vi("div",RQ,[Hi(l,{id:"cornersSquareColor",modelValue:pi(s).cornersSquareColor,"onUpdate:modelValue":t[5]||(t[5]=e=>pi(s).cornersSquareColor=e),onChange:c,"show-alpha":""},null,8,["modelValue"])])]),vi("div",FQ,[NQ,vi("div",VQ,[Hi(d,{modelValue:pi(s).cornersSquareType,"onUpdate:modelValue":t[6]||(t[6]=e=>pi(s).cornersSquareType=e),onChange:c,style:{width:"90px"}},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(h).cornersDotType,(e=>(ui(),Ai(u,{value:e,key:e},{default:mi((()=>[Ri(bi(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])])]),vi("div",UQ,[vi("div",zQ,[HQ,vi("div",YQ,[Hi(l,{id:"cornersDotColor",modelValue:pi(s).cornersDotColor,"onUpdate:modelValue":t[7]||(t[7]=e=>pi(s).cornersDotColor=e),onChange:c,"show-alpha":""},null,8,["modelValue"])])]),vi("div",GQ,[WQ,vi("div",XQ,[Hi(d,{modelValue:pi(s).cornersDotType,"onUpdate:modelValue":t[8]||(t[8]=e=>pi(s).cornersDotType=e),onChange:c,style:{width:"90px"}},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(h).cornersDotType,(e=>(ui(),Ai(u,{value:e,key:e},{default:mi((()=>[Ri(bi(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])])]),vi("div",$Q,[vi("div",qQ,[KQ,vi("div",JQ,[Hi(l,{id:"background",modelValue:pi(s).background,"onUpdate:modelValue":t[9]||(t[9]=e=>pi(s).background=e),onChange:c,"show-alpha":""},null,8,["modelValue"])])]),vi("div",ZQ,[eL,vi("div",tL,[Hi(d,{modelValue:pi(s).errorCorrectionLevel,"onUpdate:modelValue":t[10]||(t[10]=e=>pi(s).errorCorrectionLevel=e),onChange:c,style:{width:"90px"}},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(h).errorCorrectionLevelType,(e=>(ui(),Ai(u,{value:e,key:e},{default:mi((()=>[Ri(bi(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])])])])])):Fi("",!0)}}}),[["__scopeId","data-v-c371f3a1"]]),iL=e=>(Tr("data-v-aeab6e2c"),e=e(),Dr(),e),rL={key:0,class:"attr-item-box"},oL=iL((()=>vi("h4",null,"条形码属性",-1))),aL={class:"flex-view"},sL={class:"flex-item"},lL=iL((()=>vi("span",{class:"label"},"代码",-1))),cL={class:"content"},uL={key:0,class:"flex-view"},hL={class:"flex-item"},dL=iL((()=>vi("span",{class:"label"},"文字",-1))),fL={class:"content"},pL={class:"flex-view"},gL={class:"flex-item"},vL=iL((()=>vi("span",{class:"label"},"显示",-1))),AL={class:"content"},mL={key:0,class:"flex-item"},yL=iL((()=>vi("span",{class:"label"},"垂直",-1))),bL={class:"content"},CL={key:1,class:"flex-view"},wL={class:"flex-item"},xL={class:"flex-view"},_L={span:12,class:"flex-item"},EL=iL((()=>vi("span",{class:"label"},"条码",-1))),SL={class:"content"},IL={key:0,span:12,class:"flex-item"},kL={class:"content f-center"},BL={class:"flex-view"},OL={class:"flex-item"},TL=iL((()=>vi("span",{class:"label"},"背景",-1))),DL={class:"content"},ML={class:"flex-item"},QL=iL((()=>vi("span",{class:"label mr-10px"},"类型",-1))),LL={class:"content"},PL=ai({__name:"AttributeBarcode",setup(e){const t=ey(),{isOne:n,isMatchType:i}=_B(["image"]),r=Ci(),o=si(""),a=Si((()=>"barcode"===o.value)),s=zi({value:"",format:"",text:"12121",textAlign:"left",textPosition:"bottom",fontSize:12,background:"",lineColor:"",displayValue:!1}),l=["left","center","right"],c=["left","center","right"],u=e=>{var n;const r=null==(n=t.canvas)?void 0:n.getActiveObject();e&&e.target&&e.target!==r||(o.value=(null==r?void 0:r.extensionType)||"",r&&i&&"barcode"===(null==r?void 0:r.extensionType)&&(s.value=r.get("extension").value,s.format=r.get("extension").format,s.text=r.get("extension").text,s.textAlign=r.get("extension").textAlign,s.textPosition=r.get("extension").textPosition,s.fontSize=r.get("extension").fontSize,s.background=r.get("extension").background,s.lineColor=r.get("extension").lineColor,s.displayValue=r.get("extension").displayValue))},h=()=>{var e;t.editor.setBarcode(Ti(s)),null==(e=t.canvas)||e.renderAll()},d=()=>{var e;o.value="",null==(e=null==r?void 0:r.proxy)||e.$forceUpdate()},f=si([]);return ci((()=>{ki((()=>{var e,n,i,r;u(),f.value=null==(e=t.editor)?void 0:e.getBarcodeTypes(),null==(n=t.editor)||n.on("selectCancel",d),null==(i=t.editor)||i.on("selectOne",u),null==(r=t.canvas)||r.on("object:modified",u)}))})),or((()=>{var e,n,i;null==(e=t.editor)||e.off("selectCancel",d),null==(n=t.editor)||n.off("selectOne",u),null==(i=t.canvas)||i.off("object:modified",u)})),(e,t)=>{const r=tn,o=Ze,u=Vv,d=tv,p=ev,g=en,v=pp,A=fp,m=yg;return pi(n)&&pi(i)&&pi(a)?(ui(),hi("div",rL,[Hi(r,{"content-position":"left"},{default:mi((()=>[oL])),_:1}),vi("div",null,[vi("div",aL,[vi("div",sL,[lL,vi("div",cL,[Hi(o,{modelValue:pi(s).value,"onUpdate:modelValue":t[0]||(t[0]=e=>pi(s).value=e),onChange:h},null,8,["modelValue"])])])]),pi(s).displayValue?(ui(),hi("div",uL,[vi("div",hL,[dL,vi("div",fL,[Hi(o,{modelValue:pi(s).text,"onUpdate:modelValue":t[1]||(t[1]=e=>pi(s).text=e),onChange:h},null,8,["modelValue"])])])])):Fi("",!0),vi("div",pL,[vi("div",gL,[vL,vi("div",AL,[Hi(u,{modelValue:pi(s).displayValue,"onUpdate:modelValue":t[2]||(t[2]=e=>pi(s).displayValue=e),onChange:h},null,8,["modelValue"])])]),pi(s).displayValue?(ui(),hi("div",mL,[yL,vi("div",bL,[Hi(p,{modelValue:pi(s).textPosition,"onUpdate:modelValue":t[3]||(t[3]=e=>pi(s).textPosition=e),onChange:h},{default:mi((()=>[Hi(d,{value:"bottom"},{default:mi((()=>[Ri("bottom")])),_:1}),Hi(d,{value:"top"},{default:mi((()=>[Ri("top")])),_:1})])),_:1},8,["modelValue"])])])):Fi("",!0)]),pi(s).displayValue?(ui(),hi("div",CL,[vi("div",wL,[Hi(A,{class:"button-group",modelValue:pi(s).textAlign,"onUpdate:modelValue":t[4]||(t[4]=e=>pi(s).textAlign=e),onChange:h,size:"small"},{default:mi((()=>[(ui(),hi(ji,null,Zi(l,((e,t)=>Hi(v,{label:e,value:e,key:e},{default:mi((()=>[Hi(g,{extClass:"text-20px",color:"#fff",icon:c[t]},null,8,["icon"])])),_:2},1032,["label","value"]))),64))])),_:1},8,["modelValue"])])])):Fi("",!0),vi("div",xL,[vi("div",_L,[EL,vi("div",SL,[Hi(m,{modelValue:pi(s).lineColor,"onUpdate:modelValue":t[5]||(t[5]=e=>pi(s).lineColor=e),onChange:h,"show-alpha":""},null,8,["modelValue"])])]),pi(s).displayValue?(ui(),hi("div",IL,[vi("div",kL,[Hi(pi(QT),{modelValue:pi(s).fontSize,"onUpdate:modelValue":t[6]||(t[6]=e=>pi(s).fontSize=e),onOnChange:h,append:"字号",min:1},null,8,["modelValue"])])])):Fi("",!0)]),vi("div",BL,[vi("div",OL,[TL,vi("div",DL,[Hi(m,{modelValue:pi(s).background,"onUpdate:modelValue":t[7]||(t[7]=e=>pi(s).background=e),onChange:h,"show-alpha":""},null,8,["modelValue"])])]),vi("div",ML,[QL,vi("div",LL,[Hi(p,{modelValue:pi(s).format,"onUpdate:modelValue":t[8]||(t[8]=e=>pi(s).format=e),onOnChange:h,style:{width:"90px"}},{default:mi((()=>[(ui(!0),hi(ji,null,Zi(pi(f),(e=>(ui(),Ai(d,{value:e,key:e},{default:mi((()=>[Ri(bi(e),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])])])])])):Fi("",!0)}}}),jL=Or(PL,[["__scopeId","data-v-aeab6e2c"]]),RL={key:0,class:"attr-item-box mt-8px"},FL={class:"bg-item"},NL=Or(ai({__name:"Flip",setup(e){const t=ey(),{isOne:n}=_B(),i=e=>{var n,i;const r=null==(n=t.canvas)?void 0:n.getActiveObject();r.set(`flip${e}`,!r[`flip${e}`]).setCoords(),null==(i=t.canvas)||i.requestRenderAll()};return(e,t)=>{const r=en,o=et,a=nt;return pi(n)?(ui(),hi("div",RL,[vi("div",FL,[Hi(a,{content:e.$t("editor.attrSetting.flip.x")},{default:mi((()=>[Hi(o,{onClick:t[0]||(t[0]=e=>i("X")),link:""},{default:mi((()=>[Hi(r,{extClass:"text-20px",color:"#fff",icon:"flip-x"})])),_:1})])),_:1},8,["content"]),Hi(a,{content:e.$t("editor.attrSetting.flip.y")},{default:mi((()=>[Hi(o,{onClick:t[1]||(t[1]=e=>i("Y")),link:""},{default:mi((()=>[Hi(r,{extClass:"text-20px",color:"#fff",icon:"flip-y"})])),_:1})])),_:1},8,["content"])])])):Fi("",!0)}}}),[["__scopeId","data-v-b455346a"]]),VL={key:0,class:"attr-item-box mt-8px"},UL={class:"bg-item",style:{"margin-bottom":"10px"}},zL={class:"bg-item"},HL=ai({__name:"ClipImage",setup(e){const t=ey(),{isOne:n}=_B(),i=Ci(),{t:r}=Xt(),o=si(""),a=[{label:r("editor.polygonClip"),value:"polygon"},{label:r("editor.rectClip"),value:"rect"},{label:r("editor.circleClip"),value:"circle"},{label:r("editor.triangleClip"),value:"triangle"},{label:r("editor.polygonClipInverted"),value:"polygon-inverted"},{label:r("editor.rectClipInverted"),value:"rect-inverted"},{label:r("editor.circleClipInverted"),value:"circle-inverted"},{label:r("editor.triangleClipInverted"),value:"triangle-inverted"}],s=e=>h(this,null,(function*(){t.editor.addClipPathToImage(e)})),l=()=>{t.editor.removeClip()},c=()=>{var e,n;const r=null==(e=t.canvas)?void 0:e.getActiveObjects()[0];r&&(o.value=r.type,null==(n=null==i?void 0:i.proxy)||n.$forceUpdate())};return ci((()=>{ki((()=>{var e;null==(e=t.editor)||e.on("selectOne",c)}))})),or((()=>{var e;null==(e=t.editor)||e.off("selectOne",c)})),(e,t)=>{const i=et,r=Kt,c=Jt,u=Zt;return pi(n)&&"image"===pi(o)?(ui(),hi("div",VL,[vi("div",UL,[Hi(u,{style:{width:"270px"},onCommand:s},{dropdown:mi((()=>[Hi(c,null,{default:mi((()=>[(ui(),hi(ji,null,Zi(a,(e=>Hi(r,{key:e.value,command:e.value},{default:mi((()=>[Ri(bi(e.label),1)])),_:2},1032,["command"]))),64))])),_:1})])),default:mi((()=>[Hi(i,{text:""},{default:mi((()=>[Ri(bi(e.$t("editor.createClip")),1)])),_:1})])),_:1})]),vi("div",zL,[Hi(i,{onClick:l,text:""},{default:mi((()=>[Ri(bi(e.$t("editor.removeClip")),1)])),_:1})])])):Fi("",!0)}}}),YL=Or(HL,[["__scopeId","data-v-bd4fb21b"]]),GL={};GL.getData=e=>new Promise(((t,n)=>{let i={};(function(e){let t=null;return new Promise(((n,i)=>{if(e.src)if(/^data\:/i.test(e.src))t=function(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"",e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");for(var n=atob(e),i=n.length%2==0?n.length:n.length+1,r=new ArrayBuffer(i),o=new Uint16Array(r),a=0;a<i;a++)o[a]=n.charCodeAt(a);return r}(e.src),n(t);else if(/^blob\:/i.test(e.src)){var r=new FileReader;r.onload=function(e){t=e.target.result,n(t)},function(e,t){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="blob",n.onload=function(e){(200==this.status||0===this.status)&&t(this.response)},n.send()}(e.src,(function(e){r.readAsArrayBuffer(e)}))}else{var o=new XMLHttpRequest;o.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";t=o.response,n(t),o=null},o.open("GET",e.src,!0),o.responseType="arraybuffer",o.send(null)}else i("img error")}))})(e).then((e=>{i.arrayBuffer=e;try{i.orientation=function(e){var t,n,i,r,o,a,s,l,c,u,h=new DataView(e),d=h.byteLength;if(255===h.getUint8(0)&&216===h.getUint8(1))for(c=2;c<d;){if(255===h.getUint8(c)&&225===h.getUint8(c+1)){s=c;break}c++}if(s&&(n=s+4,i=s+10,"Exif"===function(e,t,n){var i,r="";for(i=t,n+=t;i<n;i++)r+=String.fromCharCode(e.getUint8(i));return r}(h,n,4)&&(a=h.getUint16(i),((o=18761===a)||19789===a)&&42===h.getUint16(i+2,o)&&(r=h.getUint32(i+4,o),r>=8&&(l=i+r)))),l)for(d=h.getUint16(l,o),u=0;u<d;u++)if(c=l+12*u+2,274===h.getUint16(c,o)){c+=8,t=h.getUint16(c,o);break}return t}(e)}catch(n){i.orientation=-1}t(i)})).catch((e=>{n(e)}))}));const WL=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},XL=ai({data:function(){return{w:0,h:0,scale:1,x:0,y:0,loading:!0,trueWidth:0,trueHeight:0,move:!0,moveX:0,moveY:0,crop:!1,cropping:!1,cropW:0,cropH:0,cropOldW:0,cropOldH:0,canChangeX:!1,canChangeY:!1,changeCropTypeX:1,changeCropTypeY:1,cropX:0,cropY:0,cropChangeX:0,cropChangeY:0,cropOffsertX:0,cropOffsertY:0,support:"",touches:[],touchNow:!1,rotate:0,isIos:!1,orientation:0,imgs:"",coe:.2,scaling:!1,scalingSet:"",coeStatus:"",isCanShow:!0,imgIsQqualCrop:!1}},props:{img:{type:[String,Blob,null,File],default:""},outputSize:{type:Number,default:1},outputType:{type:String,default:"jpeg"},info:{type:Boolean,default:!0},canScale:{type:Boolean,default:!0},autoCrop:{type:Boolean,default:!1},autoCropWidth:{type:[Number,String],default:0},autoCropHeight:{type:[Number,String],default:0},fixed:{type:Boolean,default:!1},fixedNumber:{type:Array,default:()=>[1,1]},fixedBox:{type:Boolean,default:!1},full:{type:Boolean,default:!1},canMove:{type:Boolean,default:!0},canMoveBox:{type:Boolean,default:!0},original:{type:Boolean,default:!1},centerBox:{type:Boolean,default:!1},high:{type:Boolean,default:!0},infoTrue:{type:Boolean,default:!1},maxImgSize:{type:[Number,String],default:2e3},enlarge:{type:[Number,String],default:1},preW:{type:[Number,String],default:0},mode:{type:String,default:"contain"},limitMinSize:{type:[Number,Array,String],default:()=>10,validator:function(e){return Array.isArray(e)?Number(e[0])>=0&&Number(e[1])>=0:Number(e)>=0}},fillColor:{type:String,default:""}},computed:{cropInfo(){let e={};if(e.top=this.cropOffsertY>21?"-21px":"0px",e.width=this.cropW>0?this.cropW:0,e.height=this.cropH>0?this.cropH:0,this.infoTrue){let t=1;this.high&&!this.full&&(t=window.devicePixelRatio),1!==this.enlarge&!this.full&&(t=Math.abs(Number(this.enlarge))),e.width=e.width*t,e.height=e.height*t,this.full&&(e.width=e.width/this.scale,e.height=e.height/this.scale)}return e.width=e.width.toFixed(0),e.height=e.height.toFixed(0),e},isIE:()=>!!window.ActiveXObject||"ActiveXObject"in window,passive(){return this.isIE?null:{passive:!1}},isRotateRightOrLeft(){return[1,-1,3,-3].includes(this.rotate)}},watch:{img(){this.checkedImg()},imgs(e){""!==e&&this.reload()},cropW(){this.showPreview()},cropH(){this.showPreview()},cropOffsertX(){this.showPreview()},cropOffsertY(){this.showPreview()},scale(e,t){this.showPreview()},x(){this.showPreview()},y(){this.showPreview()},autoCrop(e){e&&this.goAutoCrop()},autoCropWidth(){this.autoCrop&&this.goAutoCrop()},autoCropHeight(){this.autoCrop&&this.goAutoCrop()},mode(){this.checkedImg()},rotate(){this.showPreview(),(this.autoCrop||this.cropW>0||this.cropH>0)&&this.goAutoCrop(this.cropW,this.cropH)}},methods:{getVersion(e){var t=navigator.userAgent.split(" "),n="";let i=0;const r=new RegExp(e,"i");for(var o=0;o<t.length;o++)r.test(t[o])&&(n=t[o]);return i=n?n.split("/")[1].split("."):["0","0","0"],i},checkOrientationImage(e,t,n,i){if(this.getVersion("chrome")[0]>=81)t=-1;else if(this.getVersion("safari")[0]>=605){const e=this.getVersion("version");e[0]>13&&e[1]>1&&(t=-1)}else{const e=navigator.userAgent.toLowerCase().match(/cpu iphone os (.*?) like mac os/);if(e){let n=e[1];n=n.split("_"),(n[0]>13||n[0]>=13&&n[1]>=4)&&(t=-1)}}let r=document.createElement("canvas"),o=r.getContext("2d");switch(o.save(),t){case 2:r.width=n,r.height=i,o.translate(n,0),o.scale(-1,1);break;case 3:r.width=n,r.height=i,o.translate(n/2,i/2),o.rotate(180*Math.PI/180),o.translate(-n/2,-i/2);break;case 4:r.width=n,r.height=i,o.translate(0,i),o.scale(1,-1);break;case 5:r.height=n,r.width=i,o.rotate(.5*Math.PI),o.scale(1,-1);break;case 6:r.width=i,r.height=n,o.translate(i/2,n/2),o.rotate(90*Math.PI/180),o.translate(-n/2,-i/2);break;case 7:r.height=n,r.width=i,o.rotate(.5*Math.PI),o.translate(n,-i),o.scale(-1,1);break;case 8:r.height=n,r.width=i,o.translate(i/2,n/2),o.rotate(-90*Math.PI/180),o.translate(-n/2,-i/2);break;default:r.width=n,r.height=i}o.drawImage(e,0,0,n,i),o.restore(),r.toBlob((e=>{let t=URL.createObjectURL(e);URL.revokeObjectURL(this.imgs),this.imgs=t}),"image/"+this.outputType,1)},checkedImg(){if(null===this.img||""===this.img)return this.imgs="",void this.clearCrop();this.loading=!0,this.scale=1,this.rotate=0,this.imgIsQqualCrop=!1,this.clearCrop();let e=new Image;if(e.onload=()=>{if(""===this.img)return this.$emit("img-load",new Error("图片不能为空")),!1;let t=e.width,n=e.height;GL.getData(e).then((i=>{this.orientation=i.orientation||1;let r=Number(this.maxImgSize);!this.orientation&&t<r&n<r?this.imgs=this.img:(t>r&&(n=n/t*r,t=r),n>r&&(t=t/n*r,n=r),this.checkOrientationImage(e,this.orientation,t,n))})).catch((e=>{this.$emit("img-load","error"),this.$emit("img-load-error",e)}))},e.onerror=e=>{this.$emit("img-load","error"),this.$emit("img-load-error",e)},"data"!==this.img.substr(0,4)&&(e.crossOrigin=""),this.isIE){var t=new XMLHttpRequest;t.onload=function(){var t=URL.createObjectURL(this.response);e.src=t},t.open("GET",this.img,!0),t.responseType="blob",t.send()}else e.src=this.img},startMove(e){if(e.preventDefault(),this.move&&!this.crop){if(!this.canMove)return!1;this.moveX=("clientX"in e?e.clientX:e.touches[0].clientX)-this.x,this.moveY=("clientY"in e?e.clientY:e.touches[0].clientY)-this.y,e.touches?(window.addEventListener("touchmove",this.moveImg),window.addEventListener("touchend",this.leaveImg),2==e.touches.length&&(this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale))):(window.addEventListener("mousemove",this.moveImg),window.addEventListener("mouseup",this.leaveImg)),this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}else this.cropping=!0,window.addEventListener("mousemove",this.createCrop),window.addEventListener("mouseup",this.endCrop),window.addEventListener("touchmove",this.createCrop),window.addEventListener("touchend",this.endCrop),this.cropOffsertX=e.offsetX?e.offsetX:e.touches[0].pageX-this.$refs.cropper.offsetLeft,this.cropOffsertY=e.offsetY?e.offsetY:e.touches[0].pageY-this.$refs.cropper.offsetTop,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.cropW=0,this.cropH=0},touchScale(e){e.preventDefault();let t=this.scale;var n=this.touches[0].clientX,i=this.touches[0].clientY,r=e.touches[0].clientX,o=e.touches[0].clientY,a=this.touches[1].clientX,s=this.touches[1].clientY,l=e.touches[1].clientX,c=e.touches[1].clientY,u=Math.sqrt(Math.pow(n-a,2)+Math.pow(i-s,2)),h=Math.sqrt(Math.pow(r-l,2)+Math.pow(o-c,2))-u,d=1,f=(d=(d=d/this.trueWidth>d/this.trueHeight?d/this.trueHeight:d/this.trueWidth)>.1?.1:d)*h;if(!this.touchNow){if(this.touchNow=!0,h>0?t+=Math.abs(f):h<0&&t>Math.abs(f)&&(t-=Math.abs(f)),this.touches=e.touches,setTimeout((()=>{this.touchNow=!1}),8),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t}},cancelTouchScale(e){window.removeEventListener("touchmove",this.touchScale)},moveImg(e){if(e.preventDefault(),e.touches&&2===e.touches.length)return this.touches=e.touches,window.addEventListener("touchmove",this.touchScale),window.addEventListener("touchend",this.cancelTouchScale),window.removeEventListener("touchmove",this.moveImg),!1;let t,n,i="clientX"in e?e.clientX:e.touches[0].clientX,r="clientY"in e?e.clientY:e.touches[0].clientY;t=i-this.moveX,n=r-this.moveY,this.$nextTick((()=>{if(this.centerBox){let e,i,r,o,a=this.getImgAxis(t,n,this.scale),s=this.getCropAxis(),l=this.trueHeight*this.scale,c=this.trueWidth*this.scale;switch(this.rotate){case 1:case-1:case 3:case-3:e=this.cropOffsertX-this.trueWidth*(1-this.scale)/2+(l-c)/2,i=this.cropOffsertY-this.trueHeight*(1-this.scale)/2+(c-l)/2,r=e-l+this.cropW,o=i-c+this.cropH;break;default:e=this.cropOffsertX-this.trueWidth*(1-this.scale)/2,i=this.cropOffsertY-this.trueHeight*(1-this.scale)/2,r=e-c+this.cropW,o=i-l+this.cropH}a.x1>=s.x1&&(t=e),a.y1>=s.y1&&(n=i),a.x2<=s.x2&&(t=r),a.y2<=s.y2&&(n=o)}this.x=t,this.y=n,this.$emit("img-moving",{moving:!0,axis:this.getImgAxis()})}))},leaveImg(e){window.removeEventListener("mousemove",this.moveImg),window.removeEventListener("touchmove",this.moveImg),window.removeEventListener("mouseup",this.leaveImg),window.removeEventListener("touchend",this.leaveImg),this.$emit("img-moving",{moving:!1,axis:this.getImgAxis()})},scaleImg(){this.canScale&&window.addEventListener(this.support,this.changeSize,this.passive)},cancelScale(){this.canScale&&window.removeEventListener(this.support,this.changeSize)},changeSize(e){e.preventDefault();let t=this.scale;var n=e.deltaY||e.wheelDelta;n=navigator.userAgent.indexOf("Firefox")>0?30*n:n,this.isIE&&(n=-n);var i=this.coe,r=(i=i/this.trueWidth>i/this.trueHeight?i/this.trueHeight:i/this.trueWidth)*n;r<0?t+=Math.abs(r):t>Math.abs(r)&&(t-=Math.abs(r));let o=r<0?"add":"reduce";if(o!==this.coeStatus&&(this.coeStatus=o,this.coe=.2),this.scaling||(this.scalingSet=setTimeout((()=>{this.scaling=!1,this.coe=this.coe+=.01}),50)),this.scaling=!0,!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},changeScale(e){let t=this.scale;e=e||1;var n=20;if((e*=n=n/this.trueWidth>n/this.trueHeight?n/this.trueHeight:n/this.trueWidth)>0?t+=Math.abs(e):t>Math.abs(e)&&(t-=Math.abs(e)),!this.checkoutImgAxis(this.x,this.y,t))return!1;this.scale=t},createCrop(e){e.preventDefault();var t="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,n="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;this.$nextTick((()=>{var e=t-this.cropX,i=n-this.cropY;if(e>0?(this.cropW=e+this.cropChangeX>this.w?this.w-this.cropChangeX:e,this.cropOffsertX=this.cropChangeX):(this.cropW=this.w-this.cropChangeX+Math.abs(e)>this.w?this.cropChangeX:Math.abs(e),this.cropOffsertX=this.cropChangeX+e>0?this.cropChangeX+e:0),this.fixed){var r=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];r+this.cropOffsertY>this.h?(this.cropH=this.h-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],this.cropOffsertX=e>0?this.cropChangeX:this.cropChangeX-this.cropW):this.cropH=r,this.cropOffsertY=this.cropOffsertY}else i>0?(this.cropH=i+this.cropChangeY>this.h?this.h-this.cropChangeY:i,this.cropOffsertY=this.cropChangeY):(this.cropH=this.h-this.cropChangeY+Math.abs(i)>this.h?this.cropChangeY:Math.abs(i),this.cropOffsertY=this.cropChangeY+i>0?this.cropChangeY+i:0)}))},changeCropSize(e,t,n,i,r){e.preventDefault(),window.addEventListener("mousemove",this.changeCropNow),window.addEventListener("mouseup",this.changeCropEnd),window.addEventListener("touchmove",this.changeCropNow),window.addEventListener("touchend",this.changeCropEnd),this.canChangeX=t,this.canChangeY=n,this.changeCropTypeX=i,this.changeCropTypeY=r,this.cropX="clientX"in e?e.clientX:e.touches[0].clientX,this.cropY="clientY"in e?e.clientY:e.touches[0].clientY,this.cropOldW=this.cropW,this.cropOldH=this.cropH,this.cropChangeX=this.cropOffsertX,this.cropChangeY=this.cropOffsertY,this.fixed&&this.canChangeX&&this.canChangeY&&(this.canChangeY=0),this.$emit("change-crop-size",{width:this.cropW,height:this.cropH})},changeCropNow(e){e.preventDefault();var t="clientX"in e?e.clientX:e.touches?e.touches[0].clientX:0,n="clientY"in e?e.clientY:e.touches?e.touches[0].clientY:0;let i=this.w,r=this.h,o=0,a=0;if(this.centerBox){let e=this.getImgAxis(),t=e.x2,n=e.y2;o=e.x1>0?e.x1:0,a=e.y1>0?e.y1:0,i>t&&(i=t),r>n&&(r=n)}const[s,l]=this.checkCropLimitSize();this.$nextTick((()=>{var e=t-this.cropX,c=n-this.cropY;if(this.canChangeX&&(1===this.changeCropTypeX?this.cropOldW-e<s?(this.cropW=s,this.cropOffsertX=this.cropOldW+this.cropChangeX-o-s):this.cropOldW-e>0?(this.cropW=i-this.cropChangeX-e<=i-o?this.cropOldW-e:this.cropOldW+this.cropChangeX-o,this.cropOffsertX=i-this.cropChangeX-e<=i-o?this.cropChangeX+e:o):(this.cropW=Math.abs(e)+this.cropChangeX<=i?Math.abs(e)-this.cropOldW:i-this.cropOldW-this.cropChangeX,this.cropOffsertX=this.cropChangeX+this.cropOldW):2===this.changeCropTypeX&&(this.cropOldW+e<s?this.cropW=s:this.cropOldW+e>0?(this.cropW=this.cropOldW+e+this.cropOffsertX<=i?this.cropOldW+e:i-this.cropOffsertX,this.cropOffsertX=this.cropChangeX):(this.cropW=i-this.cropChangeX+Math.abs(e+this.cropOldW)<=i-o?Math.abs(e+this.cropOldW):this.cropChangeX-o,this.cropOffsertX=i-this.cropChangeX+Math.abs(e+this.cropOldW)<=i-o?this.cropChangeX-Math.abs(e+this.cropOldW):o))),this.canChangeY&&(1===this.changeCropTypeY?this.cropOldH-c<l?(this.cropH=l,this.cropOffsertY=this.cropOldH+this.cropChangeY-a-l):this.cropOldH-c>0?(this.cropH=r-this.cropChangeY-c<=r-a?this.cropOldH-c:this.cropOldH+this.cropChangeY-a,this.cropOffsertY=r-this.cropChangeY-c<=r-a?this.cropChangeY+c:a):(this.cropH=Math.abs(c)+this.cropChangeY<=r?Math.abs(c)-this.cropOldH:r-this.cropOldH-this.cropChangeY,this.cropOffsertY=this.cropChangeY+this.cropOldH):2===this.changeCropTypeY&&(this.cropOldH+c<l?this.cropH=l:this.cropOldH+c>0?(this.cropH=this.cropOldH+c+this.cropOffsertY<=r?this.cropOldH+c:r-this.cropOffsertY,this.cropOffsertY=this.cropChangeY):(this.cropH=r-this.cropChangeY+Math.abs(c+this.cropOldH)<=r-a?Math.abs(c+this.cropOldH):this.cropChangeY-a,this.cropOffsertY=r-this.cropChangeY+Math.abs(c+this.cropOldH)<=r-a?this.cropChangeY-Math.abs(c+this.cropOldH):a))),this.canChangeX&&this.fixed){var u=this.cropW/this.fixedNumber[0]*this.fixedNumber[1];u<l?(this.cropH=l,this.cropW=this.fixedNumber[0]*l/this.fixedNumber[1],1===this.changeCropTypeX&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):u+this.cropOffsertY>r?(this.cropH=r-this.cropOffsertY,this.cropW=this.cropH/this.fixedNumber[1]*this.fixedNumber[0],1===this.changeCropTypeX&&(this.cropOffsertX=this.cropChangeX+(this.cropOldW-this.cropW))):this.cropH=u}if(this.canChangeY&&this.fixed){var h=this.cropH/this.fixedNumber[1]*this.fixedNumber[0];h<s?(this.cropW=s,this.cropH=this.fixedNumber[1]*s/this.fixedNumber[0],this.cropOffsertY=this.cropOldH+this.cropChangeY-this.cropH):h+this.cropOffsertX>i?(this.cropW=i-this.cropOffsertX,this.cropH=this.cropW/this.fixedNumber[0]*this.fixedNumber[1]):this.cropW=h}}))},checkCropLimitSize(){let{cropW:e,cropH:t,limitMinSize:n}=this,i=new Array;return i=Array.isArray(n)?n:[n,n],e=parseFloat(i[0]),t=parseFloat(i[1]),[e,t]},changeCropEnd(e){window.removeEventListener("mousemove",this.changeCropNow),window.removeEventListener("mouseup",this.changeCropEnd),window.removeEventListener("touchmove",this.changeCropNow),window.removeEventListener("touchend",this.changeCropEnd)},calculateSize(e,t,n,i,r,o){const a=e/t;let s=r,l=o;return s<n&&(s=n,l=Math.ceil(s/a)),l<i&&(l=i,s=Math.ceil(l*a),s<n&&(s=n,l=Math.ceil(s/a))),s<r&&(s=r,l=Math.ceil(s/a)),l<o&&(l=o,s=Math.ceil(l*a)),{width:s,height:l}},endCrop(){0===this.cropW&&0===this.cropH&&(this.cropping=!1);let[e,t]=this.checkCropLimitSize();const{width:n,height:i}=this.fixed?this.calculateSize(this.fixedNumber[0],this.fixedNumber[1],e,t,this.cropW,this.cropH):{width:e,height:t};n>this.cropW&&(this.cropW=n,this.cropOffsertX+n>this.w&&(this.cropOffsertX=this.w-n)),i>this.cropH&&(this.cropH=i,this.cropOffsertY+i>this.h&&(this.cropOffsertY=this.h-i)),window.removeEventListener("mousemove",this.createCrop),window.removeEventListener("mouseup",this.endCrop),window.removeEventListener("touchmove",this.createCrop),window.removeEventListener("touchend",this.endCrop)},startCrop(){this.crop=!0},stopCrop(){this.crop=!1},clearCrop(){this.cropping=!1,this.cropW=0,this.cropH=0},cropMove(e){if(e.preventDefault(),!this.canMoveBox)return this.crop=!1,this.startMove(e),!1;if(e.touches&&2===e.touches.length)return this.crop=!1,this.startMove(e),this.leaveCrop(),!1;window.addEventListener("mousemove",this.moveCrop),window.addEventListener("mouseup",this.leaveCrop),window.addEventListener("touchmove",this.moveCrop),window.addEventListener("touchend",this.leaveCrop);let t,n,i="clientX"in e?e.clientX:e.touches[0].clientX,r="clientY"in e?e.clientY:e.touches[0].clientY;t=i-this.cropOffsertX,n=r-this.cropOffsertY,this.cropX=t,this.cropY=n,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})},moveCrop(e,t){let n=0,i=0;e&&(e.preventDefault(),n="clientX"in e?e.clientX:e.touches[0].clientX,i="clientY"in e?e.clientY:e.touches[0].clientY),this.$nextTick((()=>{let e,r,o=n-this.cropX,a=i-this.cropY;if(t&&(o=this.cropOffsertX,a=this.cropOffsertY),e=o<=0?0:o+this.cropW>this.w?this.w-this.cropW:o,r=a<=0?0:a+this.cropH>this.h?this.h-this.cropH:a,this.centerBox){let t=this.getImgAxis();e<=t.x1&&(e=t.x1),e+this.cropW>t.x2&&(e=t.x2-this.cropW),r<=t.y1&&(r=t.y1),r+this.cropH>t.y2&&(r=t.y2-this.cropH)}this.cropOffsertX=e,this.cropOffsertY=r,this.$emit("crop-moving",{moving:!0,axis:this.getCropAxis()})}))},getImgAxis(e,t,n){e=e||this.x,t=t||this.y,n=n||this.scale;let i={x1:0,x2:0,y1:0,y2:0},r=this.trueWidth*n,o=this.trueHeight*n;switch(this.rotate){case 0:i.x1=e+this.trueWidth*(1-n)/2,i.x2=i.x1+this.trueWidth*n,i.y1=t+this.trueHeight*(1-n)/2,i.y2=i.y1+this.trueHeight*n;break;case 1:case-1:case 3:case-3:i.x1=e+this.trueWidth*(1-n)/2+(r-o)/2,i.x2=i.x1+this.trueHeight*n,i.y1=t+this.trueHeight*(1-n)/2+(o-r)/2,i.y2=i.y1+this.trueWidth*n;break;default:i.x1=e+this.trueWidth*(1-n)/2,i.x2=i.x1+this.trueWidth*n,i.y1=t+this.trueHeight*(1-n)/2,i.y2=i.y1+this.trueHeight*n}return i},getCropAxis(){let e={x1:0,x2:0,y1:0,y2:0};return e.x1=this.cropOffsertX,e.x2=e.x1+this.cropW,e.y1=this.cropOffsertY,e.y2=e.y1+this.cropH,e},leaveCrop(e){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.$emit("crop-moving",{moving:!1,axis:this.getCropAxis()})},getCropChecked(e){let t=document.createElement("canvas"),n=t.getContext("2d"),i=new Image,r=this.rotate,o=this.trueWidth,a=this.trueHeight,s=this.cropOffsertX,l=this.cropOffsertY;i.onload=()=>{if(0!==this.cropW){let e=1;this.high&!this.full&&(e=window.devicePixelRatio),1!==this.enlarge&!this.full&&(e=Math.abs(Number(this.enlarge)));let t=this.cropW*e,c=this.cropH*e,h=o*this.scale*e,d=a*this.scale*e,f=(this.x-s+this.trueWidth*(1-this.scale)/2)*e,p=(this.y-l+this.trueHeight*(1-this.scale)/2)*e;switch(u(t,c),n.save(),r){case 0:this.full?(u(t/this.scale,c/this.scale),n.drawImage(i,f/this.scale,p/this.scale,h/this.scale,d/this.scale)):n.drawImage(i,f,p,h,d);break;case 1:case-3:this.full?(u(t/this.scale,c/this.scale),f=f/this.scale+(h/this.scale-d/this.scale)/2,p=p/this.scale+(d/this.scale-h/this.scale)/2,n.rotate(90*r*Math.PI/180),n.drawImage(i,p,-f-d/this.scale,h/this.scale,d/this.scale)):(f+=(h-d)/2,p+=(d-h)/2,n.rotate(90*r*Math.PI/180),n.drawImage(i,p,-f-d,h,d));break;case 2:case-2:this.full?(u(t/this.scale,c/this.scale),n.rotate(90*r*Math.PI/180),f/=this.scale,p/=this.scale,n.drawImage(i,-f-h/this.scale,-p-d/this.scale,h/this.scale,d/this.scale)):(n.rotate(90*r*Math.PI/180),n.drawImage(i,-f-h,-p-d,h,d));break;case 3:case-1:this.full?(u(t/this.scale,c/this.scale),f=f/this.scale+(h/this.scale-d/this.scale)/2,p=p/this.scale+(d/this.scale-h/this.scale)/2,n.rotate(90*r*Math.PI/180),n.drawImage(i,-p-h/this.scale,f,h/this.scale,d/this.scale)):(f+=(h-d)/2,p+=(d-h)/2,n.rotate(90*r*Math.PI/180),n.drawImage(i,-p-h,f,h,d));break;default:this.full?(u(t/this.scale,c/this.scale),n.drawImage(i,f/this.scale,p/this.scale,h/this.scale,d/this.scale)):n.drawImage(i,f,p,h,d)}n.restore()}else{let e=o*this.scale,t=a*this.scale;switch(n.save(),r){case 0:u(e,t),n.drawImage(i,0,0,e,t);break;case 1:case-3:u(t,e),n.rotate(90*r*Math.PI/180),n.drawImage(i,0,-t,e,t);break;case 2:case-2:u(e,t),n.rotate(90*r*Math.PI/180),n.drawImage(i,-e,-t,e,t);break;case 3:case-1:u(t,e),n.rotate(90*r*Math.PI/180),n.drawImage(i,-e,0,e,t);break;default:u(e,t),n.drawImage(i,0,0,e,t)}n.restore()}e(t)},"data"!==this.img.substr(0,4)&&(i.crossOrigin="Anonymous"),i.src=this.imgs;const c=this.fillColor;function u(e,i){t.width=Math.round(e),t.height=Math.round(i),c&&(n.fillStyle=c,n.fillRect(0,0,t.width,t.height))}},getCropData(e){this.getCropChecked((t=>{e(t.toDataURL("image/"+this.outputType,this.outputSize))}))},getCropBlob(e){this.getCropChecked((t=>{t.toBlob((t=>e(t)),"image/"+this.outputType,this.outputSize)}))},showPreview(){if(!this.isCanShow)return!1;this.isCanShow=!1,setTimeout((()=>{this.isCanShow=!0}),16);let e=this.cropW,t=this.cropH,n=this.scale;var i={};i.div={width:`${e}px`,height:`${t}px`};let r=(this.x-this.cropOffsertX)/n,o=(this.y-this.cropOffsertY)/n;i.w=e,i.h=t,i.url=this.imgs,i.img={width:`${this.trueWidth}px`,height:`${this.trueHeight}px`,transform:`scale(${n})translate3d(${r}px, ${o}px, 0px)rotateZ(${90*this.rotate}deg)`},i.html=`\n      <div class="show-preview" style="width: ${i.w}px; height: ${i.h}px,; overflow: hidden">\n        <div style="width: ${e}px; height: ${t}px">\n          <img src=${i.url} style="width: ${this.trueWidth}px; height: ${this.trueHeight}px; transform:\n          scale(${n})translate3d(${r}px, ${o}px, 0px)rotateZ(${90*this.rotate}deg)">\n        </div>\n      </div>`,this.$emit("real-time",i)},reload(){let e=new Image;e.onload=()=>{this.w=parseFloat(window.getComputedStyle(this.$refs.cropper).width),this.h=parseFloat(window.getComputedStyle(this.$refs.cropper).height),this.trueWidth=e.width,this.trueHeight=e.height,this.original?this.scale=1:this.scale=this.checkedMode(),this.$nextTick((()=>{this.x=-(this.trueWidth-this.trueWidth*this.scale)/2+(this.w-this.trueWidth*this.scale)/2,this.y=-(this.trueHeight-this.trueHeight*this.scale)/2+(this.h-this.trueHeight*this.scale)/2,this.loading=!1,this.autoCrop&&this.goAutoCrop(),this.$emit("img-load","success"),setTimeout((()=>{this.showPreview()}),20)}))},e.onerror=()=>{this.$emit("img-load","error")},e.src=this.imgs},checkedMode(){let e=1,t=this.trueWidth,n=this.trueHeight;const i=this.mode.split(" ");switch(i[0]){case"contain":this.trueWidth>this.w&&(e=this.w/this.trueWidth),this.trueHeight*e>this.h&&(e=this.h/this.trueHeight);break;case"cover":t=this.w,e=t/this.trueWidth,n*=e,n<this.h&&(n=this.h,e=n/this.trueHeight);break;default:try{let r=i[0];if(-1!==r.search("px")){r=r.replace("px",""),t=parseFloat(r);const o=t/this.trueWidth;let a=1,s=i[1];-1!==s.search("px")&&(s=s.replace("px",""),n=parseFloat(s),a=n/this.trueHeight),e=Math.min(o,a)}if(-1!==r.search("%")&&(r=r.replace("%",""),t=parseFloat(r)/100*this.w,e=t/this.trueWidth),2===i.length&&"auto"===r){let t=i[1];-1!==t.search("px")&&(t=t.replace("px",""),n=parseFloat(t),e=n/this.trueHeight),-1!==t.search("%")&&(t=t.replace("%",""),n=parseFloat(t)/100*this.h,e=n/this.trueHeight)}}catch(r){e=1}}return e},goAutoCrop(e,t){if(""===this.imgs||null===this.imgs)return;this.clearCrop(),this.cropping=!0;let n=this.w,i=this.h;if(this.centerBox){const e=Math.abs(this.rotate)%2>0;let t=(e?this.trueHeight:this.trueWidth)*this.scale,r=(e?this.trueWidth:this.trueHeight)*this.scale;n=t<n?t:n,i=r<i?r:i}var r=e||parseFloat(this.autoCropWidth),o=t||parseFloat(this.autoCropHeight);(0===r||0===o)&&(r=.8*n,o=.8*i),r=r>n?n:r,o=o>i?i:o,this.fixed&&(o=r/this.fixedNumber[0]*this.fixedNumber[1]),o>this.h&&(r=(o=this.h)/this.fixedNumber[1]*this.fixedNumber[0]),this.changeCrop(r,o)},changeCrop(e,t){if(this.centerBox){let n=this.getImgAxis();e>n.x2-n.x1&&(t=(e=n.x2-n.x1)/this.fixedNumber[0]*this.fixedNumber[1]),t>n.y2-n.y1&&(e=(t=n.y2-n.y1)/this.fixedNumber[1]*this.fixedNumber[0])}this.cropW=e,this.cropH=t,this.checkCropLimitSize(),this.$nextTick((()=>{this.cropOffsertX=(this.w-this.cropW)/2,this.cropOffsertY=(this.h-this.cropH)/2,this.centerBox&&this.moveCrop(null,!0)}))},refresh(){this.img,this.imgs="",this.scale=1,this.crop=!1,this.rotate=0,this.w=0,this.h=0,this.trueWidth=0,this.trueHeight=0,this.imgIsQqualCrop=!1,this.clearCrop(),this.$nextTick((()=>{this.checkedImg()}))},rotateLeft(){this.rotate=this.rotate<=-3?0:this.rotate-1},rotateRight(){this.rotate=this.rotate>=3?0:this.rotate+1},rotateClear(){this.rotate=0},checkoutImgAxis(e,t,n){e=e||this.x,t=t||this.y,n=n||this.scale;let i=!0;if(this.centerBox){let r=this.getImgAxis(e,t,n),o=this.getCropAxis();r.x1>=o.x1&&(i=!1),r.x2<=o.x2&&(i=!1),r.y1>=o.y1&&(i=!1),r.y2<=o.y2&&(i=!1),i||this.changeImgScale(r,o,n)}return i},changeImgScale(e,t,n){let i=this.trueWidth,r=this.trueHeight,o=i*n,a=r*n;if(o>=this.cropW&&a>=this.cropH)this.scale=n;else{const e=this.cropW/i,t=this.cropH/r,n=this.cropH<=r*e?e:t;this.scale=n,o=i*n,a=r*n}this.imgIsQqualCrop||(e.x1>=t.x1&&(this.isRotateRightOrLeft?this.x=t.x1-(i-o)/2-(o-a)/2:this.x=t.x1-(i-o)/2),e.x2<=t.x2&&(this.isRotateRightOrLeft?this.x=t.x1-(i-o)/2-(o-a)/2-a+this.cropW:this.x=t.x2-(i-o)/2-o),e.y1>=t.y1&&(this.isRotateRightOrLeft?this.y=t.y1-(r-a)/2-(a-o)/2:this.y=t.y1-(r-a)/2),e.y2<=t.y2&&(this.isRotateRightOrLeft?this.y=t.y2-(r-a)/2-(a-o)/2-o:this.y=t.y2-(r-a)/2-a)),(o<this.cropW||a<this.cropH)&&(this.imgIsQqualCrop=!0)}},mounted(){this.support="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";let e=this;var t=navigator.userAgent;this.isIOS=!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(t,n,i){for(var r=atob(this.toDataURL(n,i).split(",")[1]),o=r.length,a=new Uint8Array(o),s=0;s<o;s++)a[s]=r.charCodeAt(s);t(new Blob([a],{type:e.type||"image/png"}))}}),this.showPreview(),this.checkedImg()},unmounted(){window.removeEventListener("mousemove",this.moveCrop),window.removeEventListener("mouseup",this.leaveCrop),window.removeEventListener("touchmove",this.moveCrop),window.removeEventListener("touchend",this.leaveCrop),this.cancelScale()}}),$L={key:0,class:"cropper-box"},qL=["src"],KL={class:"cropper-view-box"},JL=["src"],ZL={key:1};const eP=WL(XL,[["render",function(e,t,n,i,r,o){return ui(),hi("div",{class:"vue-cropper",ref:"cropper",onMouseover:t[28]||(t[28]=(...t)=>e.scaleImg&&e.scaleImg(...t)),onMouseout:t[29]||(t[29]=(...t)=>e.cancelScale&&e.cancelScale(...t))},[e.imgs?(ui(),hi("div",$L,[Mi(vi("div",{class:"cropper-box-canvas",style:Ni({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+e.x/e.scale+"px,"+e.y/e.scale+"px,0)rotateZ("+90*e.rotate+"deg)"})},[vi("img",{src:e.imgs,alt:"cropper-img",ref:"cropperImg"},null,8,qL)],4),[[$i,!e.loading]])])):Fi("",!0),vi("div",{class:fi(["cropper-drag-box",{"cropper-move":e.move&&!e.crop,"cropper-crop":e.crop,"cropper-modal":e.cropping}]),onMousedown:t[0]||(t[0]=(...t)=>e.startMove&&e.startMove(...t)),onTouchstart:t[1]||(t[1]=(...t)=>e.startMove&&e.startMove(...t))},null,34),Mi(vi("div",{class:"cropper-crop-box",style:Ni({width:e.cropW+"px",height:e.cropH+"px",transform:"translate3d("+e.cropOffsertX+"px,"+e.cropOffsertY+"px,0)"})},[vi("span",KL,[vi("img",{style:Ni({width:e.trueWidth+"px",height:e.trueHeight+"px",transform:"scale("+e.scale+","+e.scale+") translate3d("+(e.x-e.cropOffsertX)/e.scale+"px,"+(e.y-e.cropOffsertY)/e.scale+"px,0)rotateZ("+90*e.rotate+"deg)"}),src:e.imgs,alt:"cropper-img"},null,12,JL)]),vi("span",{class:"cropper-face cropper-move",onMousedown:t[2]||(t[2]=(...t)=>e.cropMove&&e.cropMove(...t)),onTouchstart:t[3]||(t[3]=(...t)=>e.cropMove&&e.cropMove(...t))},null,32),e.info?(ui(),hi("span",{key:0,class:"crop-info",style:Ni({top:e.cropInfo.top})},bi(e.cropInfo.width)+" × "+bi(e.cropInfo.height),5)):Fi("",!0),e.fixedBox?Fi("",!0):(ui(),hi("span",ZL,[vi("span",{class:"crop-line line-w",onMousedown:t[4]||(t[4]=t=>e.changeCropSize(t,!1,!0,0,1)),onTouchstart:t[5]||(t[5]=t=>e.changeCropSize(t,!1,!0,0,1))},null,32),vi("span",{class:"crop-line line-a",onMousedown:t[6]||(t[6]=t=>e.changeCropSize(t,!0,!1,1,0)),onTouchstart:t[7]||(t[7]=t=>e.changeCropSize(t,!0,!1,1,0))},null,32),vi("span",{class:"crop-line line-s",onMousedown:t[8]||(t[8]=t=>e.changeCropSize(t,!1,!0,0,2)),onTouchstart:t[9]||(t[9]=t=>e.changeCropSize(t,!1,!0,0,2))},null,32),vi("span",{class:"crop-line line-d",onMousedown:t[10]||(t[10]=t=>e.changeCropSize(t,!0,!1,2,0)),onTouchstart:t[11]||(t[11]=t=>e.changeCropSize(t,!0,!1,2,0))},null,32),vi("span",{class:"crop-point point1",onMousedown:t[12]||(t[12]=t=>e.changeCropSize(t,!0,!0,1,1)),onTouchstart:t[13]||(t[13]=t=>e.changeCropSize(t,!0,!0,1,1))},null,32),vi("span",{class:"crop-point point2",onMousedown:t[14]||(t[14]=t=>e.changeCropSize(t,!1,!0,0,1)),onTouchstart:t[15]||(t[15]=t=>e.changeCropSize(t,!1,!0,0,1))},null,32),vi("span",{class:"crop-point point3",onMousedown:t[16]||(t[16]=t=>e.changeCropSize(t,!0,!0,2,1)),onTouchstart:t[17]||(t[17]=t=>e.changeCropSize(t,!0,!0,2,1))},null,32),vi("span",{class:"crop-point point4",onMousedown:t[18]||(t[18]=t=>e.changeCropSize(t,!0,!1,1,0)),onTouchstart:t[19]||(t[19]=t=>e.changeCropSize(t,!0,!1,1,0))},null,32),vi("span",{class:"crop-point point5",onMousedown:t[20]||(t[20]=t=>e.changeCropSize(t,!0,!1,2,0)),onTouchstart:t[21]||(t[21]=t=>e.changeCropSize(t,!0,!1,2,0))},null,32),vi("span",{class:"crop-point point6",onMousedown:t[22]||(t[22]=t=>e.changeCropSize(t,!0,!0,1,2)),onTouchstart:t[23]||(t[23]=t=>e.changeCropSize(t,!0,!0,1,2))},null,32),vi("span",{class:"crop-point point7",onMousedown:t[24]||(t[24]=t=>e.changeCropSize(t,!1,!0,0,2)),onTouchstart:t[25]||(t[25]=t=>e.changeCropSize(t,!1,!0,0,2))},null,32),vi("span",{class:"crop-point point8",onMousedown:t[26]||(t[26]=t=>e.changeCropSize(t,!0,!0,2,2)),onTouchstart:t[27]||(t[27]=t=>e.changeCropSize(t,!0,!0,2,2))},null,32)]))],4),[[$i,e.cropping]])],544)}],["__scopeId","data-v-a742df44"]]),tP=e=>(Tr("data-v-eef55ae3"),e=e(),Dr(),e),nP={class:"main max-h-90v overflow-y-auto"},iP={class:"options"},rP=tP((()=>vi("label",null,"裁剪比例",-1))),oP={class:"flex mt-2 ratio-item-wrapper"},aP=[tP((()=>vi("div",{class:"ratio-item-content",style:{height:"70px",width:"70px"}}," 1:1 ",-1)))],sP=[tP((()=>vi("div",{class:"ratio-item-content",style:{height:"70px",width:"calc(70px * 2 / 3)"}}," 2:3 ",-1)))],lP=[tP((()=>vi("div",{class:"ratio-item-content",style:{height:"calc(70px * 2 / 3)",width:"70px"}}," 3:2 ",-1)))],cP=[tP((()=>vi("div",{class:"ratio-item-content",style:{height:"calc(70px * 3 / 4)",width:"70px"}}," 4:3 ",-1)))],uP=[tP((()=>vi("div",{class:"ratio-item-content",style:{width:"calc(70px * 3 / 4)",height:"70px"}}," 3:4 ",-1)))],hP=[tP((()=>vi("div",{class:"ratio-item-content",style:{height:"calc(70px * 9 / 16)",width:"70px"}}," 16:9 ",-1)))],dP=[tP((()=>vi("div",{class:"ratio-item-content",style:{width:"calc(70px * 9 / 16)",height:"70px"}}," 9:16 ",-1)))],fP=tP((()=>vi("label",null,"当前尺寸",-1))),pP={class:"flex mt-2"},gP=tP((()=>vi("span",{class:"mx-2"},"X",-1))),vP={class:"cropper-wrapper"},AP={class:"preview-wrapper"},mP=["src"],yP=tP((()=>vi("div",{class:"title"},"预览",-1))),bP={class:"dialog-footer"},CP=Or(ai({__name:"CropModal",setup(e,{expose:t}){const n=si(!1),i=si(),r=si(),o=si({width:"100px",height:"100px",overflow:"hidden",margin:"0"}),a=si(!1),s=si(),u=si(0),h=si(0);function d(e,t){v.value&&("width"===e?h.value=t*g.value[1]/g.value[0]:u.value=t*g.value[0]/g.value[1]),ki((()=>{i.value.goAutoCrop(Number(u.value),Number(h.value))}))}function f(e){0===e.w&&0===e.h?a.value=!0:a.value=!1,u.value=e.w,h.value=e.h,o.value={width:e.w+"px",height:e.h+"px",overflow:"hidden",margin:"0",zoom:100/e.w},s.value=e}function p(){n.value=!1}const g=si([1,1]),v=si(!1);function A(e){e?(v.value=!0,g.value=e):v.value=!1,ki((()=>{i.value.goAutoCrop(9999,9999)}))}let m=null;function y(){i.value.getCropData((e=>{m&&m(e),n.value=!1}))}return t({open(e,t){r.value=e.img,m=t,n.value=!0}}),(e,t)=>{const m=qt,b=Ze,C=et,w=nn;return ui(),Ai(w,{modelValue:pi(n),"onUpdate:modelValue":t[12]||(t[12]=e=>Qi(n)?n.value=e:null),onClose:p,title:"图片裁剪",width:"80%","destroy-on-close":"",style:{height:"80%"}},{footer:mi((()=>[vi("div",bP,[Hi(C,{onClick:p},{default:mi((()=>[Ri("取消")])),_:1}),Hi(C,{type:"primary",onClick:y},{default:mi((()=>[Ri(" 确认 ")])),_:1})])])),default:mi((()=>[vi("div",nP,[Hi(m,{size:"large",fix:"",show:pi(a)},{default:mi((()=>[Ri("图片加载中...")])),_:1},8,["show"]),vi("div",iP,[rP,vi("div",oP,[vi("div",{class:fi(["ratio-item",{active:!pi(v)}]),onClick:t[0]||(t[0]=e=>A())}," 自由 ",2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&1===pi(g)[0]&&1===pi(g)[1]}]),onClick:t[1]||(t[1]=e=>A([1,1]))},aP,2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&2===pi(g)[0]&&3===pi(g)[1]}]),onClick:t[2]||(t[2]=e=>A([2,3]))},sP,2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&3===pi(g)[0]&&2===pi(g)[1]}]),onClick:t[3]||(t[3]=e=>A([3,2]))},lP,2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&4===pi(g)[0]&&3===pi(g)[1]}]),onClick:t[4]||(t[4]=e=>A([4,3]))},cP,2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&3===pi(g)[0]&&4===pi(g)[1]}]),onClick:t[5]||(t[5]=e=>A([3,4]))},uP,2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&16===pi(g)[0]&&9===pi(g)[1]}]),onClick:t[6]||(t[6]=e=>A([16,9]))},hP,2),vi("div",{class:fi(["ratio-item",{active:pi(v)&&9===pi(g)[0]&&16===pi(g)[1]}]),onClick:t[7]||(t[7]=e=>A([9,16]))},dP,2)]),fP,vi("div",pP,[Hi(b,{modelValue:pi(u),"onUpdate:modelValue":t[8]||(t[8]=e=>Qi(u)?u.value=e:null),type:"number",onChange:t[9]||(t[9]=e=>d("width",Number(e)))},null,8,["modelValue"]),gP,Hi(b,{modelValue:pi(h),"onUpdate:modelValue":t[10]||(t[10]=e=>Qi(h)?h.value=e:null),type:"number",onChange:t[11]||(t[11]=e=>d("height",Number(e)))},null,8,["modelValue"])])]),vi("div",vP,[Hi(pi(eP),{ref_key:"cropperRef",ref:i,img:pi(r),outputSize:1,outputType:"png",autoCrop:"",fixed:pi(v),fixedNumber:pi(g),centerBox:"",fixedBox:!1,full:"",onRealTime:f},null,8,["img","fixed","fixedNumber"])]),vi("div",AP,[vi("div",{style:Ni([{height:"100px",width:"100px",border:"1px solid rgba(59, 130, 246, 0.5)"},pi(o)])},[pi(s)?(ui(),hi("div",{key:0,style:Ni(pi(s).div)},[vi("img",{src:pi(s).url,style:Ni(c(l({},pi(s).img),{maxWidth:pi(s).img.width}))},null,12,mP)],4)):Fi("",!0)],4),yP])])])),_:1},8,["modelValue"])}}}),[["__scopeId","data-v-eef55ae3"]]),wP={key:0,class:"attr-item-box mt-8px"},xP={class:"bg-item"},_P={__name:"index",setup(e){const t=ey(),{insertImgFile:n}=Wm,i=Ci(),{isOne:r}=_B(),o=si(""),a=si(),s=()=>{const e=t.canvas.getActiveObjects()[0];e&&"image"===e.type&&a.value.open({img:e._element.src},(i=>h(this,null,(function*(){const r=yield n(i);e.setSrc(r.src,(()=>{t.canvas.renderAll()})),r.remove()}))))},l=()=>{var e;const n=t.canvas.getActiveObjects()[0];n&&(o.value=n.type,null==(e=null==i?void 0:i.proxy)||e.$forceUpdate())};return ci((()=>{ki((()=>{var e;null==(e=t.editor)||e.on("selectOne",l)}))})),or((()=>{t.editor.off("selectOne",l)})),(e,t)=>{const n=et;return ui(),hi(ji,null,[pi(r)&&"image"===pi(o)?(ui(),hi("div",wP,[vi("div",xP,[Hi(n,{class:"w-full",onClick:s,text:""},{default:mi((()=>[Ri(bi(e.$t("editor.cropImg")),1)])),_:1})])])):Fi("",!0),Hi(CP,{ref_key:"cropperDialogRef",ref:a},null,512)],64)}}},EP={key:0,class:"attr-item-box mt-8px"},SP={class:"bg-item"},IP=Or(ai({__name:"ReplaceImg",setup(e){const t=ey(),{isOne:n}=_B(),{getImgStr:i,selectFiles:r,insertImgFile:o}=Wm,a=Ci(),s=si(""),l=()=>h(this,null,(function*(){var e;const n=null==(e=t.canvas)?void 0:e.getActiveObjects()[0];if(n&&"image"===n.type){const[e]=yield r({accept:"image/*",multiple:!1}),a=yield i(e),s=yield o(a),l=n.get("width"),c=n.get("height"),u=n.get("scaleX"),h=n.get("scaleY");n.setSrc(s.src,(()=>{var e;n.set("scaleX",l*u/s.width),n.set("scaleY",c*h/s.height),null==(e=t.canvas)||e.renderAll()})),s.remove()}})),c=()=>{var e,n;const i=null==(e=t.canvas)?void 0:e.getActiveObjects()[0];i&&(s.value=i.type,null==(n=null==a?void 0:a.proxy)||n.$forceUpdate())};return ci((()=>{ki((()=>{var e;null==(e=t.editor)||e.on("selectOne",c)}))})),or((()=>{var e;null==(e=t.editor)||e.off("selectOne",c)})),(e,t)=>{const i=et;return pi(n)&&"image"===pi(s)?(ui(),hi("div",EP,[vi("div",SP,[Hi(i,{onClick:l,text:""},{default:mi((()=>[Ri(bi(e.$t("editor.repleaceImg")),1)])),_:1})])])):Fi("",!0)}}}),[["__scopeId","data-v-cb8c52b2"]]),kP=ai({__name:"Edit",setup(e){const t=ey(),{isMatchType:n}=_B(["polygon"]),i=()=>{var e;const n=null==(e=t.editor.fabricCanvas)?void 0:e.getActiveObject();n&&"polygon"===n.type?t.editor.activeEdit():Gt.warning("请检查选择polygon")};return(e,t)=>{const r=en,o=et,a=nt;return pi(n)?(ui(),Ai(a,{key:0,content:e.$t("editor.quick.editPoly")},{default:mi((()=>[Hi(o,{onClick:i,link:""},{default:mi((()=>[Hi(r,{extClass:"text-20px",icon:"editor-brush"})])),_:1})])),_:1},8,["content"])):Fi("",!0)}}}),BP=Or(ai({__name:"Hide",setup(e){const t=ey(),{isOne:n}=_B(),i=si(!1),r=e=>{var n,r;(null==(n=t.canvas)?void 0:n.getActiveObject()).set("visible",!e),null==(r=t.canvas)||r.requestRenderAll(),i.value=e},o=()=>{var e;const n=null==(e=t.canvas)?void 0:e.getActiveObject();i.value=!n.visible};return ci((()=>{var e;null==(e=t.editor)||e.on("selectOne",o)})),or((()=>{var e;null==(e=t.editor)||e.off("selectOne",o)})),(e,t)=>{const o=et;return pi(n)?(ui(),Ai(o,{key:0,text:"",content:e.$t("editor.quick.hide")},{default:mi((()=>[pi(i)?(ui(),Ai(o,{key:0,onClick:t[0]||(t[0]=e=>r(!1)),icon:pi(kn),link:""},null,8,["icon"])):(ui(),Ai(o,{key:1,onClick:t[1]||(t[1]=e=>r(!0)),icon:pi(Bn),link:""},null,8,["icon"]))])),_:1},8,["content"])):Fi("",!0)}}}),[["__scopeId","data-v-e6c46ef3"]]),OP=ai({__name:"Clone",setup(e){const t=ey(),{isOne:n}=_B(),i=le((function(){t.editor.clone()}),300);return(e,t)=>{const r=et,o=nt;return pi(n)?(ui(),Ai(o,{key:0,content:e.$t("editor.quick.copy")},{default:mi((()=>[Hi(r,{onClick:pi(i),icon:pi(On),link:""},null,8,["onClick","icon"])])),_:1},8,["content"])):Fi("",!0)}}}),TP=ai({__name:"Delete",setup(e){const t=ey(),{isSelect:n}=_B(),i=le((function(){t.editor.del()}),300);return(e,t)=>{const r=et,o=nt;return pi(n)?(ui(),Ai(o,{key:0,content:e.$t("editor.quick.del")},{default:mi((()=>[Hi(r,{onClick:pi(i),icon:pi(sn),link:""},null,8,["onClick","icon"])])),_:1},8,["content"])):Fi("",!0)}}}),DP=Or(ai({__name:"Lock",setup(e){const t=ey(),{isOne:n}=_B(),i=si(!1),r=e=>{var n,i;e?null==(n=t.editor)||n.lock():null==(i=t.editor)||i.unLock()},o=e=>{i.value=!e[0].selectable};return ci((()=>{ki((()=>{var e;null==(e=t.editor)||e.on("selectOne",o)}))})),or((()=>{var e;null==(e=t.editor)||e.off("selectOne",o)})),(e,t)=>{const o=et,a=nt;return pi(n)?(ui(),Ai(a,{key:0,content:e.$t("quick.lock")},{default:mi((()=>[pi(i)?(ui(),Ai(o,{key:0,onClick:t[0]||(t[0]=e=>r(!1)),icon:pi(fn),link:""},null,8,["icon"])):(ui(),Ai(o,{key:1,onClick:t[1]||(t[1]=e=>r(!0)),icon:pi(pn),link:""},null,8,["icon"]))])),_:1},8,["content"])):Fi("",!0)}}}),[["__scopeId","data-v-c716c165"]]),MP={key:0,class:"attr-item-box"},QP={class:"bg-item"},LP=ai({__name:"CenterAlign",setup(e){const{isSelect:t}=_B(),n=ey(),i=e=>{n.editor.position(e)};return(e,n)=>{const r=tn,o=en,a=et,s=nt;return pi(t)?(ui(),hi("div",MP,[Hi(r,{"content-position":"left"},{default:mi((()=>[vi("h4",null,bi(e.$t("editor.attrSetting.centerAlign.name")),1)])),_:1}),vi("div",QP,[Hi(s,{content:e.$t("editor.attrSetting.centerAlign.centerX")},{default:mi((()=>[Hi(a,{onClick:n[0]||(n[0]=e=>i("centerH")),link:""},{default:mi((()=>[Hi(o,{extClass:"text-20px",color:"#fff",icon:"center-x"})])),_:1})])),_:1},8,["content"]),Hi(s,{content:e.$t("editor.attrSetting.centerAlign.center")},{default:mi((()=>[Hi(a,{onClick:n[1]||(n[1]=e=>i("center")),link:""},{default:mi((()=>[Hi(o,{extClass:"text-20px",color:"#fff",icon:"center-v"})])),_:1})])),_:1},8,["content"]),Hi(s,{content:e.$t("editor.attrSetting.centerAlign.centerY")},{default:mi((()=>[Hi(a,{onClick:n[2]||(n[2]=e=>i("centerV")),link:""},{default:mi((()=>[Hi(o,{extClass:"text-20px",color:"#fff",icon:"center-y"})])),_:1})])),_:1},8,["content"])])])):Fi("",!0)}}}),PP=Or(LP,[["__scopeId","data-v-0706c904"]]),jP={key:0,class:"attr-item-box"},RP=vi("h4",null,"对齐",-1),FP={class:"bg-item flex flex-wrap"},NP=ai({__name:"Align",setup(e){const{isMultiple:t}=_B(),n=ey(),i=()=>{n.editor.left()},r=()=>{n.editor.right()},o=()=>{n.editor.xcenter()},a=()=>{n.editor.ycenter()},s=()=>{n.editor.top()},l=()=>{n.editor.bottom()},c=()=>{n.editor.xequation()},u=()=>{n.editor.yequation()};return(e,n)=>{const h=tn,d=en,f=et,p=nt;return pi(t)?(ui(),hi("div",jP,[Hi(h,{"content-position":"left"},{default:mi((()=>[RP])),_:1}),vi("div",FP,[Hi(p,{content:e.$t("editor.attrSetting.align.left")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:i,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"left"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.centerX")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:o,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"centerx"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.right")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:r,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"right"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.top")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:s,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"top"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.centerY")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:a,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"centery"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.bottom")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:l,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"bottom"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.averageX")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:c,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"sx"})])),_:1})])),_:1},8,["content"]),Hi(p,{content:e.$t("editor.attrSetting.align.averageY")},{default:mi((()=>[Hi(f,{class:"w-36px",onClick:u,size:"small",link:""},{default:mi((()=>[Hi(d,{extClass:"text-20px",icon:"sy"})])),_:1})])),_:1},8,["content"])])])):Fi("",!0)}}}),VP={key:0,class:"attr-item-box"},UP={class:"bg-item"},zP=Or(ai({__name:"Group",setup(e){const t=ey(),{isGroup:n,isMultiple:i}=_B(),r=()=>{t.editor.unGroup()},o=()=>{t.editor.group()};return(e,t)=>{const a=en,s=et;return pi(i)||pi(n)?(ui(),hi("div",VP,[vi("div",UP,[pi(i)?(ui(),Ai(s,{key:0,disabled:!pi(i),onClick:o},{default:mi((()=>[Hi(a,{extClass:"text-20px",color:"#fff",icon:"group"}),Ri(" "+bi(e.$t("editor.attrSetting.group")),1)])),_:1},8,["disabled"])):Fi("",!0),pi(n)?(ui(),Ai(s,{key:1,disabled:!pi(n),onClick:r},{default:mi((()=>[Hi(a,{extClass:"text-20px",color:"#fff",icon:"un-group"}),Ri(" "+bi(e.$t("editor.attrSetting.unGroup")),1)])),_:1},8,["disabled"])):Fi("",!0)])])):Fi("",!0)}}}),[["__scopeId","data-v-11b4505b"]]),HP={key:0},YP={class:"attr-item-box"},GP={class:"attr-item-box"},WP={class:"color-list"},XP=["onClick"],$P={class:"attr-item-box"},qP=(e=>(Tr("data-v-cc937672"),e=e(),Dr(),e))((()=>vi("h4",null,"背景图",-1))),KP={class:"f-center"},JP=ai({__name:"BgBar",setup(e){const{isSelect:t}=_B(),n=ey(),{getImgStr:i,selectFiles:r}=Wm,o=si(["#5F2B63","#B23554","#F27E56","#FCE766","#86DCCD","#E7FDCB","#FFDC84","#F57677","#5FC2C7","#98DFE5","#C2EFF3","#DDFDFD","#9EE9D3","#2FC6C8","#2D7A9D","#48466d","#61c0bf","#bbded6","#fae3d9","#ffb6b9","#ffaaa5","#ffd3b6","#dcedc1","#a8e6cf"]),a=si("rgba(255, 255, 255, 1)"),s=()=>{l(a.value)};function l(e){var t;e&&(null==(t=n.canvas)||t.setBackgroundColor(e,n.canvas.renderAll.bind(n.canvas)),a.value=e)}const c=()=>{var e,t;const i=null==(e=n.canvas)?void 0:e.getObjects().find((e=>"workspace"===e.id));a.value=null!=(t=null==i?void 0:i.fill)?t:""},u=le((function(){r({accept:"image/*",multiple:!0}).then((e=>{Array.from(e).forEach((e=>{i(e).then((e=>{const t=new Image;t.crossOrigin="anonymous",t.src=e,t.onload=function(){const i=n.canvas,{width:r,height:o}=t,a=n.editor.getWorkspaceSize();i&&i.setBackgroundImage(e,null==i?void 0:i.renderAll.bind(i),{scaleX:a.width/r,scaleY:a.height/o})}}))}))}))}),250),h=le((function(){$t.confirm("您确定移除画布吗?","Warning",{title:"提示",type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}).then((()=>{var e;null==(e=n.canvas)||e.setBackgroundImage(null,n.canvas.renderAll.bind(n.canvas))}))}),250);return ci((()=>{ki((()=>{var e;null==(e=n.editor)||e.on("loadJson",c)}))})),zr((()=>{n.editor.off("loadJson",c)})),(e,n)=>{const i=tn,r=yg,c=et;return pi(t)?Fi("",!0):(ui(),hi("div",HP,[vi("div",YP,[Hi(i,{"content-position":"left"},{default:mi((()=>[vi("h4",null,bi(e.$t("editor.bgSeting.color")),1)])),_:1}),Hi(r,{modelValue:pi(a),"onUpdate:modelValue":n[0]||(n[0]=e=>Qi(a)?a.value=e:null),onChange:s,"show-alpha":""},null,8,["modelValue"])]),vi("div",GP,[Hi(i,{"content-position":"left"},{default:mi((()=>[vi("h4",null,bi(e.$t("editor.bgSeting.colorMacthing")),1)])),_:1}),vi("div",WP,[(ui(!0),hi(ji,null,Zi(pi(o),((e,t)=>(ui(),hi("span",{key:e+t,style:Ni(`background:${e}`),onClick:t=>l(e)},null,12,XP)))),128))])]),vi("div",$P,[Hi(i,{"content-position":"left"},{default:mi((()=>[qP])),_:1}),vi("div",KP,[Hi(c,{onClick:pi(h)},{default:mi((()=>[Ri(" 移除背景图 ")])),_:1},8,["onClick"]),Hi(c,{onClick:pi(u)},{default:mi((()=>[Ri(" 设置背景图 ")])),_:1},8,["onClick"])])])]))}}}),ZP=Or(JP,[["__scopeId","data-v-cc937672"]]),ej={key:0,class:"attr-item-box"},tj=Or(ai({__name:"SetSize",setup(e){const t=ey(),{isSelect:n}=_B(),i=900,r=1200,o=si(null),a=si(i),s=si(r);ci((()=>{ki((()=>{var e,n,i;const{width:r,height:o}=(null==(e=t.editor)?void 0:e.getWorkspaceSize())||{width:0,height:0};r>0&&(a.value=r),o>0&&(s.value=o),null==(n=t.editor)||n.setSize(a.value,s.value),null==(i=t.editor)||i.on("sizeChange",((e,t)=>{a.value=e,s.value=t}))}))}));const l=()=>{var e;null==(e=o.value)||e.showSetSize(a.value,s.value)},c=(e,n)=>{var i;a.value=e,s.value=n,null==(i=t.editor)||i.setSize(a.value,s.value)};return(e,t)=>{const i=tn,r=Ze,u=En,h=Se,d=et,f=Sn;return pi(n)?Fi("",!0):(ui(),hi("div",ej,[Hi(i,{"content-position":"left"},{default:mi((()=>[vi("h4",null,bi(e.$t("editor.bgSeting.size")),1)])),_:1}),Hi(f,{"label-width":40,inline:"",class:"flex"},{default:mi((()=>[Hi(u,{label:e.$t("editor.bgSeting.width"),prop:"name"},{default:mi((()=>[Hi(r,{style:{width:"60px"},disabled:"",modelValue:pi(a),"onUpdate:modelValue":t[0]||(t[0]=e=>Qi(a)?a.value=e:null),readonly:""},null,8,["modelValue"])])),_:1},8,["label"]),Hi(u,{label:e.$t("editor.bgSeting.height"),prop:"name"},{default:mi((()=>[Hi(r,{style:{width:"60px"},disabled:"",modelValue:pi(s),"onUpdate:modelValue":t[1]||(t[1]=e=>Qi(s)?s.value=e:null),readonly:""},null,8,["modelValue"])])),_:1},8,["label"]),Hi(u,{"label-width":0},{default:mi((()=>[Hi(d,{link:"",onClick:l},{default:mi((()=>[Hi(h,{size:"18"},{default:mi((()=>[Hi(pi(Tn))])),_:1})])),_:1})])),_:1})])),_:1}),Hi(Vk,{title:e.$t("editor.setSizeTip"),ref_key:"modalSizeRef",ref:o,onSet:c},null,8,["title"])]))}}}),[["__scopeId","data-v-1193b5b4"]]),nj={class:"right-bar flex-basis-304px box-border overflow-hidden p-10px"},ij={class:"attr-item-box"},rj=(e=>(Tr("data-v-ff72effd"),e=e(),Dr(),e))((()=>vi("h4",null,"快捷操作",-1))),oj={class:"bg-item"},aj=Or(ai({__name:"index",setup(e){const t=ey(),{mixinState:n}=_B(),i=Si((()=>t.editor));return(e,t)=>{const r=tj,o=ZP,a=zP,s=NP,l=PP,c=tn,u=DP,h=TP,d=OP,f=BP,p=kP,g=IP,v=_P,A=YL,m=NL,y=jL,b=nL,C=gQ,w=XM,x=QM,_=jD,E=vD,S=uD,I=iD,k=JT,B=GT,O=jT,T=bT,D=et;return ui(),hi("section",nj,[Mi(vi("div",null,[Hi(r),Hi(o)],512),[[$i,!pi(n).mSelectMode]]),Mi(vi("div",null,[Hi(a),Hi(s),Hi(l)],512),[[$i,"multiple"===pi(n).mSelectMode]]),Mi(vi("div",ij,[Hi(a),Hi(c,{"content-position":"left"},{default:mi((()=>[rj])),_:1}),Mi(vi("div",oj,[Hi(u),Hi(h),Hi(d),Hi(f),Hi(p)],512),[[$i,pi(n).mSelectMode]]),Hi(l),Hi(g),Hi(v),Hi(A),Hi(m),Hi(y),Hi(b),Hi(C),Hi(w),Hi(x),Hi(_),Hi(E),Hi(S),Hi(I),Hi(k),Hi(B),Hi(O),Hi(T),Hi(D,{onClick:t[0]||(t[0]=e=>pi(i).getFontJson()),size:"small"},{default:mi((()=>[Ri("获取元素数据")])),_:1})],512),[[$i,"one"===pi(n).mSelectMode]])])}}}),[["__scopeId","data-v-ff72effd"]]),sj=ai({__name:"index",setup:e=>(e,t)=>(ui(),hi(ji,null,[Hi(ZO),Hi(AT),Hi(aj)],64))}),lj={class:"editor-wrap"},cj=Or(ai(c(l({},{name:"Home"}),{__name:"index",setup(e){const t=iy(),n=ey(),i=Qr,r=new Qy;return ci((()=>{var e;const o=new vA.fabric.Canvas("canvas",{fireRightClick:!0,stopContextMenu:!0,controlsAboveOverlay:!0,preserveObjectStacking:!0});r.init(o),r.use(Ly).use(gb).use(Py).use(Fy).use(Ny).use(Vy).use(Uy).use(zy).use(Hy).use(Yy).use(Xy).use($y).use(qy).use(Ky).use(Jy).use(Zy).use(ab).use(vb).use(Ab).use(mb).use(mx).use(ok).use(dk).use(hb,{repoSrc:i}).use(sb,{repoSrc:i}).use(fx).use(fk).use(pk).use(vk).use(Ak),n.setEditor(r),n.setCanvas(o),n.rulerEnable&&r.rulerEnable();const a=xr();null==(e=null==a?void 0:a.query)||e.id;const{createTemplate:s}=jB();t.addTemplate(s())})),zr((()=>r.destory())),(e,t)=>{const n=Dn,i=Mn,r=Qn;return ui(),hi("div",lj,[Hi(r,null,{default:mi((()=>[Hi(n,null,{default:mi((()=>[Hi(Xk)])),_:1}),Hi(i,null,{default:mi((()=>[Hi(sj)])),_:1})])),_:1})])}}})),[["__scopeId","data-v-b4e2d999"]]);export{cj as default};
